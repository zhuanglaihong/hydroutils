
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://zhuanglaihong.github.io/hydroutils/api/hydroutils/">
      
      
        <link rel="prev" href="../../faq/">
      
      
        <link rel="next" href="../hydro_stat/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.17">
    
    
      
        <title>Overview - hydroutils</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.7e37652d.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="preference" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#api-reference" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="hydroutils" class="md-header__button md-logo" aria-label="hydroutils" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            hydroutils
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Overview
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/zhuanglaihong/hydroutils" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="hydroutils" class="md-nav__button md-logo" aria-label="hydroutils" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    hydroutils
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/zhuanglaihong/hydroutils" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Getting Started
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Getting Started
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../installation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Installation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../usage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Quick Start
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    FAQ
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    API Reference
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            API Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#core-module" class="md-nav__link">
    <span class="md-ellipsis">
      Core Module
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils" class="md-nav__link">
    <span class="md-ellipsis">
      hydroutils
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.HydroWarning" class="md-nav__link">
    <span class="md-ellipsis">
      HydroWarning
    </span>
  </a>
  
    <nav class="md-nav" aria-label="HydroWarning">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#hydroutils.HydroWarning.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.HydroWarning.file_not_found" class="md-nav__link">
    <span class="md-ellipsis">
      file_not_found
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.HydroWarning.no_directory" class="md-nav__link">
    <span class="md-ellipsis">
      no_directory
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.HydroWarning.operation_successful" class="md-nav__link">
    <span class="md-ellipsis">
      operation_successful
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.HydrographCorrector" class="md-nav__link">
    <span class="md-ellipsis">
      HydrographCorrector
    </span>
  </a>
  
    <nav class="md-nav" aria-label="HydrographCorrector">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#hydroutils.HydrographCorrector.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.HydrographCorrector.apply_correction" class="md-nav__link">
    <span class="md-ellipsis">
      apply_correction
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.HydrographCorrector.cubic_spline_interpolation" class="md-nav__link">
    <span class="md-ellipsis">
      cubic_spline_interpolation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.HydrographCorrector.five_point_smooth" class="md-nav__link">
    <span class="md-ellipsis">
      five_point_smooth
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.NumpyArrayEncoder" class="md-nav__link">
    <span class="md-ellipsis">
      NumpyArrayEncoder
    </span>
  </a>
  
    <nav class="md-nav" aria-label="NumpyArrayEncoder">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#hydroutils.NumpyArrayEncoder.convert_ndarray" class="md-nav__link">
    <span class="md-ellipsis">
      convert_ndarray
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.NumpyArrayEncoder.default" class="md-nav__link">
    <span class="md-ellipsis">
      default
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.KGE" class="md-nav__link">
    <span class="md-ellipsis">
      KGE
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.apply_smooth_correction" class="md-nav__link">
    <span class="md-ellipsis">
      apply_smooth_correction
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.apply_water_balance_correction" class="md-nav__link">
    <span class="md-ellipsis">
      apply_water_balance_correction
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.assign_time_start_end" class="md-nav__link">
    <span class="md-ellipsis">
      assign_time_start_end
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.boto3_download_file" class="md-nav__link">
    <span class="md-ellipsis">
      boto3_download_file
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.boto3_upload_file" class="md-nav__link">
    <span class="md-ellipsis">
      boto3_upload_file
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.cal_4_stat_inds" class="md-nav__link">
    <span class="md-ellipsis">
      cal_4_stat_inds
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.cal_fdc" class="md-nav__link">
    <span class="md-ellipsis">
      cal_fdc
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.cal_stat" class="md-nav__link">
    <span class="md-ellipsis">
      cal_stat
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.cal_stat_gamma" class="md-nav__link">
    <span class="md-ellipsis">
      cal_stat_gamma
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.cal_stat_prcp_norm" class="md-nav__link">
    <span class="md-ellipsis">
      cal_stat_prcp_norm
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.calculate_utc_offset" class="md-nav__link">
    <span class="md-ellipsis">
      calculate_utc_offset
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.calculate_water_balance_metrics" class="md-nav__link">
    <span class="md-ellipsis">
      calculate_water_balance_metrics
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.create_median_labels" class="md-nav__link">
    <span class="md-ellipsis">
      create_median_labels
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.date_to_julian" class="md-nav__link">
    <span class="md-ellipsis">
      date_to_julian
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.download_a_file_from_google_drive" class="md-nav__link">
    <span class="md-ellipsis">
      download_a_file_from_google_drive
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.download_excel" class="md-nav__link">
    <span class="md-ellipsis">
      download_excel
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.download_one_zip" class="md-nav__link">
    <span class="md-ellipsis">
      download_one_zip
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.download_small_file" class="md-nav__link">
    <span class="md-ellipsis">
      download_small_file
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.download_small_zip" class="md-nav__link">
    <span class="md-ellipsis">
      download_small_zip
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.download_zip_files" class="md-nav__link">
    <span class="md-ellipsis">
      download_zip_files
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.ecdf" class="md-nav__link">
    <span class="md-ellipsis">
      ecdf
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.fms" class="md-nav__link">
    <span class="md-ellipsis">
      fms
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.generate_start0101_time_range" class="md-nav__link">
    <span class="md-ellipsis">
      generate_start0101_time_range
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.get_cache_dir" class="md-nav__link">
    <span class="md-ellipsis">
      get_cache_dir
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.get_lastest_file_in_a_dir" class="md-nav__link">
    <span class="md-ellipsis">
      get_lastest_file_in_a_dir
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.get_latest_file_in_a_lst" class="md-nav__link">
    <span class="md-ellipsis">
      get_latest_file_in_a_lst
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.get_year" class="md-nav__link">
    <span class="md-ellipsis">
      get_year
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.hydro_logger" class="md-nav__link">
    <span class="md-ellipsis">
      hydro_logger
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.intersect" class="md-nav__link">
    <span class="md-ellipsis">
      intersect
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.is_there_file" class="md-nav__link">
    <span class="md-ellipsis">
      is_there_file
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.mean_peak_timing" class="md-nav__link">
    <span class="md-ellipsis">
      mean_peak_timing
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.minio_download_file" class="md-nav__link">
    <span class="md-ellipsis">
      minio_download_file
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.minio_upload_file" class="md-nav__link">
    <span class="md-ellipsis">
      minio_upload_file
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.month_stat_for_daily_df" class="md-nav__link">
    <span class="md-ellipsis">
      month_stat_for_daily_df
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.plot_boxes_matplotlib" class="md-nav__link">
    <span class="md-ellipsis">
      plot_boxes_matplotlib
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.plot_boxs" class="md-nav__link">
    <span class="md-ellipsis">
      plot_boxs
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.plot_diff_boxes" class="md-nav__link">
    <span class="md-ellipsis">
      plot_diff_boxes
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.plot_ecdf" class="md-nav__link">
    <span class="md-ellipsis">
      plot_ecdf
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.plot_ecdfs" class="md-nav__link">
    <span class="md-ellipsis">
      plot_ecdfs
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.plot_ecdfs_matplot" class="md-nav__link">
    <span class="md-ellipsis">
      plot_ecdfs_matplot
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.plot_heat_map" class="md-nav__link">
    <span class="md-ellipsis">
      plot_heat_map
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.plot_map_carto" class="md-nav__link">
    <span class="md-ellipsis">
      plot_map_carto
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.plot_pdf_cdf" class="md-nav__link">
    <span class="md-ellipsis">
      plot_pdf_cdf
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.plot_quiver" class="md-nav__link">
    <span class="md-ellipsis">
      plot_quiver
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.plot_rainfall_runoff" class="md-nav__link">
    <span class="md-ellipsis">
      plot_rainfall_runoff
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.plot_rainfall_runoff_chai" class="md-nav__link">
    <span class="md-ellipsis">
      plot_rainfall_runoff_chai
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.plot_rainfall_runoff_xu" class="md-nav__link">
    <span class="md-ellipsis">
      plot_rainfall_runoff_xu
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.plot_scatter_with_11line" class="md-nav__link">
    <span class="md-ellipsis">
      plot_scatter_with_11line
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.plot_scatter_xyc" class="md-nav__link">
    <span class="md-ellipsis">
      plot_scatter_xyc
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.plot_ts" class="md-nav__link">
    <span class="md-ellipsis">
      plot_ts
    </span>
  </a>
  
    <nav class="md-nav" aria-label="plot_ts">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#hydroutils.plot_ts--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.plot_ts--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.plot_ts_map" class="md-nav__link">
    <span class="md-ellipsis">
      plot_ts_map
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.plot_ts_matplot" class="md-nav__link">
    <span class="md-ellipsis">
      plot_ts_matplot
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.random_choice_no_return" class="md-nav__link">
    <span class="md-ellipsis">
      random_choice_no_return
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.remove_abnormal_data" class="md-nav__link">
    <span class="md-ellipsis">
      remove_abnormal_data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.serialize_json" class="md-nav__link">
    <span class="md-ellipsis">
      serialize_json
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.serialize_json_np" class="md-nav__link">
    <span class="md-ellipsis">
      serialize_json_np
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.serialize_numpy" class="md-nav__link">
    <span class="md-ellipsis">
      serialize_numpy
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.serialize_pickle" class="md-nav__link">
    <span class="md-ellipsis">
      serialize_pickle
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.stat_error" class="md-nav__link">
    <span class="md-ellipsis">
      stat_error
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.stat_error_i" class="md-nav__link">
    <span class="md-ellipsis">
      stat_error_i
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.stat_errors" class="md-nav__link">
    <span class="md-ellipsis">
      stat_errors
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.swarmplot_without_legend" class="md-nav__link">
    <span class="md-ellipsis">
      swarmplot_without_legend
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.t2str" class="md-nav__link">
    <span class="md-ellipsis">
      t2str
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.t_days_lst2range" class="md-nav__link">
    <span class="md-ellipsis">
      t_days_lst2range
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.t_range_days" class="md-nav__link">
    <span class="md-ellipsis">
      t_range_days
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.t_range_days_timedelta" class="md-nav__link">
    <span class="md-ellipsis">
      t_range_days_timedelta
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.t_range_to_julian" class="md-nav__link">
    <span class="md-ellipsis">
      t_range_to_julian
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.t_range_years" class="md-nav__link">
    <span class="md-ellipsis">
      t_range_years
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.trans_norm" class="md-nav__link">
    <span class="md-ellipsis">
      trans_norm
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.unserialize_json" class="md-nav__link">
    <span class="md-ellipsis">
      unserialize_json
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.unserialize_json_ordered" class="md-nav__link">
    <span class="md-ellipsis">
      unserialize_json_ordered
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.unserialize_numpy" class="md-nav__link">
    <span class="md-ellipsis">
      unserialize_numpy
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.unserialize_pickle" class="md-nav__link">
    <span class="md-ellipsis">
      unserialize_pickle
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.unzip_file" class="md-nav__link">
    <span class="md-ellipsis">
      unzip_file
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.unzip_nested_zip" class="md-nav__link">
    <span class="md-ellipsis">
      unzip_nested_zip
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.validate_correction_quality" class="md-nav__link">
    <span class="md-ellipsis">
      validate_correction_quality
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.wilcoxon_t_test" class="md-nav__link">
    <span class="md-ellipsis">
      wilcoxon_t_test
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.wilcoxon_t_test_for_lst" class="md-nav__link">
    <span class="md-ellipsis">
      wilcoxon_t_test_for_lst
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.zip_extract" class="md-nav__link">
    <span class="md-ellipsis">
      zip_extract
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.zip_file_name_from_url" class="md-nav__link">
    <span class="md-ellipsis">
      zip_file_name_from_url
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#submodules" class="md-nav__link">
    <span class="md-ellipsis">
      Submodules
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Core Modules
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            Core Modules
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../hydro_stat/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Statistical Analysis
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../hydro_plot/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Visualization
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../hydro_time/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Time Processing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../hydro_file/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    File Operations
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" >
        
          
          <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Advanced Modules
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            Advanced Modules
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../hydro_arithmetric/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Mathematical Operations
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../hydro_s3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    AWS S3 Integration
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../hydro_log/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Logging Utilities
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Development
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Development
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../contributing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Contributing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../changelog/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Changelog
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="https://github.com/zhuanglaihong/hydroutils/issues" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Report Issues
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#core-module" class="md-nav__link">
    <span class="md-ellipsis">
      Core Module
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils" class="md-nav__link">
    <span class="md-ellipsis">
      hydroutils
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.HydroWarning" class="md-nav__link">
    <span class="md-ellipsis">
      HydroWarning
    </span>
  </a>
  
    <nav class="md-nav" aria-label="HydroWarning">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#hydroutils.HydroWarning.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.HydroWarning.file_not_found" class="md-nav__link">
    <span class="md-ellipsis">
      file_not_found
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.HydroWarning.no_directory" class="md-nav__link">
    <span class="md-ellipsis">
      no_directory
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.HydroWarning.operation_successful" class="md-nav__link">
    <span class="md-ellipsis">
      operation_successful
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.HydrographCorrector" class="md-nav__link">
    <span class="md-ellipsis">
      HydrographCorrector
    </span>
  </a>
  
    <nav class="md-nav" aria-label="HydrographCorrector">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#hydroutils.HydrographCorrector.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.HydrographCorrector.apply_correction" class="md-nav__link">
    <span class="md-ellipsis">
      apply_correction
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.HydrographCorrector.cubic_spline_interpolation" class="md-nav__link">
    <span class="md-ellipsis">
      cubic_spline_interpolation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.HydrographCorrector.five_point_smooth" class="md-nav__link">
    <span class="md-ellipsis">
      five_point_smooth
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.NumpyArrayEncoder" class="md-nav__link">
    <span class="md-ellipsis">
      NumpyArrayEncoder
    </span>
  </a>
  
    <nav class="md-nav" aria-label="NumpyArrayEncoder">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#hydroutils.NumpyArrayEncoder.convert_ndarray" class="md-nav__link">
    <span class="md-ellipsis">
      convert_ndarray
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.NumpyArrayEncoder.default" class="md-nav__link">
    <span class="md-ellipsis">
      default
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.KGE" class="md-nav__link">
    <span class="md-ellipsis">
      KGE
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.apply_smooth_correction" class="md-nav__link">
    <span class="md-ellipsis">
      apply_smooth_correction
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.apply_water_balance_correction" class="md-nav__link">
    <span class="md-ellipsis">
      apply_water_balance_correction
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.assign_time_start_end" class="md-nav__link">
    <span class="md-ellipsis">
      assign_time_start_end
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.boto3_download_file" class="md-nav__link">
    <span class="md-ellipsis">
      boto3_download_file
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.boto3_upload_file" class="md-nav__link">
    <span class="md-ellipsis">
      boto3_upload_file
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.cal_4_stat_inds" class="md-nav__link">
    <span class="md-ellipsis">
      cal_4_stat_inds
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.cal_fdc" class="md-nav__link">
    <span class="md-ellipsis">
      cal_fdc
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.cal_stat" class="md-nav__link">
    <span class="md-ellipsis">
      cal_stat
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.cal_stat_gamma" class="md-nav__link">
    <span class="md-ellipsis">
      cal_stat_gamma
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.cal_stat_prcp_norm" class="md-nav__link">
    <span class="md-ellipsis">
      cal_stat_prcp_norm
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.calculate_utc_offset" class="md-nav__link">
    <span class="md-ellipsis">
      calculate_utc_offset
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.calculate_water_balance_metrics" class="md-nav__link">
    <span class="md-ellipsis">
      calculate_water_balance_metrics
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.create_median_labels" class="md-nav__link">
    <span class="md-ellipsis">
      create_median_labels
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.date_to_julian" class="md-nav__link">
    <span class="md-ellipsis">
      date_to_julian
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.download_a_file_from_google_drive" class="md-nav__link">
    <span class="md-ellipsis">
      download_a_file_from_google_drive
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.download_excel" class="md-nav__link">
    <span class="md-ellipsis">
      download_excel
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.download_one_zip" class="md-nav__link">
    <span class="md-ellipsis">
      download_one_zip
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.download_small_file" class="md-nav__link">
    <span class="md-ellipsis">
      download_small_file
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.download_small_zip" class="md-nav__link">
    <span class="md-ellipsis">
      download_small_zip
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.download_zip_files" class="md-nav__link">
    <span class="md-ellipsis">
      download_zip_files
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.ecdf" class="md-nav__link">
    <span class="md-ellipsis">
      ecdf
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.fms" class="md-nav__link">
    <span class="md-ellipsis">
      fms
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.generate_start0101_time_range" class="md-nav__link">
    <span class="md-ellipsis">
      generate_start0101_time_range
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.get_cache_dir" class="md-nav__link">
    <span class="md-ellipsis">
      get_cache_dir
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.get_lastest_file_in_a_dir" class="md-nav__link">
    <span class="md-ellipsis">
      get_lastest_file_in_a_dir
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.get_latest_file_in_a_lst" class="md-nav__link">
    <span class="md-ellipsis">
      get_latest_file_in_a_lst
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.get_year" class="md-nav__link">
    <span class="md-ellipsis">
      get_year
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.hydro_logger" class="md-nav__link">
    <span class="md-ellipsis">
      hydro_logger
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.intersect" class="md-nav__link">
    <span class="md-ellipsis">
      intersect
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.is_there_file" class="md-nav__link">
    <span class="md-ellipsis">
      is_there_file
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.mean_peak_timing" class="md-nav__link">
    <span class="md-ellipsis">
      mean_peak_timing
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.minio_download_file" class="md-nav__link">
    <span class="md-ellipsis">
      minio_download_file
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.minio_upload_file" class="md-nav__link">
    <span class="md-ellipsis">
      minio_upload_file
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.month_stat_for_daily_df" class="md-nav__link">
    <span class="md-ellipsis">
      month_stat_for_daily_df
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.plot_boxes_matplotlib" class="md-nav__link">
    <span class="md-ellipsis">
      plot_boxes_matplotlib
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.plot_boxs" class="md-nav__link">
    <span class="md-ellipsis">
      plot_boxs
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.plot_diff_boxes" class="md-nav__link">
    <span class="md-ellipsis">
      plot_diff_boxes
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.plot_ecdf" class="md-nav__link">
    <span class="md-ellipsis">
      plot_ecdf
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.plot_ecdfs" class="md-nav__link">
    <span class="md-ellipsis">
      plot_ecdfs
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.plot_ecdfs_matplot" class="md-nav__link">
    <span class="md-ellipsis">
      plot_ecdfs_matplot
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.plot_heat_map" class="md-nav__link">
    <span class="md-ellipsis">
      plot_heat_map
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.plot_map_carto" class="md-nav__link">
    <span class="md-ellipsis">
      plot_map_carto
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.plot_pdf_cdf" class="md-nav__link">
    <span class="md-ellipsis">
      plot_pdf_cdf
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.plot_quiver" class="md-nav__link">
    <span class="md-ellipsis">
      plot_quiver
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.plot_rainfall_runoff" class="md-nav__link">
    <span class="md-ellipsis">
      plot_rainfall_runoff
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.plot_rainfall_runoff_chai" class="md-nav__link">
    <span class="md-ellipsis">
      plot_rainfall_runoff_chai
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.plot_rainfall_runoff_xu" class="md-nav__link">
    <span class="md-ellipsis">
      plot_rainfall_runoff_xu
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.plot_scatter_with_11line" class="md-nav__link">
    <span class="md-ellipsis">
      plot_scatter_with_11line
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.plot_scatter_xyc" class="md-nav__link">
    <span class="md-ellipsis">
      plot_scatter_xyc
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.plot_ts" class="md-nav__link">
    <span class="md-ellipsis">
      plot_ts
    </span>
  </a>
  
    <nav class="md-nav" aria-label="plot_ts">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#hydroutils.plot_ts--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.plot_ts--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.plot_ts_map" class="md-nav__link">
    <span class="md-ellipsis">
      plot_ts_map
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.plot_ts_matplot" class="md-nav__link">
    <span class="md-ellipsis">
      plot_ts_matplot
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.random_choice_no_return" class="md-nav__link">
    <span class="md-ellipsis">
      random_choice_no_return
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.remove_abnormal_data" class="md-nav__link">
    <span class="md-ellipsis">
      remove_abnormal_data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.serialize_json" class="md-nav__link">
    <span class="md-ellipsis">
      serialize_json
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.serialize_json_np" class="md-nav__link">
    <span class="md-ellipsis">
      serialize_json_np
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.serialize_numpy" class="md-nav__link">
    <span class="md-ellipsis">
      serialize_numpy
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.serialize_pickle" class="md-nav__link">
    <span class="md-ellipsis">
      serialize_pickle
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.stat_error" class="md-nav__link">
    <span class="md-ellipsis">
      stat_error
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.stat_error_i" class="md-nav__link">
    <span class="md-ellipsis">
      stat_error_i
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.stat_errors" class="md-nav__link">
    <span class="md-ellipsis">
      stat_errors
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.swarmplot_without_legend" class="md-nav__link">
    <span class="md-ellipsis">
      swarmplot_without_legend
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.t2str" class="md-nav__link">
    <span class="md-ellipsis">
      t2str
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.t_days_lst2range" class="md-nav__link">
    <span class="md-ellipsis">
      t_days_lst2range
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.t_range_days" class="md-nav__link">
    <span class="md-ellipsis">
      t_range_days
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.t_range_days_timedelta" class="md-nav__link">
    <span class="md-ellipsis">
      t_range_days_timedelta
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.t_range_to_julian" class="md-nav__link">
    <span class="md-ellipsis">
      t_range_to_julian
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.t_range_years" class="md-nav__link">
    <span class="md-ellipsis">
      t_range_years
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.trans_norm" class="md-nav__link">
    <span class="md-ellipsis">
      trans_norm
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.unserialize_json" class="md-nav__link">
    <span class="md-ellipsis">
      unserialize_json
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.unserialize_json_ordered" class="md-nav__link">
    <span class="md-ellipsis">
      unserialize_json_ordered
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.unserialize_numpy" class="md-nav__link">
    <span class="md-ellipsis">
      unserialize_numpy
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.unserialize_pickle" class="md-nav__link">
    <span class="md-ellipsis">
      unserialize_pickle
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.unzip_file" class="md-nav__link">
    <span class="md-ellipsis">
      unzip_file
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.unzip_nested_zip" class="md-nav__link">
    <span class="md-ellipsis">
      unzip_nested_zip
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.validate_correction_quality" class="md-nav__link">
    <span class="md-ellipsis">
      validate_correction_quality
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.wilcoxon_t_test" class="md-nav__link">
    <span class="md-ellipsis">
      wilcoxon_t_test
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.wilcoxon_t_test_for_lst" class="md-nav__link">
    <span class="md-ellipsis">
      wilcoxon_t_test_for_lst
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.zip_extract" class="md-nav__link">
    <span class="md-ellipsis">
      zip_extract
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.zip_file_name_from_url" class="md-nav__link">
    <span class="md-ellipsis">
      zip_file_name_from_url
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#submodules" class="md-nav__link">
    <span class="md-ellipsis">
      Submodules
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                



                  


  
  


<h1 id="api-reference">API Reference<a class="headerlink" href="#api-reference" title="Permanent link">&para;</a></h1>
<p>This section provides detailed documentation for all modules and functions in the <code>hydroutils</code> package.</p>
<h2 id="core-module">Core Module<a class="headerlink" href="#core-module" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-module">



<a id="hydroutils"></a>
    <div class="doc doc-contents first">

        <p>Author: Wenyu Ouyang
Date: 2022-12-02 10:42:19
LastEditTime: 2023-10-27 14:53:16
LastEditors: Wenyu Ouyang
Description: Top-level package for hydroutils.
FilePath: /hydroutils/hydroutils/<strong>init</strong>.py
Copyright (c) 2023-2024 Wenyu Ouyang. All rights reserved.</p>









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="hydroutils.HydroWarning" class="doc doc-heading">
            <code>HydroWarning</code>


<a href="#hydroutils.HydroWarning" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">


        <p>A class for handling and displaying hydrology-related warnings and messages.</p>
<p>This class provides methods for displaying formatted warning messages and operation
status using the rich library's console features.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="hydroutils.HydroWarning.console">console</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A rich.console.Console instance for formatted terminal output.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>







              <details class="quote">
                <summary>Source code in <code>hydroutils/hydro_log.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">HydroWarning</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A class for handling and displaying hydrology-related warnings and messages.</span>

<span class="sd">    This class provides methods for displaying formatted warning messages and operation</span>
<span class="sd">    status using the rich library&#39;s console features.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        console: A rich.console.Console instance for formatted terminal output.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initializes the HydroWarning with a rich console.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">console</span> <span class="o">=</span> <span class="n">Console</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">no_directory</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">directory_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="n">Text</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Displays a warning message for a missing directory.</span>

<span class="sd">        Args:</span>
<span class="sd">            directory_name: Name of the directory that was not found.</span>
<span class="sd">            message: Optional custom message. If None, a default message is used.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">message</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">message</span> <span class="o">=</span> <span class="n">Text</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;There is no such directory: </span><span class="si">{</span><span class="n">directory_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;bold red&quot;</span>
            <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">file_not_found</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="n">Text</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Displays a warning message for a missing file.</span>

<span class="sd">        Args:</span>
<span class="sd">            file_name: Name of the file that was not found.</span>
<span class="sd">            message: Optional custom message. If None, a default message is used.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">message</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">message</span> <span class="o">=</span> <span class="n">Text</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;We didn&#39;t find this file: </span><span class="si">{</span><span class="n">file_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;bold yellow&quot;</span>
            <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">operation_successful</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">operation_detail</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="n">Text</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Displays a success message for a completed operation.</span>

<span class="sd">        Args:</span>
<span class="sd">            operation_detail: Description of the successful operation.</span>
<span class="sd">            message: Optional custom message. If None, a default message is used.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">message</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">message</span> <span class="o">=</span> <span class="n">Text</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Operation Success: </span><span class="si">{</span><span class="n">operation_detail</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;bold green&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="hydroutils.HydroWarning.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">()</span></code>

<a href="#hydroutils.HydroWarning.__init__" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Initializes the HydroWarning with a rich console.</p>


            <details class="quote">
              <summary>Source code in <code>hydroutils/hydro_log.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initializes the HydroWarning with a rich console.&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">console</span> <span class="o">=</span> <span class="n">Console</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="hydroutils.HydroWarning.file_not_found" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">file_not_found</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#hydroutils.HydroWarning.file_not_found" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Displays a warning message for a missing file.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>file_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the file that was not found.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>message</code>
            </td>
            <td>
                  <code><span title="rich.text.Text">Text</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional custom message. If None, a default message is used.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>hydroutils/hydro_log.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">file_not_found</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="n">Text</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Displays a warning message for a missing file.</span>

<span class="sd">    Args:</span>
<span class="sd">        file_name: Name of the file that was not found.</span>
<span class="sd">        message: Optional custom message. If None, a default message is used.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">message</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">message</span> <span class="o">=</span> <span class="n">Text</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;We didn&#39;t find this file: </span><span class="si">{</span><span class="n">file_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;bold yellow&quot;</span>
        <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="hydroutils.HydroWarning.no_directory" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">no_directory</span><span class="p">(</span><span class="n">directory_name</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#hydroutils.HydroWarning.no_directory" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Displays a warning message for a missing directory.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>directory_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the directory that was not found.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>message</code>
            </td>
            <td>
                  <code><span title="rich.text.Text">Text</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional custom message. If None, a default message is used.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>hydroutils/hydro_log.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">no_directory</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">directory_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="n">Text</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Displays a warning message for a missing directory.</span>

<span class="sd">    Args:</span>
<span class="sd">        directory_name: Name of the directory that was not found.</span>
<span class="sd">        message: Optional custom message. If None, a default message is used.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">message</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">message</span> <span class="o">=</span> <span class="n">Text</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;There is no such directory: </span><span class="si">{</span><span class="n">directory_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;bold red&quot;</span>
        <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="hydroutils.HydroWarning.operation_successful" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">operation_successful</span><span class="p">(</span><span class="n">operation_detail</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#hydroutils.HydroWarning.operation_successful" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Displays a success message for a completed operation.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>operation_detail</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Description of the successful operation.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>message</code>
            </td>
            <td>
                  <code><span title="rich.text.Text">Text</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional custom message. If None, a default message is used.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>hydroutils/hydro_log.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">operation_successful</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">operation_detail</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="n">Text</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Displays a success message for a completed operation.</span>

<span class="sd">    Args:</span>
<span class="sd">        operation_detail: Description of the successful operation.</span>
<span class="sd">        message: Optional custom message. If None, a default message is used.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">message</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">message</span> <span class="o">=</span> <span class="n">Text</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Operation Success: </span><span class="si">{</span><span class="n">operation_detail</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;bold green&quot;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="hydroutils.HydrographCorrector" class="doc doc-heading">
            <code>HydrographCorrector</code>


<a href="#hydroutils.HydrographCorrector" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">


        <p>洪水过程线交互式修正器</p>
<p>基于《洪水预报过程的交互式修正技术研究》(章四龙, 2006)
实现五点二次平滑和三次样条插值的组合算法</p>







              <details class="quote">
                <summary>Source code in <code>hydroutils/hydro_correct.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">HydrographCorrector</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    洪水过程线交互式修正器</span>

<span class="sd">    基于《洪水预报过程的交互式修正技术研究》(章四龙, 2006)</span>
<span class="sd">    实现五点二次平滑和三次样条插值的组合算法</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time_points</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">discharge_values</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        初始化修正器</span>

<span class="sd">        Args:</span>
<span class="sd">            time_points: 时间点数组</span>
<span class="sd">            discharge_values: 径流值数组</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">time_points</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">discharge_original</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">discharge_values</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_points</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">discharge_values</span><span class="p">)</span>

        <span class="c1"># 预计算平滑矩阵（只需计算一次）</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">smoothing_matrix</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_smoothing_matrix</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_create_smoothing_matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">sparse</span><span class="o">.</span><span class="n">csr_matrix</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        构造五点二次平滑矩阵</span>

<span class="sd">        根据论文公式(5)-(7)构造稀疏矩阵，每行对应一个输出点的平滑系数</span>

<span class="sd">        Returns:</span>
<span class="sd">            稀疏平滑矩阵 (n x n)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_points</span>
        <span class="k">if</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">:</span>
            <span class="c1"># 对于少于5个点的数据，返回单位矩阵（不进行平滑）</span>
            <span class="k">return</span> <span class="n">sparse</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;csr&quot;</span><span class="p">)</span>

        <span class="c1"># 构造稀疏矩阵的行、列、数据</span>
        <span class="n">rows</span><span class="p">,</span> <span class="n">cols</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>

        <span class="c1"># 第一个点 (索引0) - 公式(6)第一个</span>
        <span class="c1"># y_{-2} = (31y_{-2} + 9y_{-1} - 3y_0 - 5y_1 + 3y_2) / 35</span>
        <span class="n">coeffs_0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">31</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span> <span class="o">/</span> <span class="mi">35</span>
        <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">coeff</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">coeffs_0</span><span class="p">):</span>
            <span class="n">rows</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">cols</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
            <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">coeff</span><span class="p">)</span>

        <span class="c1"># 第二个点 (索引1) - 公式(6)第二个</span>
        <span class="c1"># y_{-1} = (9y_{-2} + 13y_{-1} + 12y_0 + 6y_1 - 5y_2) / 35</span>
        <span class="n">coeffs_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">9</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">])</span> <span class="o">/</span> <span class="mi">35</span>
        <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">coeff</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">coeffs_1</span><span class="p">):</span>
            <span class="n">rows</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">cols</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
            <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">coeff</span><span class="p">)</span>

        <span class="c1"># 中间点 (索引2到n-3) - 公式(5)</span>
        <span class="c1"># y_0 = [-3(y_{-2} + y_2) + 12(y_{-1} + y_1) + 17y_0] / 35</span>
        <span class="n">coeffs_mid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">])</span> <span class="o">/</span> <span class="mi">35</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">2</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">coeff</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">coeffs_mid</span><span class="p">):</span>
                <span class="n">rows</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
                <span class="n">cols</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">j</span><span class="p">)</span>
                <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">coeff</span><span class="p">)</span>

        <span class="c1"># 倒数第二个点 (索引n-2) - 公式(7)第一个</span>
        <span class="c1"># y_1 = (-5y_{-2} + 6y_{-1} + 12y_0 + 13y_1 + 9y_2) / 35</span>
        <span class="n">coeffs_n2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">9</span><span class="p">])</span> <span class="o">/</span> <span class="mi">35</span>
        <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">coeff</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">coeffs_n2</span><span class="p">):</span>
            <span class="n">rows</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>
            <span class="n">cols</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">5</span> <span class="o">+</span> <span class="n">j</span><span class="p">)</span>
            <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">coeff</span><span class="p">)</span>

        <span class="c1"># 最后一个点 (索引n-1) - 公式(7)第二个</span>
        <span class="c1"># y_2 = (3y_{-2} - 5y_{-1} - 3y_0 + 9y_1 + 31y_2) / 35</span>
        <span class="n">coeffs_n1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">31</span><span class="p">])</span> <span class="o">/</span> <span class="mi">35</span>
        <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">coeff</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">coeffs_n1</span><span class="p">):</span>
            <span class="n">rows</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">cols</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">5</span> <span class="o">+</span> <span class="n">j</span><span class="p">)</span>
            <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">coeff</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">sparse</span><span class="o">.</span><span class="n">csr_matrix</span><span class="p">((</span><span class="n">data</span><span class="p">,</span> <span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="n">cols</span><span class="p">)),</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">five_point_smooth</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">discharge_values</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        对径流数据进行五点二次平滑</span>

<span class="sd">        Args:</span>
<span class="sd">            discharge_values: 径流值数组</span>

<span class="sd">        Returns:</span>
<span class="sd">            平滑后的径流值数组</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">discharge_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">discharge_values</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">discharge_values</span><span class="p">)</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_points</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;输入数据长度 </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">discharge_values</span><span class="p">)</span><span class="si">}</span><span class="s2"> 与初始化长度 </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">n_points</span><span class="si">}</span><span class="s2"> 不匹配&quot;</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

        <span class="c1"># 使用预计算的稀疏矩阵进行向量化平滑</span>
        <span class="n">smoothed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">smoothing_matrix</span> <span class="o">@</span> <span class="n">discharge_values</span>

        <span class="c1"># 确保结果非负（径流不能为负）</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">smoothed</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_build_spline_system</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
        <span class="n">y</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
        <span class="n">y_prime_start</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
        <span class="n">y_prime_end</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">sparse</span><span class="o">.</span><span class="n">csr_matrix</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        构造三次样条插值的线性方程组</span>

<span class="sd">        根据论文公式(17)-(21)构造三对角方程组 A·M = β</span>

<span class="sd">        Args:</span>
<span class="sd">            x: 节点位置数组</span>
<span class="sd">            y: 节点值数组</span>
<span class="sd">            y_prime_start: 起始点一阶导数边界条件</span>
<span class="sd">            y_prime_end: 终点一阶导数边界条件</span>

<span class="sd">        Returns:</span>
<span class="sd">            系数矩阵A和右端向量β</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>  <span class="c1"># 区间数</span>
        <span class="n">h</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>  <span class="c1"># h[i] = x[i+1] - x[i]</span>

        <span class="c1"># 构造三对角矩阵 A</span>
        <span class="n">main_diag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mf">2.0</span>

        <span class="c1"># 构造上下对角线</span>
        <span class="n">upper_diag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>  <span class="c1"># 长度为n的上对角线</span>
        <span class="n">lower_diag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>  <span class="c1"># 长度为n的下对角线</span>

        <span class="c1"># 边界条件</span>
        <span class="k">if</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">upper_diag</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1"># 第一行的边界条件</span>
            <span class="n">lower_diag</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1"># 最后一行的边界条件</span>

        <span class="c1"># 内节点的α系数</span>
        <span class="k">if</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">alpha</span> <span class="o">=</span> <span class="n">h</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">/</span> <span class="p">(</span><span class="n">h</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">h</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>  <span class="c1"># α_i = h_{i+1}/(h_i + h_{i+1})</span>

            <span class="c1"># 填充内节点的系数</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">alpha</span><span class="p">)):</span>
                <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">upper_diag</span><span class="p">):</span>
                    <span class="n">upper_diag</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">alpha</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">lower_diag</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">lower_diag</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">alpha</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

        <span class="c1"># 构造稀疏三对角矩阵</span>
        <span class="n">diagonals</span> <span class="o">=</span> <span class="p">[</span><span class="n">lower_diag</span><span class="p">,</span> <span class="n">main_diag</span><span class="p">,</span> <span class="n">upper_diag</span><span class="p">]</span>
        <span class="n">offsets</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
        <span class="n">A</span> <span class="o">=</span> <span class="n">sparse</span><span class="o">.</span><span class="n">diags</span><span class="p">(</span><span class="n">diagonals</span><span class="p">,</span> <span class="n">offsets</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;csr&quot;</span><span class="p">)</span>

        <span class="c1"># 构造右端向量β</span>
        <span class="n">beta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

        <span class="c1"># 边界条件 - 公式(19)(20)</span>
        <span class="k">if</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">beta</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">6.0</span> <span class="o">/</span> <span class="n">h</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="p">((</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="n">h</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">y_prime_start</span><span class="p">)</span>
            <span class="n">beta</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">6.0</span> <span class="o">/</span> <span class="n">h</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">y_prime_end</span> <span class="o">-</span> <span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">y</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span> <span class="o">/</span> <span class="n">h</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

        <span class="c1"># 内节点的β值 - 公式(17)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
            <span class="n">beta</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                <span class="mf">6.0</span>
                <span class="o">/</span> <span class="p">(</span><span class="n">h</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">h</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="o">*</span> <span class="p">((</span><span class="n">y</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">/</span> <span class="n">h</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="n">h</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="n">A</span><span class="p">,</span> <span class="n">beta</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_solve_spline_coefficients</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
        <span class="n">y</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
        <span class="n">y_prime_start</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
        <span class="n">y_prime_end</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        求解三次样条插值的二阶导数系数</span>

<span class="sd">        Args:</span>
<span class="sd">            x: 节点位置</span>
<span class="sd">            y: 节点值</span>
<span class="sd">            y_prime_start: 起始点导数边界条件</span>
<span class="sd">            y_prime_end: 终点导数边界条件</span>

<span class="sd">        Returns:</span>
<span class="sd">            节点处的二阶导数值M</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">A</span><span class="p">,</span> <span class="n">beta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_spline_system</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">y_prime_start</span><span class="p">,</span> <span class="n">y_prime_end</span><span class="p">)</span>

        <span class="c1"># 使用稀疏矩阵求解器（追赶法的高效实现）</span>
        <span class="n">M</span> <span class="o">=</span> <span class="n">spsolve</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">beta</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">M</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_evaluate_spline</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">x_nodes</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">y_nodes</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">M</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">x_new</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        计算三次样条函数在新点处的值</span>

<span class="sd">        使用论文公式(15)的向量化实现</span>

<span class="sd">        Args:</span>
<span class="sd">            x_nodes: 原始节点位置</span>
<span class="sd">            y_nodes: 原始节点值</span>
<span class="sd">            M: 节点处二阶导数</span>
<span class="sd">            x_new: 新的插值点位置</span>

<span class="sd">        Returns:</span>
<span class="sd">            插值结果</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">h</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x_nodes</span><span class="p">)</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x_nodes</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>

        <span class="c1"># 找到每个新点所在的区间</span>
        <span class="n">indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">searchsorted</span><span class="p">(</span><span class="n">x_nodes</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">x_new</span><span class="p">)</span>
        <span class="n">indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">indices</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>

        <span class="c1"># 向量化计算 - 公式(15)</span>
        <span class="n">x_left</span> <span class="o">=</span> <span class="n">x_nodes</span><span class="p">[</span><span class="n">indices</span><span class="p">]</span>
        <span class="n">x_right</span> <span class="o">=</span> <span class="n">x_nodes</span><span class="p">[</span><span class="n">indices</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
        <span class="n">y_left</span> <span class="o">=</span> <span class="n">y_nodes</span><span class="p">[</span><span class="n">indices</span><span class="p">]</span>
        <span class="n">y_right</span> <span class="o">=</span> <span class="n">y_nodes</span><span class="p">[</span><span class="n">indices</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
        <span class="n">M_left</span> <span class="o">=</span> <span class="n">M</span><span class="p">[</span><span class="n">indices</span><span class="p">]</span>
        <span class="n">M_right</span> <span class="o">=</span> <span class="n">M</span><span class="p">[</span><span class="n">indices</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
        <span class="n">h_seg</span> <span class="o">=</span> <span class="n">h</span><span class="p">[</span><span class="n">indices</span><span class="p">]</span>

        <span class="c1"># 样条公式的向量化实现</span>
        <span class="n">t1</span> <span class="o">=</span> <span class="p">(</span><span class="n">x_right</span> <span class="o">-</span> <span class="n">x_new</span><span class="p">)</span> <span class="o">/</span> <span class="n">h_seg</span>
        <span class="n">t2</span> <span class="o">=</span> <span class="p">(</span><span class="n">x_new</span> <span class="o">-</span> <span class="n">x_left</span><span class="p">)</span> <span class="o">/</span> <span class="n">h_seg</span>

        <span class="n">result</span> <span class="o">=</span> <span class="p">(</span>
            <span class="p">(</span><span class="n">t1</span><span class="o">**</span><span class="mi">3</span> <span class="o">*</span> <span class="n">M_left</span> <span class="o">+</span> <span class="n">t2</span><span class="o">**</span><span class="mi">3</span> <span class="o">*</span> <span class="n">M_right</span><span class="p">)</span> <span class="o">*</span> <span class="n">h_seg</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="mf">6.0</span>
            <span class="o">+</span> <span class="p">(</span><span class="n">y_left</span> <span class="o">-</span> <span class="n">M_left</span> <span class="o">*</span> <span class="n">h_seg</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="mf">6.0</span><span class="p">)</span> <span class="o">*</span> <span class="n">t1</span>
            <span class="o">+</span> <span class="p">(</span><span class="n">y_right</span> <span class="o">-</span> <span class="n">M_right</span> <span class="o">*</span> <span class="n">h_seg</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="mf">6.0</span><span class="p">)</span> <span class="o">*</span> <span class="n">t2</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">cubic_spline_interpolation</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">x_new</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        三次样条插值</span>

<span class="sd">        Args:</span>
<span class="sd">            x: 原始时间点</span>
<span class="sd">            y: 原始径流值</span>
<span class="sd">            x_new: 新的时间点（如果为None，则使用原始时间点）</span>

<span class="sd">        Returns:</span>
<span class="sd">            插值后的径流值</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">x_new</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">x_new</span> <span class="o">=</span> <span class="n">x</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">x_new</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">x_new</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">:</span>
            <span class="c1"># 对于少于3个点的数据，使用线性插值</span>
            <span class="kn">from</span><span class="w"> </span><span class="nn">scipy.interpolate</span><span class="w"> </span><span class="kn">import</span> <span class="n">interp1d</span>

            <span class="n">f</span> <span class="o">=</span> <span class="n">interp1d</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;linear&quot;</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="s2">&quot;extrapolate&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">f</span><span class="p">(</span><span class="n">x_new</span><span class="p">)</span>

        <span class="c1"># 设置边界条件（自然边界：二阶导数为0）</span>
        <span class="n">y_prime_start</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="n">y_prime_end</span> <span class="o">=</span> <span class="mf">0.0</span>

        <span class="c1"># 求解样条系数</span>
        <span class="n">M</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_solve_spline_coefficients</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">y_prime_start</span><span class="p">,</span> <span class="n">y_prime_end</span><span class="p">)</span>

        <span class="c1"># 计算插值结果</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_evaluate_spline</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">x_new</span><span class="p">)</span>

        <span class="c1"># 确保结果非负</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">apply_correction</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">modified_discharge</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
        <span class="n">smoothing_enabled</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">interpolation_enabled</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        应用完整的修正算法</span>

<span class="sd">        Args:</span>
<span class="sd">            modified_discharge: 修改后的径流数据</span>
<span class="sd">            smoothing_enabled: 是否启用五点平滑</span>
<span class="sd">            interpolation_enabled: 是否启用样条插值</span>

<span class="sd">        Returns:</span>
<span class="sd">            修正后的径流数据</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">modified_discharge</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="c1"># 步骤1：五点二次平滑</span>
        <span class="k">if</span> <span class="n">smoothing_enabled</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_points</span> <span class="o">&gt;=</span> <span class="mi">5</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">five_point_smooth</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

        <span class="c1"># 步骤2：三次样条插值</span>
        <span class="k">if</span> <span class="n">interpolation_enabled</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_points</span> <span class="o">&gt;=</span> <span class="mi">3</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cubic_spline_interpolation</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time_points</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">result</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="hydroutils.HydrographCorrector.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">time_points</span><span class="p">,</span> <span class="n">discharge_values</span><span class="p">)</span></code>

<a href="#hydroutils.HydrographCorrector.__init__" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>初始化修正器</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>time_points</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>时间点数组</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>discharge_values</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>径流值数组</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>hydroutils/hydro_correct.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time_points</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">discharge_values</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    初始化修正器</span>

<span class="sd">    Args:</span>
<span class="sd">        time_points: 时间点数组</span>
<span class="sd">        discharge_values: 径流值数组</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">time_points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">time_points</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">discharge_original</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">discharge_values</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">n_points</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">discharge_values</span><span class="p">)</span>

    <span class="c1"># 预计算平滑矩阵（只需计算一次）</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">smoothing_matrix</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_smoothing_matrix</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="hydroutils.HydrographCorrector.apply_correction" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">apply_correction</span><span class="p">(</span><span class="n">modified_discharge</span><span class="p">,</span> <span class="n">smoothing_enabled</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">interpolation_enabled</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#hydroutils.HydrographCorrector.apply_correction" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>应用完整的修正算法</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>modified_discharge</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>修改后的径流数据</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>smoothing_enabled</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>是否启用五点平滑</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>interpolation_enabled</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>是否启用样条插值</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>修正后的径流数据</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>hydroutils/hydro_correct.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">apply_correction</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">modified_discharge</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">smoothing_enabled</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">interpolation_enabled</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    应用完整的修正算法</span>

<span class="sd">    Args:</span>
<span class="sd">        modified_discharge: 修改后的径流数据</span>
<span class="sd">        smoothing_enabled: 是否启用五点平滑</span>
<span class="sd">        interpolation_enabled: 是否启用样条插值</span>

<span class="sd">    Returns:</span>
<span class="sd">        修正后的径流数据</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">modified_discharge</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="c1"># 步骤1：五点二次平滑</span>
    <span class="k">if</span> <span class="n">smoothing_enabled</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_points</span> <span class="o">&gt;=</span> <span class="mi">5</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">five_point_smooth</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

    <span class="c1"># 步骤2：三次样条插值</span>
    <span class="k">if</span> <span class="n">interpolation_enabled</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_points</span> <span class="o">&gt;=</span> <span class="mi">3</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cubic_spline_interpolation</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time_points</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">result</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="hydroutils.HydrographCorrector.cubic_spline_interpolation" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">cubic_spline_interpolation</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x_new</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#hydroutils.HydrographCorrector.cubic_spline_interpolation" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>三次样条插值</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>x</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>原始时间点</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>y</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>原始径流值</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>x_new</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="numpy.ndarray">ndarray</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>新的时间点（如果为None，则使用原始时间点）</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>插值后的径流值</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>hydroutils/hydro_correct.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">cubic_spline_interpolation</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">x_new</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    三次样条插值</span>

<span class="sd">    Args:</span>
<span class="sd">        x: 原始时间点</span>
<span class="sd">        y: 原始径流值</span>
<span class="sd">        x_new: 新的时间点（如果为None，则使用原始时间点）</span>

<span class="sd">    Returns:</span>
<span class="sd">        插值后的径流值</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">x_new</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">x_new</span> <span class="o">=</span> <span class="n">x</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">x_new</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">x_new</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">:</span>
        <span class="c1"># 对于少于3个点的数据，使用线性插值</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">scipy.interpolate</span><span class="w"> </span><span class="kn">import</span> <span class="n">interp1d</span>

        <span class="n">f</span> <span class="o">=</span> <span class="n">interp1d</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;linear&quot;</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="s2">&quot;extrapolate&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">f</span><span class="p">(</span><span class="n">x_new</span><span class="p">)</span>

    <span class="c1"># 设置边界条件（自然边界：二阶导数为0）</span>
    <span class="n">y_prime_start</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="n">y_prime_end</span> <span class="o">=</span> <span class="mf">0.0</span>

    <span class="c1"># 求解样条系数</span>
    <span class="n">M</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_solve_spline_coefficients</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">y_prime_start</span><span class="p">,</span> <span class="n">y_prime_end</span><span class="p">)</span>

    <span class="c1"># 计算插值结果</span>
    <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_evaluate_spline</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">x_new</span><span class="p">)</span>

    <span class="c1"># 确保结果非负</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="hydroutils.HydrographCorrector.five_point_smooth" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">five_point_smooth</span><span class="p">(</span><span class="n">discharge_values</span><span class="p">)</span></code>

<a href="#hydroutils.HydrographCorrector.five_point_smooth" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>对径流数据进行五点二次平滑</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>discharge_values</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>径流值数组</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>平滑后的径流值数组</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>hydroutils/hydro_correct.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">five_point_smooth</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">discharge_values</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    对径流数据进行五点二次平滑</span>

<span class="sd">    Args:</span>
<span class="sd">        discharge_values: 径流值数组</span>

<span class="sd">    Returns:</span>
<span class="sd">        平滑后的径流值数组</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">discharge_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">discharge_values</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">discharge_values</span><span class="p">)</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_points</span><span class="p">:</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;输入数据长度 </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">discharge_values</span><span class="p">)</span><span class="si">}</span><span class="s2"> 与初始化长度 </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">n_points</span><span class="si">}</span><span class="s2"> 不匹配&quot;</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

    <span class="c1"># 使用预计算的稀疏矩阵进行向量化平滑</span>
    <span class="n">smoothed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">smoothing_matrix</span> <span class="o">@</span> <span class="n">discharge_values</span>

    <span class="c1"># 确保结果非负（径流不能为负）</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">smoothed</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="hydroutils.NumpyArrayEncoder" class="doc doc-heading">
            <code>NumpyArrayEncoder</code>


<a href="#hydroutils.NumpyArrayEncoder" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="json.JSONEncoder">JSONEncoder</span></code></p>


        <p>JSON encoder that handles NumPy arrays and scalars.</p>
<p>This encoder converts NumPy arrays and scalars to native Python types
that can be serialized to JSON.</p>


<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;array&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])}</span>
<span class="n">json_str</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="bp">cls</span><span class="o">=</span><span class="n">NumpyArrayEncoder</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
</details>






              <details class="quote">
                <summary>Source code in <code>hydroutils/hydro_file.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">NumpyArrayEncoder</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">JSONEncoder</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;JSON encoder that handles NumPy arrays and scalars.</span>

<span class="sd">    This encoder converts NumPy arrays and scalars to native Python types</span>
<span class="sd">    that can be serialized to JSON.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        import numpy as np</span>
<span class="sd">        data = {&#39;array&#39;: np.array([1, 2, 3])}</span>
<span class="sd">        json_str = json.dumps(data, cls=NumpyArrayEncoder)</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">default</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Converts NumPy objects to JSON-serializable types.</span>

<span class="sd">        Args:</span>
<span class="sd">            obj: Object to convert.</span>

<span class="sd">        Returns:</span>
<span class="sd">            JSON-serializable version of the object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">convert_ndarray</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">floating</span><span class="p">)):</span>
            <span class="k">return</span> <span class="n">obj</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">JSONEncoder</span><span class="o">.</span><span class="n">default</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">convert_ndarray</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">array</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Recursively converts a NumPy array to a Python list.</span>

<span class="sd">        Args:</span>
<span class="sd">            array: NumPy array to convert.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Python list or scalar value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">array</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">array</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
        <span class="k">return</span> <span class="p">[</span>
            <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">convert_ndarray</span><span class="p">(</span><span class="n">element</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">element</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span>
                <span class="k">else</span> <span class="n">element</span>
            <span class="p">)</span>
            <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">array</span>
        <span class="p">]</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="hydroutils.NumpyArrayEncoder.convert_ndarray" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">convert_ndarray</span><span class="p">(</span><span class="n">array</span><span class="p">)</span></code>

<a href="#hydroutils.NumpyArrayEncoder.convert_ndarray" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Recursively converts a NumPy array to a Python list.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>array</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>NumPy array to convert.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Python list or scalar value.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>hydroutils/hydro_file.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">convert_ndarray</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">array</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Recursively converts a NumPy array to a Python list.</span>

<span class="sd">    Args:</span>
<span class="sd">        array: NumPy array to convert.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Python list or scalar value.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">array</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">array</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
    <span class="k">return</span> <span class="p">[</span>
        <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">convert_ndarray</span><span class="p">(</span><span class="n">element</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">element</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span>
            <span class="k">else</span> <span class="n">element</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">array</span>
    <span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="hydroutils.NumpyArrayEncoder.default" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">default</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span></code>

<a href="#hydroutils.NumpyArrayEncoder.default" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Converts NumPy objects to JSON-serializable types.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>obj</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Object to convert.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>JSON-serializable version of the object.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>hydroutils/hydro_file.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">default</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Converts NumPy objects to JSON-serializable types.</span>

<span class="sd">    Args:</span>
<span class="sd">        obj: Object to convert.</span>

<span class="sd">    Returns:</span>
<span class="sd">        JSON-serializable version of the object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">convert_ndarray</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">floating</span><span class="p">)):</span>
        <span class="k">return</span> <span class="n">obj</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">JSONEncoder</span><span class="o">.</span><span class="n">default</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h2 id="hydroutils.KGE" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">KGE</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">xo</span><span class="p">)</span></code>

<a href="#hydroutils.KGE" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Calculates Kling-Gupta Efficiency between simulated and observed values.</p>
<p>KGE combines correlation, bias, and variability to evaluate model performance.
KGE = 1 - sqrt((r-1)² + (α-1)² + (β-1)²)
where:
- r is Pearson correlation
- α is ratio of simulated to observed standard deviation
- β is ratio of simulated to observed mean</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>xs</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Simulated values.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>xo</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Observed values.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>KGE score (-∞ to 1, where 1 is perfect).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">obs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="n">sim</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">2.1</span><span class="p">,</span> <span class="mf">2.9</span><span class="p">,</span> <span class="mf">4.2</span><span class="p">,</span> <span class="mf">5.1</span><span class="p">])</span>
<span class="n">kge</span> <span class="o">=</span> <span class="n">KGE</span><span class="p">(</span><span class="n">sim</span><span class="p">,</span> <span class="n">obs</span><span class="p">)</span>  <span class="c1"># Returns value close to 1</span>
</code></pre></div></td></tr></table></div>
</details>

<details class="note" open>
  <summary>Note</summary>
  <p>Based on Gupta et al. (2009), doi:10.1016/j.jhydrol.2009.08.003</p>
</details>

            <details class="quote">
              <summary>Source code in <code>hydroutils/hydro_stat.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">KGE</span><span class="p">(</span><span class="n">xs</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">xo</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculates Kling-Gupta Efficiency between simulated and observed values.</span>

<span class="sd">    KGE combines correlation, bias, and variability to evaluate model performance.</span>
<span class="sd">    KGE = 1 - sqrt((r-1)² + (α-1)² + (β-1)²)</span>
<span class="sd">    where:</span>
<span class="sd">    - r is Pearson correlation</span>
<span class="sd">    - α is ratio of simulated to observed standard deviation</span>
<span class="sd">    - β is ratio of simulated to observed mean</span>

<span class="sd">    Args:</span>
<span class="sd">        xs: Simulated values.</span>
<span class="sd">        xo: Observed values.</span>

<span class="sd">    Returns:</span>
<span class="sd">        KGE score (-∞ to 1, where 1 is perfect).</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        obs = np.array([1, 2, 3, 4, 5])</span>
<span class="sd">        sim = np.array([1.1, 2.1, 2.9, 4.2, 5.1])</span>
<span class="sd">        kge = KGE(sim, obs)  # Returns value close to 1</span>
<span class="sd">        ```</span>

<span class="sd">    Note:</span>
<span class="sd">        Based on Gupta et al. (2009), doi:10.1016/j.jhydrol.2009.08.003</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">corrcoef</span><span class="p">(</span><span class="n">xo</span><span class="p">,</span> <span class="n">xs</span><span class="p">)[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
    <span class="n">alpha</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">xs</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">xo</span><span class="p">)</span>
    <span class="n">beta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">xs</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">xo</span><span class="p">)</span>
    <span class="k">return</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">r</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">alpha</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">beta</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="hydroutils.apply_smooth_correction" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">apply_smooth_correction</span><span class="p">(</span><span class="n">original_data</span><span class="p">,</span> <span class="n">modified_data</span><span class="p">,</span> <span class="n">discharge_column</span><span class="o">=</span><span class="s1">&#39;gen_discharge&#39;</span><span class="p">,</span> <span class="n">time_column</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">)</span></code>

<a href="#hydroutils.apply_smooth_correction" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>应用基于论文的平滑修正算法</p>
<p>这是主要的接口函数，支持多点同时修改的情况，使用五点二次平滑和三次样条插值</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>original_data</code>
            </td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>原始数据DataFrame</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>modified_data</code>
            </td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>修改后的数据DataFrame</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>discharge_column</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>径流数据列名</p>
              </div>
            </td>
            <td>
                  <code>&#39;gen_discharge&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>time_column</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>时间列名</p>
              </div>
            </td>
            <td>
                  <code>&#39;time&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>平滑修正后的数据DataFrame</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>hydroutils/hydro_correct.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">apply_smooth_correction</span><span class="p">(</span>
    <span class="n">original_data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">modified_data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">discharge_column</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;gen_discharge&quot;</span><span class="p">,</span>
    <span class="n">time_column</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;time&quot;</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    应用基于论文的平滑修正算法</span>

<span class="sd">    这是主要的接口函数，支持多点同时修改的情况，使用五点二次平滑和三次样条插值</span>

<span class="sd">    Args:</span>
<span class="sd">        original_data: 原始数据DataFrame</span>
<span class="sd">        modified_data: 修改后的数据DataFrame</span>
<span class="sd">        discharge_column: 径流数据列名</span>
<span class="sd">        time_column: 时间列名</span>

<span class="sd">    Returns:</span>
<span class="sd">        平滑修正后的数据DataFrame</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">discharge_column</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">modified_data</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;数据中缺少径流列: </span><span class="si">{</span><span class="n">discharge_column</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">time_column</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">modified_data</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;数据中缺少时间列: </span><span class="si">{</span><span class="n">time_column</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># 提取时间和径流数据</span>
    <span class="n">time_points</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">modified_data</span><span class="p">[</span><span class="n">time_column</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span> <span class="o">/</span> <span class="mf">1e9</span>
    <span class="p">)</span>  <span class="c1"># 转换为秒数</span>
    <span class="n">discharge_values</span> <span class="o">=</span> <span class="n">modified_data</span><span class="p">[</span><span class="n">discharge_column</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

    <span class="c1"># 创建修正器</span>
    <span class="n">corrector</span> <span class="o">=</span> <span class="n">HydrographCorrector</span><span class="p">(</span><span class="n">time_points</span><span class="p">,</span> <span class="n">discharge_values</span><span class="p">)</span>

    <span class="c1"># 应用修正算法</span>
    <span class="n">corrected_discharge</span> <span class="o">=</span> <span class="n">corrector</span><span class="o">.</span><span class="n">apply_correction</span><span class="p">(</span>
        <span class="n">discharge_values</span><span class="p">,</span> <span class="n">smoothing_enabled</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">interpolation_enabled</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">)</span>

    <span class="c1"># 创建结果DataFrame</span>
    <span class="n">result_data</span> <span class="o">=</span> <span class="n">modified_data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">result_data</span><span class="p">[</span><span class="n">discharge_column</span><span class="p">]</span> <span class="o">=</span> <span class="n">corrected_discharge</span>

    <span class="k">return</span> <span class="n">result_data</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="hydroutils.apply_water_balance_correction" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">apply_water_balance_correction</span><span class="p">(</span><span class="n">original_data</span><span class="p">,</span> <span class="n">modified_data</span><span class="p">,</span> <span class="n">discharge_column</span><span class="o">=</span><span class="s1">&#39;gen_discharge&#39;</span><span class="p">,</span> <span class="n">time_column</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">)</span></code>

<a href="#hydroutils.apply_water_balance_correction" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>应用真正的水量平衡修正算法</p>
<p>TODO: 这里是简化实现，后续需要补充具体的水量平衡计算逻辑</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>original_data</code>
            </td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>原始数据DataFrame</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>modified_data</code>
            </td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>修改后的数据DataFrame</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>discharge_column</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>径流数据列名</p>
              </div>
            </td>
            <td>
                  <code>&#39;gen_discharge&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>time_column</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>时间列名</p>
              </div>
            </td>
            <td>
                  <code>&#39;time&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>水量平衡修正后的数据DataFrame</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>hydroutils/hydro_correct.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">apply_water_balance_correction</span><span class="p">(</span>
    <span class="n">original_data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">modified_data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">discharge_column</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;gen_discharge&quot;</span><span class="p">,</span>
    <span class="n">time_column</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;time&quot;</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    应用真正的水量平衡修正算法</span>

<span class="sd">    TODO: 这里是简化实现，后续需要补充具体的水量平衡计算逻辑</span>

<span class="sd">    Args:</span>
<span class="sd">        original_data: 原始数据DataFrame</span>
<span class="sd">        modified_data: 修改后的数据DataFrame</span>
<span class="sd">        discharge_column: 径流数据列名</span>
<span class="sd">        time_column: 时间列名</span>

<span class="sd">    Returns:</span>
<span class="sd">        水量平衡修正后的数据DataFrame</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">discharge_column</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">modified_data</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;数据中缺少径流列: </span><span class="si">{</span><span class="n">discharge_column</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># 简化实现：第一个数据加1，其他数据保持不变</span>
    <span class="n">result_data</span> <span class="o">=</span> <span class="n">modified_data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">result_data</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">result_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">result_data</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">get_loc</span><span class="p">(</span><span class="n">discharge_column</span><span class="p">)]</span> <span class="o">+=</span> <span class="mf">1.0</span>

    <span class="k">return</span> <span class="n">result_data</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="hydroutils.assign_time_start_end" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">assign_time_start_end</span><span class="p">(</span><span class="n">time_ranges</span><span class="p">,</span> <span class="n">assign_way</span><span class="o">=</span><span class="s1">&#39;intersection&#39;</span><span class="p">)</span></code>

<a href="#hydroutils.assign_time_start_end" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Determines overall start and end times from multiple time ranges.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>time_ranges</code>
            </td>
            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of [start, end] time ranges.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>assign_way</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Method to combine ranges:
- "intersection": Use latest start and earliest end
- "union": Use earliest start and latest end</p>
              </div>
            </td>
            <td>
                  <code>&#39;intersection&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="tuple">tuple</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Tuple of (start_time, end_time).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="NotImplementedError">NotImplementedError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If assign_way is not "intersection" or "union".</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">ranges</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="s1">&#39;2023-01-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2023-12-31&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="s1">&#39;2023-03-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2024-02-28&#39;</span><span class="p">]</span>
<span class="p">]</span>

<span class="c1"># Get intersection (common period)</span>
<span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="o">=</span> <span class="n">assign_time_start_end</span><span class="p">(</span><span class="n">ranges</span><span class="p">,</span> <span class="s1">&#39;intersection&#39;</span><span class="p">)</span>
<span class="c1"># Returns (&#39;2023-03-01&#39;, &#39;2023-12-31&#39;)</span>

<span class="c1"># Get union (total span)</span>
<span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="o">=</span> <span class="n">assign_time_start_end</span><span class="p">(</span><span class="n">ranges</span><span class="p">,</span> <span class="s1">&#39;union&#39;</span><span class="p">)</span>
<span class="c1"># Returns (&#39;2023-01-01&#39;, &#39;2024-02-28&#39;)</span>
</code></pre></div></td></tr></table></div>
</details>

            <details class="quote">
              <summary>Source code in <code>hydroutils/hydro_time.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">assign_time_start_end</span><span class="p">(</span><span class="n">time_ranges</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">assign_way</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;intersection&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Determines overall start and end times from multiple time ranges.</span>

<span class="sd">    Args:</span>
<span class="sd">        time_ranges: List of [start, end] time ranges.</span>
<span class="sd">        assign_way: Method to combine ranges:</span>
<span class="sd">            - &quot;intersection&quot;: Use latest start and earliest end</span>
<span class="sd">            - &quot;union&quot;: Use earliest start and latest end</span>

<span class="sd">    Returns:</span>
<span class="sd">        Tuple of (start_time, end_time).</span>

<span class="sd">    Raises:</span>
<span class="sd">        NotImplementedError: If assign_way is not &quot;intersection&quot; or &quot;union&quot;.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        ranges = [</span>
<span class="sd">            [&#39;2023-01-01&#39;, &#39;2023-12-31&#39;],</span>
<span class="sd">            [&#39;2023-03-01&#39;, &#39;2024-02-28&#39;]</span>
<span class="sd">        ]</span>

<span class="sd">        # Get intersection (common period)</span>
<span class="sd">        start, end = assign_time_start_end(ranges, &#39;intersection&#39;)</span>
<span class="sd">        # Returns (&#39;2023-03-01&#39;, &#39;2023-12-31&#39;)</span>

<span class="sd">        # Get union (total span)</span>
<span class="sd">        start, end = assign_time_start_end(ranges, &#39;union&#39;)</span>
<span class="sd">        # Returns (&#39;2023-01-01&#39;, &#39;2024-02-28&#39;)</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">assign_way</span> <span class="o">==</span> <span class="s2">&quot;intersection&quot;</span><span class="p">:</span>
        <span class="n">time_start</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">time_ranges</span><span class="p">)</span>
        <span class="n">time_end</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">time_ranges</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">assign_way</span> <span class="o">==</span> <span class="s2">&quot;union&quot;</span><span class="p">:</span>
        <span class="n">time_start</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">time_ranges</span><span class="p">)</span>
        <span class="n">time_end</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">time_ranges</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;We don&#39;t support this assign_way yet&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">time_start</span><span class="p">,</span> <span class="n">time_end</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="hydroutils.boto3_download_file" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">boto3_download_file</span><span class="p">(</span><span class="n">client</span><span class="p">,</span> <span class="n">bucket_name</span><span class="p">,</span> <span class="n">object_name</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span></code>

<a href="#hydroutils.boto3_download_file" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Downloads a file from AWS S3 using boto3.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>client</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>boto3 S3 client instance.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>bucket_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the bucket containing the object.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>object_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the object to download.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>file_path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Local path where the file should be saved.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">boto3</span>
<span class="n">client</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">(</span><span class="s1">&#39;s3&#39;</span><span class="p">)</span>
<span class="n">boto3_download_file</span><span class="p">(</span><span class="n">client</span><span class="p">,</span> <span class="s1">&#39;mybucket&#39;</span><span class="p">,</span> <span class="s1">&#39;data.csv&#39;</span><span class="p">,</span> <span class="s1">&#39;./downloaded.csv&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
</details>

            <details class="quote">
              <summary>Source code in <code>hydroutils/hydro_s3.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">boto3_download_file</span><span class="p">(</span><span class="n">client</span><span class="p">,</span> <span class="n">bucket_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">object_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Downloads a file from AWS S3 using boto3.</span>

<span class="sd">    Args:</span>
<span class="sd">        client: boto3 S3 client instance.</span>
<span class="sd">        bucket_name: Name of the bucket containing the object.</span>
<span class="sd">        object_name: Name of the object to download.</span>
<span class="sd">        file_path: Local path where the file should be saved.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        import boto3</span>
<span class="sd">        client = boto3.client(&#39;s3&#39;)</span>
<span class="sd">        boto3_download_file(client, &#39;mybucket&#39;, &#39;data.csv&#39;, &#39;./downloaded.csv&#39;)</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">client</span><span class="o">.</span><span class="n">download_file</span><span class="p">(</span><span class="n">bucket_name</span><span class="p">,</span> <span class="n">object_name</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="hydroutils.boto3_upload_file" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">boto3_upload_file</span><span class="p">(</span><span class="n">client</span><span class="p">,</span> <span class="n">bucket_name</span><span class="p">,</span> <span class="n">object_name</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span></code>

<a href="#hydroutils.boto3_upload_file" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Uploads a file to AWS S3 using boto3.</p>
<p>Creates the bucket if it doesn't exist, uploads the file, and returns a list of
all objects in the bucket.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>client</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>boto3 S3 client instance.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>bucket_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the bucket to upload to.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>object_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name to give the object in S3.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>file_path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Local path of the file to upload.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of object keys in the bucket after upload.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">boto3</span>
<span class="n">client</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">(</span><span class="s1">&#39;s3&#39;</span><span class="p">)</span>
<span class="n">objects</span> <span class="o">=</span> <span class="n">boto3_upload_file</span><span class="p">(</span><span class="n">client</span><span class="p">,</span> <span class="s1">&#39;mybucket&#39;</span><span class="p">,</span> <span class="s1">&#39;data.csv&#39;</span><span class="p">,</span> <span class="s1">&#39;./data.csv&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Bucket contents: </span><span class="si">{</span><span class="n">objects</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
</details>

            <details class="quote">
              <summary>Source code in <code>hydroutils/hydro_s3.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">boto3_upload_file</span><span class="p">(</span><span class="n">client</span><span class="p">,</span> <span class="n">bucket_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">object_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Uploads a file to AWS S3 using boto3.</span>

<span class="sd">    Creates the bucket if it doesn&#39;t exist, uploads the file, and returns a list of</span>
<span class="sd">    all objects in the bucket.</span>

<span class="sd">    Args:</span>
<span class="sd">        client: boto3 S3 client instance.</span>
<span class="sd">        bucket_name: Name of the bucket to upload to.</span>
<span class="sd">        object_name: Name to give the object in S3.</span>
<span class="sd">        file_path: Local path of the file to upload.</span>

<span class="sd">    Returns:</span>
<span class="sd">        List of object keys in the bucket after upload.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        import boto3</span>
<span class="sd">        client = boto3.client(&#39;s3&#39;)</span>
<span class="sd">        objects = boto3_upload_file(client, &#39;mybucket&#39;, &#39;data.csv&#39;, &#39;./data.csv&#39;)</span>
<span class="sd">        print(f&quot;Bucket contents: {objects}&quot;)</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Make a bucket</span>
    <span class="n">bucket_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">dic</span><span class="p">[</span><span class="s2">&quot;Name&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">dic</span> <span class="ow">in</span> <span class="n">client</span><span class="o">.</span><span class="n">list_buckets</span><span class="p">()[</span><span class="s2">&quot;Buckets&quot;</span><span class="p">]]</span>
    <span class="k">if</span> <span class="n">bucket_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">bucket_names</span><span class="p">:</span>
        <span class="n">client</span><span class="o">.</span><span class="n">create_bucket</span><span class="p">(</span><span class="n">Bucket</span><span class="o">=</span><span class="n">bucket_name</span><span class="p">)</span>
    <span class="c1"># Upload an object</span>
    <span class="n">client</span><span class="o">.</span><span class="n">upload_file</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">bucket_name</span><span class="p">,</span> <span class="n">object_name</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">dic</span><span class="p">[</span><span class="s2">&quot;Key&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">dic</span> <span class="ow">in</span> <span class="n">client</span><span class="o">.</span><span class="n">list_objects</span><span class="p">(</span><span class="n">Bucket</span><span class="o">=</span><span class="n">bucket_name</span><span class="p">)[</span><span class="s2">&quot;Contents&quot;</span><span class="p">]]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="hydroutils.cal_4_stat_inds" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">cal_4_stat_inds</span><span class="p">(</span><span class="n">b</span><span class="p">)</span></code>

<a href="#hydroutils.cal_4_stat_inds" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Calculates four basic statistical indices for an array.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>b</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Input array of numerical values.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List containing [10th percentile, 90th percentile, mean, standard deviation].</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If std &lt; 0.001, returns 1 for std to avoid numerical issues.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>
<span class="n">p10</span><span class="p">,</span> <span class="n">p90</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">std</span> <span class="o">=</span> <span class="n">cal_4_stat_inds</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mean: </span><span class="si">{</span><span class="n">mean</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">, Std: </span><span class="si">{</span><span class="n">std</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;10th-90th percentile range: [</span><span class="si">{</span><span class="n">p10</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">p90</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">]&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
</details>

            <details class="quote">
              <summary>Source code in <code>hydroutils/hydro_stat.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">cal_4_stat_inds</span><span class="p">(</span><span class="n">b</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculates four basic statistical indices for an array.</span>

<span class="sd">    Args:</span>
<span class="sd">        b: Input array of numerical values.</span>

<span class="sd">    Returns:</span>
<span class="sd">        List containing [10th percentile, 90th percentile, mean, standard deviation].</span>
<span class="sd">        If std &lt; 0.001, returns 1 for std to avoid numerical issues.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        data = np.array([1, 2, 3, 4, 5, 6, 7, 8, 9, 10])</span>
<span class="sd">        p10, p90, mean, std = cal_4_stat_inds(data)</span>
<span class="sd">        print(f&quot;Mean: {mean:.1f}, Std: {std:.1f}&quot;)</span>
<span class="sd">        print(f&quot;10th-90th percentile range: [{p10:.1f}, {p90:.1f}]&quot;)</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">p10</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
    <span class="n">p90</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="mi">90</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
    <span class="n">mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
    <span class="n">std</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">std</span> <span class="o">&lt;</span> <span class="mf">0.001</span><span class="p">:</span>
        <span class="n">std</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">p10</span><span class="p">,</span> <span class="n">p90</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">std</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="hydroutils.cal_fdc" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">cal_fdc</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">quantile_num</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span></code>

<a href="#hydroutils.cal_fdc" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Calculates flow duration curves for multiple time series.</p>
<p>For each location/grid point, computes a flow duration curve by sorting flows
from highest to lowest and selecting evenly spaced quantiles.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>data</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Flow data array of shape [n_locations, n_timesteps].</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>quantile_num</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of quantile points to compute. Defaults to 100.</p>
              </div>
            </td>
            <td>
                  <code>100</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Array of shape [n_locations, quantile_num] containing flow duration curves.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Each row represents the FDC for one location.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="Exception">Exception</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If output flow array length doesn't match quantile_num.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1"># Flow data for 2 locations, 365 days</span>
<span class="n">flows</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">lognormal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">365</span><span class="p">))</span>

<span class="c1"># Calculate FDCs with 100 points</span>
<span class="n">fdcs</span> <span class="o">=</span> <span class="n">cal_fdc</span><span class="p">(</span><span class="n">flows</span><span class="p">,</span> <span class="n">quantile_num</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>

<span class="c1"># Plot first FDC</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="n">fdcs</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Exceedance Probability (%)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Flow&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
</details>

<details class="note" open>
  <summary>Note</summary>
  <ul>
<li>Handles NaN values by removing them</li>
<li>For locations with no valid data, returns zeros</li>
<li>Flow values are sorted from highest to lowest</li>
</ul>
</details>

            <details class="quote">
              <summary>Source code in <code>hydroutils/hydro_stat.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span>
<span class="normal">845</span>
<span class="normal">846</span>
<span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span>
<span class="normal">851</span>
<span class="normal">852</span>
<span class="normal">853</span>
<span class="normal">854</span>
<span class="normal">855</span>
<span class="normal">856</span>
<span class="normal">857</span>
<span class="normal">858</span>
<span class="normal">859</span>
<span class="normal">860</span>
<span class="normal">861</span>
<span class="normal">862</span>
<span class="normal">863</span>
<span class="normal">864</span>
<span class="normal">865</span>
<span class="normal">866</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">cal_fdc</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">quantile_num</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculates flow duration curves for multiple time series.</span>

<span class="sd">    For each location/grid point, computes a flow duration curve by sorting flows</span>
<span class="sd">    from highest to lowest and selecting evenly spaced quantiles.</span>

<span class="sd">    Args:</span>
<span class="sd">        data: Flow data array of shape [n_locations, n_timesteps].</span>
<span class="sd">        quantile_num: Number of quantile points to compute. Defaults to 100.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Array of shape [n_locations, quantile_num] containing flow duration curves.</span>
<span class="sd">        Each row represents the FDC for one location.</span>

<span class="sd">    Raises:</span>
<span class="sd">        Exception: If output flow array length doesn&#39;t match quantile_num.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        # Flow data for 2 locations, 365 days</span>
<span class="sd">        flows = np.random.lognormal(0, 1, (2, 365))</span>

<span class="sd">        # Calculate FDCs with 100 points</span>
<span class="sd">        fdcs = cal_fdc(flows, quantile_num=100)</span>

<span class="sd">        # Plot first FDC</span>
<span class="sd">        plt.plot(np.linspace(0, 100, 100), fdcs[0])</span>
<span class="sd">        plt.xlabel(&#39;Exceedance Probability (%)&#39;)</span>
<span class="sd">        plt.ylabel(&#39;Flow&#39;)</span>
<span class="sd">        ```</span>

<span class="sd">    Note:</span>
<span class="sd">        - Handles NaN values by removing them</span>
<span class="sd">        - For locations with no valid data, returns zeros</span>
<span class="sd">        - Flow values are sorted from highest to lowest</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># data = n_grid * n_day</span>
    <span class="n">n_grid</span><span class="p">,</span> <span class="n">n_day</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span>
    <span class="n">fdc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">([</span><span class="n">n_grid</span><span class="p">,</span> <span class="n">quantile_num</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_grid</span><span class="p">):</span>
        <span class="n">temp_data0</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">ii</span><span class="p">,</span> <span class="p">:]</span>
        <span class="n">temp_data</span> <span class="o">=</span> <span class="n">temp_data0</span><span class="p">[</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">temp_data0</span><span class="p">)]</span>
        <span class="c1"># deal with no data case for some gages</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">temp_data</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">temp_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">n_day</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="c1"># sort from large to small</span>
        <span class="n">temp_sort</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">temp_data</span><span class="p">)[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="c1"># select quantile_num quantile points</span>
        <span class="n">n_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">temp_data</span><span class="p">)</span>
        <span class="n">ind</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">quantile_num</span><span class="p">)</span> <span class="o">/</span> <span class="n">quantile_num</span> <span class="o">*</span> <span class="n">n_len</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
        <span class="n">fdc_flow</span> <span class="o">=</span> <span class="n">temp_sort</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">fdc_flow</span><span class="p">)</span> <span class="o">!=</span> <span class="n">quantile_num</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;unknown assimilation variable&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">fdc</span><span class="p">[</span><span class="n">ii</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">fdc_flow</span>

    <span class="k">return</span> <span class="n">fdc</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="hydroutils.cal_stat" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">cal_stat</span><span class="p">(</span><span class="n">x</span><span class="p">)</span></code>

<a href="#hydroutils.cal_stat" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Calculates basic statistics for an array, ignoring NaN values.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>x</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Input array. Can contain NaN values.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List containing [10th percentile, 90th percentile, mean, standard deviation].</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If array is empty or all NaN, returns statistics for [0].</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="n">stats</span> <span class="o">=</span> <span class="n">cal_stat</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>  <span class="c1"># Calculates stats ignoring NaN</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mean (excluding NaN): </span><span class="si">{</span><span class="n">stats</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
</details>

            <details class="quote">
              <summary>Source code in <code>hydroutils/hydro_stat.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">cal_stat</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculates basic statistics for an array, ignoring NaN values.</span>

<span class="sd">    Args:</span>
<span class="sd">        x: Input array. Can contain NaN values.</span>

<span class="sd">    Returns:</span>
<span class="sd">        List containing [10th percentile, 90th percentile, mean, standard deviation].</span>
<span class="sd">        If array is empty or all NaN, returns statistics for [0].</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        data = np.array([1, 2, np.nan, 4, 5])</span>
<span class="sd">        stats = cal_stat(data)  # Calculates stats ignoring NaN</span>
<span class="sd">        print(f&quot;Mean (excluding NaN): {stats[2]:.1f}&quot;)</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">a</span><span class="p">)]</span>
    <span class="k">if</span> <span class="n">b</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="c1"># if b is [], then give it a 0 value</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">cal_4_stat_inds</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="hydroutils.cal_stat_gamma" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">cal_stat_gamma</span><span class="p">(</span><span class="n">x</span><span class="p">)</span></code>

<a href="#hydroutils.cal_stat_gamma" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Transforms data to approximate normal distribution and calculates statistics.</p>
<p>Applies a transformation (log10(sqrt(x) + 0.1)) to handle gamma-distributed data
like streamflow, precipitation, and evapotranspiration.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>x</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Input array, typically daily hydrology data.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List containing [10th percentile, 90th percentile, mean, standard deviation]</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>of the transformed data.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">flow</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">])</span>  <span class="c1"># Gamma-like distribution</span>
<span class="n">stats</span> <span class="o">=</span> <span class="n">cal_stat_gamma</span><span class="p">(</span><span class="n">flow</span><span class="p">)</span>  <span class="c1"># Stats of transformed data</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mean of transformed data: </span><span class="si">{</span><span class="n">stats</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
</details>

<details class="note" open>
  <summary>Note</summary>
  <ul>
<li>Ignores NaN values</li>
<li>Transformation: log10(sqrt(x) + 0.1)</li>
<li>Suitable for positively skewed data</li>
</ul>
</details>

            <details class="quote">
              <summary>Source code in <code>hydroutils/hydro_stat.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">cal_stat_gamma</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Transforms data to approximate normal distribution and calculates statistics.</span>

<span class="sd">    Applies a transformation (log10(sqrt(x) + 0.1)) to handle gamma-distributed data</span>
<span class="sd">    like streamflow, precipitation, and evapotranspiration.</span>

<span class="sd">    Args:</span>
<span class="sd">        x: Input array, typically daily hydrology data.</span>

<span class="sd">    Returns:</span>
<span class="sd">        List containing [10th percentile, 90th percentile, mean, standard deviation]</span>
<span class="sd">        of the transformed data.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        flow = np.array([0.1, 0.5, 1.0, 2.0, 5.0])  # Gamma-like distribution</span>
<span class="sd">        stats = cal_stat_gamma(flow)  # Stats of transformed data</span>
<span class="sd">        print(f&quot;Mean of transformed data: {stats[2]:.2f}&quot;)</span>
<span class="sd">        ```</span>

<span class="sd">    Note:</span>
<span class="sd">        - Ignores NaN values</span>
<span class="sd">        - Transformation: log10(sqrt(x) + 0.1)</span>
<span class="sd">        - Suitable for positively skewed data</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">a</span><span class="p">)]</span>  <span class="c1"># kick out Nan</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span>
        <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.1</span>
    <span class="p">)</span>  <span class="c1"># do some tranformation to change gamma characteristics</span>
    <span class="k">return</span> <span class="n">cal_4_stat_inds</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="hydroutils.cal_stat_prcp_norm" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">cal_stat_prcp_norm</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">meanprep</span><span class="p">)</span></code>

<a href="#hydroutils.cal_stat_prcp_norm" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Normalizes data by mean precipitation and calculates statistics.</p>
<p>Divides data by mean precipitation to remove rainfall magnitude influence,
reducing bias between dry and wet basins. Then applies gamma transformation
and calculates statistics.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>x</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Data to normalize, typically hydrological variables.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>meanprep</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Mean precipitation for each location/basin.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List containing [10th percentile, 90th percentile, mean, standard deviation]</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>of the normalized and transformed data.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">flow</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">3.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">]])</span>  <span class="c1"># 2 basins, 2 timesteps</span>
<span class="n">mean_precip</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">])</span>  <span class="c1"># Mean annual precip for each basin</span>
<span class="n">stats</span> <span class="o">=</span> <span class="n">cal_stat_prcp_norm</span><span class="p">(</span><span class="n">flow</span><span class="p">,</span> <span class="n">mean_precip</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mean of normalized data: </span><span class="si">{</span><span class="n">stats</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
</details>

<details class="note" open>
  <summary>Note</summary>
  <ul>
<li>Normalizes by precipitation: x / meanprep</li>
<li>Then applies gamma transformation</li>
<li>Useful for comparing basins with different rainfall regimes</li>
</ul>
</details>

            <details class="quote">
              <summary>Source code in <code>hydroutils/hydro_stat.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">cal_stat_prcp_norm</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">meanprep</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Normalizes data by mean precipitation and calculates statistics.</span>

<span class="sd">    Divides data by mean precipitation to remove rainfall magnitude influence,</span>
<span class="sd">    reducing bias between dry and wet basins. Then applies gamma transformation</span>
<span class="sd">    and calculates statistics.</span>

<span class="sd">    Args:</span>
<span class="sd">        x: Data to normalize, typically hydrological variables.</span>
<span class="sd">        meanprep: Mean precipitation for each location/basin.</span>

<span class="sd">    Returns:</span>
<span class="sd">        List containing [10th percentile, 90th percentile, mean, standard deviation]</span>
<span class="sd">        of the normalized and transformed data.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        flow = np.array([[1.0, 2.0], [3.0, 4.0]])  # 2 basins, 2 timesteps</span>
<span class="sd">        mean_precip = np.array([100, 200])  # Mean annual precip for each basin</span>
<span class="sd">        stats = cal_stat_prcp_norm(flow, mean_precip)</span>
<span class="sd">        print(f&quot;Mean of normalized data: {stats[2]:.3f}&quot;)</span>
<span class="sd">        ```</span>

<span class="sd">    Note:</span>
<span class="sd">        - Normalizes by precipitation: x / meanprep</span>
<span class="sd">        - Then applies gamma transformation</span>
<span class="sd">        - Useful for comparing basins with different rainfall regimes</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># meanprep = readAttr(gageDict[&#39;id&#39;], [&#39;q_mean&#39;])</span>
    <span class="n">tempprep</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">meanprep</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
    <span class="c1"># unit (mm/day)/(mm/day)</span>
    <span class="n">flowua</span> <span class="o">=</span> <span class="n">x</span> <span class="o">/</span> <span class="n">tempprep</span>
    <span class="k">return</span> <span class="n">cal_stat_gamma</span><span class="p">(</span><span class="n">flowua</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="hydroutils.calculate_utc_offset" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">calculate_utc_offset</span><span class="p">(</span><span class="n">lat</span><span class="p">,</span> <span class="n">lng</span><span class="p">,</span> <span class="n">date</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#hydroutils.calculate_utc_offset" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Calculates UTC offset for a location using tzfpy.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>lat</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Latitude in decimal degrees.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>lng</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Longitude in decimal degrees.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>date</code>
            </td>
            <td>
                  <code><span title="datetime.datetime">datetime</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional date for timezone calculation. Uses current date if not provided.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>UTC offset in hours, or None if timezone cannot be determined.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1"># Get current UTC offset for New York</span>
<span class="n">offset</span> <span class="o">=</span> <span class="n">calculate_utc_offset</span><span class="p">(</span><span class="mf">40.7128</span><span class="p">,</span> <span class="o">-</span><span class="mf">74.0060</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;New York is UTC</span><span class="si">{</span><span class="n">offset</span><span class="si">:</span><span class="s2">+d</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># e.g., &quot;UTC-4&quot;</span>

<span class="c1"># Get offset for specific date</span>
<span class="n">date</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2023</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">offset</span> <span class="o">=</span> <span class="n">calculate_utc_offset</span><span class="p">(</span><span class="mf">40.7128</span><span class="p">,</span> <span class="o">-</span><span class="mf">74.0060</span><span class="p">,</span> <span class="n">date</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
</details>

            <details class="quote">
              <summary>Source code in <code>hydroutils/hydro_time.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">calculate_utc_offset</span><span class="p">(</span><span class="n">lat</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">lng</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">date</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculates UTC offset for a location using tzfpy.</span>

<span class="sd">    Args:</span>
<span class="sd">        lat: Latitude in decimal degrees.</span>
<span class="sd">        lng: Longitude in decimal degrees.</span>
<span class="sd">        date: Optional date for timezone calculation. Uses current date if not provided.</span>

<span class="sd">    Returns:</span>
<span class="sd">        UTC offset in hours, or None if timezone cannot be determined.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        # Get current UTC offset for New York</span>
<span class="sd">        offset = calculate_utc_offset(40.7128, -74.0060)</span>
<span class="sd">        print(f&quot;New York is UTC{offset:+d}&quot;)  # e.g., &quot;UTC-4&quot;</span>

<span class="sd">        # Get offset for specific date</span>
<span class="sd">        date = datetime(2023, 1, 1)</span>
<span class="sd">        offset = calculate_utc_offset(40.7128, -74.0060, date)</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">date</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">date</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">utcnow</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">timezone_str</span> <span class="o">:=</span> <span class="n">tzfpy</span><span class="o">.</span><span class="n">get_tz</span><span class="p">(</span><span class="n">lng</span><span class="p">,</span> <span class="n">lat</span><span class="p">):</span>
        <span class="c1"># Get the timezone object using pytz</span>
        <span class="n">tz</span> <span class="o">=</span> <span class="n">pytz</span><span class="o">.</span><span class="n">timezone</span><span class="p">(</span><span class="n">timezone_str</span><span class="p">)</span>
        <span class="c1"># Get the UTC offset for the specified date</span>
        <span class="n">offset</span> <span class="o">=</span> <span class="n">tz</span><span class="o">.</span><span class="n">utcoffset</span><span class="p">(</span><span class="n">date</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">offset</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">offset</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">()</span> <span class="o">/</span> <span class="mi">3600</span><span class="p">)</span>
    <span class="k">return</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="hydroutils.calculate_water_balance_metrics" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">calculate_water_balance_metrics</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">net_rain_column</span><span class="o">=</span><span class="s1">&#39;net_rain&#39;</span><span class="p">,</span> <span class="n">discharge_column</span><span class="o">=</span><span class="s1">&#39;gen_discharge&#39;</span><span class="p">,</span> <span class="n">time_step_hours</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span></code>

<a href="#hydroutils.calculate_water_balance_metrics" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>计算水量平衡指标</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>data</code>
            </td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>数据DataFrame</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>net_rain_column</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>净雨列名</p>
              </div>
            </td>
            <td>
                  <code>&#39;net_rain&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>discharge_column</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>径流列名</p>
              </div>
            </td>
            <td>
                  <code>&#39;gen_discharge&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>time_step_hours</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>时间步长（小时）</p>
              </div>
            </td>
            <td>
                  <code>1.0</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>水量平衡指标字典</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>hydroutils/hydro_correct.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">calculate_water_balance_metrics</span><span class="p">(</span>
    <span class="n">data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">net_rain_column</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;net_rain&quot;</span><span class="p">,</span>
    <span class="n">discharge_column</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;gen_discharge&quot;</span><span class="p">,</span>
    <span class="n">time_step_hours</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    计算水量平衡指标</span>

<span class="sd">    Args:</span>
<span class="sd">        data: 数据DataFrame</span>
<span class="sd">        net_rain_column: 净雨列名</span>
<span class="sd">        discharge_column: 径流列名</span>
<span class="sd">        time_step_hours: 时间步长（小时）</span>

<span class="sd">    Returns:</span>
<span class="sd">        水量平衡指标字典</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">metrics</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="c1"># 计算净雨总量（mm）</span>
    <span class="k">if</span> <span class="n">net_rain_column</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="n">total_net_rain</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">net_rain_column</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
        <span class="n">metrics</span><span class="p">[</span><span class="s2">&quot;total_net_rain_mm&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">total_net_rain</span>

    <span class="c1"># 计算径流总量（转换为mm）</span>
    <span class="k">if</span> <span class="n">discharge_column</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="c1"># 假设单位流域面积（1 km²）</span>
        <span class="c1"># 流量 m³/s × 时间步长(h) × 3600(s/h) / 1000000(m²/km²) × 1000(mm/m) = mm</span>
        <span class="n">time_step_seconds</span> <span class="o">=</span> <span class="n">time_step_hours</span> <span class="o">*</span> <span class="mi">3600</span>
        <span class="n">discharge_volume_mm</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">discharge_column</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">*</span> <span class="n">time_step_seconds</span> <span class="o">/</span> <span class="mi">1000</span>
        <span class="n">metrics</span><span class="p">[</span><span class="s2">&quot;total_discharge_mm&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">discharge_volume_mm</span>

        <span class="c1"># 计算水量平衡误差</span>
        <span class="k">if</span> <span class="n">net_rain_column</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span> <span class="ow">and</span> <span class="n">total_net_rain</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">balance_error</span> <span class="o">=</span> <span class="p">(</span>
                <span class="p">(</span><span class="n">discharge_volume_mm</span> <span class="o">-</span> <span class="n">total_net_rain</span><span class="p">)</span> <span class="o">/</span> <span class="n">total_net_rain</span> <span class="o">*</span> <span class="mi">100</span>
            <span class="p">)</span>
            <span class="n">metrics</span><span class="p">[</span><span class="s2">&quot;balance_error_percent&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">balance_error</span>

    <span class="c1"># 径流统计</span>
    <span class="k">if</span> <span class="n">discharge_column</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="n">discharge_stats</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;mean&quot;</span><span class="p">:</span> <span class="n">data</span><span class="p">[</span><span class="n">discharge_column</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span>
            <span class="s2">&quot;max&quot;</span><span class="p">:</span> <span class="n">data</span><span class="p">[</span><span class="n">discharge_column</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span>
            <span class="s2">&quot;min&quot;</span><span class="p">:</span> <span class="n">data</span><span class="p">[</span><span class="n">discharge_column</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span>
            <span class="s2">&quot;std&quot;</span><span class="p">:</span> <span class="n">data</span><span class="p">[</span><span class="n">discharge_column</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">(),</span>
            <span class="s2">&quot;peak_time_index&quot;</span><span class="p">:</span> <span class="n">data</span><span class="p">[</span><span class="n">discharge_column</span><span class="p">]</span><span class="o">.</span><span class="n">idxmax</span><span class="p">(),</span>
        <span class="p">}</span>
        <span class="n">metrics</span><span class="p">[</span><span class="s2">&quot;discharge_stats&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">discharge_stats</span>

    <span class="k">return</span> <span class="n">metrics</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="hydroutils.create_median_labels" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">create_median_labels</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">medians_value</span><span class="p">,</span> <span class="n">percent25value</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">percent75value</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="s1">&#39;small&#39;</span><span class="p">)</span></code>

<a href="#hydroutils.create_median_labels" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>"create median labels for boxes in a boxplot
Parameters</p>
<hr />
<p>ax : plt.AxesSubplot
    an ax in a fig
medians_value : np.array
    <em>description</em>
percent25value : <em>type</em>, optional
    <em>description</em>, by default None
percent75value : <em>type</em>, optional
    <em>description</em>, by default None
size : str, optional
    the size of median-value labels, by default small</p>


            <details class="quote">
              <summary>Source code in <code>hydroutils/hydro_plot.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">create_median_labels</span><span class="p">(</span>
    <span class="n">ax</span><span class="p">,</span> <span class="n">medians_value</span><span class="p">,</span> <span class="n">percent25value</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">percent75value</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="s2">&quot;small&quot;</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; &quot;create median labels for boxes in a boxplot</span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    ax : plt.AxesSubplot</span>
<span class="sd">        an ax in a fig</span>
<span class="sd">    medians_value : np.array</span>
<span class="sd">        _description_</span>
<span class="sd">    percent25value : _type_, optional</span>
<span class="sd">        _description_, by default None</span>
<span class="sd">    percent75value : _type_, optional</span>
<span class="sd">        _description_, by default None</span>
<span class="sd">    size : str, optional</span>
<span class="sd">        the size of median-value labels, by default small</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">decimal_places</span> <span class="o">=</span> <span class="s2">&quot;2&quot;</span>
    <span class="k">if</span> <span class="n">percent25value</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">percent75value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">vertical_offset</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">medians_value</span> <span class="o">*</span> <span class="mf">0.01</span><span class="p">)</span>  <span class="c1"># offset from median for display</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">per25min</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">percent25value</span><span class="p">)</span>
        <span class="n">per75max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">percent75value</span><span class="p">)</span>
        <span class="n">vertical_offset</span> <span class="o">=</span> <span class="p">(</span><span class="n">per75max</span> <span class="o">-</span> <span class="n">per25min</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.01</span>
    <span class="n">median_labels</span> <span class="o">=</span> <span class="p">[</span><span class="nb">format</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;.</span><span class="si">{</span><span class="n">decimal_places</span><span class="si">}</span><span class="s2">f&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">medians_value</span><span class="p">]</span>
    <span class="n">pos</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">medians_value</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">xtick</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_xticks</span><span class="p">():</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
            <span class="n">pos</span><span class="p">[</span><span class="n">xtick</span><span class="p">],</span>
            <span class="n">medians_value</span><span class="p">[</span><span class="n">xtick</span><span class="p">]</span> <span class="o">+</span> <span class="n">vertical_offset</span><span class="p">,</span>
            <span class="n">median_labels</span><span class="p">[</span><span class="n">xtick</span><span class="p">],</span>
            <span class="n">horizontalalignment</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="s2">&quot;w&quot;</span><span class="p">,</span>
            <span class="c1"># https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.text.html</span>
            <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">,</span>
            <span class="n">weight</span><span class="o">=</span><span class="s2">&quot;semibold&quot;</span><span class="p">,</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="hydroutils.date_to_julian" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">date_to_julian</span><span class="p">(</span><span class="n">a_time</span><span class="p">)</span></code>

<a href="#hydroutils.date_to_julian" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Converts a date to its Julian day (day of year).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>a_time</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="str">str</span>, <span title="datetime.datetime">datetime</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Date as either:
- string in 'YYYY-MM-DD' format
- datetime object</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Day of year (1-366).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1"># From string</span>
<span class="n">day</span> <span class="o">=</span> <span class="n">date_to_julian</span><span class="p">(</span><span class="s1">&#39;2023-02-01&#39;</span><span class="p">)</span>  <span class="c1"># Returns 32</span>

<span class="c1"># From datetime</span>
<span class="n">day</span> <span class="o">=</span> <span class="n">date_to_julian</span><span class="p">(</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2023</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>  <span class="c1"># Returns 32</span>
</code></pre></div></td></tr></table></div>
</details>

            <details class="quote">
              <summary>Source code in <code>hydroutils/hydro_time.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">date_to_julian</span><span class="p">(</span><span class="n">a_time</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Converts a date to its Julian day (day of year).</span>

<span class="sd">    Args:</span>
<span class="sd">        a_time: Date as either:</span>
<span class="sd">            - string in &#39;YYYY-MM-DD&#39; format</span>
<span class="sd">            - datetime object</span>

<span class="sd">    Returns:</span>
<span class="sd">        Day of year (1-366).</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        # From string</span>
<span class="sd">        day = date_to_julian(&#39;2023-02-01&#39;)  # Returns 32</span>

<span class="sd">        # From datetime</span>
<span class="sd">        day = date_to_julian(datetime(2023, 2, 1))  # Returns 32</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">a_time</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">fmt</span> <span class="o">=</span> <span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">&quot;</span>
        <span class="n">dt</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">a_time</span><span class="p">,</span> <span class="n">fmt</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">dt</span> <span class="o">=</span> <span class="n">a_time</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">timetuple</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">tt</span><span class="o">.</span><span class="n">tm_yday</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="hydroutils.download_a_file_from_google_drive" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">download_a_file_from_google_drive</span><span class="p">(</span><span class="n">drive</span><span class="p">,</span> <span class="n">dir_id</span><span class="p">,</span> <span class="n">download_dir</span><span class="p">)</span></code>

<a href="#hydroutils.download_a_file_from_google_drive" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Downloads files and folders from Google Drive recursively.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>drive</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Google Drive API client instance.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dir_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>ID of the Google Drive folder to download from.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>download_dir</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Local directory where files should be saved.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span>
<span class="normal">9</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">pydrive.auth</span><span class="w"> </span><span class="kn">import</span> <span class="n">GoogleAuth</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pydrive.drive</span><span class="w"> </span><span class="kn">import</span> <span class="n">GoogleDrive</span>

<span class="n">gauth</span> <span class="o">=</span> <span class="n">GoogleAuth</span><span class="p">()</span>
<span class="n">gauth</span><span class="o">.</span><span class="n">LocalWebserverAuth</span><span class="p">()</span>
<span class="n">drive</span> <span class="o">=</span> <span class="n">GoogleDrive</span><span class="p">(</span><span class="n">gauth</span><span class="p">)</span>

<span class="c1"># Download folder with ID &#39;1234...&#39; to &#39;./downloads&#39;</span>
<span class="n">download_a_file_from_google_drive</span><span class="p">(</span><span class="n">drive</span><span class="p">,</span> <span class="s1">&#39;1234...&#39;</span><span class="p">,</span> <span class="s1">&#39;./downloads&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
</details>

<details class="note" open>
  <summary>Note</summary>
  <ul>
<li>Handles both files and folders recursively</li>
<li>Skips already downloaded files</li>
<li>Creates subdirectories as needed</li>
<li>Prints progress information</li>
</ul>
</details>

            <details class="quote">
              <summary>Source code in <code>hydroutils/hydro_file.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">download_a_file_from_google_drive</span><span class="p">(</span><span class="n">drive</span><span class="p">,</span> <span class="n">dir_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">download_dir</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Downloads files and folders from Google Drive recursively.</span>

<span class="sd">    Args:</span>
<span class="sd">        drive: Google Drive API client instance.</span>
<span class="sd">        dir_id: ID of the Google Drive folder to download from.</span>
<span class="sd">        download_dir: Local directory where files should be saved.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        from pydrive.auth import GoogleAuth</span>
<span class="sd">        from pydrive.drive import GoogleDrive</span>

<span class="sd">        gauth = GoogleAuth()</span>
<span class="sd">        gauth.LocalWebserverAuth()</span>
<span class="sd">        drive = GoogleDrive(gauth)</span>

<span class="sd">        # Download folder with ID &#39;1234...&#39; to &#39;./downloads&#39;</span>
<span class="sd">        download_a_file_from_google_drive(drive, &#39;1234...&#39;, &#39;./downloads&#39;)</span>
<span class="sd">        ```</span>

<span class="sd">    Note:</span>
<span class="sd">        - Handles both files and folders recursively</span>
<span class="sd">        - Skips already downloaded files</span>
<span class="sd">        - Creates subdirectories as needed</span>
<span class="sd">        - Prints progress information</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">file_list</span> <span class="o">=</span> <span class="n">drive</span><span class="o">.</span><span class="n">ListFile</span><span class="p">(</span>
        <span class="p">{</span><span class="s2">&quot;q&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;&#39;</span><span class="si">{</span><span class="n">dir_id</span><span class="si">}</span><span class="s2">&#39; in parents and trashed=false&quot;</span><span class="p">}</span>
    <span class="p">)</span><span class="o">.</span><span class="n">GetList</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">file_list</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;title: </span><span class="si">{</span><span class="n">file</span><span class="p">[</span><span class="s2">&quot;title&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1">, id: </span><span class="si">{</span><span class="n">file</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">file_dl</span> <span class="o">=</span> <span class="n">drive</span><span class="o">.</span><span class="n">CreateFile</span><span class="p">({</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="n">file</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]})</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;mimetype is </span><span class="si">{</span><span class="n">file_dl</span><span class="p">[</span><span class="s2">&quot;mimeType&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">file_dl</span><span class="p">[</span><span class="s2">&quot;mimeType&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;application/vnd.google-apps.folder&quot;</span><span class="p">:</span>
            <span class="n">download_dir_sub</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">download_dir</span><span class="p">,</span> <span class="n">file_dl</span><span class="p">[</span><span class="s2">&quot;title&quot;</span><span class="p">])</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">download_dir_sub</span><span class="p">):</span>
                <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">download_dir_sub</span><span class="p">)</span>
            <span class="n">download_a_file_from_google_drive</span><span class="p">(</span><span class="n">drive</span><span class="p">,</span> <span class="n">file_dl</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">],</span> <span class="n">download_dir_sub</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># download</span>
            <span class="n">temp_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">download_dir</span><span class="p">,</span> <span class="n">file_dl</span><span class="p">[</span><span class="s2">&quot;title&quot;</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">temp_file</span><span class="p">):</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;file has been downloaded&quot;</span><span class="p">)</span>
                <span class="k">continue</span>
            <span class="n">file_dl</span><span class="o">.</span><span class="n">GetContentFile</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">download_dir</span><span class="p">,</span> <span class="n">file_dl</span><span class="p">[</span><span class="s2">&quot;title&quot;</span><span class="p">]))</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Downloading file finished&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="hydroutils.download_excel" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">download_excel</span><span class="p">(</span><span class="n">data_url</span><span class="p">,</span> <span class="n">temp_file</span><span class="p">)</span></code>

<a href="#hydroutils.download_excel" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Downloads an Excel file from a URL.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>data_url</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>URL of the Excel file.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>temp_file</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path where the file should be saved.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;https://example.com/data.xlsx&#39;</span>
<span class="n">download_excel</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="s1">&#39;./data.xlsx&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
</details>

<details class="note" open>
  <summary>Note</summary>
  <p>Only downloads if the file doesn't already exist locally.</p>
</details>

            <details class="quote">
              <summary>Source code in <code>hydroutils/hydro_file.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">download_excel</span><span class="p">(</span><span class="n">data_url</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">temp_file</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Downloads an Excel file from a URL.</span>

<span class="sd">    Args:</span>
<span class="sd">        data_url: URL of the Excel file.</span>
<span class="sd">        temp_file: Path where the file should be saved.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        url = &#39;https://example.com/data.xlsx&#39;</span>
<span class="sd">        download_excel(url, &#39;./data.xlsx&#39;)</span>
<span class="sd">        ```</span>

<span class="sd">    Note:</span>
<span class="sd">        Only downloads if the file doesn&#39;t already exist locally.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">temp_file</span><span class="p">):</span>
        <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">urlretrieve</span><span class="p">(</span><span class="n">data_url</span><span class="p">,</span> <span class="n">temp_file</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="hydroutils.download_one_zip" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">download_one_zip</span><span class="p">(</span><span class="n">data_url</span><span class="p">,</span> <span class="n">data_dir</span><span class="p">)</span></code>

<a href="#hydroutils.download_one_zip" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Downloads and extracts a zip file from a URL.</p>
<p>Creates the target directory and bucket if they don't exist.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>data_url</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>URL of the zip file to download.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>data_dir</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Directory where the file should be downloaded and extracted.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of object names in the extracted contents.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;https://example.com/data.zip&#39;</span>
<span class="n">files</span> <span class="o">=</span> <span class="n">download_one_zip</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="s1">&#39;./downloads&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Downloaded and extracted: </span><span class="si">{</span><span class="n">files</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
</details>

            <details class="quote">
              <summary>Source code in <code>hydroutils/hydro_file.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">download_one_zip</span><span class="p">(</span><span class="n">data_url</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">data_dir</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Downloads and extracts a zip file from a URL.</span>

<span class="sd">    Creates the target directory and bucket if they don&#39;t exist.</span>

<span class="sd">    Args:</span>
<span class="sd">        data_url: URL of the zip file to download.</span>
<span class="sd">        data_dir: Directory where the file should be downloaded and extracted.</span>

<span class="sd">    Returns:</span>
<span class="sd">        List of object names in the extracted contents.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        url = &#39;https://example.com/data.zip&#39;</span>
<span class="sd">        files = download_one_zip(url, &#39;./downloads&#39;)</span>
<span class="sd">        print(f&quot;Downloaded and extracted: {files}&quot;)</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">zipfile_path</span><span class="p">,</span> <span class="n">unzip_dir</span> <span class="o">=</span> <span class="n">zip_file_name_from_url</span><span class="p">(</span><span class="n">data_url</span><span class="p">,</span> <span class="n">data_dir</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">is_there_file</span><span class="p">(</span><span class="n">zipfile_path</span><span class="p">,</span> <span class="n">unzip_dir</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">unzip_dir</span><span class="p">):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">unzip_dir</span><span class="p">)</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">data_url</span><span class="p">,</span> <span class="n">stream</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">zipfile_path</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">py_file</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="n">r</span><span class="o">.</span><span class="n">iter_content</span><span class="p">(</span><span class="n">chunk_size</span><span class="o">=</span><span class="mi">1024</span><span class="p">):</span>  <span class="c1"># 1024 bytes</span>
                <span class="k">if</span> <span class="n">chunk</span><span class="p">:</span>
                    <span class="n">py_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">chunk</span><span class="p">)</span>
        <span class="n">unzip_nested_zip</span><span class="p">(</span><span class="n">zipfile_path</span><span class="p">,</span> <span class="n">unzip_dir</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="hydroutils.download_small_file" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">download_small_file</span><span class="p">(</span><span class="n">data_url</span><span class="p">,</span> <span class="n">temp_file</span><span class="p">)</span></code>

<a href="#hydroutils.download_small_file" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Downloads a small text file from a URL.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>data_url</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>URL of the file to download.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>temp_file</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path where the file should be saved.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;https://example.com/data.txt&#39;</span>
<span class="n">download_small_file</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="s1">&#39;./data.txt&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
</details>

<details class="note" open>
  <summary>Note</summary>
  <p>This function is designed for text files. For binary files,
use download_small_zip or download_one_zip instead.</p>
</details>

            <details class="quote">
              <summary>Source code in <code>hydroutils/hydro_file.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">download_small_file</span><span class="p">(</span><span class="n">data_url</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">temp_file</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Downloads a small text file from a URL.</span>

<span class="sd">    Args:</span>
<span class="sd">        data_url: URL of the file to download.</span>
<span class="sd">        temp_file: Path where the file should be saved.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        url = &#39;https://example.com/data.txt&#39;</span>
<span class="sd">        download_small_file(url, &#39;./data.txt&#39;)</span>
<span class="sd">        ```</span>

<span class="sd">    Note:</span>
<span class="sd">        This function is designed for text files. For binary files,</span>
<span class="sd">        use download_small_zip or download_one_zip instead.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">data_url</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">temp_file</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="hydroutils.download_small_zip" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">download_small_zip</span><span class="p">(</span><span class="n">data_url</span><span class="p">,</span> <span class="n">data_dir</span><span class="p">)</span></code>

<a href="#hydroutils.download_small_zip" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Downloads and extracts a small zip file using urllib.</p>
<p>This function is optimized for small files. For large files,
use download_one_zip instead.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>data_url</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>URL of the zip file to download.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>data_dir</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Directory where the file should be downloaded and extracted.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;https://example.com/small_data.zip&#39;</span>
<span class="n">download_small_zip</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="s1">&#39;./downloads&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
</details>

            <details class="quote">
              <summary>Source code in <code>hydroutils/hydro_file.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">download_small_zip</span><span class="p">(</span><span class="n">data_url</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">data_dir</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Downloads and extracts a small zip file using urllib.</span>

<span class="sd">    This function is optimized for small files. For large files,</span>
<span class="sd">    use download_one_zip instead.</span>

<span class="sd">    Args:</span>
<span class="sd">        data_url: URL of the zip file to download.</span>
<span class="sd">        data_dir: Directory where the file should be downloaded and extracted.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        url = &#39;https://example.com/small_data.zip&#39;</span>
<span class="sd">        download_small_zip(url, &#39;./downloads&#39;)</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">zipfile_path</span><span class="p">,</span> <span class="n">unzip_dir</span> <span class="o">=</span> <span class="n">zip_file_name_from_url</span><span class="p">(</span><span class="n">data_url</span><span class="p">,</span> <span class="n">data_dir</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">is_there_file</span><span class="p">(</span><span class="n">zipfile_path</span><span class="p">,</span> <span class="n">unzip_dir</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">unzip_dir</span><span class="p">):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">unzip_dir</span><span class="p">)</span>
        <span class="n">zipfile_path</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">urlretrieve</span><span class="p">(</span><span class="n">data_url</span><span class="p">,</span> <span class="n">zipfile_path</span><span class="p">)</span>
        <span class="n">unzip_nested_zip</span><span class="p">(</span><span class="n">zipfile_path</span><span class="p">,</span> <span class="n">unzip_dir</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="hydroutils.download_zip_files" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">download_zip_files</span><span class="p">(</span><span class="n">urls</span><span class="p">,</span> <span class="n">the_dir</span><span class="p">)</span></code>

<a href="#hydroutils.download_zip_files" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Downloads multiple files from multiple URLs.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>urls</code>
            </td>
            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of URLs to download from.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>the_dir</code>
            </td>
            <td>
                  <code><span title="pathlib.Path">Path</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Directory where downloaded files will be saved.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
<span class="n">urls</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;https://example.com/file1.zip&#39;</span><span class="p">,</span>
    <span class="s1">&#39;https://example.com/file2.zip&#39;</span>
<span class="p">]</span>
<span class="n">download_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s1">&#39;./downloads&#39;</span><span class="p">)</span>
<span class="n">download_zip_files</span><span class="p">(</span><span class="n">urls</span><span class="p">,</span> <span class="n">download_dir</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
</details>

<details class="note" open>
  <summary>Note</summary>
  <p>Uses async_retriever for efficient parallel downloads.
Files are named based on the last component of their URLs.</p>
</details>

            <details class="quote">
              <summary>Source code in <code>hydroutils/hydro_file.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">download_zip_files</span><span class="p">(</span><span class="n">urls</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">the_dir</span><span class="p">:</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Downloads multiple files from multiple URLs.</span>

<span class="sd">    Args:</span>
<span class="sd">        urls: List of URLs to download from.</span>
<span class="sd">        the_dir: Directory where downloaded files will be saved.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        from pathlib import Path</span>
<span class="sd">        urls = [</span>
<span class="sd">            &#39;https://example.com/file1.zip&#39;,</span>
<span class="sd">            &#39;https://example.com/file2.zip&#39;</span>
<span class="sd">        ]</span>
<span class="sd">        download_dir = Path(&#39;./downloads&#39;)</span>
<span class="sd">        download_zip_files(urls, download_dir)</span>
<span class="sd">        ```</span>

<span class="sd">    Note:</span>
<span class="sd">        Uses async_retriever for efficient parallel downloads.</span>
<span class="sd">        Files are named based on the last component of their URLs.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">TemporaryDirectory</span><span class="p">()</span> <span class="k">as</span> <span class="n">tmpdir</span><span class="p">:</span>
        <span class="n">cache_names</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">tmpdir</span><span class="p">)</span><span class="o">.</span><span class="n">joinpath</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">the_dir</span><span class="o">.</span><span class="n">stem</span><span class="si">}</span><span class="s2">.sqlite&quot;</span><span class="p">)</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">ar</span><span class="o">.</span><span class="n">retrieve</span><span class="p">(</span><span class="n">urls</span><span class="p">,</span> <span class="s2">&quot;binary&quot;</span><span class="p">,</span> <span class="n">cache_name</span><span class="o">=</span><span class="n">cache_names</span><span class="p">,</span> <span class="n">ssl</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">files</span> <span class="o">=</span> <span class="p">[</span><span class="n">the_dir</span><span class="o">.</span><span class="n">joinpath</span><span class="p">(</span><span class="n">url</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">url</span> <span class="ow">in</span> <span class="n">urls</span><span class="p">]</span>
        <span class="p">[</span><span class="n">files</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">write_bytes</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n">getbuffer</span><span class="p">())</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">files</span><span class="p">))]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="hydroutils.ecdf" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">ecdf</span><span class="p">(</span><span class="n">data</span><span class="p">)</span></code>

<a href="#hydroutils.ecdf" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Computes empirical cumulative distribution function (ECDF).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>data</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Input array of values.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Tuple">Tuple</span>[<span title="numpy.ndarray">ndarray</span>, <span title="numpy.ndarray">ndarray</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Tuple of (sorted_values, cumulative_probabilities).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">ecdf</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="c1"># x = [1, 2, 2, 3, 4, 4, 5]  # Sorted values</span>
<span class="c1"># y ≈ [0.14, 0.29, 0.43, 0.57, 0.71, 0.86, 1.0]  # Probabilities</span>
</code></pre></div></td></tr></table></div>
</details>

            <details class="quote">
              <summary>Source code in <code>hydroutils/hydro_stat.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">ecdf</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Computes empirical cumulative distribution function (ECDF).</span>

<span class="sd">    Args:</span>
<span class="sd">        data: Input array of values.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Tuple of (sorted_values, cumulative_probabilities).</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        data = np.array([1, 2, 2, 3, 4, 4, 5])</span>
<span class="sd">        x, y = ecdf(data)</span>
<span class="sd">        # x = [1, 2, 2, 3, 4, 4, 5]  # Sorted values</span>
<span class="sd">        # y ≈ [0.14, 0.29, 0.43, 0.57, 0.71, 0.86, 1.0]  # Probabilities</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">size</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">n</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="hydroutils.fms" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">fms</span><span class="p">(</span><span class="n">obs</span><span class="p">,</span> <span class="n">sim</span><span class="p">,</span> <span class="n">lower</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">upper</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span></code>

<a href="#hydroutils.fms" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Calculates the slope of the middle section of the flow duration curve.</p>
<p>Computes the bias in the slope of the middle section of the flow duration curve (FDC)
between simulated and observed flows. The middle section is defined by the lower
and upper percentiles.</p>
<p>The formula used is:
BiasFMS = (|log(Qs_lower) - log(Qs_upper)| - |log(Qo_lower) - log(Qo_upper)|) /
          |log(Qs_lower) - log(Qs_upper)| × 100</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>obs</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Observed flow time series.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>sim</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Simulated flow time series.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>lower</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Lower percentile bound (0-1). Defaults to 0.2 (20th percentile).</p>
              </div>
            </td>
            <td>
                  <code>0.2</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>upper</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Upper percentile bound (0-1). Defaults to 0.7 (70th percentile).</p>
              </div>
            </td>
            <td>
                  <code>0.7</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Percentage bias in the FDC slope.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If lower/upper bounds are not in range (0,1) or if lower &gt;= upper.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">obs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">])</span>
<span class="n">sim</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.2</span><span class="p">,</span> <span class="mf">2.1</span><span class="p">,</span> <span class="mf">2.9</span><span class="p">,</span> <span class="mf">4.2</span><span class="p">,</span> <span class="mf">5.1</span><span class="p">])</span>
<span class="n">bias</span> <span class="o">=</span> <span class="n">fms</span><span class="p">(</span><span class="n">obs</span><span class="p">,</span> <span class="n">sim</span><span class="p">,</span> <span class="n">lower</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">upper</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
</details>

<details class="note" open>
  <summary>Note</summary>
  <p>Based on Yilmaz et al. (2008), doi:10.1029/2007WR006716</p>
</details>

            <details class="quote">
              <summary>Source code in <code>hydroutils/hydro_stat.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">fms</span><span class="p">(</span><span class="n">obs</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">sim</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">lower</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">,</span> <span class="n">upper</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.7</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculates the slope of the middle section of the flow duration curve.</span>

<span class="sd">    Computes the bias in the slope of the middle section of the flow duration curve (FDC)</span>
<span class="sd">    between simulated and observed flows. The middle section is defined by the lower</span>
<span class="sd">    and upper percentiles.</span>

<span class="sd">    The formula used is:</span>
<span class="sd">    BiasFMS = (|log(Qs_lower) - log(Qs_upper)| - |log(Qo_lower) - log(Qo_upper)|) /</span>
<span class="sd">              |log(Qs_lower) - log(Qs_upper)| × 100</span>

<span class="sd">    Args:</span>
<span class="sd">        obs: Observed flow time series.</span>
<span class="sd">        sim: Simulated flow time series.</span>
<span class="sd">        lower: Lower percentile bound (0-1). Defaults to 0.2 (20th percentile).</span>
<span class="sd">        upper: Upper percentile bound (0-1). Defaults to 0.7 (70th percentile).</span>

<span class="sd">    Returns:</span>
<span class="sd">        Percentage bias in the FDC slope.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If lower/upper bounds are not in range (0,1) or if lower &gt;= upper.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        obs = np.array([1.0, 2.0, 3.0, 4.0, 5.0])</span>
<span class="sd">        sim = np.array([1.2, 2.1, 2.9, 4.2, 5.1])</span>
<span class="sd">        bias = fms(obs, sim, lower=0.2, upper=0.7)</span>
<span class="sd">        ```</span>

<span class="sd">    Note:</span>
<span class="sd">        Based on Yilmaz et al. (2008), doi:10.1029/2007WR006716</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">obs</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

    <span class="k">if</span> <span class="nb">any</span><span class="p">((</span><span class="n">x</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">x</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">[</span><span class="n">upper</span><span class="p">,</span> <span class="n">lower</span><span class="p">]):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;upper and lower have to be in range ]0,1[&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">lower</span> <span class="o">&gt;=</span> <span class="n">upper</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The lower threshold has to be smaller than the upper.&quot;</span><span class="p">)</span>

    <span class="c1"># get arrays of sorted (descending) discharges</span>
    <span class="n">obs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">obs</span><span class="p">)</span>
    <span class="n">sim</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">sim</span><span class="p">)</span>

    <span class="c1"># for numerical reasons change 0s to 1e-6. Simulations can still contain negatives, so also reset those.</span>
    <span class="n">sim</span><span class="p">[</span><span class="n">sim</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1e-6</span>
    <span class="n">obs</span><span class="p">[</span><span class="n">obs</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1e-6</span>

    <span class="c1"># calculate fms part by part</span>
    <span class="n">qsm_lower</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">sim</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">lower</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">sim</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)])</span>
    <span class="n">qsm_upper</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">sim</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">upper</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">sim</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)])</span>
    <span class="n">qom_lower</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">obs</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">lower</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">obs</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)])</span>
    <span class="n">qom_upper</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">obs</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">upper</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">obs</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)])</span>

    <span class="n">fms</span> <span class="o">=</span> <span class="p">((</span><span class="n">qsm_lower</span> <span class="o">-</span> <span class="n">qsm_upper</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">qom_lower</span> <span class="o">-</span> <span class="n">qom_upper</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span>
        <span class="n">qom_lower</span> <span class="o">-</span> <span class="n">qom_upper</span> <span class="o">+</span> <span class="mf">1e-6</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">fms</span> <span class="o">*</span> <span class="mi">100</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="hydroutils.generate_start0101_time_range" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">generate_start0101_time_range</span><span class="p">(</span><span class="n">start_time</span><span class="p">,</span> <span class="n">end_time</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;8D&#39;</span><span class="p">)</span></code>

<a href="#hydroutils.generate_start0101_time_range" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Generates a time range that resets to January 1st each year.</p>
<p>Creates a sequence of dates with specified frequency, but ensures that each year
starts from January 1st regardless of the frequency interval.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>start_time</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="str">str</span>, <span title="pandas.Timestamp">Timestamp</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Start date as string ('YYYY-MM-DD') or pandas Timestamp.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>end_time</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="str">str</span>, <span title="pandas.Timestamp">Timestamp</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>End date as string ('YYYY-MM-DD') or pandas Timestamp.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>freq</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Time frequency (e.g., '8D' for 8 days, '7D' for weekly).</p>
              </div>
            </td>
            <td>
                  <code>&#39;8D&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas.DatetimeIndex">DatetimeIndex</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DatetimeIndex with specified frequency and annual reset to January 1st.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1"># Generate 8-day intervals, resetting to Jan 1st each year</span>
<span class="n">dates</span> <span class="o">=</span> <span class="n">generate_start0101_time_range</span><span class="p">(</span><span class="s1">&#39;2023-01-15&#39;</span><span class="p">,</span> <span class="s1">&#39;2024-02-01&#39;</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;8D&#39;</span><span class="p">)</span>

<span class="c1"># Generate weekly intervals</span>
<span class="n">dates</span> <span class="o">=</span> <span class="n">generate_start0101_time_range</span><span class="p">(</span><span class="s1">&#39;2023-01-15&#39;</span><span class="p">,</span> <span class="s1">&#39;2024-02-01&#39;</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;7D&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
</details>

<details class="note" open>
  <summary>Note</summary>
  <p>If an interval would cross into a new year, it's truncated and the next
interval starts from January 1st of the new year.</p>
</details>

            <details class="quote">
              <summary>Source code in <code>hydroutils/hydro_time.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">generate_start0101_time_range</span><span class="p">(</span>
    <span class="n">start_time</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">],</span>
    <span class="n">end_time</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">],</span>
    <span class="n">freq</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;8D&quot;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DatetimeIndex</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generates a time range that resets to January 1st each year.</span>

<span class="sd">    Creates a sequence of dates with specified frequency, but ensures that each year</span>
<span class="sd">    starts from January 1st regardless of the frequency interval.</span>

<span class="sd">    Args:</span>
<span class="sd">        start_time: Start date as string (&#39;YYYY-MM-DD&#39;) or pandas Timestamp.</span>
<span class="sd">        end_time: End date as string (&#39;YYYY-MM-DD&#39;) or pandas Timestamp.</span>
<span class="sd">        freq: Time frequency (e.g., &#39;8D&#39; for 8 days, &#39;7D&#39; for weekly).</span>

<span class="sd">    Returns:</span>
<span class="sd">        DatetimeIndex with specified frequency and annual reset to January 1st.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        # Generate 8-day intervals, resetting to Jan 1st each year</span>
<span class="sd">        dates = generate_start0101_time_range(&#39;2023-01-15&#39;, &#39;2024-02-01&#39;, freq=&#39;8D&#39;)</span>

<span class="sd">        # Generate weekly intervals</span>
<span class="sd">        dates = generate_start0101_time_range(&#39;2023-01-15&#39;, &#39;2024-02-01&#39;, freq=&#39;7D&#39;)</span>
<span class="sd">        ```</span>

<span class="sd">    Note:</span>
<span class="sd">        If an interval would cross into a new year, it&#39;s truncated and the next</span>
<span class="sd">        interval starts from January 1st of the new year.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">all_dates</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># Ensure the start and end times are of type pd.Timestamp</span>
    <span class="n">current_time</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="n">start_time</span><span class="p">)</span>
    <span class="n">end_time</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="n">end_time</span><span class="p">)</span>

    <span class="c1"># Parse the frequency interval correctly</span>
    <span class="n">interval_days</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timedelta</span><span class="p">(</span><span class="n">freq</span><span class="p">)</span>  <span class="c1"># Ensure it&#39;s a Timedelta</span>

    <span class="k">while</span> <span class="n">current_time</span> <span class="o">&lt;=</span> <span class="n">end_time</span><span class="p">:</span>
        <span class="n">all_dates</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">current_time</span><span class="p">)</span>

        <span class="c1"># Calculate next date with the specified interval</span>
        <span class="n">next_time</span> <span class="o">=</span> <span class="n">current_time</span> <span class="o">+</span> <span class="n">interval_days</span>

        <span class="c1"># If next_time crosses into a new year, reset to 01-01 of the new year</span>
        <span class="k">if</span> <span class="n">next_time</span><span class="o">.</span><span class="n">year</span> <span class="o">&gt;</span> <span class="n">current_time</span><span class="o">.</span><span class="n">year</span><span class="p">:</span>
            <span class="n">next_time</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">next_time</span><span class="o">.</span><span class="n">year</span><span class="si">}</span><span class="s2">-01-01&quot;</span><span class="p">)</span>

        <span class="n">current_time</span> <span class="o">=</span> <span class="n">next_time</span>

    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">all_dates</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="hydroutils.get_cache_dir" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_cache_dir</span><span class="p">(</span><span class="n">app_name</span><span class="o">=</span><span class="s1">&#39;hydro&#39;</span><span class="p">)</span></code>

<a href="#hydroutils.get_cache_dir" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Gets the appropriate cache directory for the current platform.</p>
<p>Creates the directory if it doesn't exist.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>app_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the application (used in path). Defaults to "hydro".</p>
              </div>
            </td>
            <td>
                  <code>&#39;hydro&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to the cache directory.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1"># Get default cache directory</span>
<span class="n">cache_dir</span> <span class="o">=</span> <span class="n">get_cache_dir</span><span class="p">()</span>

<span class="c1"># Get cache directory for custom app</span>
<span class="n">cache_dir</span> <span class="o">=</span> <span class="n">get_cache_dir</span><span class="p">(</span><span class="s1">&#39;myapp&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
</details>

<details class="note" open>
  <summary>Note</summary>
  <p>Uses platform-specific paths:
- Windows: ~/AppData/Local/{app_name}/Cache
- macOS: ~/Library/Caches/{app_name}
- Linux/Unix: ~/.cache/{app_name}</p>
</details>

            <details class="quote">
              <summary>Source code in <code>hydroutils/hydro_file.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_cache_dir</span><span class="p">(</span><span class="n">app_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;hydro&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Gets the appropriate cache directory for the current platform.</span>

<span class="sd">    Creates the directory if it doesn&#39;t exist.</span>

<span class="sd">    Args:</span>
<span class="sd">        app_name: Name of the application (used in path). Defaults to &quot;hydro&quot;.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Path to the cache directory.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        # Get default cache directory</span>
<span class="sd">        cache_dir = get_cache_dir()</span>

<span class="sd">        # Get cache directory for custom app</span>
<span class="sd">        cache_dir = get_cache_dir(&#39;myapp&#39;)</span>
<span class="sd">        ```</span>

<span class="sd">    Note:</span>
<span class="sd">        Uses platform-specific paths:</span>
<span class="sd">        - Windows: ~/AppData/Local/{app_name}/Cache</span>
<span class="sd">        - macOS: ~/Library/Caches/{app_name}</span>
<span class="sd">        - Linux/Unix: ~/.cache/{app_name}</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">home</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s2">&quot;~&quot;</span><span class="p">)</span>
    <span class="n">system</span> <span class="o">=</span> <span class="n">platform</span><span class="o">.</span><span class="n">system</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">system</span> <span class="o">==</span> <span class="s2">&quot;Windows&quot;</span><span class="p">:</span>
        <span class="n">cache_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">home</span><span class="p">,</span> <span class="s2">&quot;AppData&quot;</span><span class="p">,</span> <span class="s2">&quot;Local&quot;</span><span class="p">,</span> <span class="n">app_name</span><span class="p">,</span> <span class="s2">&quot;Cache&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">system</span> <span class="o">==</span> <span class="s2">&quot;Darwin&quot;</span><span class="p">:</span>
        <span class="n">cache_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">home</span><span class="p">,</span> <span class="s2">&quot;Library&quot;</span><span class="p">,</span> <span class="s2">&quot;Caches&quot;</span><span class="p">,</span> <span class="n">app_name</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">cache_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">home</span><span class="p">,</span> <span class="s2">&quot;.cache&quot;</span><span class="p">,</span> <span class="n">app_name</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">cache_dir</span><span class="p">):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">cache_dir</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">cache_dir</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="hydroutils.get_lastest_file_in_a_dir" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_lastest_file_in_a_dir</span><span class="p">(</span><span class="n">dir_path</span><span class="p">)</span></code>

<a href="#hydroutils.get_lastest_file_in_a_dir" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Gets the most recently modified .pth file in a directory.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>dir_path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Directory to search in.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to the most recently modified .pth file.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1"># Get latest model weights file</span>
<span class="n">latest</span> <span class="o">=</span> <span class="n">get_lastest_file_in_a_dir</span><span class="p">(</span><span class="s1">&#39;./models&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Latest weights: </span><span class="si">{</span><span class="n">latest</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
</details>

            <details class="quote">
              <summary>Source code in <code>hydroutils/hydro_file.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_lastest_file_in_a_dir</span><span class="p">(</span><span class="n">dir_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Gets the most recently modified .pth file in a directory.</span>

<span class="sd">    Args:</span>
<span class="sd">        dir_path: Directory to search in.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Path to the most recently modified .pth file.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        # Get latest model weights file</span>
<span class="sd">        latest = get_lastest_file_in_a_dir(&#39;./models&#39;)</span>
<span class="sd">        print(f&quot;Latest weights: {latest}&quot;)</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">pth_files_lst</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dir_path</span><span class="p">,</span> <span class="n">file</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">dir_path</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">fnmatch</span><span class="o">.</span><span class="n">fnmatch</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="s2">&quot;*.pth&quot;</span><span class="p">)</span>
    <span class="p">]</span>
    <span class="k">return</span> <span class="n">get_latest_file_in_a_lst</span><span class="p">(</span><span class="n">pth_files_lst</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="hydroutils.get_latest_file_in_a_lst" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_latest_file_in_a_lst</span><span class="p">(</span><span class="n">lst</span><span class="p">)</span></code>

<a href="#hydroutils.get_latest_file_in_a_lst" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Gets the most recently modified file from a list of files.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>lst</code>
            </td>
            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of file paths.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to the most recently modified file.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">files</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;model_v1.pth&#39;</span><span class="p">,</span> <span class="s1">&#39;model_v2.pth&#39;</span><span class="p">,</span> <span class="s1">&#39;model_v3.pth&#39;</span><span class="p">]</span>
<span class="n">latest</span> <span class="o">=</span> <span class="n">get_latest_file_in_a_lst</span><span class="p">(</span><span class="n">files</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Latest version: </span><span class="si">{</span><span class="n">latest</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
</details>

            <details class="quote">
              <summary>Source code in <code>hydroutils/hydro_file.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_latest_file_in_a_lst</span><span class="p">(</span><span class="n">lst</span><span class="p">:</span> <span class="nb">list</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Gets the most recently modified file from a list of files.</span>

<span class="sd">    Args:</span>
<span class="sd">        lst: List of file paths.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Path to the most recently modified file.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        files = [&#39;model_v1.pth&#39;, &#39;model_v2.pth&#39;, &#39;model_v3.pth&#39;]</span>
<span class="sd">        latest = get_latest_file_in_a_lst(files)</span>
<span class="sd">        print(f&quot;Latest version: {latest}&quot;)</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">lst_ctime</span> <span class="o">=</span> <span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">getctime</span><span class="p">(</span><span class="n">file</span><span class="p">)</span> <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">lst</span><span class="p">]</span>
    <span class="n">sort_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">lst_ctime</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">lst</span><span class="p">[</span><span class="n">sort_idx</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="hydroutils.get_year" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_year</span><span class="p">(</span><span class="n">a_time</span><span class="p">)</span></code>

<a href="#hydroutils.get_year" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Extracts the year from various date formats.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>a_time</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="datetime.date">date</span>, <span title="numpy.datetime64">datetime64</span>, <span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Date in one of these formats:
- datetime.date object
- numpy.datetime64 object
- string in 'YYYY-MM-DD' format</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Year as integer.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1"># From datetime.date</span>
<span class="n">year</span> <span class="o">=</span> <span class="n">get_year</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="p">(</span><span class="mi">2023</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>  <span class="c1"># Returns 2023</span>

<span class="c1"># From numpy.datetime64</span>
<span class="n">year</span> <span class="o">=</span> <span class="n">get_year</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">datetime64</span><span class="p">(</span><span class="s1">&#39;2023-01-01&#39;</span><span class="p">))</span>  <span class="c1"># Returns 2023</span>

<span class="c1"># From string</span>
<span class="n">year</span> <span class="o">=</span> <span class="n">get_year</span><span class="p">(</span><span class="s1">&#39;2023-01-01&#39;</span><span class="p">)</span>  <span class="c1"># Returns 2023</span>
</code></pre></div></td></tr></table></div>
</details>

            <details class="quote">
              <summary>Source code in <code>hydroutils/hydro_time.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_year</span><span class="p">(</span><span class="n">a_time</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">datetime64</span><span class="p">,</span> <span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Extracts the year from various date formats.</span>

<span class="sd">    Args:</span>
<span class="sd">        a_time: Date in one of these formats:</span>
<span class="sd">            - datetime.date object</span>
<span class="sd">            - numpy.datetime64 object</span>
<span class="sd">            - string in &#39;YYYY-MM-DD&#39; format</span>

<span class="sd">    Returns:</span>
<span class="sd">        Year as integer.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        # From datetime.date</span>
<span class="sd">        year = get_year(datetime.date(2023, 1, 1))  # Returns 2023</span>

<span class="sd">        # From numpy.datetime64</span>
<span class="sd">        year = get_year(np.datetime64(&#39;2023-01-01&#39;))  # Returns 2023</span>

<span class="sd">        # From string</span>
<span class="sd">        year = get_year(&#39;2023-01-01&#39;)  # Returns 2023</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">a_time</span><span class="p">,</span> <span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">a_time</span><span class="o">.</span><span class="n">year</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">a_time</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">datetime64</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">a_time</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;datetime64[Y]&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1970</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">a_time</span><span class="p">[:</span><span class="mi">4</span><span class="p">])</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="hydroutils.hydro_logger" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">hydro_logger</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span></code>

<a href="#hydroutils.hydro_logger" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>A class decorator that adds logging capabilities to a class.</p>
<p>This decorator sets up both file and console logging for the decorated class.
Logs are stored in a cache directory with timestamps in the filename.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>cls</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The class to be decorated.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The decorated class with an added logger attribute.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@hydro_logger</span>
<span class="k">class</span><span class="w"> </span><span class="nc">MyHydroClass</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">some_method</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Processing data...&quot;</span><span class="p">)</span>
        <span class="c1"># Method implementation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Processing complete&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
</details>

            <details class="quote">
              <summary>Source code in <code>hydroutils/hydro_log.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">hydro_logger</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A class decorator that adds logging capabilities to a class.</span>

<span class="sd">    This decorator sets up both file and console logging for the decorated class.</span>
<span class="sd">    Logs are stored in a cache directory with timestamps in the filename.</span>

<span class="sd">    Args:</span>
<span class="sd">        cls: The class to be decorated.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The decorated class with an added logger attribute.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        @hydro_logger</span>
<span class="sd">        class MyHydroClass:</span>
<span class="sd">            def some_method(self):</span>
<span class="sd">                self.logger.info(&quot;Processing data...&quot;)</span>
<span class="sd">                # Method implementation</span>
<span class="sd">                self.logger.debug(&quot;Processing complete&quot;)</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Use the class name as the logger name</span>
    <span class="n">logger_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="n">logger_name</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">)</span>
    <span class="n">cache_dir</span> <span class="o">=</span> <span class="n">get_cache_dir</span><span class="p">()</span>
    <span class="n">log_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">cache_dir</span><span class="p">,</span> <span class="s2">&quot;logs&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">log_dir</span><span class="p">):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">log_dir</span><span class="p">)</span>
    <span class="n">current_time</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y%m</span><span class="si">%d</span><span class="s2">_%H%M%S&quot;</span><span class="p">)</span>
    <span class="n">log_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">log_dir</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">logger_name</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">current_time</span><span class="si">}</span><span class="s2">.log&quot;</span><span class="p">)</span>
    <span class="c1"># Check if handlers have already been added to avoid duplication</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">logger</span><span class="o">.</span><span class="n">handlers</span><span class="p">:</span>
        <span class="c1"># Create a file handler to write logs to the specified file</span>
        <span class="n">file_handler</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">FileHandler</span><span class="p">(</span><span class="n">log_file</span><span class="p">)</span>
        <span class="n">file_handler</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">)</span>

        <span class="c1"># Create a console handler to output logs to the console (optional)</span>
        <span class="n">console_handler</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">StreamHandler</span><span class="p">()</span>
        <span class="n">console_handler</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>

        <span class="c1"># set the format of the log</span>
        <span class="n">formatter</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">Formatter</span><span class="p">(</span>
            <span class="s2">&quot;</span><span class="si">%(asctime)s</span><span class="s2"> - </span><span class="si">%(name)s</span><span class="s2"> - </span><span class="si">%(levelname)s</span><span class="s2"> - </span><span class="si">%(message)s</span><span class="s2">&quot;</span>
        <span class="p">)</span>
        <span class="n">file_handler</span><span class="o">.</span><span class="n">setFormatter</span><span class="p">(</span><span class="n">formatter</span><span class="p">)</span>
        <span class="n">console_handler</span><span class="o">.</span><span class="n">setFormatter</span><span class="p">(</span><span class="n">formatter</span><span class="p">)</span>

        <span class="c1"># Add handlers to the logger</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">addHandler</span><span class="p">(</span><span class="n">file_handler</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">addHandler</span><span class="p">(</span><span class="n">console_handler</span><span class="p">)</span>

    <span class="c1"># Bind the logger to the class attribute</span>
    <span class="bp">cls</span><span class="o">.</span><span class="n">logger</span> <span class="o">=</span> <span class="n">logger</span>
    <span class="k">return</span> <span class="bp">cls</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="hydroutils.intersect" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">intersect</span><span class="p">(</span><span class="n">t_lst1</span><span class="p">,</span> <span class="n">t_lst2</span><span class="p">)</span></code>

<a href="#hydroutils.intersect" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Finds indices where two time arrays intersect.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>t_lst1</code>
            </td>
            <td>
                  <code><span title="numpy.array">array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>First time array.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>t_lst2</code>
            </td>
            <td>
                  <code><span title="numpy.array">array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Second time array.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="tuple">tuple</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Tuple of (indices_in_t_lst1, indices_in_t_lst2) where values match.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">t1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;2000-01-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2000-01-02&#39;</span><span class="p">,</span> <span class="s1">&#39;2000-01-03&#39;</span><span class="p">])</span>
<span class="n">t2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;2000-01-02&#39;</span><span class="p">,</span> <span class="s1">&#39;2000-01-03&#39;</span><span class="p">,</span> <span class="s1">&#39;2000-01-04&#39;</span><span class="p">])</span>
<span class="n">idx1</span><span class="p">,</span> <span class="n">idx2</span> <span class="o">=</span> <span class="n">intersect</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">)</span>
<span class="c1"># idx1 = [1, 2] (indices in t1)</span>
<span class="c1"># idx2 = [0, 1] (indices in t2)</span>
</code></pre></div></td></tr></table></div>
</details>

            <details class="quote">
              <summary>Source code in <code>hydroutils/hydro_time.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">intersect</span><span class="p">(</span><span class="n">t_lst1</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">,</span> <span class="n">t_lst2</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Finds indices where two time arrays intersect.</span>

<span class="sd">    Args:</span>
<span class="sd">        t_lst1: First time array.</span>
<span class="sd">        t_lst2: Second time array.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Tuple of (indices_in_t_lst1, indices_in_t_lst2) where values match.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        t1 = np.array([&#39;2000-01-01&#39;, &#39;2000-01-02&#39;, &#39;2000-01-03&#39;])</span>
<span class="sd">        t2 = np.array([&#39;2000-01-02&#39;, &#39;2000-01-03&#39;, &#39;2000-01-04&#39;])</span>
<span class="sd">        idx1, idx2 = intersect(t1, t2)</span>
<span class="sd">        # idx1 = [1, 2] (indices in t1)</span>
<span class="sd">        # idx2 = [0, 1] (indices in t2)</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">C</span><span class="p">,</span> <span class="n">ind1</span><span class="p">,</span> <span class="n">ind2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">intersect1d</span><span class="p">(</span><span class="n">t_lst1</span><span class="p">,</span> <span class="n">t_lst2</span><span class="p">,</span> <span class="n">return_indices</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ind1</span><span class="p">,</span> <span class="n">ind2</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="hydroutils.is_there_file" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_there_file</span><span class="p">(</span><span class="n">zipfile_path</span><span class="p">,</span> <span class="n">unzip_dir</span><span class="p">)</span></code>

<a href="#hydroutils.is_there_file" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Checks if a zip file exists and is properly extracted.</p>
<p>If the zip file exists but hasn't been extracted, extracts it.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>zipfile_path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to the zip file.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>unzip_dir</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Directory where the file should be/has been extracted.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if the file exists (and is extracted), False otherwise.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">if</span> <span class="n">is_there_file</span><span class="p">(</span><span class="s1">&#39;data.zip&#39;</span><span class="p">,</span> <span class="s1">&#39;./extracted&#39;</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;File exists and is extracted&#39;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;File not found&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
</details>

            <details class="quote">
              <summary>Source code in <code>hydroutils/hydro_file.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">is_there_file</span><span class="p">(</span><span class="n">zipfile_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">unzip_dir</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Checks if a zip file exists and is properly extracted.</span>

<span class="sd">    If the zip file exists but hasn&#39;t been extracted, extracts it.</span>

<span class="sd">    Args:</span>
<span class="sd">        zipfile_path: Path to the zip file.</span>
<span class="sd">        unzip_dir: Directory where the file should be/has been extracted.</span>

<span class="sd">    Returns:</span>
<span class="sd">        True if the file exists (and is extracted), False otherwise.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        if is_there_file(&#39;data.zip&#39;, &#39;./extracted&#39;):</span>
<span class="sd">            print(&#39;File exists and is extracted&#39;)</span>
<span class="sd">        else:</span>
<span class="sd">            print(&#39;File not found&#39;)</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">zipfile_path</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">unzip_dir</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="n">unzip_nested_zip</span><span class="p">(</span><span class="n">zipfile_path</span><span class="p">,</span> <span class="n">unzip_dir</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">True</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="hydroutils.mean_peak_timing" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">mean_peak_timing</span><span class="p">(</span><span class="n">obs</span><span class="p">,</span> <span class="n">sim</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">resolution</span><span class="o">=</span><span class="s1">&#39;1D&#39;</span><span class="p">,</span> <span class="n">datetime_coord</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#hydroutils.mean_peak_timing" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Calculates mean difference in peak flow timing between observed and simulated flows.</p>
<p>Uses peak detection to find significant peaks in the observed time series and
compares their timing with corresponding peaks in the simulated series.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>obs</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Observed flow time series.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>sim</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Simulated flow time series.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>window</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Search window size for matching peaks. If None, uses resolution-dependent
defaults (e.g., 3 for daily, 12 for hourly data).</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>resolution</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Time step size ('1D' for daily, '1H' for hourly, etc.).</p>
              </div>
            </td>
            <td>
                  <code>&#39;1D&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>datetime_coord</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of datetime coordinate. Inferred if not specified.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Mean absolute time difference between observed and simulated peaks.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">obs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>  <span class="c1"># Peak at index 2</span>
<span class="n">sim</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>  <span class="c1"># Peak at index 1</span>
<span class="n">diff</span> <span class="o">=</span> <span class="n">mean_peak_timing</span><span class="p">(</span><span class="n">obs</span><span class="p">,</span> <span class="n">sim</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># Returns 1 (time step difference)</span>
</code></pre></div></td></tr></table></div>
</details>

<details class="note" open>
  <summary>Note</summary>
  <p>Based on Kratzert et al. (2020), https://doi.org/10.5194/hess-2020-221
Peaks are filtered by prominence and minimum distance requirements.</p>
</details>

            <details class="quote">
              <summary>Source code in <code>hydroutils/hydro_stat.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">mean_peak_timing</span><span class="p">(</span>
    <span class="n">obs</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">sim</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">window</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">resolution</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;1D&quot;</span><span class="p">,</span>
    <span class="n">datetime_coord</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculates mean difference in peak flow timing between observed and simulated flows.</span>

<span class="sd">    Uses peak detection to find significant peaks in the observed time series and</span>
<span class="sd">    compares their timing with corresponding peaks in the simulated series.</span>

<span class="sd">    Args:</span>
<span class="sd">        obs: Observed flow time series.</span>
<span class="sd">        sim: Simulated flow time series.</span>
<span class="sd">        window: Search window size for matching peaks. If None, uses resolution-dependent</span>
<span class="sd">            defaults (e.g., 3 for daily, 12 for hourly data).</span>
<span class="sd">        resolution: Time step size (&#39;1D&#39; for daily, &#39;1H&#39; for hourly, etc.).</span>
<span class="sd">        datetime_coord: Name of datetime coordinate. Inferred if not specified.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Mean absolute time difference between observed and simulated peaks.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        obs = np.array([1, 2, 5, 2, 1])  # Peak at index 2</span>
<span class="sd">        sim = np.array([1, 4, 2, 1, 1])  # Peak at index 1</span>
<span class="sd">        diff = mean_peak_timing(obs, sim, window=1)  # Returns 1 (time step difference)</span>
<span class="sd">        ```</span>

<span class="sd">    Note:</span>
<span class="sd">        Based on Kratzert et al. (2020), https://doi.org/10.5194/hess-2020-221</span>
<span class="sd">        Peaks are filtered by prominence and minimum distance requirements.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># verify inputs</span>
    <span class="n">_validate_inputs</span><span class="p">(</span><span class="n">obs</span><span class="p">,</span> <span class="n">sim</span><span class="p">)</span>

    <span class="c1"># get time series with only valid observations (scipy&#39;s find_peaks doesn&#39;t guarantee correctness with NaNs)</span>
    <span class="n">obs</span><span class="p">,</span> <span class="n">sim</span> <span class="o">=</span> <span class="n">_mask_valid</span><span class="p">(</span><span class="n">obs</span><span class="p">,</span> <span class="n">sim</span><span class="p">)</span>

    <span class="c1"># heuristic to get indices of peaks and their corresponding height.</span>
    <span class="n">peaks</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">find_peaks</span><span class="p">(</span>
        <span class="n">obs</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">distance</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">prominence</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">obs</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
    <span class="p">)</span>

    <span class="c1"># infer name of datetime index</span>
    <span class="k">if</span> <span class="n">datetime_coord</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">datetime_coord</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">infer_datetime_coord</span><span class="p">(</span><span class="n">obs</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">window</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># infer a reasonable window size</span>
        <span class="n">window</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">utils</span><span class="o">.</span><span class="n">get_frequency_factor</span><span class="p">(</span><span class="s2">&quot;12H&quot;</span><span class="p">,</span> <span class="n">resolution</span><span class="p">)),</span> <span class="mi">3</span><span class="p">)</span>

    <span class="c1"># evaluate timing</span>
    <span class="n">timing_errors</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">peaks</span><span class="p">:</span>
        <span class="c1"># skip peaks at the start and end of the sequence and peaks around missing observations</span>
        <span class="c1"># (NaNs that were removed in obs &amp; sim would result in windows that span too much time).</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="p">(</span><span class="n">idx</span> <span class="o">-</span> <span class="n">window</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
            <span class="ow">or</span> <span class="p">(</span><span class="n">idx</span> <span class="o">+</span> <span class="n">window</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">obs</span><span class="p">))</span>
            <span class="ow">or</span> <span class="p">(</span>
                <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span>
                    <span class="n">obs</span><span class="p">[</span><span class="n">idx</span> <span class="o">-</span> <span class="n">window</span><span class="p">][</span><span class="n">datetime_coord</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
                    <span class="n">obs</span><span class="p">[</span><span class="n">idx</span> <span class="o">+</span> <span class="n">window</span><span class="p">][</span><span class="n">datetime_coord</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
                    <span class="n">freq</span><span class="o">=</span><span class="n">resolution</span><span class="p">,</span>
                <span class="p">)</span><span class="o">.</span><span class="n">size</span>
                <span class="o">!=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">window</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="p">)</span>
        <span class="p">):</span>
            <span class="k">continue</span>

        <span class="c1"># check if the value at idx is a peak (both neighbors must be smaller)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">sim</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">sim</span><span class="p">[</span><span class="n">idx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">sim</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">sim</span><span class="p">[</span><span class="n">idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]):</span>
            <span class="n">peak_sim</span> <span class="o">=</span> <span class="n">sim</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># define peak around idx as the max value inside of the window</span>
            <span class="n">values</span> <span class="o">=</span> <span class="n">sim</span><span class="p">[</span><span class="n">idx</span> <span class="o">-</span> <span class="n">window</span> <span class="p">:</span> <span class="n">idx</span> <span class="o">+</span> <span class="n">window</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
            <span class="n">peak_sim</span> <span class="o">=</span> <span class="n">values</span><span class="p">[</span><span class="n">values</span><span class="o">.</span><span class="n">argmax</span><span class="p">()]</span>

        <span class="c1"># get xarray object of qobs peak, for getting the date and calculating the datetime offset</span>
        <span class="n">peak_obs</span> <span class="o">=</span> <span class="n">obs</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>

        <span class="c1"># calculate the time difference between the peaks</span>
        <span class="n">delta</span> <span class="o">=</span> <span class="n">peak_obs</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="n">datetime_coord</span><span class="p">]</span> <span class="o">-</span> <span class="n">peak_sim</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="n">datetime_coord</span><span class="p">]</span>

        <span class="n">timing_error</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">delta</span><span class="o">.</span><span class="n">values</span> <span class="o">/</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_timedelta</span><span class="p">(</span><span class="n">resolution</span><span class="p">))</span>

        <span class="n">timing_errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">timing_error</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">timing_errors</span><span class="p">)</span> <span class="k">if</span> <span class="n">timing_errors</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="hydroutils.minio_download_file" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">minio_download_file</span><span class="p">(</span><span class="n">client</span><span class="p">,</span> <span class="n">bucket_name</span><span class="p">,</span> <span class="n">object_name</span><span class="p">,</span> <span class="n">file_path</span><span class="p">,</span> <span class="n">version_id</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#hydroutils.minio_download_file" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Downloads a file from MinIO S3-compatible storage.</p>
<p>Downloads an object from S3 and saves it to a local file. Handles UTF-8 encoded text files.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>client</code>
            </td>
            <td>
                  <code><span title="minio.Minio">Minio</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>MinIO client instance.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>bucket_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the bucket containing the object.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>object_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the object to download.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>file_path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Local path where the file should be saved.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>version_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional version ID for versioned objects.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">minio</span><span class="w"> </span><span class="kn">import</span> <span class="n">Minio</span>
<span class="n">client</span> <span class="o">=</span> <span class="n">Minio</span><span class="p">(</span><span class="s1">&#39;play.min.io&#39;</span><span class="p">,</span> <span class="n">access_key</span><span class="o">=</span><span class="s1">&#39;...&#39;</span><span class="p">,</span> <span class="n">secret_key</span><span class="o">=</span><span class="s1">&#39;...&#39;</span><span class="p">)</span>
<span class="n">minio_download_file</span><span class="p">(</span><span class="n">client</span><span class="p">,</span> <span class="s1">&#39;mybucket&#39;</span><span class="p">,</span> <span class="s1">&#39;data.csv&#39;</span><span class="p">,</span> <span class="s1">&#39;./downloaded.csv&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
</details>

            <details class="quote">
              <summary>Source code in <code>hydroutils/hydro_s3.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">minio_download_file</span><span class="p">(</span>
    <span class="n">client</span><span class="p">:</span> <span class="n">Minio</span><span class="p">,</span> <span class="n">bucket_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">object_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">version_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Downloads a file from MinIO S3-compatible storage.</span>

<span class="sd">    Downloads an object from S3 and saves it to a local file. Handles UTF-8 encoded text files.</span>

<span class="sd">    Args:</span>
<span class="sd">        client: MinIO client instance.</span>
<span class="sd">        bucket_name: Name of the bucket containing the object.</span>
<span class="sd">        object_name: Name of the object to download.</span>
<span class="sd">        file_path: Local path where the file should be saved.</span>
<span class="sd">        version_id: Optional version ID for versioned objects.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        from minio import Minio</span>
<span class="sd">        client = Minio(&#39;play.min.io&#39;, access_key=&#39;...&#39;, secret_key=&#39;...&#39;)</span>
<span class="sd">        minio_download_file(client, &#39;mybucket&#39;, &#39;data.csv&#39;, &#39;./downloaded.csv&#39;)</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">get_object</span><span class="p">(</span><span class="n">bucket_name</span><span class="p">,</span> <span class="n">object_name</span><span class="p">,</span> <span class="n">version_id</span><span class="p">)</span>
        <span class="n">res_csv</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf8&quot;</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s2">&quot;w+&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
            <span class="n">fp</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">res_csv</span><span class="p">)</span>
    <span class="k">finally</span><span class="p">:</span>
        <span class="n">response</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">response</span><span class="o">.</span><span class="n">release_conn</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="hydroutils.minio_upload_file" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">minio_upload_file</span><span class="p">(</span><span class="n">client</span><span class="p">,</span> <span class="n">bucket_name</span><span class="p">,</span> <span class="n">object_name</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span></code>

<a href="#hydroutils.minio_upload_file" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Uploads a file to MinIO S3-compatible storage.</p>
<p>Creates the bucket if it doesn't exist, uploads the file, and returns a list of
all objects in the bucket.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>client</code>
            </td>
            <td>
                  <code><span title="minio.Minio">Minio</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>MinIO client instance.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>bucket_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the bucket to upload to.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>object_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name to give the object in S3.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>file_path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Local path of the file to upload.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of object names in the bucket after upload.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">minio</span><span class="w"> </span><span class="kn">import</span> <span class="n">Minio</span>
<span class="n">client</span> <span class="o">=</span> <span class="n">Minio</span><span class="p">(</span><span class="s1">&#39;play.min.io&#39;</span><span class="p">,</span> <span class="n">access_key</span><span class="o">=</span><span class="s1">&#39;...&#39;</span><span class="p">,</span> <span class="n">secret_key</span><span class="o">=</span><span class="s1">&#39;...&#39;</span><span class="p">)</span>
<span class="n">objects</span> <span class="o">=</span> <span class="n">minio_upload_file</span><span class="p">(</span><span class="n">client</span><span class="p">,</span> <span class="s1">&#39;mybucket&#39;</span><span class="p">,</span> <span class="s1">&#39;data.csv&#39;</span><span class="p">,</span> <span class="s1">&#39;./data.csv&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Bucket contents: </span><span class="si">{</span><span class="n">objects</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
</details>

            <details class="quote">
              <summary>Source code in <code>hydroutils/hydro_s3.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">minio_upload_file</span><span class="p">(</span><span class="n">client</span><span class="p">:</span> <span class="n">Minio</span><span class="p">,</span> <span class="n">bucket_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">object_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Uploads a file to MinIO S3-compatible storage.</span>

<span class="sd">    Creates the bucket if it doesn&#39;t exist, uploads the file, and returns a list of</span>
<span class="sd">    all objects in the bucket.</span>

<span class="sd">    Args:</span>
<span class="sd">        client: MinIO client instance.</span>
<span class="sd">        bucket_name: Name of the bucket to upload to.</span>
<span class="sd">        object_name: Name to give the object in S3.</span>
<span class="sd">        file_path: Local path of the file to upload.</span>

<span class="sd">    Returns:</span>
<span class="sd">        List of object names in the bucket after upload.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        from minio import Minio</span>
<span class="sd">        client = Minio(&#39;play.min.io&#39;, access_key=&#39;...&#39;, secret_key=&#39;...&#39;)</span>
<span class="sd">        objects = minio_upload_file(client, &#39;mybucket&#39;, &#39;data.csv&#39;, &#39;./data.csv&#39;)</span>
<span class="sd">        print(f&quot;Bucket contents: {objects}&quot;)</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Make a bucket</span>
    <span class="n">bucket_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">bucket</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">bucket</span> <span class="ow">in</span> <span class="n">client</span><span class="o">.</span><span class="n">list_buckets</span><span class="p">()]</span>
    <span class="k">if</span> <span class="n">bucket_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">bucket_names</span><span class="p">:</span>
        <span class="n">client</span><span class="o">.</span><span class="n">make_bucket</span><span class="p">(</span><span class="n">bucket_name</span><span class="p">)</span>
    <span class="c1"># Upload an object</span>
    <span class="n">client</span><span class="o">.</span><span class="n">fput_object</span><span class="p">(</span><span class="n">bucket_name</span><span class="p">,</span> <span class="n">object_name</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span>
    <span class="c1"># List objects</span>
    <span class="n">objects</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">list_objects</span><span class="p">(</span><span class="n">bucket_name</span><span class="p">,</span> <span class="n">recursive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">obj</span><span class="o">.</span><span class="n">object_name</span> <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">objects</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="hydroutils.month_stat_for_daily_df" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">month_stat_for_daily_df</span><span class="p">(</span><span class="n">df</span><span class="p">)</span></code>

<a href="#hydroutils.month_stat_for_daily_df" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Calculates monthly statistics from daily data.</p>
<p>Resamples daily data to monthly frequency using mean values.
Automatically converts index to datetime if needed.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>df</code>
            </td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DataFrame with daily data and datetime index.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DataFrame with monthly statistics (means).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span>
<span class="normal">9</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1"># Daily flow data</span>
<span class="n">daily</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;flow&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span>  <span class="c1"># 365 values</span>
    <span class="s1">&#39;temp&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span>
<span class="p">},</span> <span class="n">index</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s1">&#39;2023-01-01&#39;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">365</span><span class="p">))</span>

<span class="c1"># Convert to monthly means</span>
<span class="n">monthly</span> <span class="o">=</span> <span class="n">month_stat_for_daily_df</span><span class="p">(</span><span class="n">daily</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of months: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">monthly</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># 12</span>
</code></pre></div></td></tr></table></div>
</details>

<details class="note" open>
  <summary>Note</summary>
  <p>Uses pandas resample with 'MS' (month start) frequency
and mean aggregation.</p>
</details>

            <details class="quote">
              <summary>Source code in <code>hydroutils/hydro_stat.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">907</span>
<span class="normal">908</span>
<span class="normal">909</span>
<span class="normal">910</span>
<span class="normal">911</span>
<span class="normal">912</span>
<span class="normal">913</span>
<span class="normal">914</span>
<span class="normal">915</span>
<span class="normal">916</span>
<span class="normal">917</span>
<span class="normal">918</span>
<span class="normal">919</span>
<span class="normal">920</span>
<span class="normal">921</span>
<span class="normal">922</span>
<span class="normal">923</span>
<span class="normal">924</span>
<span class="normal">925</span>
<span class="normal">926</span>
<span class="normal">927</span>
<span class="normal">928</span>
<span class="normal">929</span>
<span class="normal">930</span>
<span class="normal">931</span>
<span class="normal">932</span>
<span class="normal">933</span>
<span class="normal">934</span>
<span class="normal">935</span>
<span class="normal">936</span>
<span class="normal">937</span>
<span class="normal">938</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">month_stat_for_daily_df</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculates monthly statistics from daily data.</span>

<span class="sd">    Resamples daily data to monthly frequency using mean values.</span>
<span class="sd">    Automatically converts index to datetime if needed.</span>

<span class="sd">    Args:</span>
<span class="sd">        df: DataFrame with daily data and datetime index.</span>

<span class="sd">    Returns:</span>
<span class="sd">        DataFrame with monthly statistics (means).</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        # Daily flow data</span>
<span class="sd">        daily = pd.DataFrame({</span>
<span class="sd">            &#39;flow&#39;: [1, 2, 3, 4, ...],  # 365 values</span>
<span class="sd">            &#39;temp&#39;: [20, 21, 19, 22, ...]</span>
<span class="sd">        }, index=pd.date_range(&#39;2023-01-01&#39;, periods=365))</span>

<span class="sd">        # Convert to monthly means</span>
<span class="sd">        monthly = month_stat_for_daily_df(daily)</span>
<span class="sd">        print(f&quot;Number of months: {len(monthly)}&quot;)  # 12</span>
<span class="sd">        ```</span>

<span class="sd">    Note:</span>
<span class="sd">        Uses pandas resample with &#39;MS&#39; (month start) frequency</span>
<span class="sd">        and mean aggregation.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># guarantee the index is datetime</span>
    <span class="n">df</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s2">&quot;MS&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="hydroutils.plot_boxes_matplotlib" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">plot_boxes_matplotlib</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">label1</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">label2</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">leg_col</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">colorlst</span><span class="o">=</span><span class="s1">&#39;rbgcmywrbgcmyw&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">xticklabel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">axin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ylim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">notch</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">widths</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">subplots_adjust_wspace</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">show_median</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">median_line_color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">median_font_size</span><span class="o">=</span><span class="s1">&#39;small&#39;</span><span class="p">)</span></code>

<a href="#hydroutils.plot_boxes_matplotlib" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Creates multiple boxplots for comparing multiple indicators or groups.</p>
<p>This function generates a sophisticated boxplot visualization with multiple customization
options, including median display, notched boxes, and flexible layout options. It's
particularly useful for comparing distributions across different groups or indicators.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>data</code>
            </td>
            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of arrays, where each array contains the data for one indicator
or group to be displayed as a boxplot.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>label1</code>
            </td>
            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Labels for each subplot. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>label2</code>
            </td>
            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Legend labels for boxes within each subplot. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>leg_col</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of columns in the legend. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>colorlst</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>String of color characters for box colors. Defaults to
"rbgcmywrbgcmyw".</p>
              </div>
            </td>
            <td>
                  <code>&#39;rbgcmywrbgcmyw&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>title</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Title of the plot. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>figsize</code>
            </td>
            <td>
                  <code><span title="tuple">tuple</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Figure size as (width, height). Defaults to (8, 6).</p>
              </div>
            </td>
            <td>
                  <code>(8, 6)</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>sharey</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, all subplots share the same y-axis scale.
Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>xticklabel</code>
            </td>
            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Custom x-axis tick labels. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>axin</code>
            </td>
            <td>
                  <code><span title="matplotlib.axes.Axes">Axes</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Existing axes to plot on. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ylim</code>
            </td>
            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Y-axis limits as [min, max]. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ylabel</code>
            </td>
            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Y-axis labels for each subplot. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>notch</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, creates notched boxes. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>widths</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Width of the boxes. Defaults to 0.5.</p>
              </div>
            </td>
            <td>
                  <code>0.5</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>subplots_adjust_wspace</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Width space between subplots.
Defaults to 0.2.</p>
              </div>
            </td>
            <td>
                  <code>0.2</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>show_median</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, displays median values. Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>median_line_color</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Color of median lines. Defaults to "black".</p>
              </div>
            </td>
            <td>
                  <code>&#39;black&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>median_font_size</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Font size for median values. Defaults to "small".</p>
              </div>
            </td>
            <td>
                  <code>&#39;small&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Union[matplotlib.figure.Figure, Tuple[matplotlib.axes.Axes, dict]]:
If axin is None, returns the Figure object.
If axin is provided, returns a tuple of (Axes, boxplot_dict).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span> <span class="o">=</span> <span class="n">plot_boxes_matplotlib</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">data</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">label1</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Group A&#39;</span><span class="p">,</span> <span class="s1">&#39;Group B&#39;</span><span class="p">,</span> <span class="s1">&#39;Group C&#39;</span><span class="p">],</span>
<span class="gp">... </span>    <span class="n">show_median</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">notch</span><span class="o">=</span><span class="kc">True</span>
<span class="gp">... </span><span class="p">)</span>
</code></pre></div></td></tr></table></div>


<details class="notes" open>
  <summary>Notes</summary>
  <ul>
<li>The function automatically handles NaN values in the data.</li>
<li>Median values can be displayed with customizable formatting.</li>
<li>Supports both single and multiple subplot layouts.</li>
</ul>
</details>

            <details class="quote">
              <summary>Source code in <code>hydroutils/hydro_plot.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_boxes_matplotlib</span><span class="p">(</span>
    <span class="n">data</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span>
    <span class="n">label1</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">label2</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">leg_col</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">colorlst</span><span class="o">=</span><span class="s2">&quot;rbgcmywrbgcmyw&quot;</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span>
    <span class="n">sharey</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">xticklabel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">axin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">ylim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">ylabel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">notch</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">widths</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
    <span class="n">subplots_adjust_wspace</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
    <span class="n">show_median</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">median_line_color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span>
    <span class="n">median_font_size</span><span class="o">=</span><span class="s2">&quot;small&quot;</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates multiple boxplots for comparing multiple indicators or groups.</span>

<span class="sd">    This function generates a sophisticated boxplot visualization with multiple customization</span>
<span class="sd">    options, including median display, notched boxes, and flexible layout options. It&#39;s</span>
<span class="sd">    particularly useful for comparing distributions across different groups or indicators.</span>

<span class="sd">    Args:</span>
<span class="sd">        data (list): List of arrays, where each array contains the data for one indicator</span>
<span class="sd">            or group to be displayed as a boxplot.</span>
<span class="sd">        label1 (list, optional): Labels for each subplot. Defaults to None.</span>
<span class="sd">        label2 (list, optional): Legend labels for boxes within each subplot. Defaults to None.</span>
<span class="sd">        leg_col (int, optional): Number of columns in the legend. Defaults to None.</span>
<span class="sd">        colorlst (str, optional): String of color characters for box colors. Defaults to</span>
<span class="sd">            &quot;rbgcmywrbgcmyw&quot;.</span>
<span class="sd">        title (str, optional): Title of the plot. Defaults to None.</span>
<span class="sd">        figsize (tuple, optional): Figure size as (width, height). Defaults to (8, 6).</span>
<span class="sd">        sharey (bool, optional): If True, all subplots share the same y-axis scale.</span>
<span class="sd">            Defaults to False.</span>
<span class="sd">        xticklabel (list, optional): Custom x-axis tick labels. Defaults to None.</span>
<span class="sd">        axin (matplotlib.axes.Axes, optional): Existing axes to plot on. Defaults to None.</span>
<span class="sd">        ylim (list, optional): Y-axis limits as [min, max]. Defaults to None.</span>
<span class="sd">        ylabel (list, optional): Y-axis labels for each subplot. Defaults to None.</span>
<span class="sd">        notch (bool, optional): If True, creates notched boxes. Defaults to False.</span>
<span class="sd">        widths (float, optional): Width of the boxes. Defaults to 0.5.</span>
<span class="sd">        subplots_adjust_wspace (float, optional): Width space between subplots.</span>
<span class="sd">            Defaults to 0.2.</span>
<span class="sd">        show_median (bool, optional): If True, displays median values. Defaults to True.</span>
<span class="sd">        median_line_color (str, optional): Color of median lines. Defaults to &quot;black&quot;.</span>
<span class="sd">        median_font_size (str, optional): Font size for median values. Defaults to &quot;small&quot;.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Union[matplotlib.figure.Figure, Tuple[matplotlib.axes.Axes, dict]]:</span>
<span class="sd">            If axin is None, returns the Figure object.</span>
<span class="sd">            If axin is provided, returns a tuple of (Axes, boxplot_dict).</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; data = [np.random.normal(0, 1, 100) for _ in range(3)]</span>
<span class="sd">        &gt;&gt;&gt; fig = plot_boxes_matplotlib(</span>
<span class="sd">        ...     data,</span>
<span class="sd">        ...     label1=[&#39;Group A&#39;, &#39;Group B&#39;, &#39;Group C&#39;],</span>
<span class="sd">        ...     show_median=True,</span>
<span class="sd">        ...     notch=True</span>
<span class="sd">        ... )</span>

<span class="sd">    Notes:</span>
<span class="sd">        - The function automatically handles NaN values in the data.</span>
<span class="sd">        - Median values can be displayed with customizable formatting.</span>
<span class="sd">        - Supports both single and multiple subplot layouts.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">nc</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">axin</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span>
            <span class="n">ncols</span><span class="o">=</span><span class="n">nc</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="n">sharey</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">,</span> <span class="n">constrained_layout</span><span class="o">=</span><span class="kc">False</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">axes</span> <span class="o">=</span> <span class="n">axin</span>

    <span class="c1"># the next few lines are for showing median values</span>
    <span class="n">decimal_places</span> <span class="o">=</span> <span class="s2">&quot;2&quot;</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nc</span><span class="p">):</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="k">if</span> <span class="n">nc</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">axes</span>
        <span class="n">temp</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">kk</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">temp</span><span class="p">)):</span>
                <span class="n">tt</span> <span class="o">=</span> <span class="n">temp</span><span class="p">[</span><span class="n">kk</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">tt</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">tt</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">tt</span> <span class="o">=</span> <span class="n">tt</span><span class="p">[</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">tt</span><span class="p">)]</span>
                    <span class="n">temp</span><span class="p">[</span><span class="n">kk</span><span class="p">]</span> <span class="o">=</span> <span class="n">tt</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">temp</span><span class="p">[</span><span class="n">kk</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">temp</span> <span class="o">=</span> <span class="n">temp</span><span class="p">[</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">temp</span><span class="p">)]</span>
        <span class="n">bp</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span>
            <span class="n">temp</span><span class="p">,</span> <span class="n">patch_artist</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">notch</span><span class="o">=</span><span class="n">notch</span><span class="p">,</span> <span class="n">showfliers</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">widths</span><span class="o">=</span><span class="n">widths</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">median</span> <span class="ow">in</span> <span class="n">bp</span><span class="p">[</span><span class="s2">&quot;medians&quot;</span><span class="p">]:</span>
            <span class="n">median</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="n">median_line_color</span><span class="p">)</span>
        <span class="n">medians_value</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span> <span class="k">for</span> <span class="n">tmp</span> <span class="ow">in</span> <span class="n">temp</span><span class="p">]</span>
        <span class="n">percent25value</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">tmp</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span> <span class="k">for</span> <span class="n">tmp</span> <span class="ow">in</span> <span class="n">temp</span><span class="p">]</span>
        <span class="n">percent75value</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">tmp</span><span class="p">,</span> <span class="mi">75</span><span class="p">)</span> <span class="k">for</span> <span class="n">tmp</span> <span class="ow">in</span> <span class="n">temp</span><span class="p">]</span>
        <span class="n">per25min</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">percent25value</span><span class="p">)</span>
        <span class="n">per75max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">percent75value</span><span class="p">)</span>
        <span class="n">median_labels</span> <span class="o">=</span> <span class="p">[</span><span class="nb">format</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;.</span><span class="si">{</span><span class="n">decimal_places</span><span class="si">}</span><span class="s2">f&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">medians_value</span><span class="p">]</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">medians_value</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">show_median</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">tick</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">()):</span>
                <span class="c1"># params of ax.text could be seen here: https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.text.html</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
                    <span class="n">pos</span><span class="p">[</span><span class="n">tick</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
                    <span class="n">medians_value</span><span class="p">[</span><span class="n">tick</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">per75max</span> <span class="o">-</span> <span class="n">per25min</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.01</span><span class="p">,</span>
                    <span class="n">median_labels</span><span class="p">[</span><span class="n">tick</span><span class="p">],</span>
                    <span class="n">horizontalalignment</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
                    <span class="c1"># https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.text.html</span>
                    <span class="n">size</span><span class="o">=</span><span class="n">median_font_size</span><span class="p">,</span>
                    <span class="n">weight</span><span class="o">=</span><span class="s2">&quot;semibold&quot;</span><span class="p">,</span>
                    <span class="n">color</span><span class="o">=</span><span class="n">median_line_color</span><span class="p">,</span>
                <span class="p">)</span>
        <span class="k">for</span> <span class="n">kk</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">bp</span><span class="p">[</span><span class="s2">&quot;boxes&quot;</span><span class="p">])):</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">bp</span><span class="p">[</span><span class="s2">&quot;boxes&quot;</span><span class="p">][</span><span class="n">kk</span><span class="p">],</span> <span class="n">facecolor</span><span class="o">=</span><span class="n">colorlst</span><span class="p">[</span><span class="n">kk</span><span class="p">])</span>

        <span class="k">if</span> <span class="n">label1</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">label1</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">xticklabel</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([</span><span class="n">y</span> <span class="o">+</span> <span class="mi">1</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">k</span><span class="p">]),</span> <span class="mi">2</span><span class="p">)])</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">xticklabel</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ylabel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">ylim</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ylim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">label2</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span>
            <span class="n">bp</span><span class="p">[</span><span class="s2">&quot;boxes&quot;</span><span class="p">],</span>
            <span class="n">label2</span><span class="p">,</span>
            <span class="c1"># explanation for bbox_to_anchor: https://zhuanlan.zhihu.com/p/101059179</span>
            <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.02</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">),</span>
            <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper right&quot;</span><span class="p">,</span>
            <span class="n">borderaxespad</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
            <span class="n">ncol</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">label2</span><span class="p">)</span> <span class="k">if</span> <span class="n">leg_col</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">leg_col</span><span class="p">,</span>
            <span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">if</span> <span class="n">title</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># fig.suptitle(title)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">wspace</span><span class="o">=</span><span class="n">subplots_adjust_wspace</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">fig</span> <span class="k">if</span> <span class="n">axin</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">bp</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="hydroutils.plot_boxs" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">plot_boxs</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">x_name</span><span class="p">,</span> <span class="n">y_name</span><span class="p">,</span> <span class="n">uniform_color</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">swarm_plot</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">colormap</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ylim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="s1">&#39;serif&#39;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span> <span class="n">show_median</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#hydroutils.plot_boxs" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>plot multiple boxes in one ax with seaborn
Parameters</p>
<hr />
<p>data : pd.DataFrame
    a tidy pandas dataframe;
    if you don't know what is "tidy data", please read: https://github.com/jizhang/pandas-tidy-data
x_name : str
    the names of each box
y_name : str
    what is shown
uniform_color : str, optional
    unified color for all boxes, by default None
swarm_plot : bool, optional
    <em>description</em>, by default False
hue : <em>type</em>, optional
    <em>description</em>, by default None
colormap : bool, optional
    <em>description</em>, by default False
xlim : <em>type</em>, optional
    <em>description</em>, by default None
ylim : <em>type</em>, optional
    <em>description</em>, by default None
order : <em>type</em>, optional
    <em>description</em>, by default None
font : str, optional
    <em>description</em>, by default "serif"
rotation : int, optional
    rotation for labels in x-axis, by default 45
show_median: bool, optional
    if True, show median value for each box, by default False
Returns</p>
<hr />
<p><em>type</em>
    <em>description</em></p>


            <details class="quote">
              <summary>Source code in <code>hydroutils/hydro_plot.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_boxs</span><span class="p">(</span>
    <span class="n">data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">x_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">y_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">uniform_color</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">swarm_plot</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">hue</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">colormap</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">xlim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">ylim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">order</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">font</span><span class="o">=</span><span class="s2">&quot;serif&quot;</span><span class="p">,</span>
    <span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span>
    <span class="n">show_median</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;plot multiple boxes in one ax with seaborn</span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : pd.DataFrame</span>
<span class="sd">        a tidy pandas dataframe;</span>
<span class="sd">        if you don&#39;t know what is &quot;tidy data&quot;, please read: https://github.com/jizhang/pandas-tidy-data</span>
<span class="sd">    x_name : str</span>
<span class="sd">        the names of each box</span>
<span class="sd">    y_name : str</span>
<span class="sd">        what is shown</span>
<span class="sd">    uniform_color : str, optional</span>
<span class="sd">        unified color for all boxes, by default None</span>
<span class="sd">    swarm_plot : bool, optional</span>
<span class="sd">        _description_, by default False</span>
<span class="sd">    hue : _type_, optional</span>
<span class="sd">        _description_, by default None</span>
<span class="sd">    colormap : bool, optional</span>
<span class="sd">        _description_, by default False</span>
<span class="sd">    xlim : _type_, optional</span>
<span class="sd">        _description_, by default None</span>
<span class="sd">    ylim : _type_, optional</span>
<span class="sd">        _description_, by default None</span>
<span class="sd">    order : _type_, optional</span>
<span class="sd">        _description_, by default None</span>
<span class="sd">    font : str, optional</span>
<span class="sd">        _description_, by default &quot;serif&quot;</span>
<span class="sd">    rotation : int, optional</span>
<span class="sd">        rotation for labels in x-axis, by default 45</span>
<span class="sd">    show_median: bool, optional</span>
<span class="sd">        if True, show median value for each box, by default False</span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    _type_</span>
<span class="sd">        _description_</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s2">&quot;ticks&quot;</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s2">&quot;pastel&quot;</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="n">font</span><span class="p">,</span> <span class="n">font_scale</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
    <span class="c1"># Draw a nested boxplot to show bills by day and time</span>
    <span class="k">if</span> <span class="n">uniform_color</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">sns_box</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span>
            <span class="n">x</span><span class="o">=</span><span class="n">x_name</span><span class="p">,</span>
            <span class="n">y</span><span class="o">=</span><span class="n">y_name</span><span class="p">,</span>
            <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="n">uniform_color</span><span class="p">,</span>
            <span class="n">showfliers</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">order</span><span class="o">=</span><span class="n">order</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">sns_box</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span>
            <span class="n">x</span><span class="o">=</span><span class="n">x_name</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y_name</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">showfliers</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="n">order</span>
        <span class="p">)</span>
    <span class="k">if</span> <span class="n">swarm_plot</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">hue</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">sns_box</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">swarmplot</span><span class="p">(</span>
                <span class="n">x</span><span class="o">=</span><span class="n">x_name</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y_name</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;.2&quot;</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="n">order</span>
            <span class="p">)</span>
        <span class="k">elif</span> <span class="n">colormap</span><span class="p">:</span>
            <span class="c1"># Create a matplotlib colormap from the sns seagreen color palette</span>
            <span class="n">cmap</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">light_palette</span><span class="p">(</span><span class="s2">&quot;seagreen&quot;</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">as_cmap</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="c1"># Normalize to the range of possible values from df[&quot;c&quot;]</span>
            <span class="n">norm</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span>
                <span class="n">vmin</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="n">hue</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">vmax</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="n">hue</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
            <span class="p">)</span>
            <span class="n">colors</span> <span class="o">=</span> <span class="p">{</span><span class="n">cval</span><span class="p">:</span> <span class="n">cmap</span><span class="p">(</span><span class="n">norm</span><span class="p">(</span><span class="n">cval</span><span class="p">))</span> <span class="k">for</span> <span class="n">cval</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="n">hue</span><span class="p">]}</span>
            <span class="c1"># plot the swarmplot with the colors dictionary as palette, s=2 means size is 2</span>
            <span class="n">sns_box</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">swarmplot</span><span class="p">(</span>
                <span class="n">x</span><span class="o">=</span><span class="n">x_name</span><span class="p">,</span>
                <span class="n">y</span><span class="o">=</span><span class="n">y_name</span><span class="p">,</span>
                <span class="n">hue</span><span class="o">=</span><span class="n">hue</span><span class="p">,</span>
                <span class="n">s</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
                <span class="n">palette</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span>
                <span class="n">order</span><span class="o">=</span><span class="n">order</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="c1"># remove the legend, because we want to set a colorbar instead</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">legend_</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
            <span class="c1"># create colorbar</span>
            <span class="n">divider</span> <span class="o">=</span> <span class="n">make_axes_locatable</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">())</span>
            <span class="n">ax_cb</span> <span class="o">=</span> <span class="n">divider</span><span class="o">.</span><span class="n">new_horizontal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="s2">&quot;5%&quot;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
            <span class="n">fig</span> <span class="o">=</span> <span class="n">sns_box</span><span class="o">.</span><span class="n">get_figure</span><span class="p">()</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">(</span><span class="n">ax_cb</span><span class="p">)</span>
            <span class="n">cb1</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">colorbar</span><span class="o">.</span><span class="n">ColorbarBase</span><span class="p">(</span>
                <span class="n">ax_cb</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s2">&quot;vertical&quot;</span>
            <span class="p">)</span>
            <span class="n">cb1</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s2">&quot;Some Units&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">palette</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">light_palette</span><span class="p">(</span><span class="s2">&quot;seagreen&quot;</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">n_colors</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
            <span class="n">sns_box</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">swarmplot</span><span class="p">(</span>
                <span class="n">x</span><span class="o">=</span><span class="n">x_name</span><span class="p">,</span>
                <span class="n">y</span><span class="o">=</span><span class="n">y_name</span><span class="p">,</span>
                <span class="n">hue</span><span class="o">=</span><span class="n">hue</span><span class="p">,</span>
                <span class="n">s</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
                <span class="n">palette</span><span class="o">=</span><span class="n">palette</span><span class="p">,</span>
                <span class="n">order</span><span class="o">=</span><span class="n">order</span><span class="p">,</span>
            <span class="p">)</span>
    <span class="k">if</span> <span class="n">xlim</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">xlim</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">ylim</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="n">ylim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ylim</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">show_median</span><span class="p">:</span>
        <span class="n">medians</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="n">x_name</span><span class="p">],</span> <span class="n">sort</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="n">y_name</span><span class="p">]</span><span class="o">.</span><span class="n">median</span><span class="p">()</span><span class="o">.</span><span class="n">values</span>
        <span class="n">create_median_labels</span><span class="p">(</span><span class="n">sns_box</span><span class="p">,</span> <span class="n">medians_value</span><span class="o">=</span><span class="n">medians</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="s2">&quot;x-small&quot;</span><span class="p">)</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>
    <span class="n">locs</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="n">rotation</span><span class="p">)</span>
    <span class="c1"># plt.show()</span>
    <span class="k">return</span> <span class="n">sns_box</span><span class="o">.</span><span class="n">get_figure</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="hydroutils.plot_diff_boxes" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">plot_diff_boxes</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">row_and_col</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">y_col</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">x_col</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">title_str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">title_font_size</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span></code>

<a href="#hydroutils.plot_diff_boxes" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>plot boxplots in rows and cols</p>


            <details class="quote">
              <summary>Source code in <code>hydroutils/hydro_plot.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_diff_boxes</span><span class="p">(</span>
    <span class="n">data</span><span class="p">,</span>
    <span class="n">row_and_col</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">y_col</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">x_col</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">hspace</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>
    <span class="n">wspace</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">title_str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">title_font_size</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;plot boxplots in rows and cols&quot;&quot;&quot;</span>
    <span class="c1"># matplotlib.use(&#39;TkAgg&#39;)</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="n">subplot_num</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="n">y_col</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_col</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">row_and_col</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">row_num</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">col_num</span> <span class="o">=</span> <span class="n">subplot_num</span>
        <span class="n">f</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">row_num</span><span class="p">,</span> <span class="n">col_num</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">hspace</span><span class="o">=</span><span class="n">hspace</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="n">wspace</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">assert</span> <span class="n">subplot_num</span> <span class="o">&lt;=</span> <span class="n">row_and_col</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">row_and_col</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">row_num</span> <span class="o">=</span> <span class="n">row_and_col</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">col_num</span> <span class="o">=</span> <span class="n">row_and_col</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">f</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">row_num</span><span class="p">,</span> <span class="n">col_num</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">subplot_num</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">y_col</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">row_num</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">col_num</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span>
                    <span class="n">y</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                    <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
                    <span class="n">width</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
                    <span class="n">orient</span><span class="o">=</span><span class="s2">&quot;v&quot;</span><span class="p">,</span>
                    <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                    <span class="n">showfliers</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="p">)</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">row_idx</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">i</span> <span class="o">/</span> <span class="n">col_num</span><span class="p">)</span>
                <span class="n">col_idx</span> <span class="o">=</span> <span class="n">i</span> <span class="o">%</span> <span class="n">col_num</span>
                <span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span>
                    <span class="n">y</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                    <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
                    <span class="n">orient</span><span class="o">=</span><span class="s2">&quot;v&quot;</span><span class="p">,</span>
                    <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="n">row_idx</span><span class="p">,</span> <span class="n">col_idx</span><span class="p">],</span>
                    <span class="n">showfliers</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">assert</span> <span class="n">x_col</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
            <span class="k">if</span> <span class="n">row_num</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">col_num</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span>
                    <span class="n">x</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">x_col</span><span class="p">],</span>
                    <span class="n">y</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">y_col</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span>
                    <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
                    <span class="n">orient</span><span class="o">=</span><span class="s2">&quot;v&quot;</span><span class="p">,</span>
                    <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                    <span class="n">showfliers</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">row_idx</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">i</span> <span class="o">/</span> <span class="n">col_num</span><span class="p">)</span>
                <span class="n">col_idx</span> <span class="o">=</span> <span class="n">i</span> <span class="o">%</span> <span class="n">col_num</span>
                <span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span>
                    <span class="n">x</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">x_col</span><span class="p">],</span>
                    <span class="n">y</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">y_col</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span>
                    <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
                    <span class="n">orient</span><span class="o">=</span><span class="s2">&quot;v&quot;</span><span class="p">,</span>
                    <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="n">row_idx</span><span class="p">,</span> <span class="n">col_idx</span><span class="p">],</span>
                    <span class="n">showfliers</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="p">)</span>
    <span class="k">if</span> <span class="n">title_str</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">f</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">title_str</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">title_font_size</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">f</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="hydroutils.plot_ecdf" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">plot_ecdf</span><span class="p">(</span><span class="n">mydataframe</span><span class="p">,</span> <span class="n">mycolumn</span><span class="p">,</span> <span class="n">save_file</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#hydroutils.plot_ecdf" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Creates an empirical cumulative distribution function (ECDF) plot for a single column.</p>
<p>This function generates an ECDF plot for a single column of data from a pandas
DataFrame. It provides a simple interface for quick visualization of data
distributions.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>mydataframe</code>
            </td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DataFrame containing the data to plot.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>mycolumn</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the column to create ECDF for.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>save_file</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to save the plot. If None, plot is only
displayed. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;values&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plot_ecdf</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s1">&#39;values&#39;</span><span class="p">,</span> <span class="s1">&#39;normal_dist_ecdf.png&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>


<details class="notes" open>
  <summary>Notes</summary>
  <ul>
<li>Uses seaborn's styling for better visualization</li>
<li>Automatically handles NaN values</li>
<li>Plot range is set to [0, 1] for both axes</li>
<li>Uses 0.05 intervals for axis ticks</li>
</ul>
</details>

            <details class="quote">
              <summary>Source code in <code>hydroutils/hydro_plot.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1122</span>
<span class="normal">1123</span>
<span class="normal">1124</span>
<span class="normal">1125</span>
<span class="normal">1126</span>
<span class="normal">1127</span>
<span class="normal">1128</span>
<span class="normal">1129</span>
<span class="normal">1130</span>
<span class="normal">1131</span>
<span class="normal">1132</span>
<span class="normal">1133</span>
<span class="normal">1134</span>
<span class="normal">1135</span>
<span class="normal">1136</span>
<span class="normal">1137</span>
<span class="normal">1138</span>
<span class="normal">1139</span>
<span class="normal">1140</span>
<span class="normal">1141</span>
<span class="normal">1142</span>
<span class="normal">1143</span>
<span class="normal">1144</span>
<span class="normal">1145</span>
<span class="normal">1146</span>
<span class="normal">1147</span>
<span class="normal">1148</span>
<span class="normal">1149</span>
<span class="normal">1150</span>
<span class="normal">1151</span>
<span class="normal">1152</span>
<span class="normal">1153</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_ecdf</span><span class="p">(</span><span class="n">mydataframe</span><span class="p">,</span> <span class="n">mycolumn</span><span class="p">,</span> <span class="n">save_file</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates an empirical cumulative distribution function (ECDF) plot for a single column.</span>

<span class="sd">    This function generates an ECDF plot for a single column of data from a pandas</span>
<span class="sd">    DataFrame. It provides a simple interface for quick visualization of data</span>
<span class="sd">    distributions.</span>

<span class="sd">    Args:</span>
<span class="sd">        mydataframe (pd.DataFrame): DataFrame containing the data to plot.</span>
<span class="sd">        mycolumn (str): Name of the column to create ECDF for.</span>
<span class="sd">        save_file (str, optional): Path to save the plot. If None, plot is only</span>
<span class="sd">            displayed. Defaults to None.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; df = pd.DataFrame({&#39;values&#39;: np.random.normal(0, 1, 1000)})</span>
<span class="sd">        &gt;&gt;&gt; plot_ecdf(df, &#39;values&#39;, &#39;normal_dist_ecdf.png&#39;)</span>

<span class="sd">    Notes:</span>
<span class="sd">        - Uses seaborn&#39;s styling for better visualization</span>
<span class="sd">        - Automatically handles NaN values</span>
<span class="sd">        - Plot range is set to [0, 1] for both axes</span>
<span class="sd">        - Uses 0.05 intervals for axis ticks</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">ecdf</span><span class="p">(</span><span class="n">mydataframe</span><span class="p">[</span><span class="n">mycolumn</span><span class="p">])</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="n">x</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="n">y</span><span class="p">})</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s2">&quot;ticks&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;axes.grid&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">estimator</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span><span class="o">.</span><span class="n">set</span><span class="p">(</span>
        <span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">xticks</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">),</span> <span class="n">yticks</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">save_file</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">save_file</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="hydroutils.plot_ecdfs" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">plot_ecdfs</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">ys</span><span class="p">,</span> <span class="n">legends</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">case_str</span><span class="o">=</span><span class="s1">&#39;case&#39;</span><span class="p">,</span> <span class="n">event_str</span><span class="o">=</span><span class="s1">&#39;event&#39;</span><span class="p">,</span> <span class="n">x_str</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">y_str</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">ax_as_subplot</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span></code>

<a href="#hydroutils.plot_ecdfs" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Creates empirical cumulative distribution function (ECDF) plots for multiple datasets.</p>
<p>This function generates ECDF plots for multiple datasets with customizable styling
and labeling options. It's particularly useful for comparing distributions of
different datasets or experimental conditions.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>xs</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="numpy.array">array</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of x-values arrays for each ECDF.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ys</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="numpy.array">array</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of y-values arrays for each ECDF.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>legends</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Legend labels for each ECDF. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>style</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Line styles for each ECDF. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>case_str</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Label for different cases in the plot.
Defaults to "case".</p>
              </div>
            </td>
            <td>
                  <code>&#39;case&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>event_str</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Label for different events in the plot.
Defaults to "event".</p>
              </div>
            </td>
            <td>
                  <code>&#39;event&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>x_str</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>X-axis label. Defaults to "x".</p>
              </div>
            </td>
            <td>
                  <code>&#39;x&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>y_str</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Y-axis label. Defaults to "y".</p>
              </div>
            </td>
            <td>
                  <code>&#39;y&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ax_as_subplot</code>
            </td>
            <td>
                  <code><span title="matplotlib.axes.Axes">Axes</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Existing axes to plot on.
Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>interval</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Interval for axis ticks. Defaults to 0.1.</p>
              </div>
            </td>
            <td>
                  <code>0.1</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>matplotlib.axes.Axes: The axes object containing the ECDF plots.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Compare two distributions</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">,</span> <span class="mi">1000</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">x1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">x2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span> <span class="o">=</span> <span class="n">plot_ecdfs</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">[</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">],</span> <span class="p">[</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">],</span>
<span class="gp">... </span>    <span class="n">legends</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Distribution 1&#39;</span><span class="p">,</span> <span class="s1">&#39;Distribution 2&#39;</span><span class="p">],</span>
<span class="gp">... </span>    <span class="n">x_str</span><span class="o">=</span><span class="s1">&#39;Value&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">y_str</span><span class="o">=</span><span class="s1">&#39;Cumulative Probability&#39;</span>
<span class="gp">... </span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Multiple distributions with different styles</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span> <span class="o">=</span> <span class="n">plot_ecdfs</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">[</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">],</span> <span class="p">[</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">],</span>
<span class="gp">... </span>    <span class="n">legends</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Group A&#39;</span><span class="p">,</span> <span class="s1">&#39;Group B&#39;</span><span class="p">],</span>
<span class="gp">... </span>    <span class="n">style</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">],</span>
<span class="gp">... </span>    <span class="n">interval</span><span class="o">=</span><span class="mf">0.2</span>
<span class="gp">... </span><span class="p">)</span>
</code></pre></div></td></tr></table></div>


<details class="notes" open>
  <summary>Notes</summary>
  <ul>
<li>Input arrays must be sorted in ascending order</li>
<li>Function automatically validates data ordering</li>
<li>Supports both single and multiple subplot layouts</li>
<li>Uses seaborn for enhanced visual styling</li>
</ul>
</details>

            <details class="quote">
              <summary>Source code in <code>hydroutils/hydro_plot.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 984</span>
<span class="normal"> 985</span>
<span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span>
<span class="normal">1109</span>
<span class="normal">1110</span>
<span class="normal">1111</span>
<span class="normal">1112</span>
<span class="normal">1113</span>
<span class="normal">1114</span>
<span class="normal">1115</span>
<span class="normal">1116</span>
<span class="normal">1117</span>
<span class="normal">1118</span>
<span class="normal">1119</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_ecdfs</span><span class="p">(</span>
    <span class="n">xs</span><span class="p">,</span>
    <span class="n">ys</span><span class="p">,</span>
    <span class="n">legends</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">style</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">case_str</span><span class="o">=</span><span class="s2">&quot;case&quot;</span><span class="p">,</span>
    <span class="n">event_str</span><span class="o">=</span><span class="s2">&quot;event&quot;</span><span class="p">,</span>
    <span class="n">x_str</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span>
    <span class="n">y_str</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span>
    <span class="n">ax_as_subplot</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">interval</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates empirical cumulative distribution function (ECDF) plots for multiple datasets.</span>

<span class="sd">    This function generates ECDF plots for multiple datasets with customizable styling</span>
<span class="sd">    and labeling options. It&#39;s particularly useful for comparing distributions of</span>
<span class="sd">    different datasets or experimental conditions.</span>

<span class="sd">    Args:</span>
<span class="sd">        xs (list[np.array]): List of x-values arrays for each ECDF.</span>
<span class="sd">        ys (list[np.array]): List of y-values arrays for each ECDF.</span>
<span class="sd">        legends (list[str], optional): Legend labels for each ECDF. Defaults to None.</span>
<span class="sd">        style (list[str], optional): Line styles for each ECDF. Defaults to None.</span>
<span class="sd">        case_str (str, optional): Label for different cases in the plot.</span>
<span class="sd">            Defaults to &quot;case&quot;.</span>
<span class="sd">        event_str (str, optional): Label for different events in the plot.</span>
<span class="sd">            Defaults to &quot;event&quot;.</span>
<span class="sd">        x_str (str, optional): X-axis label. Defaults to &quot;x&quot;.</span>
<span class="sd">        y_str (str, optional): Y-axis label. Defaults to &quot;y&quot;.</span>
<span class="sd">        ax_as_subplot (matplotlib.axes.Axes, optional): Existing axes to plot on.</span>
<span class="sd">            Defaults to None.</span>
<span class="sd">        interval (float, optional): Interval for axis ticks. Defaults to 0.1.</span>

<span class="sd">    Returns:</span>
<span class="sd">        matplotlib.axes.Axes: The axes object containing the ECDF plots.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; # Compare two distributions</span>
<span class="sd">        &gt;&gt;&gt; x1 = np.sort(np.random.normal(0, 1, 1000))</span>
<span class="sd">        &gt;&gt;&gt; x2 = np.sort(np.random.normal(0.5, 1.2, 1000))</span>
<span class="sd">        &gt;&gt;&gt; y1 = np.linspace(0, 1, len(x1))</span>
<span class="sd">        &gt;&gt;&gt; y2 = np.linspace(0, 1, len(x2))</span>
<span class="sd">        &gt;&gt;&gt; ax = plot_ecdfs(</span>
<span class="sd">        ...     [x1, x2], [y1, y2],</span>
<span class="sd">        ...     legends=[&#39;Distribution 1&#39;, &#39;Distribution 2&#39;],</span>
<span class="sd">        ...     x_str=&#39;Value&#39;,</span>
<span class="sd">        ...     y_str=&#39;Cumulative Probability&#39;</span>
<span class="sd">        ... )</span>

<span class="sd">        &gt;&gt;&gt; # Multiple distributions with different styles</span>
<span class="sd">        &gt;&gt;&gt; ax = plot_ecdfs(</span>
<span class="sd">        ...     [x1, x2], [y1, y2],</span>
<span class="sd">        ...     legends=[&#39;Group A&#39;, &#39;Group B&#39;],</span>
<span class="sd">        ...     style=[&#39;-&#39;, &#39;--&#39;],</span>
<span class="sd">        ...     interval=0.2</span>
<span class="sd">        ... )</span>

<span class="sd">    Notes:</span>
<span class="sd">        - Input arrays must be sorted in ascending order</span>
<span class="sd">        - Function automatically validates data ordering</span>
<span class="sd">        - Supports both single and multiple subplot layouts</span>
<span class="sd">        - Uses seaborn for enhanced visual styling</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ys</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">xs</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">ys</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">legends</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">legends</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">ys</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">legends</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">style</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">style</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">ys</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">style</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">ys</span><span class="p">:</span>
        <span class="k">assert</span> <span class="nb">all</span><span class="p">(</span><span class="n">xi</span> <span class="o">&lt;</span> <span class="n">yi</span> <span class="k">for</span> <span class="n">xi</span><span class="p">,</span> <span class="n">yi</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">:]))</span>
    <span class="n">frames</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">xs</span><span class="p">)):</span>
        <span class="n">str_i</span> <span class="o">=</span> <span class="n">x_str</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">if</span> <span class="n">legends</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">legends</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">assert</span> <span class="nb">all</span><span class="p">(</span><span class="n">xi</span> <span class="o">&lt;</span> <span class="n">yi</span> <span class="k">for</span> <span class="n">xi</span><span class="p">,</span> <span class="n">yi</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">xs</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">xs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">:]))</span>
        <span class="n">df_dict_i</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">x_str</span><span class="p">:</span> <span class="n">xs</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
            <span class="n">y_str</span><span class="p">:</span> <span class="n">ys</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
            <span class="n">case_str</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">([</span><span class="n">xs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">size</span><span class="p">],</span> <span class="n">str_i</span><span class="p">),</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="n">style</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">df_dict_i</span><span class="p">[</span><span class="n">event_str</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">([</span><span class="n">xs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">size</span><span class="p">],</span> <span class="n">style</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="n">df_i</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">df_dict_i</span><span class="p">)</span>
        <span class="n">frames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df_i</span><span class="p">)</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">frames</span><span class="p">)</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s2">&quot;ticks&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;axes.grid&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
    <span class="k">if</span> <span class="n">style</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x_str</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y_str</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="n">case_str</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">estimator</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span><span class="o">.</span><span class="n">set</span><span class="p">(</span>
                <span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                <span class="n">xticks</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">interval</span><span class="p">),</span>
                <span class="n">yticks</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">interval</span><span class="p">),</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">ax_as_subplot</span> <span class="ow">is</span> <span class="kc">None</span>
            <span class="k">else</span> <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span>
                <span class="n">ax</span><span class="o">=</span><span class="n">ax_as_subplot</span><span class="p">,</span>
                <span class="n">x</span><span class="o">=</span><span class="n">x_str</span><span class="p">,</span>
                <span class="n">y</span><span class="o">=</span><span class="n">y_str</span><span class="p">,</span>
                <span class="n">hue</span><span class="o">=</span><span class="n">case_str</span><span class="p">,</span>
                <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span>
                <span class="n">estimator</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="p">)</span><span class="o">.</span><span class="n">set</span><span class="p">(</span>
                <span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                <span class="n">xticks</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">interval</span><span class="p">),</span>
                <span class="n">yticks</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">interval</span><span class="p">),</span>
            <span class="p">)</span>
        <span class="p">)</span>
    <span class="k">elif</span> <span class="n">ax_as_subplot</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span>
            <span class="n">x</span><span class="o">=</span><span class="n">x_str</span><span class="p">,</span>
            <span class="n">y</span><span class="o">=</span><span class="n">y_str</span><span class="p">,</span>
            <span class="n">hue</span><span class="o">=</span><span class="n">case_str</span><span class="p">,</span>
            <span class="n">style</span><span class="o">=</span><span class="n">event_str</span><span class="p">,</span>
            <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span>
            <span class="n">estimator</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="p">)</span><span class="o">.</span><span class="n">set</span><span class="p">(</span>
            <span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="n">xticks</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">interval</span><span class="p">),</span>
            <span class="n">yticks</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">interval</span><span class="p">),</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span>
            <span class="n">ax</span><span class="o">=</span><span class="n">ax_as_subplot</span><span class="p">,</span>
            <span class="n">x</span><span class="o">=</span><span class="n">x_str</span><span class="p">,</span>
            <span class="n">y</span><span class="o">=</span><span class="n">y_str</span><span class="p">,</span>
            <span class="n">hue</span><span class="o">=</span><span class="n">case_str</span><span class="p">,</span>
            <span class="n">style</span><span class="o">=</span><span class="n">event_str</span><span class="p">,</span>
            <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span>
            <span class="n">estimator</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="p">)</span><span class="o">.</span><span class="n">set</span><span class="p">(</span>
            <span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="n">xticks</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">interval</span><span class="p">),</span>
            <span class="n">yticks</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">interval</span><span class="p">),</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="hydroutils.plot_ecdfs_matplot" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">plot_ecdfs_matplot</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">ys</span><span class="p">,</span> <span class="n">legends</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;rbkgcmy&#39;</span><span class="p">,</span> <span class="n">dash_lines</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">x_str</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">y_str</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">x_interval</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">y_interval</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">x_lim</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">y_lim</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">show_legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">legend_font_size</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">fig_size</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span></code>

<a href="#hydroutils.plot_ecdfs_matplot" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Creates ECDF plots using matplotlib with extensive customization options.</p>
<p>This function provides a more customizable alternative to the seaborn-based ECDF
plotting functions, offering direct control over matplotlib parameters and styling.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>xs</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="numpy.array">array</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of x-values arrays for each ECDF.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ys</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="numpy.array">array</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of y-values arrays for each ECDF.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>legends</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Legend labels for each ECDF. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>colors</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>String of color characters for different lines.
Defaults to "rbkgcmy".</p>
              </div>
            </td>
            <td>
                  <code>&#39;rbkgcmy&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dash_lines</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="bool">bool</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Specifies which lines should be dashed.
Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>x_str</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>X-axis label. Defaults to "x".</p>
              </div>
            </td>
            <td>
                  <code>&#39;x&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>y_str</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Y-axis label. Defaults to "y".</p>
              </div>
            </td>
            <td>
                  <code>&#39;y&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>x_interval</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Interval for x-axis ticks. Defaults to 0.1.</p>
              </div>
            </td>
            <td>
                  <code>0.1</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>y_interval</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Interval for y-axis ticks. Defaults to 0.1.</p>
              </div>
            </td>
            <td>
                  <code>0.1</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>x_lim</code>
            </td>
            <td>
                  <code><span title="tuple">tuple</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>X-axis limits as (min, max). Defaults to (0, 1).</p>
              </div>
            </td>
            <td>
                  <code>(0, 1)</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>y_lim</code>
            </td>
            <td>
                  <code><span title="tuple">tuple</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Y-axis limits as (min, max). Defaults to (0, 1).</p>
              </div>
            </td>
            <td>
                  <code>(0, 1)</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>show_legend</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to show legend. Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>legend_font_size</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Font size for legend. Defaults to 16.</p>
              </div>
            </td>
            <td>
                  <code>16</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>fig_size</code>
            </td>
            <td>
                  <code><span title="tuple">tuple</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Figure size as (width, height). Defaults to (8, 6).</p>
              </div>
            </td>
            <td>
                  <code>(8, 6)</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Tuple[matplotlib.figure.Figure, matplotlib.axes.Axes]: The figure and axes
objects containing the ECDF plots.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Compare multiple distributions</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">,</span> <span class="mi">1000</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plot_ecdfs_matplot</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">[</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">],</span> <span class="p">[</span><span class="n">y</span><span class="p">,</span> <span class="n">y</span><span class="p">],</span>
<span class="gp">... </span>    <span class="n">legends</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Normal(0,1)&#39;</span><span class="p">,</span> <span class="s1">&#39;Normal(0.5,1.2)&#39;</span><span class="p">],</span>
<span class="gp">... </span>    <span class="n">x_str</span><span class="o">=</span><span class="s1">&#39;Value&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">y_str</span><span class="o">=</span><span class="s1">&#39;Probability&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">x_lim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">... </span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Custom styling</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plot_ecdfs_matplot</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">[</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">],</span> <span class="p">[</span><span class="n">y</span><span class="p">,</span> <span class="n">y</span><span class="p">],</span>
<span class="gp">... </span>    <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;rb&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">dash_lines</span><span class="o">=</span><span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">],</span>
<span class="gp">... </span>    <span class="n">legend_font_size</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">fig_size</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="gp">... </span><span class="p">)</span>
</code></pre></div></td></tr></table></div>


<details class="notes" open>
  <summary>Notes</summary>
  <ul>
<li>Uses clean plotting style with minimal spines</li>
<li>Supports both continuous and dashed lines</li>
<li>Provides fine-grained control over axis properties</li>
<li>Input arrays must be sorted in ascending order</li>
<li>Automatically validates data ordering</li>
</ul>
</details>

            <details class="quote">
              <summary>Source code in <code>hydroutils/hydro_plot.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1156</span>
<span class="normal">1157</span>
<span class="normal">1158</span>
<span class="normal">1159</span>
<span class="normal">1160</span>
<span class="normal">1161</span>
<span class="normal">1162</span>
<span class="normal">1163</span>
<span class="normal">1164</span>
<span class="normal">1165</span>
<span class="normal">1166</span>
<span class="normal">1167</span>
<span class="normal">1168</span>
<span class="normal">1169</span>
<span class="normal">1170</span>
<span class="normal">1171</span>
<span class="normal">1172</span>
<span class="normal">1173</span>
<span class="normal">1174</span>
<span class="normal">1175</span>
<span class="normal">1176</span>
<span class="normal">1177</span>
<span class="normal">1178</span>
<span class="normal">1179</span>
<span class="normal">1180</span>
<span class="normal">1181</span>
<span class="normal">1182</span>
<span class="normal">1183</span>
<span class="normal">1184</span>
<span class="normal">1185</span>
<span class="normal">1186</span>
<span class="normal">1187</span>
<span class="normal">1188</span>
<span class="normal">1189</span>
<span class="normal">1190</span>
<span class="normal">1191</span>
<span class="normal">1192</span>
<span class="normal">1193</span>
<span class="normal">1194</span>
<span class="normal">1195</span>
<span class="normal">1196</span>
<span class="normal">1197</span>
<span class="normal">1198</span>
<span class="normal">1199</span>
<span class="normal">1200</span>
<span class="normal">1201</span>
<span class="normal">1202</span>
<span class="normal">1203</span>
<span class="normal">1204</span>
<span class="normal">1205</span>
<span class="normal">1206</span>
<span class="normal">1207</span>
<span class="normal">1208</span>
<span class="normal">1209</span>
<span class="normal">1210</span>
<span class="normal">1211</span>
<span class="normal">1212</span>
<span class="normal">1213</span>
<span class="normal">1214</span>
<span class="normal">1215</span>
<span class="normal">1216</span>
<span class="normal">1217</span>
<span class="normal">1218</span>
<span class="normal">1219</span>
<span class="normal">1220</span>
<span class="normal">1221</span>
<span class="normal">1222</span>
<span class="normal">1223</span>
<span class="normal">1224</span>
<span class="normal">1225</span>
<span class="normal">1226</span>
<span class="normal">1227</span>
<span class="normal">1228</span>
<span class="normal">1229</span>
<span class="normal">1230</span>
<span class="normal">1231</span>
<span class="normal">1232</span>
<span class="normal">1233</span>
<span class="normal">1234</span>
<span class="normal">1235</span>
<span class="normal">1236</span>
<span class="normal">1237</span>
<span class="normal">1238</span>
<span class="normal">1239</span>
<span class="normal">1240</span>
<span class="normal">1241</span>
<span class="normal">1242</span>
<span class="normal">1243</span>
<span class="normal">1244</span>
<span class="normal">1245</span>
<span class="normal">1246</span>
<span class="normal">1247</span>
<span class="normal">1248</span>
<span class="normal">1249</span>
<span class="normal">1250</span>
<span class="normal">1251</span>
<span class="normal">1252</span>
<span class="normal">1253</span>
<span class="normal">1254</span>
<span class="normal">1255</span>
<span class="normal">1256</span>
<span class="normal">1257</span>
<span class="normal">1258</span>
<span class="normal">1259</span>
<span class="normal">1260</span>
<span class="normal">1261</span>
<span class="normal">1262</span>
<span class="normal">1263</span>
<span class="normal">1264</span>
<span class="normal">1265</span>
<span class="normal">1266</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_ecdfs_matplot</span><span class="p">(</span>
    <span class="n">xs</span><span class="p">,</span>
    <span class="n">ys</span><span class="p">,</span>
    <span class="n">legends</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">colors</span><span class="o">=</span><span class="s2">&quot;rbkgcmy&quot;</span><span class="p">,</span>
    <span class="n">dash_lines</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">x_str</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span>
    <span class="n">y_str</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span>
    <span class="n">x_interval</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
    <span class="n">y_interval</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
    <span class="n">x_lim</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
    <span class="n">y_lim</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
    <span class="n">show_legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">legend_font_size</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span>
    <span class="n">fig_size</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates ECDF plots using matplotlib with extensive customization options.</span>

<span class="sd">    This function provides a more customizable alternative to the seaborn-based ECDF</span>
<span class="sd">    plotting functions, offering direct control over matplotlib parameters and styling.</span>

<span class="sd">    Args:</span>
<span class="sd">        xs (list[np.array]): List of x-values arrays for each ECDF.</span>
<span class="sd">        ys (list[np.array]): List of y-values arrays for each ECDF.</span>
<span class="sd">        legends (list[str], optional): Legend labels for each ECDF. Defaults to None.</span>
<span class="sd">        colors (str, optional): String of color characters for different lines.</span>
<span class="sd">            Defaults to &quot;rbkgcmy&quot;.</span>
<span class="sd">        dash_lines (list[bool], optional): Specifies which lines should be dashed.</span>
<span class="sd">            Defaults to None.</span>
<span class="sd">        x_str (str, optional): X-axis label. Defaults to &quot;x&quot;.</span>
<span class="sd">        y_str (str, optional): Y-axis label. Defaults to &quot;y&quot;.</span>
<span class="sd">        x_interval (float, optional): Interval for x-axis ticks. Defaults to 0.1.</span>
<span class="sd">        y_interval (float, optional): Interval for y-axis ticks. Defaults to 0.1.</span>
<span class="sd">        x_lim (tuple, optional): X-axis limits as (min, max). Defaults to (0, 1).</span>
<span class="sd">        y_lim (tuple, optional): Y-axis limits as (min, max). Defaults to (0, 1).</span>
<span class="sd">        show_legend (bool, optional): Whether to show legend. Defaults to True.</span>
<span class="sd">        legend_font_size (int, optional): Font size for legend. Defaults to 16.</span>
<span class="sd">        fig_size (tuple, optional): Figure size as (width, height). Defaults to (8, 6).</span>

<span class="sd">    Returns:</span>
<span class="sd">        Tuple[matplotlib.figure.Figure, matplotlib.axes.Axes]: The figure and axes</span>
<span class="sd">            objects containing the ECDF plots.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; # Compare multiple distributions</span>
<span class="sd">        &gt;&gt;&gt; x1 = np.sort(np.random.normal(0, 1, 1000))</span>
<span class="sd">        &gt;&gt;&gt; x2 = np.sort(np.random.normal(0.5, 1.2, 1000))</span>
<span class="sd">        &gt;&gt;&gt; y = np.linspace(0, 1, 1000)</span>
<span class="sd">        &gt;&gt;&gt; fig, ax = plot_ecdfs_matplot(</span>
<span class="sd">        ...     [x1, x2], [y, y],</span>
<span class="sd">        ...     legends=[&#39;Normal(0,1)&#39;, &#39;Normal(0.5,1.2)&#39;],</span>
<span class="sd">        ...     x_str=&#39;Value&#39;,</span>
<span class="sd">        ...     y_str=&#39;Probability&#39;,</span>
<span class="sd">        ...     x_lim=(-3, 3)</span>
<span class="sd">        ... )</span>

<span class="sd">        &gt;&gt;&gt; # Custom styling</span>
<span class="sd">        &gt;&gt;&gt; fig, ax = plot_ecdfs_matplot(</span>
<span class="sd">        ...     [x1, x2], [y, y],</span>
<span class="sd">        ...     colors=&#39;rb&#39;,</span>
<span class="sd">        ...     dash_lines=[False, True],</span>
<span class="sd">        ...     legend_font_size=12,</span>
<span class="sd">        ...     fig_size=(10, 8)</span>
<span class="sd">        ... )</span>

<span class="sd">    Notes:</span>
<span class="sd">        - Uses clean plotting style with minimal spines</span>
<span class="sd">        - Supports both continuous and dashed lines</span>
<span class="sd">        - Provides fine-grained control over axis properties</span>
<span class="sd">        - Input arrays must be sorted in ascending order</span>
<span class="sd">        - Automatically validates data ordering</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ys</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">xs</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">ys</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">legends</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">legends</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">ys</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">legends</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">dash_lines</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dash_lines</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">dash_lines</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">xs</span><span class="p">),</span> <span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">ys</span><span class="p">:</span>
        <span class="k">assert</span> <span class="nb">all</span><span class="p">(</span><span class="n">xi</span> <span class="o">&lt;</span> <span class="n">yi</span> <span class="k">for</span> <span class="n">xi</span><span class="p">,</span> <span class="n">yi</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">:]))</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">fig_size</span><span class="p">)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">xs</span><span class="p">)):</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">xs</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span>
            <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">xs</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span> <span class="o">==</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span>
        <span class="p">):</span>
            <span class="k">assert</span> <span class="nb">all</span><span class="p">(</span><span class="n">xi</span> <span class="o">&lt;=</span> <span class="n">yi</span> <span class="k">for</span> <span class="n">xi</span><span class="p">,</span> <span class="n">yi</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">xs</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">xs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">:]))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">all</span><span class="p">(</span><span class="n">xi</span> <span class="o">&lt;=</span> <span class="n">yi</span> <span class="k">for</span> <span class="n">xi</span><span class="p">,</span> <span class="n">yi</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">xs</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">xs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">:]))</span>
        <span class="p">(</span><span class="n">line_i</span><span class="p">,)</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xs</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">ys</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="n">legends</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">dash_lines</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
            <span class="n">line_i</span><span class="o">.</span><span class="n">set_dashes</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">x_str</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="n">y_str</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">x_lim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x_lim</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">y_lim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">y_lim</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="c1"># set x y number font size</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">x_lim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x_lim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">x_lim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="mi">100</span><span class="p">,</span> <span class="n">x_interval</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">y_lim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">y_lim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">y_lim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="mi">100</span><span class="p">,</span> <span class="n">y_interval</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">show_legend</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;size&quot;</span><span class="p">:</span> <span class="n">legend_font_size</span><span class="p">})</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="c1"># Hide the right and top spines</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="hydroutils.plot_heat_map" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">plot_heat_map</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fig_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="n">square</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">xticklabels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">yticklabels</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#hydroutils.plot_heat_map" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Creates a heatmap visualization of 2D data using seaborn.</p>
<p>This function creates a heatmap visualization with customizable formatting,
annotations, and masking options. It uses seaborn's heatmap function with
additional customization options.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>data</code>
            </td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>2D array or DataFrame to be visualized.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>mask</code>
            </td>
            <td>
                  <code><span title="numpy.array">array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Boolean array of same shape as data. True values will
be masked (not shown). Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>fig_size</code>
            </td>
            <td>
                  <code><span title="tuple">tuple</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Figure size as (width, height). Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>fmt</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>String formatting code for cell annotations. Defaults to "d"
for integer formatting.</p>
              </div>
            </td>
            <td>
                  <code>&#39;d&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>square</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, set the Axes aspect to "equal". Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>annot</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, write the data value in each cell. Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>xticklabels</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, show x-axis labels. Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>yticklabels</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, show y-axis labels. Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>matplotlib.axes.Axes: The matplotlib Axes object containing the heatmap.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plot_heat_map</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">data</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;.2f&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">fig_size</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">annot</span><span class="o">=</span><span class="kc">True</span>
<span class="gp">... </span><span class="p">)</span>
</code></pre></div></td></tr></table></div>


<details class="notes" open>
  <summary>Notes</summary>
  <p>The function uses a red-blue diverging colormap ('RdBu_r') by default.
For more details on the underlying implementation, see:
https://zhuanlan.zhihu.com/p/96040773</p>
</details>

            <details class="quote">
              <summary>Source code in <code>hydroutils/hydro_plot.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_heat_map</span><span class="p">(</span>
    <span class="n">data</span><span class="p">,</span>
    <span class="n">mask</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">fig_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">fmt</span><span class="o">=</span><span class="s2">&quot;d&quot;</span><span class="p">,</span>
    <span class="n">square</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">xticklabels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">yticklabels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates a heatmap visualization of 2D data using seaborn.</span>

<span class="sd">    This function creates a heatmap visualization with customizable formatting,</span>
<span class="sd">    annotations, and masking options. It uses seaborn&#39;s heatmap function with</span>
<span class="sd">    additional customization options.</span>

<span class="sd">    Args:</span>
<span class="sd">        data (pd.DataFrame): 2D array or DataFrame to be visualized.</span>
<span class="sd">        mask (np.array, optional): Boolean array of same shape as data. True values will</span>
<span class="sd">            be masked (not shown). Defaults to None.</span>
<span class="sd">        fig_size (tuple, optional): Figure size as (width, height). Defaults to None.</span>
<span class="sd">        fmt (str, optional): String formatting code for cell annotations. Defaults to &quot;d&quot;</span>
<span class="sd">            for integer formatting.</span>
<span class="sd">        square (bool, optional): If True, set the Axes aspect to &quot;equal&quot;. Defaults to True.</span>
<span class="sd">        annot (bool, optional): If True, write the data value in each cell. Defaults to True.</span>
<span class="sd">        xticklabels (bool, optional): If True, show x-axis labels. Defaults to True.</span>
<span class="sd">        yticklabels (bool, optional): If True, show y-axis labels. Defaults to True.</span>

<span class="sd">    Returns:</span>
<span class="sd">        matplotlib.axes.Axes: The matplotlib Axes object containing the heatmap.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; data = pd.DataFrame(np.random.rand(5, 5))</span>
<span class="sd">        &gt;&gt;&gt; plot_heat_map(</span>
<span class="sd">        ...     data,</span>
<span class="sd">        ...     fmt=&#39;.2f&#39;,</span>
<span class="sd">        ...     fig_size=(8, 6),</span>
<span class="sd">        ...     annot=True</span>
<span class="sd">        ... )</span>

<span class="sd">    Notes:</span>
<span class="sd">        The function uses a red-blue diverging colormap (&#39;RdBu_r&#39;) by default.</span>
<span class="sd">        For more details on the underlying implementation, see:</span>
<span class="sd">        https://zhuanlan.zhihu.com/p/96040773</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">fig_size</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">fig_size</span><span class="p">)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span>
        <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
        <span class="n">square</span><span class="o">=</span><span class="n">square</span><span class="p">,</span>
        <span class="n">annot</span><span class="o">=</span><span class="n">annot</span><span class="p">,</span>
        <span class="n">fmt</span><span class="o">=</span><span class="n">fmt</span><span class="p">,</span>
        <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;RdBu_r&quot;</span><span class="p">,</span>
        <span class="n">mask</span><span class="o">=</span><span class="n">mask</span><span class="p">,</span>
        <span class="n">xticklabels</span><span class="o">=</span><span class="n">xticklabels</span><span class="p">,</span>
        <span class="n">yticklabels</span><span class="o">=</span><span class="n">yticklabels</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="hydroutils.plot_map_carto" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">plot_map_carto</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span> <span class="n">fig</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">pertile_range</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">value_range</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fig_size</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="n">need_colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">colorbar_size</span><span class="o">=</span><span class="p">[</span><span class="mf">0.91</span><span class="p">,</span> <span class="mf">0.318</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">,</span> <span class="mf">0.354</span><span class="p">],</span> <span class="n">cmap_str</span><span class="o">=</span><span class="s1">&#39;jet&#39;</span><span class="p">,</span> <span class="n">idx_lst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">markers</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">marker_size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">is_discrete</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;rbkgcmywrbkgcmyw&#39;</span><span class="p">,</span> <span class="n">category_names</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">legend_font_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">colorbar_font_size</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#hydroutils.plot_map_carto" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Creates a cartographic map visualization using Cartopy with extensive customization options.</p>
<p>This function generates a map visualization for spatial data with support for continuous
and discrete color scales, multiple marker types, and various styling options. It's
particularly useful for visualizing hydrological data in a geographic context.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>data</code>
            </td>
            <td>
                  <code><span title="numpy.array">array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>1-D array of values to be plotted on the map.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>lat</code>
            </td>
            <td>
                  <code><span title="numpy.array">array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>1-D array of latitude values for each data point.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>lon</code>
            </td>
            <td>
                  <code><span title="numpy.array">array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>1-D array of longitude values for each data point.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>fig</code>
            </td>
            <td>
                  <code><span title="matplotlib.figure.Figure">Figure</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Existing figure to plot on.
Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ax</code>
            </td>
            <td>
                  <code><span title="matplotlib.axes.Axes">Axes</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Existing axes to plot on. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>pertile_range</code>
            </td>
            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Percentile range for color scaling, e.g.,
[25, 75] for interquartile range. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>value_range</code>
            </td>
            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Explicit value range for color scaling. Takes
precedence over pertile_range. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>fig_size</code>
            </td>
            <td>
                  <code><span title="tuple">tuple</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Figure size as (width, height). Defaults to (8, 8).</p>
              </div>
            </td>
            <td>
                  <code>(8, 8)</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>need_colorbar</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to add a colorbar. Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>colorbar_size</code>
            </td>
            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Colorbar dimensions [left, bottom, width, height].
Defaults to [0.91, 0.318, 0.02, 0.354].</p>
              </div>
            </td>
            <td>
                  <code>[0.91, 0.318, 0.02, 0.354]</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>cmap_str</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Colormap name. Defaults to "jet".</p>
              </div>
            </td>
            <td>
                  <code>&#39;jet&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>idx_lst</code>
            </td>
            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of index arrays for plotting multiple point
categories. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>markers</code>
            </td>
            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Marker styles for each category. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>marker_size</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="int">int</span>, <span title="list">list</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Size(s) of markers. Defaults to 20.</p>
              </div>
            </td>
            <td>
                  <code>20</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>is_discrete</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, uses discrete colors with legend instead
of continuous colorbar. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>colors</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Color characters for discrete categories.
Defaults to "rbkgcmywrbkgcmyw".</p>
              </div>
            </td>
            <td>
                  <code>&#39;rbkgcmywrbkgcmyw&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>category_names</code>
            </td>
            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Names for discrete categories in legend.
Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>legend_font_size</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Font size for legend. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>colorbar_font_size</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Font size for colorbar. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>matplotlib.axes.Axes: The axes object containing the map.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span>
<span class="normal">9</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Simple continuous color map</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lon</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mi">120</span><span class="p">,</span> <span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span> <span class="o">=</span> <span class="n">plot_map_carto</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">data</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">value_range</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="gp">... </span>    <span class="n">cmap_str</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span>
<span class="gp">... </span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Discrete categories with custom markers</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">categories</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">idx_lst</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">categories</span> <span class="o">==</span> <span class="n">i</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span> <span class="o">=</span> <span class="n">plot_map_carto</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">data</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">idx_lst</span><span class="o">=</span><span class="n">idx_lst</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">markers</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="s1">&#39;^&#39;</span><span class="p">],</span>
<span class="gp">... </span>    <span class="n">is_discrete</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">category_names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Low&#39;</span><span class="p">,</span> <span class="s1">&#39;Medium&#39;</span><span class="p">,</span> <span class="s1">&#39;High&#39;</span><span class="p">]</span>
<span class="gp">... </span><span class="p">)</span>
</code></pre></div></td></tr></table></div>


<details class="notes" open>
  <summary>Notes</summary>
  <ul>
<li>Uses Cartopy for map projections and features</li>
<li>Automatically adds state boundaries and coastlines</li>
<li>Supports both continuous and categorical data visualization</li>
<li>Handles NaN values appropriately</li>
<li>Provides flexible control over color scaling</li>
</ul>
</details>

            <details class="quote">
              <summary>Source code in <code>hydroutils/hydro_plot.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1379</span>
<span class="normal">1380</span>
<span class="normal">1381</span>
<span class="normal">1382</span>
<span class="normal">1383</span>
<span class="normal">1384</span>
<span class="normal">1385</span>
<span class="normal">1386</span>
<span class="normal">1387</span>
<span class="normal">1388</span>
<span class="normal">1389</span>
<span class="normal">1390</span>
<span class="normal">1391</span>
<span class="normal">1392</span>
<span class="normal">1393</span>
<span class="normal">1394</span>
<span class="normal">1395</span>
<span class="normal">1396</span>
<span class="normal">1397</span>
<span class="normal">1398</span>
<span class="normal">1399</span>
<span class="normal">1400</span>
<span class="normal">1401</span>
<span class="normal">1402</span>
<span class="normal">1403</span>
<span class="normal">1404</span>
<span class="normal">1405</span>
<span class="normal">1406</span>
<span class="normal">1407</span>
<span class="normal">1408</span>
<span class="normal">1409</span>
<span class="normal">1410</span>
<span class="normal">1411</span>
<span class="normal">1412</span>
<span class="normal">1413</span>
<span class="normal">1414</span>
<span class="normal">1415</span>
<span class="normal">1416</span>
<span class="normal">1417</span>
<span class="normal">1418</span>
<span class="normal">1419</span>
<span class="normal">1420</span>
<span class="normal">1421</span>
<span class="normal">1422</span>
<span class="normal">1423</span>
<span class="normal">1424</span>
<span class="normal">1425</span>
<span class="normal">1426</span>
<span class="normal">1427</span>
<span class="normal">1428</span>
<span class="normal">1429</span>
<span class="normal">1430</span>
<span class="normal">1431</span>
<span class="normal">1432</span>
<span class="normal">1433</span>
<span class="normal">1434</span>
<span class="normal">1435</span>
<span class="normal">1436</span>
<span class="normal">1437</span>
<span class="normal">1438</span>
<span class="normal">1439</span>
<span class="normal">1440</span>
<span class="normal">1441</span>
<span class="normal">1442</span>
<span class="normal">1443</span>
<span class="normal">1444</span>
<span class="normal">1445</span>
<span class="normal">1446</span>
<span class="normal">1447</span>
<span class="normal">1448</span>
<span class="normal">1449</span>
<span class="normal">1450</span>
<span class="normal">1451</span>
<span class="normal">1452</span>
<span class="normal">1453</span>
<span class="normal">1454</span>
<span class="normal">1455</span>
<span class="normal">1456</span>
<span class="normal">1457</span>
<span class="normal">1458</span>
<span class="normal">1459</span>
<span class="normal">1460</span>
<span class="normal">1461</span>
<span class="normal">1462</span>
<span class="normal">1463</span>
<span class="normal">1464</span>
<span class="normal">1465</span>
<span class="normal">1466</span>
<span class="normal">1467</span>
<span class="normal">1468</span>
<span class="normal">1469</span>
<span class="normal">1470</span>
<span class="normal">1471</span>
<span class="normal">1472</span>
<span class="normal">1473</span>
<span class="normal">1474</span>
<span class="normal">1475</span>
<span class="normal">1476</span>
<span class="normal">1477</span>
<span class="normal">1478</span>
<span class="normal">1479</span>
<span class="normal">1480</span>
<span class="normal">1481</span>
<span class="normal">1482</span>
<span class="normal">1483</span>
<span class="normal">1484</span>
<span class="normal">1485</span>
<span class="normal">1486</span>
<span class="normal">1487</span>
<span class="normal">1488</span>
<span class="normal">1489</span>
<span class="normal">1490</span>
<span class="normal">1491</span>
<span class="normal">1492</span>
<span class="normal">1493</span>
<span class="normal">1494</span>
<span class="normal">1495</span>
<span class="normal">1496</span>
<span class="normal">1497</span>
<span class="normal">1498</span>
<span class="normal">1499</span>
<span class="normal">1500</span>
<span class="normal">1501</span>
<span class="normal">1502</span>
<span class="normal">1503</span>
<span class="normal">1504</span>
<span class="normal">1505</span>
<span class="normal">1506</span>
<span class="normal">1507</span>
<span class="normal">1508</span>
<span class="normal">1509</span>
<span class="normal">1510</span>
<span class="normal">1511</span>
<span class="normal">1512</span>
<span class="normal">1513</span>
<span class="normal">1514</span>
<span class="normal">1515</span>
<span class="normal">1516</span>
<span class="normal">1517</span>
<span class="normal">1518</span>
<span class="normal">1519</span>
<span class="normal">1520</span>
<span class="normal">1521</span>
<span class="normal">1522</span>
<span class="normal">1523</span>
<span class="normal">1524</span>
<span class="normal">1525</span>
<span class="normal">1526</span>
<span class="normal">1527</span>
<span class="normal">1528</span>
<span class="normal">1529</span>
<span class="normal">1530</span>
<span class="normal">1531</span>
<span class="normal">1532</span>
<span class="normal">1533</span>
<span class="normal">1534</span>
<span class="normal">1535</span>
<span class="normal">1536</span>
<span class="normal">1537</span>
<span class="normal">1538</span>
<span class="normal">1539</span>
<span class="normal">1540</span>
<span class="normal">1541</span>
<span class="normal">1542</span>
<span class="normal">1543</span>
<span class="normal">1544</span>
<span class="normal">1545</span>
<span class="normal">1546</span>
<span class="normal">1547</span>
<span class="normal">1548</span>
<span class="normal">1549</span>
<span class="normal">1550</span>
<span class="normal">1551</span>
<span class="normal">1552</span>
<span class="normal">1553</span>
<span class="normal">1554</span>
<span class="normal">1555</span>
<span class="normal">1556</span>
<span class="normal">1557</span>
<span class="normal">1558</span>
<span class="normal">1559</span>
<span class="normal">1560</span>
<span class="normal">1561</span>
<span class="normal">1562</span>
<span class="normal">1563</span>
<span class="normal">1564</span>
<span class="normal">1565</span>
<span class="normal">1566</span>
<span class="normal">1567</span>
<span class="normal">1568</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_map_carto</span><span class="p">(</span>
    <span class="n">data</span><span class="p">,</span>
    <span class="n">lat</span><span class="p">,</span>
    <span class="n">lon</span><span class="p">,</span>
    <span class="n">fig</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">pertile_range</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">value_range</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">fig_size</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span>
    <span class="n">need_colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">colorbar_size</span><span class="o">=</span><span class="p">[</span><span class="mf">0.91</span><span class="p">,</span> <span class="mf">0.318</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">,</span> <span class="mf">0.354</span><span class="p">],</span>
    <span class="n">cmap_str</span><span class="o">=</span><span class="s2">&quot;jet&quot;</span><span class="p">,</span>
    <span class="n">idx_lst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">markers</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">marker_size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
    <span class="n">is_discrete</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">colors</span><span class="o">=</span><span class="s2">&quot;rbkgcmywrbkgcmyw&quot;</span><span class="p">,</span>
    <span class="n">category_names</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">legend_font_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">colorbar_font_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates a cartographic map visualization using Cartopy with extensive customization options.</span>

<span class="sd">    This function generates a map visualization for spatial data with support for continuous</span>
<span class="sd">    and discrete color scales, multiple marker types, and various styling options. It&#39;s</span>
<span class="sd">    particularly useful for visualizing hydrological data in a geographic context.</span>

<span class="sd">    Args:</span>
<span class="sd">        data (np.array): 1-D array of values to be plotted on the map.</span>
<span class="sd">        lat (np.array): 1-D array of latitude values for each data point.</span>
<span class="sd">        lon (np.array): 1-D array of longitude values for each data point.</span>
<span class="sd">        fig (matplotlib.figure.Figure, optional): Existing figure to plot on.</span>
<span class="sd">            Defaults to None.</span>
<span class="sd">        ax (matplotlib.axes.Axes, optional): Existing axes to plot on. Defaults to None.</span>
<span class="sd">        pertile_range (list, optional): Percentile range for color scaling, e.g.,</span>
<span class="sd">            [25, 75] for interquartile range. Defaults to None.</span>
<span class="sd">        value_range (list, optional): Explicit value range for color scaling. Takes</span>
<span class="sd">            precedence over pertile_range. Defaults to None.</span>
<span class="sd">        fig_size (tuple, optional): Figure size as (width, height). Defaults to (8, 8).</span>
<span class="sd">        need_colorbar (bool, optional): Whether to add a colorbar. Defaults to True.</span>
<span class="sd">        colorbar_size (list, optional): Colorbar dimensions [left, bottom, width, height].</span>
<span class="sd">            Defaults to [0.91, 0.318, 0.02, 0.354].</span>
<span class="sd">        cmap_str (str, optional): Colormap name. Defaults to &quot;jet&quot;.</span>
<span class="sd">        idx_lst (list, optional): List of index arrays for plotting multiple point</span>
<span class="sd">            categories. Defaults to None.</span>
<span class="sd">        markers (list, optional): Marker styles for each category. Defaults to None.</span>
<span class="sd">        marker_size (Union[int, list], optional): Size(s) of markers. Defaults to 20.</span>
<span class="sd">        is_discrete (bool, optional): If True, uses discrete colors with legend instead</span>
<span class="sd">            of continuous colorbar. Defaults to False.</span>
<span class="sd">        colors (str, optional): Color characters for discrete categories.</span>
<span class="sd">            Defaults to &quot;rbkgcmywrbkgcmyw&quot;.</span>
<span class="sd">        category_names (list, optional): Names for discrete categories in legend.</span>
<span class="sd">            Defaults to None.</span>
<span class="sd">        legend_font_size (float, optional): Font size for legend. Defaults to None.</span>
<span class="sd">        colorbar_font_size (float, optional): Font size for colorbar. Defaults to None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        matplotlib.axes.Axes: The axes object containing the map.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; # Simple continuous color map</span>
<span class="sd">        &gt;&gt;&gt; data = np.random.rand(100)</span>
<span class="sd">        &gt;&gt;&gt; lat = np.random.uniform(30, 45, 100)</span>
<span class="sd">        &gt;&gt;&gt; lon = np.random.uniform(-120, -100, 100)</span>
<span class="sd">        &gt;&gt;&gt; ax = plot_map_carto(</span>
<span class="sd">        ...     data, lat, lon,</span>
<span class="sd">        ...     value_range=[0, 1],</span>
<span class="sd">        ...     cmap_str=&#39;viridis&#39;</span>
<span class="sd">        ... )</span>

<span class="sd">        &gt;&gt;&gt; # Discrete categories with custom markers</span>
<span class="sd">        &gt;&gt;&gt; categories = np.random.randint(0, 3, 100)</span>
<span class="sd">        &gt;&gt;&gt; idx_lst = [np.where(categories == i)[0] for i in range(3)]</span>
<span class="sd">        &gt;&gt;&gt; ax = plot_map_carto(</span>
<span class="sd">        ...     data, lat, lon,</span>
<span class="sd">        ...     idx_lst=idx_lst,</span>
<span class="sd">        ...     markers=[&#39;o&#39;, &#39;s&#39;, &#39;^&#39;],</span>
<span class="sd">        ...     is_discrete=True,</span>
<span class="sd">        ...     category_names=[&#39;Low&#39;, &#39;Medium&#39;, &#39;High&#39;]</span>
<span class="sd">        ... )</span>

<span class="sd">    Notes:</span>
<span class="sd">        - Uses Cartopy for map projections and features</span>
<span class="sd">        - Automatically adds state boundaries and coastlines</span>
<span class="sd">        - Supports both continuous and categorical data visualization</span>
<span class="sd">        - Handles NaN values appropriately</span>
<span class="sd">        - Provides flexible control over color scaling</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">value_range</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">vmin</span> <span class="o">=</span> <span class="n">value_range</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">vmax</span> <span class="o">=</span> <span class="n">value_range</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">elif</span> <span class="n">pertile_range</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># https://blog.csdn.net/chenirene510/article/details/111318539</span>
        <span class="n">mask_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">masked_invalid</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">vmin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">mask_data</span><span class="p">)</span>
        <span class="n">vmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">mask_data</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">assert</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">pertile_range</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">pertile_range</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">100</span>
        <span class="n">vmin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanpercentile</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">pertile_range</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">vmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanpercentile</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">pertile_range</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">llcrnrlat</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">lat</span><span class="p">),)</span>
    <span class="n">urcrnrlat</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">lat</span><span class="p">),)</span>
    <span class="n">llcrnrlon</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">lon</span><span class="p">),)</span>
    <span class="n">urcrnrlon</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">lon</span><span class="p">),)</span>
    <span class="n">extent</span> <span class="o">=</span> <span class="p">[</span><span class="n">llcrnrlon</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">urcrnrlon</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">llcrnrlat</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">urcrnrlat</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
    <span class="c1"># Figure</span>
    <span class="k">if</span> <span class="n">fig</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span>
            <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="n">fig_size</span><span class="p">,</span> <span class="n">subplot_kw</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;projection&quot;</span><span class="p">:</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">()}</span>
        <span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_extent</span><span class="p">(</span><span class="n">extent</span><span class="p">)</span>
    <span class="n">states</span> <span class="o">=</span> <span class="n">NaturalEarthFeature</span><span class="p">(</span>
        <span class="n">category</span><span class="o">=</span><span class="s2">&quot;cultural&quot;</span><span class="p">,</span>
        <span class="n">scale</span><span class="o">=</span><span class="s2">&quot;50m&quot;</span><span class="p">,</span>
        <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">,</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;admin_1_states_provinces_shp&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">states</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">(</span><span class="s2">&quot;50m&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">idx_lst</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">marker_size</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">marker_size</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">idx_lst</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">marker_size</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">idx_lst</span><span class="p">),</span> <span class="n">marker_size</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">marker_size</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">markers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">idx_lst</span><span class="p">),</span> <span class="n">markers</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">markers</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">idx_lst</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cmap_str</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">cmap_str</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">idx_lst</span><span class="p">),</span> <span class="n">cmap_str</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">cmap_str</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">idx_lst</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">is_discrete</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">idx_lst</span><span class="p">)):</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
                    <span class="n">lon</span><span class="p">[</span><span class="n">idx_lst</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span>
                    <span class="n">lat</span><span class="p">[</span><span class="n">idx_lst</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span>
                    <span class="n">marker</span><span class="o">=</span><span class="n">markers</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                    <span class="n">ms</span><span class="o">=</span><span class="n">marker_size</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                    <span class="n">label</span><span class="o">=</span><span class="n">category_names</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                    <span class="n">c</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                    <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">prop</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">legend_font_size</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">scatter</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">idx_lst</span><span class="p">)):</span>
                <span class="n">scat</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
                    <span class="n">lon</span><span class="p">[</span><span class="n">idx_lst</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span>
                    <span class="n">lat</span><span class="p">[</span><span class="n">idx_lst</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span>
                    <span class="n">c</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="n">idx_lst</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span>
                    <span class="n">marker</span><span class="o">=</span><span class="n">markers</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                    <span class="n">s</span><span class="o">=</span><span class="n">marker_size</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                    <span class="n">cmap</span><span class="o">=</span><span class="n">cmap_str</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                    <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span>
                    <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="n">scatter</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">scat</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">need_colorbar</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">colorbar_size</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">cbar_ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">(</span><span class="n">colorbar_size</span><span class="p">)</span>
                    <span class="n">cbar</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">scat</span><span class="p">,</span> <span class="n">cax</span><span class="o">=</span><span class="n">cbar_ax</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s2">&quot;vertical&quot;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">cbar</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">scat</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">colorbar_font_size</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="n">colorbar_font_size</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">category_names</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span>
                    <span class="n">scatter</span><span class="p">,</span> <span class="n">category_names</span><span class="p">,</span> <span class="n">prop</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">legend_font_size</span><span class="p">),</span> <span class="n">ncol</span><span class="o">=</span><span class="mi">2</span>
                <span class="p">)</span>
    <span class="k">elif</span> <span class="n">is_discrete</span><span class="p">:</span>
        <span class="n">scatter</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="n">marker_size</span><span class="p">)</span>
        <span class="c1"># produce a legend with the unique colors from the scatter</span>
        <span class="n">legend1</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span>
            <span class="o">*</span><span class="n">scatter</span><span class="o">.</span><span class="n">legend_elements</span><span class="p">(),</span> <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;lower left&quot;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Classes&quot;</span>
        <span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">add_artist</span><span class="p">(</span><span class="n">legend1</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">scat</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
            <span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="n">marker_size</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap_str</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">need_colorbar</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">colorbar_size</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">cbar_ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">(</span><span class="n">colorbar_size</span><span class="p">)</span>
                <span class="n">cbar</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">scat</span><span class="p">,</span> <span class="n">cax</span><span class="o">=</span><span class="n">cbar_ax</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s2">&quot;vertical&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">cbar</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">scat</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">colorbar_font_size</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="n">colorbar_font_size</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ax</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="hydroutils.plot_pdf_cdf" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">plot_pdf_cdf</span><span class="p">(</span><span class="n">mydataframe</span><span class="p">,</span> <span class="n">mycolumn</span><span class="p">)</span></code>

<a href="#hydroutils.plot_pdf_cdf" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Creates side-by-side plots of probability density function (PDF) and cumulative
distribution function (CDF).</p>
<p>This function generates a figure with two subplots: a PDF plot on the left and
a CDF plot on the right. The PDF includes both histogram and kernel density
estimation, while the CDF shows the cumulative histogram.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>mydataframe</code>
            </td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DataFrame containing the data to plot.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>mycolumn</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the column to create distributions for.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create sample data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
<span class="gp">... </span>    <span class="s1">&#39;values&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span>
<span class="gp">... </span>        <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">),</span>
<span class="gp">... </span>        <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="gp">... </span>    <span class="p">])</span>
<span class="gp">... </span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plot_pdf_cdf</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s1">&#39;values&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>


<details class="notes" open>
  <summary>Notes</summary>
  <ul>
<li>Uses seaborn's distplot for both PDF and CDF</li>
<li>PDF includes both histogram and kernel density estimation</li>
<li>CDF shows cumulative histogram with step-style line</li>
<li>Both plots are set to range [0, 1] on x-axis</li>
<li>CDF y-axis is also set to range [0, 1]</li>
<li>High DPI (320) for publication-quality figures</li>
<li>Large figure size (18x6) for clear visualization</li>
</ul>
</details>

            <details class="quote">
              <summary>Source code in <code>hydroutils/hydro_plot.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1269</span>
<span class="normal">1270</span>
<span class="normal">1271</span>
<span class="normal">1272</span>
<span class="normal">1273</span>
<span class="normal">1274</span>
<span class="normal">1275</span>
<span class="normal">1276</span>
<span class="normal">1277</span>
<span class="normal">1278</span>
<span class="normal">1279</span>
<span class="normal">1280</span>
<span class="normal">1281</span>
<span class="normal">1282</span>
<span class="normal">1283</span>
<span class="normal">1284</span>
<span class="normal">1285</span>
<span class="normal">1286</span>
<span class="normal">1287</span>
<span class="normal">1288</span>
<span class="normal">1289</span>
<span class="normal">1290</span>
<span class="normal">1291</span>
<span class="normal">1292</span>
<span class="normal">1293</span>
<span class="normal">1294</span>
<span class="normal">1295</span>
<span class="normal">1296</span>
<span class="normal">1297</span>
<span class="normal">1298</span>
<span class="normal">1299</span>
<span class="normal">1300</span>
<span class="normal">1301</span>
<span class="normal">1302</span>
<span class="normal">1303</span>
<span class="normal">1304</span>
<span class="normal">1305</span>
<span class="normal">1306</span>
<span class="normal">1307</span>
<span class="normal">1308</span>
<span class="normal">1309</span>
<span class="normal">1310</span>
<span class="normal">1311</span>
<span class="normal">1312</span>
<span class="normal">1313</span>
<span class="normal">1314</span>
<span class="normal">1315</span>
<span class="normal">1316</span>
<span class="normal">1317</span>
<span class="normal">1318</span>
<span class="normal">1319</span>
<span class="normal">1320</span>
<span class="normal">1321</span>
<span class="normal">1322</span>
<span class="normal">1323</span>
<span class="normal">1324</span>
<span class="normal">1325</span>
<span class="normal">1326</span>
<span class="normal">1327</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_pdf_cdf</span><span class="p">(</span><span class="n">mydataframe</span><span class="p">,</span> <span class="n">mycolumn</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates side-by-side plots of probability density function (PDF) and cumulative</span>
<span class="sd">    distribution function (CDF).</span>

<span class="sd">    This function generates a figure with two subplots: a PDF plot on the left and</span>
<span class="sd">    a CDF plot on the right. The PDF includes both histogram and kernel density</span>
<span class="sd">    estimation, while the CDF shows the cumulative histogram.</span>

<span class="sd">    Args:</span>
<span class="sd">        mydataframe (pd.DataFrame): DataFrame containing the data to plot.</span>
<span class="sd">        mycolumn (str): Name of the column to create distributions for.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; # Create sample data</span>
<span class="sd">        &gt;&gt;&gt; df = pd.DataFrame({</span>
<span class="sd">        ...     &#39;values&#39;: np.concatenate([</span>
<span class="sd">        ...         np.random.normal(0.3, 0.1, 1000),</span>
<span class="sd">        ...         np.random.normal(0.7, 0.1, 1000)</span>
<span class="sd">        ...     ])</span>
<span class="sd">        ... })</span>
<span class="sd">        &gt;&gt;&gt; plot_pdf_cdf(df, &#39;values&#39;)</span>

<span class="sd">    Notes:</span>
<span class="sd">        - Uses seaborn&#39;s distplot for both PDF and CDF</span>
<span class="sd">        - PDF includes both histogram and kernel density estimation</span>
<span class="sd">        - CDF shows cumulative histogram with step-style line</span>
<span class="sd">        - Both plots are set to range [0, 1] on x-axis</span>
<span class="sd">        - CDF y-axis is also set to range [0, 1]</span>
<span class="sd">        - High DPI (320) for publication-quality figures</span>
<span class="sd">        - Large figure size (18x6) for clear visualization</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># settings</span>
    <span class="n">f</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">320</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;fraction (PDF)&quot;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;fraction (CDF)&quot;</span><span class="p">)</span>

    <span class="c1"># left plot (PDF) # REMEMBER TO CHANGE bins, xlim PROPERLY!!</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span>
        <span class="n">mydataframe</span><span class="p">[</span><span class="n">mycolumn</span><span class="p">],</span>
        <span class="n">kde</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">axlabel</span><span class="o">=</span><span class="n">mycolumn</span><span class="p">,</span>
        <span class="n">hist_kws</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;density&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">},</span>
        <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
    <span class="p">)</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

    <span class="c1"># right plot (CDF) # REMEMBER TO CHANGE bins, xlim PROPERLY!!</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span>
        <span class="n">mydataframe</span><span class="p">[</span><span class="n">mycolumn</span><span class="p">],</span>
        <span class="n">kde</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">axlabel</span><span class="o">=</span><span class="n">mycolumn</span><span class="p">,</span>
        <span class="n">hist_kws</span><span class="o">=</span><span class="p">{</span>
            <span class="s2">&quot;density&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
            <span class="s2">&quot;cumulative&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
            <span class="s2">&quot;histtype&quot;</span><span class="p">:</span> <span class="s2">&quot;step&quot;</span><span class="p">,</span>
            <span class="s2">&quot;linewidth&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
    <span class="p">)</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="hydroutils.plot_quiver" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">plot_quiver</span><span class="p">(</span><span class="n">exps_q_ssm_result_show</span><span class="p">,</span> <span class="n">exps_ssm_q_result_show</span><span class="p">,</span> <span class="n">q_diff_show</span><span class="p">,</span> <span class="n">ssm_diff_show</span><span class="p">,</span> <span class="n">x_label</span><span class="p">,</span> <span class="n">y_label</span><span class="p">)</span></code>

<a href="#hydroutils.plot_quiver" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Creates a quiver plot showing vector field with normalized arrows.</p>
<p>This function generates a quiver plot where arrows represent the direction and
magnitude of differences between two variables. The arrows are normalized to have
uniform length, with color indicating the actual magnitude of the difference.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>exps_q_ssm_result_show</code>
            </td>
            <td>
                  <code><span title="numpy.array">array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>X-coordinates for arrow origins.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>exps_ssm_q_result_show</code>
            </td>
            <td>
                  <code><span title="numpy.array">array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Y-coordinates for arrow origins.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>q_diff_show</code>
            </td>
            <td>
                  <code><span title="numpy.array">array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>X-components of the difference vectors.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ssm_diff_show</code>
            </td>
            <td>
                  <code><span title="numpy.array">array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Y-components of the difference vectors.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>x_label</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Label for x-axis.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>y_label</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Label for y-axis.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Tuple[matplotlib.figure.Figure, matplotlib.axes.Axes]: The figure and axes
objects containing the quiver plot.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create sample data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plot_quiver</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s1">&#39;X Variable&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s1">&#39;Y Variable&#39;</span>
<span class="gp">... </span><span class="p">)</span>
</code></pre></div></td></tr></table></div>


<details class="notes" open>
  <summary>Notes</summary>
  <ul>
<li>Arrows are normalized to uniform length for better visualization</li>
<li>Color indicates the actual magnitude of the difference vector</li>
<li>Plot includes a colorbar showing the magnitude scale</li>
<li>Uses clean plotting style with minimal spines</li>
<li>Default plot range is [0, 1] for both axes</li>
</ul>
</details>

            <details class="quote">
              <summary>Source code in <code>hydroutils/hydro_plot.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_quiver</span><span class="p">(</span>
    <span class="n">exps_q_ssm_result_show</span><span class="p">,</span>
    <span class="n">exps_ssm_q_result_show</span><span class="p">,</span>
    <span class="n">q_diff_show</span><span class="p">,</span>
    <span class="n">ssm_diff_show</span><span class="p">,</span>
    <span class="n">x_label</span><span class="p">,</span>
    <span class="n">y_label</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates a quiver plot showing vector field with normalized arrows.</span>

<span class="sd">    This function generates a quiver plot where arrows represent the direction and</span>
<span class="sd">    magnitude of differences between two variables. The arrows are normalized to have</span>
<span class="sd">    uniform length, with color indicating the actual magnitude of the difference.</span>

<span class="sd">    Args:</span>
<span class="sd">        exps_q_ssm_result_show (np.array): X-coordinates for arrow origins.</span>
<span class="sd">        exps_ssm_q_result_show (np.array): Y-coordinates for arrow origins.</span>
<span class="sd">        q_diff_show (np.array): X-components of the difference vectors.</span>
<span class="sd">        ssm_diff_show (np.array): Y-components of the difference vectors.</span>
<span class="sd">        x_label (str): Label for x-axis.</span>
<span class="sd">        y_label (str): Label for y-axis.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Tuple[matplotlib.figure.Figure, matplotlib.axes.Axes]: The figure and axes</span>
<span class="sd">            objects containing the quiver plot.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; # Create sample data</span>
<span class="sd">        &gt;&gt;&gt; x = np.random.rand(50)</span>
<span class="sd">        &gt;&gt;&gt; y = np.random.rand(50)</span>
<span class="sd">        &gt;&gt;&gt; dx = np.random.normal(0, 0.1, 50)</span>
<span class="sd">        &gt;&gt;&gt; dy = np.random.normal(0, 0.1, 50)</span>
<span class="sd">        &gt;&gt;&gt; fig, ax = plot_quiver(</span>
<span class="sd">        ...     x, y, dx, dy,</span>
<span class="sd">        ...     &#39;X Variable&#39;,</span>
<span class="sd">        ...     &#39;Y Variable&#39;</span>
<span class="sd">        ... )</span>

<span class="sd">    Notes:</span>
<span class="sd">        - Arrows are normalized to uniform length for better visualization</span>
<span class="sd">        - Color indicates the actual magnitude of the difference vector</span>
<span class="sd">        - Plot includes a colorbar showing the magnitude scale</span>
<span class="sd">        - Uses clean plotting style with minimal spines</span>
<span class="sd">        - Default plot range is [0, 1] for both axes</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
    <span class="n">color</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">q_diff_show</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">ssm_diff_show</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="c1"># normalize to get same length arrows</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">q_diff_show</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">ssm_diff_show</span><span class="p">,</span> <span class="mi">2</span><span class="p">)),</span> <span class="mf">0.5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span>
        <span class="n">exps_q_ssm_result_show</span><span class="p">,</span>
        <span class="n">exps_ssm_q_result_show</span><span class="p">,</span>
        <span class="n">q_diff_show</span> <span class="o">/</span> <span class="n">r</span><span class="p">,</span>
        <span class="n">ssm_diff_show</span> <span class="o">/</span> <span class="n">r</span><span class="p">,</span>
        <span class="n">color</span><span class="p">,</span>
        <span class="n">scale</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span>
        <span class="n">width</span><span class="o">=</span><span class="mf">0.005</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="c1"># Defining color</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.01</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.01</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
    <span class="c1"># Hide the right and top spines</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">x_label</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="n">y_label</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="hydroutils.plot_rainfall_runoff" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">plot_rainfall_runoff</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">qs</span><span class="p">,</span> <span class="n">fig_size</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">c_lst</span><span class="o">=</span><span class="s1">&#39;rbkgcmy&#39;</span><span class="p">,</span> <span class="n">leg_lst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dash_lines</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">prcp_ylabel</span><span class="o">=</span><span class="s1">&#39;prcp(mm/day)&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">prcp_interval</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span></code>

<a href="#hydroutils.plot_rainfall_runoff" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Creates a combined rainfall-runoff plot with precipitation bars and streamflow lines.</p>
<p>This function generates a dual-axis plot showing precipitation as inverted bars from
the top and streamflow as lines on the bottom. This is a common visualization in
hydrology for analyzing rainfall-runoff relationships.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>t</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="numpy.array">array</span>, <span title="hydroutils.hydro_stat.List">List</span>[<span title="numpy.array">array</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Time values. If multiple streamflow series
are provided, t can be a list of time arrays matching qs.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>p</code>
            </td>
            <td>
                  <code><span title="numpy.array">array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Precipitation time series data in mm/day.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>qs</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="numpy.array">array</span>, <span title="hydroutils.hydro_stat.List">List</span>[<span title="numpy.array">array</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Streamflow time series data. Can be a
single array or list of arrays for multiple streamflow series.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>fig_size</code>
            </td>
            <td>
                  <code><span title="tuple">tuple</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Figure size as (width, height). Defaults to (8, 6).</p>
              </div>
            </td>
            <td>
                  <code>(8, 6)</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>c_lst</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>String of color characters for streamflow lines.
Defaults to "rbkgcmy".</p>
              </div>
            </td>
            <td>
                  <code>&#39;rbkgcmy&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>leg_lst</code>
            </td>
            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Legend labels for streamflow series. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dash_lines</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="bool">bool</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Specifies which streamflow lines should be
dashed. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>title</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Plot title. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>xlabel</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>X-axis label. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ylabel</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Y-axis label for streamflow. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>prcp_ylabel</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Y-axis label for precipitation. Defaults to
"prcp(mm/day)".</p>
              </div>
            </td>
            <td>
                  <code>&#39;prcp(mm/day)&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>linewidth</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Width of streamflow lines. Defaults to 1.</p>
              </div>
            </td>
            <td>
                  <code>1</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>prcp_interval</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Interval for precipitation y-axis ticks.
Defaults to 20.</p>
              </div>
            </td>
            <td>
                  <code>20</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Tuple[matplotlib.figure.Figure, matplotlib.axes.Axes]: The figure and axes
objects containing the plot.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Simple rainfall-runoff plot</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="s1">&#39;2020-01-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2020-12-31&#39;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;datetime64[D]&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">exponential</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>  <span class="c1"># precipitation</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">)</span>  <span class="c1"># simulated streamflow</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plot_rainfall_runoff</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Rainfall-Runoff Analysis&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Date&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Streamflow (m³/s)&#39;</span>
<span class="gp">... </span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Multiple streamflow series</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qs</span> <span class="o">=</span> <span class="p">[</span><span class="n">q</span><span class="p">,</span> <span class="n">q</span><span class="o">*</span><span class="mf">1.2</span><span class="p">]</span>  <span class="c1"># observed and simulated</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plot_rainfall_runoff</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">qs</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">leg_lst</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Observed&#39;</span><span class="p">,</span> <span class="s1">&#39;Simulated&#39;</span><span class="p">],</span>
<span class="gp">... </span>    <span class="n">dash_lines</span><span class="o">=</span><span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">]</span>
<span class="gp">... </span><span class="p">)</span>
</code></pre></div></td></tr></table></div>


<details class="notes" open>
  <summary>Notes</summary>
  <ul>
<li>Precipitation is plotted as blue bars from the top of the plot</li>
<li>Streamflow is plotted as lines on the bottom</li>
<li>The precipitation y-axis is inverted for better visualization</li>
<li>Grid lines are added automatically</li>
</ul>
</details>

            <details class="quote">
              <summary>Source code in <code>hydroutils/hydro_plot.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1657</span>
<span class="normal">1658</span>
<span class="normal">1659</span>
<span class="normal">1660</span>
<span class="normal">1661</span>
<span class="normal">1662</span>
<span class="normal">1663</span>
<span class="normal">1664</span>
<span class="normal">1665</span>
<span class="normal">1666</span>
<span class="normal">1667</span>
<span class="normal">1668</span>
<span class="normal">1669</span>
<span class="normal">1670</span>
<span class="normal">1671</span>
<span class="normal">1672</span>
<span class="normal">1673</span>
<span class="normal">1674</span>
<span class="normal">1675</span>
<span class="normal">1676</span>
<span class="normal">1677</span>
<span class="normal">1678</span>
<span class="normal">1679</span>
<span class="normal">1680</span>
<span class="normal">1681</span>
<span class="normal">1682</span>
<span class="normal">1683</span>
<span class="normal">1684</span>
<span class="normal">1685</span>
<span class="normal">1686</span>
<span class="normal">1687</span>
<span class="normal">1688</span>
<span class="normal">1689</span>
<span class="normal">1690</span>
<span class="normal">1691</span>
<span class="normal">1692</span>
<span class="normal">1693</span>
<span class="normal">1694</span>
<span class="normal">1695</span>
<span class="normal">1696</span>
<span class="normal">1697</span>
<span class="normal">1698</span>
<span class="normal">1699</span>
<span class="normal">1700</span>
<span class="normal">1701</span>
<span class="normal">1702</span>
<span class="normal">1703</span>
<span class="normal">1704</span>
<span class="normal">1705</span>
<span class="normal">1706</span>
<span class="normal">1707</span>
<span class="normal">1708</span>
<span class="normal">1709</span>
<span class="normal">1710</span>
<span class="normal">1711</span>
<span class="normal">1712</span>
<span class="normal">1713</span>
<span class="normal">1714</span>
<span class="normal">1715</span>
<span class="normal">1716</span>
<span class="normal">1717</span>
<span class="normal">1718</span>
<span class="normal">1719</span>
<span class="normal">1720</span>
<span class="normal">1721</span>
<span class="normal">1722</span>
<span class="normal">1723</span>
<span class="normal">1724</span>
<span class="normal">1725</span>
<span class="normal">1726</span>
<span class="normal">1727</span>
<span class="normal">1728</span>
<span class="normal">1729</span>
<span class="normal">1730</span>
<span class="normal">1731</span>
<span class="normal">1732</span>
<span class="normal">1733</span>
<span class="normal">1734</span>
<span class="normal">1735</span>
<span class="normal">1736</span>
<span class="normal">1737</span>
<span class="normal">1738</span>
<span class="normal">1739</span>
<span class="normal">1740</span>
<span class="normal">1741</span>
<span class="normal">1742</span>
<span class="normal">1743</span>
<span class="normal">1744</span>
<span class="normal">1745</span>
<span class="normal">1746</span>
<span class="normal">1747</span>
<span class="normal">1748</span>
<span class="normal">1749</span>
<span class="normal">1750</span>
<span class="normal">1751</span>
<span class="normal">1752</span>
<span class="normal">1753</span>
<span class="normal">1754</span>
<span class="normal">1755</span>
<span class="normal">1756</span>
<span class="normal">1757</span>
<span class="normal">1758</span>
<span class="normal">1759</span>
<span class="normal">1760</span>
<span class="normal">1761</span>
<span class="normal">1762</span>
<span class="normal">1763</span>
<span class="normal">1764</span>
<span class="normal">1765</span>
<span class="normal">1766</span>
<span class="normal">1767</span>
<span class="normal">1768</span>
<span class="normal">1769</span>
<span class="normal">1770</span>
<span class="normal">1771</span>
<span class="normal">1772</span>
<span class="normal">1773</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_rainfall_runoff</span><span class="p">(</span>
    <span class="n">t</span><span class="p">,</span>
    <span class="n">p</span><span class="p">,</span>
    <span class="n">qs</span><span class="p">,</span>
    <span class="n">fig_size</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span>
    <span class="n">c_lst</span><span class="o">=</span><span class="s2">&quot;rbkgcmy&quot;</span><span class="p">,</span>
    <span class="n">leg_lst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">dash_lines</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">xlabel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">ylabel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">prcp_ylabel</span><span class="o">=</span><span class="s2">&quot;prcp(mm/day)&quot;</span><span class="p">,</span>
    <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">prcp_interval</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates a combined rainfall-runoff plot with precipitation bars and streamflow lines.</span>

<span class="sd">    This function generates a dual-axis plot showing precipitation as inverted bars from</span>
<span class="sd">    the top and streamflow as lines on the bottom. This is a common visualization in</span>
<span class="sd">    hydrology for analyzing rainfall-runoff relationships.</span>

<span class="sd">    Args:</span>
<span class="sd">        t (Union[np.array, List[np.array]]): Time values. If multiple streamflow series</span>
<span class="sd">            are provided, t can be a list of time arrays matching qs.</span>
<span class="sd">        p (np.array): Precipitation time series data in mm/day.</span>
<span class="sd">        qs (Union[np.array, List[np.array]]): Streamflow time series data. Can be a</span>
<span class="sd">            single array or list of arrays for multiple streamflow series.</span>
<span class="sd">        fig_size (tuple, optional): Figure size as (width, height). Defaults to (8, 6).</span>
<span class="sd">        c_lst (str, optional): String of color characters for streamflow lines.</span>
<span class="sd">            Defaults to &quot;rbkgcmy&quot;.</span>
<span class="sd">        leg_lst (list, optional): Legend labels for streamflow series. Defaults to None.</span>
<span class="sd">        dash_lines (list[bool], optional): Specifies which streamflow lines should be</span>
<span class="sd">            dashed. Defaults to None.</span>
<span class="sd">        title (str, optional): Plot title. Defaults to None.</span>
<span class="sd">        xlabel (str, optional): X-axis label. Defaults to None.</span>
<span class="sd">        ylabel (str, optional): Y-axis label for streamflow. Defaults to None.</span>
<span class="sd">        prcp_ylabel (str, optional): Y-axis label for precipitation. Defaults to</span>
<span class="sd">            &quot;prcp(mm/day)&quot;.</span>
<span class="sd">        linewidth (int, optional): Width of streamflow lines. Defaults to 1.</span>
<span class="sd">        prcp_interval (int, optional): Interval for precipitation y-axis ticks.</span>
<span class="sd">            Defaults to 20.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Tuple[matplotlib.figure.Figure, matplotlib.axes.Axes]: The figure and axes</span>
<span class="sd">            objects containing the plot.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; # Simple rainfall-runoff plot</span>
<span class="sd">        &gt;&gt;&gt; t = np.arange(&#39;2020-01-01&#39;, &#39;2020-12-31&#39;, dtype=&#39;datetime64[D]&#39;)</span>
<span class="sd">        &gt;&gt;&gt; p = np.random.exponential(2, size=len(t))  # precipitation</span>
<span class="sd">        &gt;&gt;&gt; q = np.convolve(p, np.ones(5)/5, mode=&#39;same&#39;)  # simulated streamflow</span>
<span class="sd">        &gt;&gt;&gt; fig, ax = plot_rainfall_runoff(</span>
<span class="sd">        ...     t, p, q,</span>
<span class="sd">        ...     title=&#39;Rainfall-Runoff Analysis&#39;,</span>
<span class="sd">        ...     xlabel=&#39;Date&#39;,</span>
<span class="sd">        ...     ylabel=&#39;Streamflow (m³/s)&#39;</span>
<span class="sd">        ... )</span>

<span class="sd">        &gt;&gt;&gt; # Multiple streamflow series</span>
<span class="sd">        &gt;&gt;&gt; qs = [q, q*1.2]  # observed and simulated</span>
<span class="sd">        &gt;&gt;&gt; fig, ax = plot_rainfall_runoff(</span>
<span class="sd">        ...     t, p, qs,</span>
<span class="sd">        ...     leg_lst=[&#39;Observed&#39;, &#39;Simulated&#39;],</span>
<span class="sd">        ...     dash_lines=[False, True]</span>
<span class="sd">        ... )</span>

<span class="sd">    Notes:</span>
<span class="sd">        - Precipitation is plotted as blue bars from the top of the plot</span>
<span class="sd">        - Streamflow is plotted as lines on the bottom</span>
<span class="sd">        - The precipitation y-axis is inverted for better visualization</span>
<span class="sd">        - Grid lines are added automatically</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">fig_size</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">dash_lines</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dash_lines</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">dash_lines</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">qs</span><span class="p">),</span> <span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">qs</span><span class="p">)):</span>
        <span class="n">tt</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span> <span class="k">else</span> <span class="n">t</span>
        <span class="n">q</span> <span class="o">=</span> <span class="n">qs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
        <span class="n">leg_str</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">leg_lst</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">leg_str</span> <span class="o">=</span> <span class="n">leg_lst</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
        <span class="p">(</span><span class="n">line_i</span><span class="p">,)</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tt</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">c_lst</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="n">leg_str</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="n">linewidth</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">dash_lines</span><span class="p">[</span><span class="n">k</span><span class="p">]:</span>
            <span class="n">line_i</span><span class="o">.</span><span class="n">set_dashes</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1.2</span><span class="p">)</span>
    <span class="c1"># Create second axes, in order to get the bars from the top you can multiply by -1</span>
    <span class="n">ax2</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
    <span class="c1"># ax2.bar(tt, -p, color=&quot;b&quot;)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">tt</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="n">p</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="s2">&quot;mid&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="c1"># ax2.plot(tt, -p, color=&quot;b&quot;, alpha=0.7, linewidth=1.5)</span>

    <span class="c1"># Now need to fix the axis labels</span>
    <span class="c1"># max_pre = max(p)</span>
    <span class="n">max_pre</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="n">max_pre</span> <span class="o">*</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">y2_ticks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">max_pre</span><span class="p">,</span> <span class="n">prcp_interval</span><span class="p">)</span>
    <span class="n">y2_ticklabels</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">y2_ticks</span><span class="p">]</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">y2_ticks</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="n">y2_ticklabels</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="c1"># ax2.set_yticklabels([lab.get_text()[1:] for lab in ax2.get_yticklabels()])</span>
    <span class="k">if</span> <span class="n">title</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">fontdict</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;fontsize&quot;</span><span class="p">:</span> <span class="mi">17</span><span class="p">})</span>
    <span class="k">if</span> <span class="n">ylabel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">xlabel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">xlabel</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">prcp_ylabel</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;top&quot;</span><span class="p">)</span>
    <span class="c1"># ax2.set_ylabel(&quot;precipitation (mm/day)&quot;, fontsize=12, loc=&#39;top&#39;)</span>
    <span class="c1"># https://github.com/matplotlib/matplotlib/issues/12318</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.85</span><span class="p">),</span> <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper left&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="hydroutils.plot_rainfall_runoff_chai" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">plot_rainfall_runoff_chai</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">ps</span><span class="p">,</span> <span class="n">qs</span><span class="p">,</span> <span class="n">c_lst</span><span class="o">=</span><span class="s1">&#39;rbkgcmy&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Observation of Precipitation and Streamflow&#39;</span><span class="p">,</span> <span class="n">alpha_lst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">p_labels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">q_labels</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#hydroutils.plot_rainfall_runoff_chai" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Creates a two-panel rainfall-runoff plot following Chai's style.</p>
<p>This function generates a figure with two vertically stacked panels: precipitation
on top and streamflow below. It supports multiple precipitation sources and
streamflow series with customizable styling.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>t</code>
            </td>
            <td>
                  <code><span title="array">array</span> - <span title="like">like</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Time points for x-axis.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ps</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="numpy.array">array</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of precipitation arrays from different sources.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>qs</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="numpy.array">array</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of streamflow arrays (e.g., observed and simulated).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>c_lst</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>String of color characters. Defaults to "rbkgcmy".</p>
              </div>
            </td>
            <td>
                  <code>&#39;rbkgcmy&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>title</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Figure title. Defaults to "Observation of Precipitation
and Streamflow".</p>
              </div>
            </td>
            <td>
                  <code>&#39;Observation of Precipitation and Streamflow&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>alpha_lst</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Transparency values for each series.
Defaults to [0.5, 0.5].</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>p_labels</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Labels for precipitation sources.
Defaults to ["era5land", "gauge"].</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>q_labels</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Labels for streamflow series.
Defaults to ["observation", "simulation"].</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Tuple[matplotlib.figure.Figure, matplotlib.axes.Axes]: The figure and bottom
axes (streamflow plot).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create sample data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s1">&#39;2020-01-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2020-12-31&#39;</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;D&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Two precipitation sources</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">exponential</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>  <span class="c1"># ERA5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p2</span> <span class="o">=</span> <span class="n">p1</span> <span class="o">*</span> <span class="mf">1.2</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>  <span class="c1"># Gauge</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Observed and simulated streamflow</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q_obs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q_sim</span> <span class="o">=</span> <span class="n">q_obs</span> <span class="o">*</span> <span class="mf">1.1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">q_obs</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plot_rainfall_runoff_chai</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">t</span><span class="p">,</span> <span class="p">[</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">],</span> <span class="p">[</span><span class="n">q_obs</span><span class="p">,</span> <span class="n">q_sim</span><span class="p">],</span>
<span class="gp">... </span>    <span class="n">title</span><span class="o">=</span><span class="s1">&#39;2020 Rainfall-Runoff Comparison&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">p_labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;ERA5&#39;</span><span class="p">,</span> <span class="s1">&#39;Rain Gauge&#39;</span><span class="p">],</span>
<span class="gp">... </span>    <span class="n">q_labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Observed&#39;</span><span class="p">,</span> <span class="s1">&#39;Simulated&#39;</span><span class="p">]</span>
<span class="gp">... </span><span class="p">)</span>
</code></pre></div></td></tr></table></div>


<details class="notes" open>
  <summary>Notes</summary>
  <ul>
<li>Top panel shows precipitation with bars</li>
<li>Bottom panel shows streamflow with lines</li>
<li>Precipitation y-axis is inverted and blue</li>
<li>Streamflow y-axis is red</li>
<li>Both panels share x-axis limits</li>
<li>Legends included for both panels</li>
<li>Uses large figure size (20x8) by default</li>
<li>Includes "Streamflow" text box in bottom panel</li>
</ul>
</details>

            <details class="quote">
              <summary>Source code in <code>hydroutils/hydro_plot.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1861</span>
<span class="normal">1862</span>
<span class="normal">1863</span>
<span class="normal">1864</span>
<span class="normal">1865</span>
<span class="normal">1866</span>
<span class="normal">1867</span>
<span class="normal">1868</span>
<span class="normal">1869</span>
<span class="normal">1870</span>
<span class="normal">1871</span>
<span class="normal">1872</span>
<span class="normal">1873</span>
<span class="normal">1874</span>
<span class="normal">1875</span>
<span class="normal">1876</span>
<span class="normal">1877</span>
<span class="normal">1878</span>
<span class="normal">1879</span>
<span class="normal">1880</span>
<span class="normal">1881</span>
<span class="normal">1882</span>
<span class="normal">1883</span>
<span class="normal">1884</span>
<span class="normal">1885</span>
<span class="normal">1886</span>
<span class="normal">1887</span>
<span class="normal">1888</span>
<span class="normal">1889</span>
<span class="normal">1890</span>
<span class="normal">1891</span>
<span class="normal">1892</span>
<span class="normal">1893</span>
<span class="normal">1894</span>
<span class="normal">1895</span>
<span class="normal">1896</span>
<span class="normal">1897</span>
<span class="normal">1898</span>
<span class="normal">1899</span>
<span class="normal">1900</span>
<span class="normal">1901</span>
<span class="normal">1902</span>
<span class="normal">1903</span>
<span class="normal">1904</span>
<span class="normal">1905</span>
<span class="normal">1906</span>
<span class="normal">1907</span>
<span class="normal">1908</span>
<span class="normal">1909</span>
<span class="normal">1910</span>
<span class="normal">1911</span>
<span class="normal">1912</span>
<span class="normal">1913</span>
<span class="normal">1914</span>
<span class="normal">1915</span>
<span class="normal">1916</span>
<span class="normal">1917</span>
<span class="normal">1918</span>
<span class="normal">1919</span>
<span class="normal">1920</span>
<span class="normal">1921</span>
<span class="normal">1922</span>
<span class="normal">1923</span>
<span class="normal">1924</span>
<span class="normal">1925</span>
<span class="normal">1926</span>
<span class="normal">1927</span>
<span class="normal">1928</span>
<span class="normal">1929</span>
<span class="normal">1930</span>
<span class="normal">1931</span>
<span class="normal">1932</span>
<span class="normal">1933</span>
<span class="normal">1934</span>
<span class="normal">1935</span>
<span class="normal">1936</span>
<span class="normal">1937</span>
<span class="normal">1938</span>
<span class="normal">1939</span>
<span class="normal">1940</span>
<span class="normal">1941</span>
<span class="normal">1942</span>
<span class="normal">1943</span>
<span class="normal">1944</span>
<span class="normal">1945</span>
<span class="normal">1946</span>
<span class="normal">1947</span>
<span class="normal">1948</span>
<span class="normal">1949</span>
<span class="normal">1950</span>
<span class="normal">1951</span>
<span class="normal">1952</span>
<span class="normal">1953</span>
<span class="normal">1954</span>
<span class="normal">1955</span>
<span class="normal">1956</span>
<span class="normal">1957</span>
<span class="normal">1958</span>
<span class="normal">1959</span>
<span class="normal">1960</span>
<span class="normal">1961</span>
<span class="normal">1962</span>
<span class="normal">1963</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_rainfall_runoff_chai</span><span class="p">(</span>
    <span class="n">t</span><span class="p">,</span>
    <span class="n">ps</span><span class="p">,</span>
    <span class="n">qs</span><span class="p">,</span>
    <span class="n">c_lst</span><span class="o">=</span><span class="s2">&quot;rbkgcmy&quot;</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Observation of Precipitation and Streamflow&quot;</span><span class="p">,</span>
    <span class="n">alpha_lst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">p_labels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">q_labels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates a two-panel rainfall-runoff plot following Chai&#39;s style.</span>

<span class="sd">    This function generates a figure with two vertically stacked panels: precipitation</span>
<span class="sd">    on top and streamflow below. It supports multiple precipitation sources and</span>
<span class="sd">    streamflow series with customizable styling.</span>

<span class="sd">    Args:</span>
<span class="sd">        t (array-like): Time points for x-axis.</span>
<span class="sd">        ps (list[np.array]): List of precipitation arrays from different sources.</span>
<span class="sd">        qs (list[np.array]): List of streamflow arrays (e.g., observed and simulated).</span>
<span class="sd">        c_lst (str, optional): String of color characters. Defaults to &quot;rbkgcmy&quot;.</span>
<span class="sd">        title (str, optional): Figure title. Defaults to &quot;Observation of Precipitation</span>
<span class="sd">            and Streamflow&quot;.</span>
<span class="sd">        alpha_lst (list[float], optional): Transparency values for each series.</span>
<span class="sd">            Defaults to [0.5, 0.5].</span>
<span class="sd">        p_labels (list[str], optional): Labels for precipitation sources.</span>
<span class="sd">            Defaults to [&quot;era5land&quot;, &quot;gauge&quot;].</span>
<span class="sd">        q_labels (list[str], optional): Labels for streamflow series.</span>
<span class="sd">            Defaults to [&quot;observation&quot;, &quot;simulation&quot;].</span>

<span class="sd">    Returns:</span>
<span class="sd">        Tuple[matplotlib.figure.Figure, matplotlib.axes.Axes]: The figure and bottom</span>
<span class="sd">            axes (streamflow plot).</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; # Create sample data</span>
<span class="sd">        &gt;&gt;&gt; t = pd.date_range(&#39;2020-01-01&#39;, &#39;2020-12-31&#39;, freq=&#39;D&#39;)</span>
<span class="sd">        &gt;&gt;&gt; # Two precipitation sources</span>
<span class="sd">        &gt;&gt;&gt; p1 = np.random.exponential(2, size=len(t))  # ERA5</span>
<span class="sd">        &gt;&gt;&gt; p2 = p1 * 1.2 + np.random.normal(0, 0.2, len(t))  # Gauge</span>
<span class="sd">        &gt;&gt;&gt; # Observed and simulated streamflow</span>
<span class="sd">        &gt;&gt;&gt; q_obs = np.convolve(p1, np.ones(5)/5, mode=&#39;same&#39;)</span>
<span class="sd">        &gt;&gt;&gt; q_sim = q_obs * 1.1 + np.random.normal(0, 0.1, len(q_obs))</span>
<span class="sd">        &gt;&gt;&gt; </span>
<span class="sd">        &gt;&gt;&gt; fig, ax = plot_rainfall_runoff_chai(</span>
<span class="sd">        ...     t, [p1, p2], [q_obs, q_sim],</span>
<span class="sd">        ...     title=&#39;2020 Rainfall-Runoff Comparison&#39;,</span>
<span class="sd">        ...     p_labels=[&#39;ERA5&#39;, &#39;Rain Gauge&#39;],</span>
<span class="sd">        ...     q_labels=[&#39;Observed&#39;, &#39;Simulated&#39;]</span>
<span class="sd">        ... )</span>

<span class="sd">    Notes:</span>
<span class="sd">        - Top panel shows precipitation with bars</span>
<span class="sd">        - Bottom panel shows streamflow with lines</span>
<span class="sd">        - Precipitation y-axis is inverted and blue</span>
<span class="sd">        - Streamflow y-axis is red</span>
<span class="sd">        - Both panels share x-axis limits</span>
<span class="sd">        - Legends included for both panels</span>
<span class="sd">        - Uses large figure size (20x8) by default</span>
<span class="sd">        - Includes &quot;Streamflow&quot; text box in bottom panel</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">alpha_lst</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">alpha_lst</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">p_labels</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">p_labels</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;era5land&quot;</span><span class="p">,</span> <span class="s2">&quot;gauge&quot;</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">q_labels</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">q_labels</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;observation&quot;</span><span class="p">,</span> <span class="s2">&quot;simulation&quot;</span><span class="p">]</span>
    <span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">ps</span><span class="p">):</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span>
            <span class="n">t</span><span class="p">,</span>
            <span class="n">p</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="n">c_lst</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
            <span class="n">label</span><span class="o">=</span><span class="n">p_labels</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
            <span class="n">width</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="n">alpha_lst</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
        <span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Precipitation (mm/d)&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;b&quot;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">invert_yaxis</span><span class="p">()</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">labelcolor</span><span class="o">=</span><span class="s2">&quot;b&quot;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">q</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">qs</span><span class="p">):</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">c_lst</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="n">q_labels</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha_lst</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Streamflow (m$^3$/s)&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">labelcolor</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">ax1</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">())</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
        <span class="mf">0.05</span><span class="p">,</span>
        <span class="mf">0.95</span><span class="p">,</span>
        <span class="s2">&quot;Streamflow&quot;</span><span class="p">,</span>
        <span class="n">transform</span><span class="o">=</span><span class="n">ax2</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span>
        <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>
        <span class="n">verticalalignment</span><span class="o">=</span><span class="s2">&quot;top&quot;</span><span class="p">,</span>
        <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">),</span>
    <span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax2</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="hydroutils.plot_rainfall_runoff_xu" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">plot_rainfall_runoff_xu</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">qs</span><span class="p">,</span> <span class="n">fig_size</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;prcp-streamflow&#39;</span><span class="p">,</span> <span class="n">leg_lst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;streamflow(m^3/s)&#39;</span><span class="p">,</span> <span class="n">prcp_ylabel</span><span class="o">=</span><span class="s1">&#39;prcp(mm/day)&#39;</span><span class="p">)</span></code>

<a href="#hydroutils.plot_rainfall_runoff_xu" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Creates a dual-axis plot for rainfall-runoff analysis with Xu's style.</p>
<p>This function generates a specialized plot with precipitation bars from the top
and streamflow lines on the bottom, following Xu's visualization style. It uses
dual y-axes with color-coded labels and ticks.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>t</code>
            </td>
            <td>
                  <code><span title="array">array</span> - <span title="like">like</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Time points for x-axis.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>p</code>
            </td>
            <td>
                  <code><span title="numpy.array">array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Precipitation values.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>qs</code>
            </td>
            <td>
                  <code><span title="tuple">tuple</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Tuple of (observed, predicted) streamflow values.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>fig_size</code>
            </td>
            <td>
                  <code><span title="tuple">tuple</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Figure size as (width, height). Defaults to (10, 6).</p>
              </div>
            </td>
            <td>
                  <code>(10, 6)</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>title</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Plot title. Defaults to "prcp-streamflow".</p>
              </div>
            </td>
            <td>
                  <code>&#39;prcp-streamflow&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>leg_lst</code>
            </td>
            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Legend labels. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ylabel</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Y-axis label for streamflow. Defaults to "streamflow(m^3/s)".</p>
              </div>
            </td>
            <td>
                  <code>&#39;streamflow(m^3/s)&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>prcp_ylabel</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Y-axis label for precipitation.
Defaults to "prcp(mm/day)".</p>
              </div>
            </td>
            <td>
                  <code>&#39;prcp(mm/day)&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span>
<span class="normal">9</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create sample data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="s1">&#39;2020-01-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2020-12-31&#39;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;datetime64[D]&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">exponential</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>  <span class="c1"># precipitation</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">obs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">)</span>  <span class="c1"># observed flow</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pred</span> <span class="o">=</span> <span class="n">obs</span> <span class="o">*</span> <span class="mf">1.1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">obs</span><span class="p">))</span>  <span class="c1"># predicted flow</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plot_rainfall_runoff_xu</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="p">(</span><span class="n">obs</span><span class="p">,</span> <span class="n">pred</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">title</span><span class="o">=</span><span class="s1">&#39;2020 Rainfall-Runoff Analysis&#39;</span>
<span class="gp">... </span><span class="p">)</span>
</code></pre></div></td></tr></table></div>


<details class="notes" open>
  <summary>Notes</summary>
  <ul>
<li>Precipitation shown as blue bars from top</li>
<li>Observed streamflow as solid green line</li>
<li>Predicted streamflow as dashed red line</li>
<li>Y-axes labels and ticks color-coded</li>
<li>Precipitation axis inverted</li>
<li>Legend positioned at upper left</li>
<li>Precipitation bars semi-transparent (alpha=0.6)</li>
</ul>
</details>

            <details class="quote">
              <summary>Source code in <code>hydroutils/hydro_plot.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1776</span>
<span class="normal">1777</span>
<span class="normal">1778</span>
<span class="normal">1779</span>
<span class="normal">1780</span>
<span class="normal">1781</span>
<span class="normal">1782</span>
<span class="normal">1783</span>
<span class="normal">1784</span>
<span class="normal">1785</span>
<span class="normal">1786</span>
<span class="normal">1787</span>
<span class="normal">1788</span>
<span class="normal">1789</span>
<span class="normal">1790</span>
<span class="normal">1791</span>
<span class="normal">1792</span>
<span class="normal">1793</span>
<span class="normal">1794</span>
<span class="normal">1795</span>
<span class="normal">1796</span>
<span class="normal">1797</span>
<span class="normal">1798</span>
<span class="normal">1799</span>
<span class="normal">1800</span>
<span class="normal">1801</span>
<span class="normal">1802</span>
<span class="normal">1803</span>
<span class="normal">1804</span>
<span class="normal">1805</span>
<span class="normal">1806</span>
<span class="normal">1807</span>
<span class="normal">1808</span>
<span class="normal">1809</span>
<span class="normal">1810</span>
<span class="normal">1811</span>
<span class="normal">1812</span>
<span class="normal">1813</span>
<span class="normal">1814</span>
<span class="normal">1815</span>
<span class="normal">1816</span>
<span class="normal">1817</span>
<span class="normal">1818</span>
<span class="normal">1819</span>
<span class="normal">1820</span>
<span class="normal">1821</span>
<span class="normal">1822</span>
<span class="normal">1823</span>
<span class="normal">1824</span>
<span class="normal">1825</span>
<span class="normal">1826</span>
<span class="normal">1827</span>
<span class="normal">1828</span>
<span class="normal">1829</span>
<span class="normal">1830</span>
<span class="normal">1831</span>
<span class="normal">1832</span>
<span class="normal">1833</span>
<span class="normal">1834</span>
<span class="normal">1835</span>
<span class="normal">1836</span>
<span class="normal">1837</span>
<span class="normal">1838</span>
<span class="normal">1839</span>
<span class="normal">1840</span>
<span class="normal">1841</span>
<span class="normal">1842</span>
<span class="normal">1843</span>
<span class="normal">1844</span>
<span class="normal">1845</span>
<span class="normal">1846</span>
<span class="normal">1847</span>
<span class="normal">1848</span>
<span class="normal">1849</span>
<span class="normal">1850</span>
<span class="normal">1851</span>
<span class="normal">1852</span>
<span class="normal">1853</span>
<span class="normal">1854</span>
<span class="normal">1855</span>
<span class="normal">1856</span>
<span class="normal">1857</span>
<span class="normal">1858</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_rainfall_runoff_xu</span><span class="p">(</span>
    <span class="n">t</span><span class="p">,</span>
    <span class="n">p</span><span class="p">,</span>
    <span class="n">qs</span><span class="p">,</span>
    <span class="n">fig_size</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;prcp-streamflow&quot;</span><span class="p">,</span>
    <span class="n">leg_lst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;streamflow(m^3/s)&quot;</span><span class="p">,</span>
    <span class="n">prcp_ylabel</span><span class="o">=</span><span class="s2">&quot;prcp(mm/day)&quot;</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates a dual-axis plot for rainfall-runoff analysis with Xu&#39;s style.</span>

<span class="sd">    This function generates a specialized plot with precipitation bars from the top</span>
<span class="sd">    and streamflow lines on the bottom, following Xu&#39;s visualization style. It uses</span>
<span class="sd">    dual y-axes with color-coded labels and ticks.</span>

<span class="sd">    Args:</span>
<span class="sd">        t (array-like): Time points for x-axis.</span>
<span class="sd">        p (np.array): Precipitation values.</span>
<span class="sd">        qs (tuple): Tuple of (observed, predicted) streamflow values.</span>
<span class="sd">        fig_size (tuple, optional): Figure size as (width, height). Defaults to (10, 6).</span>
<span class="sd">        title (str, optional): Plot title. Defaults to &quot;prcp-streamflow&quot;.</span>
<span class="sd">        leg_lst (list, optional): Legend labels. Defaults to None.</span>
<span class="sd">        ylabel (str, optional): Y-axis label for streamflow. Defaults to &quot;streamflow(m^3/s)&quot;.</span>
<span class="sd">        prcp_ylabel (str, optional): Y-axis label for precipitation.</span>
<span class="sd">            Defaults to &quot;prcp(mm/day)&quot;.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; # Create sample data</span>
<span class="sd">        &gt;&gt;&gt; t = np.arange(&#39;2020-01-01&#39;, &#39;2020-12-31&#39;, dtype=&#39;datetime64[D]&#39;)</span>
<span class="sd">        &gt;&gt;&gt; p = np.random.exponential(2, size=len(t))  # precipitation</span>
<span class="sd">        &gt;&gt;&gt; obs = np.convolve(p, np.ones(5)/5, mode=&#39;same&#39;)  # observed flow</span>
<span class="sd">        &gt;&gt;&gt; pred = obs * 1.1 + np.random.normal(0, 0.1, len(obs))  # predicted flow</span>
<span class="sd">        &gt;&gt;&gt; plot_rainfall_runoff_xu(</span>
<span class="sd">        ...     t, p, (obs, pred),</span>
<span class="sd">        ...     title=&#39;2020 Rainfall-Runoff Analysis&#39;</span>
<span class="sd">        ... )</span>

<span class="sd">    Notes:</span>
<span class="sd">        - Precipitation shown as blue bars from top</span>
<span class="sd">        - Observed streamflow as solid green line</span>
<span class="sd">        - Predicted streamflow as dashed red line</span>
<span class="sd">        - Y-axes labels and ticks color-coded</span>
<span class="sd">        - Precipitation axis inverted</span>
<span class="sd">        - Legend positioned at upper left</span>
<span class="sd">        - Precipitation bars semi-transparent (alpha=0.6)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">obs</span><span class="p">,</span> <span class="n">pred</span> <span class="o">=</span> <span class="n">qs</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">fig_size</span><span class="p">)</span>

    <span class="n">ax1</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Precipitation&quot;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">prcp_ylabel</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">labelcolor</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">)</span>

    <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">p</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">*</span> <span class="mi">5</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">invert_yaxis</span><span class="p">()</span>

    <span class="n">ax2</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>

    <span class="c1"># transform the unit of obs and pred</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <span class="n">t</span><span class="p">,</span>
        <span class="n">obs</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">,</span>
        <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="s2">&quot;observed value&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <span class="n">t</span><span class="p">,</span>
        <span class="n">pred</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span>
        <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="s2">&quot;predicted value&quot;</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">labelcolor</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper left&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="hydroutils.plot_scatter_with_11line" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">plot_scatter_with_11line</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">point_color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">line_color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span> <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span> <span class="n">xlabel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#hydroutils.plot_scatter_with_11line" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Creates a scatter plot comparing two variables with a 1:1 line.</p>
<p>This function generates a scatter plot with a 1:1 line (diagonal) for comparing
two variables, commonly used in model evaluation to compare observed vs predicted values.
The plot includes customizable colors, axis limits, and labels.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>x</code>
            </td>
            <td>
                  <code><span title="numpy.array">array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>First variable to be plotted (typically observed values).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>y</code>
            </td>
            <td>
                  <code><span title="numpy.array">array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Second variable to be plotted (typically predicted values).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>point_color</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Color of scatter points. Defaults to "blue".</p>
              </div>
            </td>
            <td>
                  <code>&#39;blue&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>line_color</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Color of the 1:1 line. Defaults to "black".</p>
              </div>
            </td>
            <td>
                  <code>&#39;black&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>xlim</code>
            </td>
            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>X-axis range as [min, max]. Defaults to [0.0, 1.0].</p>
              </div>
            </td>
            <td>
                  <code>[0.0, 1.0]</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ylim</code>
            </td>
            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Y-axis range as [min, max]. Defaults to [0.0, 1.0].</p>
              </div>
            </td>
            <td>
                  <code>[0.0, 1.0]</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>xlabel</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Label for x-axis. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ylabel</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Label for y-axis. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>tuple[matplotlib.figure.Figure, matplotlib.axes.Axes]: 
A tuple containing the figure and axes objects.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span>
<span class="normal">9</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">obs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">2.2</span><span class="p">,</span> <span class="mf">2.9</span><span class="p">,</span> <span class="mf">4.1</span><span class="p">,</span> <span class="mf">5.2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plot_scatter_with_11line</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">obs</span><span class="p">,</span> <span class="n">pred</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Observed&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Predicted&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
<span class="gp">... </span>    <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>
<span class="gp">... </span><span class="p">)</span>
</code></pre></div></td></tr></table></div>


            <details class="quote">
              <summary>Source code in <code>hydroutils/hydro_plot.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_scatter_with_11line</span><span class="p">(</span>
    <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">,</span>
    <span class="n">y</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">,</span>
    <span class="n">point_color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span>
    <span class="n">line_color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span>
    <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span>
    <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span>
    <span class="n">xlabel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">ylabel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates a scatter plot comparing two variables with a 1:1 line.</span>

<span class="sd">    This function generates a scatter plot with a 1:1 line (diagonal) for comparing</span>
<span class="sd">    two variables, commonly used in model evaluation to compare observed vs predicted values.</span>
<span class="sd">    The plot includes customizable colors, axis limits, and labels.</span>

<span class="sd">    Args:</span>
<span class="sd">        x (np.array): First variable to be plotted (typically observed values).</span>
<span class="sd">        y (np.array): Second variable to be plotted (typically predicted values).</span>
<span class="sd">        point_color (str, optional): Color of scatter points. Defaults to &quot;blue&quot;.</span>
<span class="sd">        line_color (str, optional): Color of the 1:1 line. Defaults to &quot;black&quot;.</span>
<span class="sd">        xlim (list, optional): X-axis range as [min, max]. Defaults to [0.0, 1.0].</span>
<span class="sd">        ylim (list, optional): Y-axis range as [min, max]. Defaults to [0.0, 1.0].</span>
<span class="sd">        xlabel (str, optional): Label for x-axis. Defaults to None.</span>
<span class="sd">        ylabel (str, optional): Label for y-axis. Defaults to None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple[matplotlib.figure.Figure, matplotlib.axes.Axes]: </span>
<span class="sd">            A tuple containing the figure and axes objects.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; obs = np.array([1, 2, 3, 4, 5])</span>
<span class="sd">        &gt;&gt;&gt; pred = np.array([1.1, 2.2, 2.9, 4.1, 5.2])</span>
<span class="sd">        &gt;&gt;&gt; fig, ax = plot_scatter_with_11line(</span>
<span class="sd">        ...     obs, pred,</span>
<span class="sd">        ...     xlabel=&#39;Observed&#39;,</span>
<span class="sd">        ...     ylabel=&#39;Predicted&#39;,</span>
<span class="sd">        ...     xlim=[0, 6],</span>
<span class="sd">        ...     ylim=[0, 6]</span>
<span class="sd">        ... )</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
    <span class="c1"># set background color for ax</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_facecolor</span><span class="p">(</span><span class="s2">&quot;whitesmoke&quot;</span><span class="p">)</span>
    <span class="c1"># plot the grid of the figure</span>
    <span class="c1"># plt.grid(color=&quot;whitesmoke&quot;)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">point_color</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">line</span> <span class="o">=</span> <span class="n">mlines</span><span class="o">.</span><span class="n">Line2D</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">line_color</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">)</span>
    <span class="n">transform</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span>
    <span class="n">line</span><span class="o">.</span><span class="n">set_transform</span><span class="p">(</span><span class="n">transform</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">add_line</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">xlim</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ylim</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">xlim</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mf">0.1</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">ylim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ylim</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mf">0.1</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="c1"># set xlable and ylabel</span>
    <span class="k">if</span> <span class="n">xlabel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">xlabel</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">ylabel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;bottom&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="hydroutils.plot_scatter_xyc" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">plot_scatter_xyc</span><span class="p">(</span><span class="n">x_label</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y_label</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">c_label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">is_reg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ylim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">quadrant</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#hydroutils.plot_scatter_xyc" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Creates a scatter plot with optional color mapping and quadrant analysis.</p>
<p>This function generates a scatter plot with optional color mapping for points,
regression line, and quadrant analysis. It's particularly useful for analyzing
relationships between variables with an additional dimension represented by color.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>x_label</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Label for x-axis.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>x</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="numpy.array">array</span>, <span title="hydroutils.hydro_stat.List">List</span>[<span title="numpy.array">array</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>X-axis data values.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>y_label</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Label for y-axis.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>y</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="numpy.array">array</span>, <span title="hydroutils.hydro_stat.List">List</span>[<span title="numpy.array">array</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Y-axis data values.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>c_label</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="str">str</span>, <span title="hydroutils.hydro_stat.List">List</span>[<span title="str">str</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Label(s) for color mapping or
multiple series. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>c</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="numpy.array">array</span>, <span title="hydroutils.hydro_stat.List">List</span>[<span title="str">str</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Values for color mapping or
colors for multiple series. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>size</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Size of scatter points. Defaults to 20.</p>
              </div>
            </td>
            <td>
                  <code>20</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>is_reg</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, adds regression line. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>xlim</code>
            </td>
            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>X-axis limits as [min, max]. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ylim</code>
            </td>
            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Y-axis limits as [min, max]. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>quadrant</code>
            </td>
            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Reference points [x, y] for quadrant analysis.
Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Simple scatter plot</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plot_scatter_xyc</span><span class="p">(</span>
<span class="gp">... </span>    <span class="s1">&#39;X Values&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s1">&#39;Y Values&#39;</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">is_reg</span><span class="o">=</span><span class="kc">True</span>
<span class="gp">... </span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Scatter plot with color mapping</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plot_scatter_xyc</span><span class="p">(</span>
<span class="gp">... </span>    <span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">c_label</span><span class="o">=</span><span class="s1">&#39;Z Values&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">c</span><span class="o">=</span><span class="n">c</span>
<span class="gp">... </span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Quadrant analysis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plot_scatter_xyc</span><span class="p">(</span>
<span class="gp">... </span>    <span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">quadrant</span><span class="o">=</span><span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>
<span class="gp">... </span>    <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="gp">... </span>    <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="gp">... </span><span class="p">)</span>
</code></pre></div></td></tr></table></div>


<details class="notes" open>
  <summary>Notes</summary>
  <ul>
<li>Supports both single and multiple series plotting</li>
<li>Automatically handles NaN values</li>
<li>Provides quadrant statistics when quadrant analysis is enabled</li>
<li>Uses clean plotting style with minimal spines</li>
<li>Supports regression line with seaborn's regplot</li>
</ul>
</details>

            <details class="quote">
              <summary>Source code in <code>hydroutils/hydro_plot.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_scatter_xyc</span><span class="p">(</span>
    <span class="n">x_label</span><span class="p">,</span>
    <span class="n">x</span><span class="p">,</span>
    <span class="n">y_label</span><span class="p">,</span>
    <span class="n">y</span><span class="p">,</span>
    <span class="n">c_label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">c</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
    <span class="n">is_reg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">xlim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">ylim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">quadrant</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates a scatter plot with optional color mapping and quadrant analysis.</span>

<span class="sd">    This function generates a scatter plot with optional color mapping for points,</span>
<span class="sd">    regression line, and quadrant analysis. It&#39;s particularly useful for analyzing</span>
<span class="sd">    relationships between variables with an additional dimension represented by color.</span>

<span class="sd">    Args:</span>
<span class="sd">        x_label (str): Label for x-axis.</span>
<span class="sd">        x (Union[np.array, List[np.array]]): X-axis data values.</span>
<span class="sd">        y_label (str): Label for y-axis.</span>
<span class="sd">        y (Union[np.array, List[np.array]]): Y-axis data values.</span>
<span class="sd">        c_label (Union[str, List[str]], optional): Label(s) for color mapping or</span>
<span class="sd">            multiple series. Defaults to None.</span>
<span class="sd">        c (Union[np.array, List[str]], optional): Values for color mapping or</span>
<span class="sd">            colors for multiple series. Defaults to None.</span>
<span class="sd">        size (int, optional): Size of scatter points. Defaults to 20.</span>
<span class="sd">        is_reg (bool, optional): If True, adds regression line. Defaults to False.</span>
<span class="sd">        xlim (list, optional): X-axis limits as [min, max]. Defaults to None.</span>
<span class="sd">        ylim (list, optional): Y-axis limits as [min, max]. Defaults to None.</span>
<span class="sd">        quadrant (list, optional): Reference points [x, y] for quadrant analysis.</span>
<span class="sd">            Defaults to None.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; # Simple scatter plot</span>
<span class="sd">        &gt;&gt;&gt; x = np.random.rand(100)</span>
<span class="sd">        &gt;&gt;&gt; y = x + np.random.normal(0, 0.1, 100)</span>
<span class="sd">        &gt;&gt;&gt; plot_scatter_xyc(</span>
<span class="sd">        ...     &#39;X Values&#39;, x,</span>
<span class="sd">        ...     &#39;Y Values&#39;, y,</span>
<span class="sd">        ...     is_reg=True</span>
<span class="sd">        ... )</span>

<span class="sd">        &gt;&gt;&gt; # Scatter plot with color mapping</span>
<span class="sd">        &gt;&gt;&gt; c = np.random.rand(100)</span>
<span class="sd">        &gt;&gt;&gt; plot_scatter_xyc(</span>
<span class="sd">        ...     &#39;X&#39;, x, &#39;Y&#39;, y,</span>
<span class="sd">        ...     c_label=&#39;Z Values&#39;,</span>
<span class="sd">        ...     c=c</span>
<span class="sd">        ... )</span>

<span class="sd">        &gt;&gt;&gt; # Quadrant analysis</span>
<span class="sd">        &gt;&gt;&gt; plot_scatter_xyc(</span>
<span class="sd">        ...     &#39;X&#39;, x, &#39;Y&#39;, y,</span>
<span class="sd">        ...     quadrant=[0.5, 0.5],</span>
<span class="sd">        ...     xlim=[0, 1],</span>
<span class="sd">        ...     ylim=[0, 1]</span>
<span class="sd">        ... )</span>

<span class="sd">    Notes:</span>
<span class="sd">        - Supports both single and multiple series plotting</span>
<span class="sd">        - Automatically handles NaN values</span>
<span class="sd">        - Provides quadrant statistics when quadrant analysis is enabled</span>
<span class="sd">        - Uses clean plotting style with minimal spines</span>
<span class="sd">        - Supports regression line with seaborn&#39;s regplot</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)):</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
                <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="n">size</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">c_label</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">c</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

    <span class="k">elif</span> <span class="n">c</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="n">x_label</span><span class="p">:</span> <span class="n">x</span><span class="p">,</span> <span class="n">y_label</span><span class="p">:</span> <span class="n">y</span><span class="p">})</span>
        <span class="n">points</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">x_label</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="n">y_label</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">quadrant</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">quadrant</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;grey&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">quadrant</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;grey&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">)</span>
            <span class="n">q2</span> <span class="o">=</span> <span class="n">df</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="n">x_label</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">y_label</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">q3</span> <span class="o">=</span> <span class="n">df</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="n">x_label</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">y_label</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">q4</span> <span class="o">=</span> <span class="n">df</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="n">x_label</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">y_label</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">q5</span> <span class="o">=</span> <span class="n">df</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="n">x_label</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">y_label</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">q1</span> <span class="o">=</span> <span class="n">df</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="n">x_label</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">y_label</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">q</span> <span class="o">=</span> <span class="n">q1</span> <span class="o">+</span> <span class="n">q2</span> <span class="o">+</span> <span class="n">q3</span> <span class="o">+</span> <span class="n">q4</span> <span class="o">+</span> <span class="n">q5</span>
            <span class="n">r1</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">q1</span> <span class="o">/</span> <span class="n">q</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span>
            <span class="n">r2</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">q2</span> <span class="o">/</span> <span class="n">q</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span>
            <span class="n">r3</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">q3</span> <span class="o">/</span> <span class="n">q</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span>
            <span class="n">r4</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">q4</span> <span class="o">/</span> <span class="n">q</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span>
            <span class="n">r5</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">-</span> <span class="n">r1</span> <span class="o">-</span> <span class="n">r2</span> <span class="o">-</span> <span class="n">r3</span> <span class="o">-</span> <span class="n">r4</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
                <span class="n">xlim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="p">(</span><span class="n">xlim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="mf">0.1</span><span class="p">,</span>
                <span class="n">ylim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="p">(</span><span class="n">ylim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">ylim</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="mf">0.1</span><span class="p">,</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">r1</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">,</span>
                <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
                <span class="n">xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">xlim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="mf">0.1</span><span class="p">,</span>
                <span class="n">ylim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="p">(</span><span class="n">ylim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">ylim</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="mf">0.1</span><span class="p">,</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">r2</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">,</span>
                <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
                <span class="n">xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">xlim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="mf">0.1</span><span class="p">,</span>
                <span class="n">ylim</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">ylim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">ylim</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="mf">0.1</span><span class="p">,</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">r3</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">,</span>
                <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
                <span class="n">xlim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="p">(</span><span class="n">xlim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="mf">0.1</span><span class="p">,</span>
                <span class="n">ylim</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">ylim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">ylim</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="mf">0.1</span><span class="p">,</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">r4</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">,</span>
                <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">r5</span><span class="p">)</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="n">x_label</span><span class="p">:</span> <span class="n">x</span><span class="p">,</span> <span class="n">y_label</span><span class="p">:</span> <span class="n">y</span><span class="p">,</span> <span class="n">c_label</span><span class="p">:</span> <span class="n">c</span><span class="p">})</span>
        <span class="n">points</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
            <span class="n">df</span><span class="p">[</span><span class="n">x_label</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="n">y_label</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">c_label</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="n">size</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;Spectral&quot;</span>
        <span class="p">)</span>  <span class="c1"># set style options</span>
        <span class="c1"># add a color bar</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>

    <span class="c1"># set limits</span>
    <span class="k">if</span> <span class="n">xlim</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">xlim</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">ylim</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="n">ylim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ylim</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="c1"># Hide the right and top spines</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="c1"># build the regression plot</span>
    <span class="k">if</span> <span class="n">is_reg</span><span class="p">:</span>
        <span class="n">plot</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">regplot</span><span class="p">(</span><span class="n">x_label</span><span class="p">,</span> <span class="n">y_label</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">scatter</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>  <span class="c1"># , color=&quot;.1&quot;</span>
        <span class="n">plot</span> <span class="o">=</span> <span class="n">plot</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="n">x_label</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="n">y_label</span><span class="p">)</span>  <span class="c1"># add labels</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">x_label</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="n">y_label</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="hydroutils.plot_ts" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">plot_ts</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">t_bar</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fig_size</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">c_lst</span><span class="o">=</span><span class="s1">&#39;rbkgcmyrbkgcmyrbkgcmy&#39;</span><span class="p">,</span> <span class="n">leg_lst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">marker_lst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">linespec</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dash_lines</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span></code>

<a href="#hydroutils.plot_ts" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Plot time series for multi arrays with matplotlib</p>
<h4 id="hydroutils.plot_ts--parameters">Parameters<a class="headerlink" href="#hydroutils.plot_ts--parameters" title="Permanent link">&para;</a></h4>
<p>t : Union[list, np.array]
    time series but not just date; it can also be numbers like 1, 2, 3, ...
y : Union[list, np.array]
    shown data series; the len of y should be equal to t's
ax : <em>type</em>, optional
    <em>description</em>, by default None
t_bar : <em>type</em>, optional
    <em>description</em>, by default None
title : <em>type</em>, optional
    <em>description</em>, by default None
xlabel: str, optional
    the name of x axis, by default None
ylabel : str, optional
    the name of y axis, by default None
fig_size : tuple, optional
    <em>description</em>, by default (12, 4)
c_lst : str, optional
    <em>description</em>, by default "rbkgcmy"
leg_lst : <em>type</em>, optional
    <em>description</em>, by default None
marker_lst : <em>type</em>, optional
    <em>description</em>, by default None
linewidth : int, optional
    <em>description</em>, by default 2
linespec : <em>type</em>, optional
    <em>description</em>, by default None
dash_lines : <em>type</em>, optional
    if dash_line, then we will plot dashed line, by default None</p>
<h4 id="hydroutils.plot_ts--returns">Returns<a class="headerlink" href="#hydroutils.plot_ts--returns" title="Permanent link">&para;</a></h4>
<p><em>type</em>
    <em>description</em></p>


            <details class="quote">
              <summary>Source code in <code>hydroutils/hydro_plot.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span>
<span class="normal">845</span>
<span class="normal">846</span>
<span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span>
<span class="normal">851</span>
<span class="normal">852</span>
<span class="normal">853</span>
<span class="normal">854</span>
<span class="normal">855</span>
<span class="normal">856</span>
<span class="normal">857</span>
<span class="normal">858</span>
<span class="normal">859</span>
<span class="normal">860</span>
<span class="normal">861</span>
<span class="normal">862</span>
<span class="normal">863</span>
<span class="normal">864</span>
<span class="normal">865</span>
<span class="normal">866</span>
<span class="normal">867</span>
<span class="normal">868</span>
<span class="normal">869</span>
<span class="normal">870</span>
<span class="normal">871</span>
<span class="normal">872</span>
<span class="normal">873</span>
<span class="normal">874</span>
<span class="normal">875</span>
<span class="normal">876</span>
<span class="normal">877</span>
<span class="normal">878</span>
<span class="normal">879</span>
<span class="normal">880</span>
<span class="normal">881</span>
<span class="normal">882</span>
<span class="normal">883</span>
<span class="normal">884</span>
<span class="normal">885</span>
<span class="normal">886</span>
<span class="normal">887</span>
<span class="normal">888</span>
<span class="normal">889</span>
<span class="normal">890</span>
<span class="normal">891</span>
<span class="normal">892</span>
<span class="normal">893</span>
<span class="normal">894</span>
<span class="normal">895</span>
<span class="normal">896</span>
<span class="normal">897</span>
<span class="normal">898</span>
<span class="normal">899</span>
<span class="normal">900</span>
<span class="normal">901</span>
<span class="normal">902</span>
<span class="normal">903</span>
<span class="normal">904</span>
<span class="normal">905</span>
<span class="normal">906</span>
<span class="normal">907</span>
<span class="normal">908</span>
<span class="normal">909</span>
<span class="normal">910</span>
<span class="normal">911</span>
<span class="normal">912</span>
<span class="normal">913</span>
<span class="normal">914</span>
<span class="normal">915</span>
<span class="normal">916</span>
<span class="normal">917</span>
<span class="normal">918</span>
<span class="normal">919</span>
<span class="normal">920</span>
<span class="normal">921</span>
<span class="normal">922</span>
<span class="normal">923</span>
<span class="normal">924</span>
<span class="normal">925</span>
<span class="normal">926</span>
<span class="normal">927</span>
<span class="normal">928</span>
<span class="normal">929</span>
<span class="normal">930</span>
<span class="normal">931</span>
<span class="normal">932</span>
<span class="normal">933</span>
<span class="normal">934</span>
<span class="normal">935</span>
<span class="normal">936</span>
<span class="normal">937</span>
<span class="normal">938</span>
<span class="normal">939</span>
<span class="normal">940</span>
<span class="normal">941</span>
<span class="normal">942</span>
<span class="normal">943</span>
<span class="normal">944</span>
<span class="normal">945</span>
<span class="normal">946</span>
<span class="normal">947</span>
<span class="normal">948</span>
<span class="normal">949</span>
<span class="normal">950</span>
<span class="normal">951</span>
<span class="normal">952</span>
<span class="normal">953</span>
<span class="normal">954</span>
<span class="normal">955</span>
<span class="normal">956</span>
<span class="normal">957</span>
<span class="normal">958</span>
<span class="normal">959</span>
<span class="normal">960</span>
<span class="normal">961</span>
<span class="normal">962</span>
<span class="normal">963</span>
<span class="normal">964</span>
<span class="normal">965</span>
<span class="normal">966</span>
<span class="normal">967</span>
<span class="normal">968</span>
<span class="normal">969</span>
<span class="normal">970</span>
<span class="normal">971</span>
<span class="normal">972</span>
<span class="normal">973</span>
<span class="normal">974</span>
<span class="normal">975</span>
<span class="normal">976</span>
<span class="normal">977</span>
<span class="normal">978</span>
<span class="normal">979</span>
<span class="normal">980</span>
<span class="normal">981</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_ts</span><span class="p">(</span>
    <span class="n">t</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">list</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">],</span>
    <span class="n">y</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">list</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">],</span>
    <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">t_bar</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">xlabel</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">ylabel</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">fig_size</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>
    <span class="n">c_lst</span><span class="o">=</span><span class="s2">&quot;rbkgcmyrbkgcmyrbkgcmy&quot;</span><span class="p">,</span>
    <span class="n">leg_lst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">marker_lst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">linespec</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">dash_lines</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plot time series for multi arrays with matplotlib</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    t : Union[list, np.array]</span>
<span class="sd">        time series but not just date; it can also be numbers like 1, 2, 3, ...</span>
<span class="sd">    y : Union[list, np.array]</span>
<span class="sd">        shown data series; the len of y should be equal to t&#39;s</span>
<span class="sd">    ax : _type_, optional</span>
<span class="sd">        _description_, by default None</span>
<span class="sd">    t_bar : _type_, optional</span>
<span class="sd">        _description_, by default None</span>
<span class="sd">    title : _type_, optional</span>
<span class="sd">        _description_, by default None</span>
<span class="sd">    xlabel: str, optional</span>
<span class="sd">        the name of x axis, by default None</span>
<span class="sd">    ylabel : str, optional</span>
<span class="sd">        the name of y axis, by default None</span>
<span class="sd">    fig_size : tuple, optional</span>
<span class="sd">        _description_, by default (12, 4)</span>
<span class="sd">    c_lst : str, optional</span>
<span class="sd">        _description_, by default &quot;rbkgcmy&quot;</span>
<span class="sd">    leg_lst : _type_, optional</span>
<span class="sd">        _description_, by default None</span>
<span class="sd">    marker_lst : _type_, optional</span>
<span class="sd">        _description_, by default None</span>
<span class="sd">    linewidth : int, optional</span>
<span class="sd">        _description_, by default 2</span>
<span class="sd">    linespec : _type_, optional</span>
<span class="sd">        _description_, by default None</span>
<span class="sd">    dash_lines : _type_, optional</span>
<span class="sd">        if dash_line, then we will plot dashed line, by default None</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    _type_</span>
<span class="sd">        _description_</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">is_new_fig</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">fig_size</span><span class="p">)</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
        <span class="n">is_new_fig</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">if</span> <span class="n">dash_lines</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dash_lines</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">dash_lines</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="c1"># dash_lines[-1] = True</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="ow">is</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
        <span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="n">y</span><span class="p">]</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">linewidth</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">list</span><span class="p">:</span>
        <span class="n">linewidth</span> <span class="o">=</span> <span class="p">[</span><span class="n">linewidth</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">list</span><span class="p">:</span>
        <span class="n">alpha</span> <span class="o">=</span> <span class="p">[</span><span class="n">alpha</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)):</span>
        <span class="n">tt</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span> <span class="k">else</span> <span class="n">t</span>
        <span class="n">yy</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
        <span class="n">leg_str</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">leg_lst</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">leg_str</span> <span class="o">=</span> <span class="n">leg_lst</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">marker_lst</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="p">(</span><span class="n">line_i</span><span class="p">,)</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tt</span><span class="p">,</span> <span class="n">yy</span><span class="p">,</span> <span class="s2">&quot;*&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">c_lst</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="n">leg_str</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                <span class="k">if</span> <span class="kc">True</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">yy</span><span class="p">)</span>
                <span class="k">else</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
                    <span class="n">tt</span><span class="p">,</span>
                    <span class="n">yy</span><span class="p">,</span>
                    <span class="n">color</span><span class="o">=</span><span class="n">c_lst</span><span class="p">[</span><span class="n">k</span><span class="p">],</span>
                    <span class="n">label</span><span class="o">=</span><span class="n">leg_str</span><span class="p">,</span>
                    <span class="n">linewidth</span><span class="o">=</span><span class="n">linewidth</span><span class="p">[</span><span class="n">k</span><span class="p">],</span>
                    <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">[</span><span class="n">k</span><span class="p">],</span>
                <span class="p">)</span>
            <span class="p">)</span>
        <span class="k">elif</span> <span class="n">marker_lst</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;-&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">linespec</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="p">(</span><span class="n">line_i</span><span class="p">,)</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
                    <span class="n">tt</span><span class="p">,</span>
                    <span class="n">yy</span><span class="p">,</span>
                    <span class="n">color</span><span class="o">=</span><span class="n">c_lst</span><span class="p">[</span><span class="n">k</span><span class="p">],</span>
                    <span class="n">label</span><span class="o">=</span><span class="n">leg_str</span><span class="p">,</span>
                    <span class="n">linestyle</span><span class="o">=</span><span class="n">linespec</span><span class="p">[</span><span class="n">k</span><span class="p">],</span>
                    <span class="n">lw</span><span class="o">=</span><span class="n">linewidth</span><span class="p">[</span><span class="n">k</span><span class="p">],</span>
                    <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">[</span><span class="n">k</span><span class="p">],</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="p">(</span><span class="n">line_i</span><span class="p">,)</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
                    <span class="n">tt</span><span class="p">,</span>
                    <span class="n">yy</span><span class="p">,</span>
                    <span class="n">color</span><span class="o">=</span><span class="n">c_lst</span><span class="p">[</span><span class="n">k</span><span class="p">],</span>
                    <span class="n">label</span><span class="o">=</span><span class="n">leg_str</span><span class="p">,</span>
                    <span class="n">lw</span><span class="o">=</span><span class="n">linewidth</span><span class="p">[</span><span class="n">k</span><span class="p">],</span>
                    <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">[</span><span class="n">k</span><span class="p">],</span>
                <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="p">(</span><span class="n">line_i</span><span class="p">,)</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
                <span class="n">tt</span><span class="p">,</span>
                <span class="n">yy</span><span class="p">,</span>
                <span class="n">color</span><span class="o">=</span><span class="n">c_lst</span><span class="p">[</span><span class="n">k</span><span class="p">],</span>
                <span class="n">label</span><span class="o">=</span><span class="n">leg_str</span><span class="p">,</span>
                <span class="n">marker</span><span class="o">=</span><span class="n">marker_lst</span><span class="p">[</span><span class="n">k</span><span class="p">],</span>
                <span class="n">lw</span><span class="o">=</span><span class="n">linewidth</span><span class="p">[</span><span class="n">k</span><span class="p">],</span>
                <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">[</span><span class="n">k</span><span class="p">],</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="n">dash_lines</span><span class="p">[</span><span class="n">k</span><span class="p">]:</span>
            <span class="n">line_i</span><span class="o">.</span><span class="n">set_dashes</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">ylabel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">xlabel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">xlabel</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">t_bar</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ylim</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span>
        <span class="n">t_bar</span> <span class="o">=</span> <span class="p">[</span><span class="n">t_bar</span><span class="p">]</span> <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">t_bar</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">list</span> <span class="k">else</span> <span class="n">t_bar</span>
        <span class="k">for</span> <span class="n">tt</span> <span class="ow">in</span> <span class="n">t_bar</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">tt</span><span class="p">,</span> <span class="n">tt</span><span class="p">],</span> <span class="n">ylim</span><span class="p">,</span> <span class="s2">&quot;-k&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">leg_lst</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper right&quot;</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;size&quot;</span><span class="p">:</span> <span class="mi">16</span><span class="p">})</span>
    <span class="k">if</span> <span class="n">title</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">fontdict</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;fontsize&quot;</span><span class="p">:</span> <span class="mi">17</span><span class="p">})</span>
    <span class="c1"># plot the grid of the figure</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="c1"># Hide the right and top spines</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span> <span class="k">if</span> <span class="n">is_new_fig</span> <span class="k">else</span> <span class="n">ax</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="hydroutils.plot_ts_map" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">plot_ts_map</span><span class="p">(</span><span class="n">dataMap</span><span class="p">,</span> <span class="n">dataTs</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">sites_id</span><span class="p">,</span> <span class="n">pertile_range</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#hydroutils.plot_ts_map" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Creates an interactive map with linked time series plots.</p>
<p>This function generates a figure with two subplots: a map on top and a time series
plot below. Clicking on a location in the map updates the time series plot to show
data from the nearest site.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>dataMap</code>
            </td>
            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Data values to be shown on the map.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dataTs</code>
            </td>
            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of time series data for each site.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>lat</code>
            </td>
            <td>
                  <code><span title="numpy.array">array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Latitude values for each site.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>lon</code>
            </td>
            <td>
                  <code><span title="numpy.array">array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Longitude values for each site.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>t</code>
            </td>
            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Time points for x-axis of time series.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>sites_id</code>
            </td>
            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Identifiers for each site.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>pertile_range</code>
            </td>
            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Percentile range for color scaling on map.
Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create sample data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n_sites</span> <span class="o">=</span> <span class="mi">10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n_times</span> <span class="o">=</span> <span class="mi">100</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="n">n_sites</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lon</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mi">120</span><span class="p">,</span> <span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="n">n_sites</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sites_id</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;SITE_</span><span class="si">{</span><span class="n">i</span><span class="si">:</span><span class="s1">03d</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_sites</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Generate sample time series for each site</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n_times</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dataTs</span> <span class="o">=</span> <span class="p">[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_sites</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">/</span><span class="mi">10</span> <span class="o">+</span> <span class="n">i</span><span class="o">/</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">obs</span> <span class="o">=</span> <span class="n">pred</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="n">n_times</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">dataTs</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">pred</span><span class="p">,</span> <span class="n">obs</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Map data could be mean values</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dataMap</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">ts</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="k">for</span> <span class="n">ts</span> <span class="ow">in</span> <span class="n">dataTs</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plot_ts_map</span><span class="p">(</span><span class="n">dataMap</span><span class="p">,</span> <span class="n">dataTs</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">sites_id</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>


<details class="notes" open>
  <summary>Notes</summary>
  <ul>
<li>Uses TkAgg backend for interactive display</li>
<li>Map uses Cartopy for proper geographic projection</li>
<li>Time series updates automatically on map click</li>
<li>Shows site ID and coordinates in time series title</li>
<li>Finds nearest site to click location</li>
<li>Both predicted and observed values shown in time series</li>
</ul>
</details>

            <details class="quote">
              <summary>Source code in <code>hydroutils/hydro_plot.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1571</span>
<span class="normal">1572</span>
<span class="normal">1573</span>
<span class="normal">1574</span>
<span class="normal">1575</span>
<span class="normal">1576</span>
<span class="normal">1577</span>
<span class="normal">1578</span>
<span class="normal">1579</span>
<span class="normal">1580</span>
<span class="normal">1581</span>
<span class="normal">1582</span>
<span class="normal">1583</span>
<span class="normal">1584</span>
<span class="normal">1585</span>
<span class="normal">1586</span>
<span class="normal">1587</span>
<span class="normal">1588</span>
<span class="normal">1589</span>
<span class="normal">1590</span>
<span class="normal">1591</span>
<span class="normal">1592</span>
<span class="normal">1593</span>
<span class="normal">1594</span>
<span class="normal">1595</span>
<span class="normal">1596</span>
<span class="normal">1597</span>
<span class="normal">1598</span>
<span class="normal">1599</span>
<span class="normal">1600</span>
<span class="normal">1601</span>
<span class="normal">1602</span>
<span class="normal">1603</span>
<span class="normal">1604</span>
<span class="normal">1605</span>
<span class="normal">1606</span>
<span class="normal">1607</span>
<span class="normal">1608</span>
<span class="normal">1609</span>
<span class="normal">1610</span>
<span class="normal">1611</span>
<span class="normal">1612</span>
<span class="normal">1613</span>
<span class="normal">1614</span>
<span class="normal">1615</span>
<span class="normal">1616</span>
<span class="normal">1617</span>
<span class="normal">1618</span>
<span class="normal">1619</span>
<span class="normal">1620</span>
<span class="normal">1621</span>
<span class="normal">1622</span>
<span class="normal">1623</span>
<span class="normal">1624</span>
<span class="normal">1625</span>
<span class="normal">1626</span>
<span class="normal">1627</span>
<span class="normal">1628</span>
<span class="normal">1629</span>
<span class="normal">1630</span>
<span class="normal">1631</span>
<span class="normal">1632</span>
<span class="normal">1633</span>
<span class="normal">1634</span>
<span class="normal">1635</span>
<span class="normal">1636</span>
<span class="normal">1637</span>
<span class="normal">1638</span>
<span class="normal">1639</span>
<span class="normal">1640</span>
<span class="normal">1641</span>
<span class="normal">1642</span>
<span class="normal">1643</span>
<span class="normal">1644</span>
<span class="normal">1645</span>
<span class="normal">1646</span>
<span class="normal">1647</span>
<span class="normal">1648</span>
<span class="normal">1649</span>
<span class="normal">1650</span>
<span class="normal">1651</span>
<span class="normal">1652</span>
<span class="normal">1653</span>
<span class="normal">1654</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_ts_map</span><span class="p">(</span><span class="n">dataMap</span><span class="p">,</span> <span class="n">dataTs</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">sites_id</span><span class="p">,</span> <span class="n">pertile_range</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates an interactive map with linked time series plots.</span>

<span class="sd">    This function generates a figure with two subplots: a map on top and a time series</span>
<span class="sd">    plot below. Clicking on a location in the map updates the time series plot to show</span>
<span class="sd">    data from the nearest site.</span>

<span class="sd">    Args:</span>
<span class="sd">        dataMap (list): Data values to be shown on the map.</span>
<span class="sd">        dataTs (list): List of time series data for each site.</span>
<span class="sd">        lat (np.array): Latitude values for each site.</span>
<span class="sd">        lon (np.array): Longitude values for each site.</span>
<span class="sd">        t (list): Time points for x-axis of time series.</span>
<span class="sd">        sites_id (list): Identifiers for each site.</span>
<span class="sd">        pertile_range (list, optional): Percentile range for color scaling on map.</span>
<span class="sd">            Defaults to None.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; # Create sample data</span>
<span class="sd">        &gt;&gt;&gt; n_sites = 10</span>
<span class="sd">        &gt;&gt;&gt; n_times = 100</span>
<span class="sd">        &gt;&gt;&gt; lat = np.random.uniform(30, 45, n_sites)</span>
<span class="sd">        &gt;&gt;&gt; lon = np.random.uniform(-120, -100, n_sites)</span>
<span class="sd">        &gt;&gt;&gt; sites_id = [f&#39;SITE_{i:03d}&#39; for i in range(n_sites)]</span>
<span class="sd">        &gt;&gt;&gt; </span>
<span class="sd">        &gt;&gt;&gt; # Generate sample time series for each site</span>
<span class="sd">        &gt;&gt;&gt; t = list(range(n_times))</span>
<span class="sd">        &gt;&gt;&gt; dataTs = []</span>
<span class="sd">        &gt;&gt;&gt; for i in range(n_sites):</span>
<span class="sd">        ...     pred = np.sin(np.array(t)/10 + i/5)</span>
<span class="sd">        ...     obs = pred + np.random.normal(0, 0.1, n_times)</span>
<span class="sd">        ...     dataTs.append([pred, obs])</span>
<span class="sd">        &gt;&gt;&gt; </span>
<span class="sd">        &gt;&gt;&gt; # Map data could be mean values</span>
<span class="sd">        &gt;&gt;&gt; dataMap = [np.mean(ts[0]) for ts in dataTs]</span>
<span class="sd">        &gt;&gt;&gt; </span>
<span class="sd">        &gt;&gt;&gt; plot_ts_map(dataMap, dataTs, lat, lon, t, sites_id)</span>

<span class="sd">    Notes:</span>
<span class="sd">        - Uses TkAgg backend for interactive display</span>
<span class="sd">        - Map uses Cartopy for proper geographic projection</span>
<span class="sd">        - Time series updates automatically on map click</span>
<span class="sd">        - Shows site ID and coordinates in time series title</span>
<span class="sd">        - Finds nearest site to click location</span>
<span class="sd">        - Both predicted and observed values shown in time series</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># show the map in a pop-up window</span>
    <span class="n">matplotlib</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">&quot;TkAgg&quot;</span><span class="p">)</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dataMap</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dataTs</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span>
    <span class="c1"># setup axes</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
    <span class="n">gs</span> <span class="o">=</span> <span class="n">gridspec</span><span class="o">.</span><span class="n">GridSpec</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="c1"># plt.subplots_adjust(left=0.13, right=0.89, bottom=0.05)</span>
    <span class="c1"># plot maps</span>
    <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
    <span class="n">ax1</span> <span class="o">=</span> <span class="n">plot_map_carto</span><span class="p">(</span>
        <span class="n">dataMap</span><span class="p">,</span> <span class="n">lat</span><span class="o">=</span><span class="n">lat</span><span class="p">,</span> <span class="n">lon</span><span class="o">=</span><span class="n">lon</span><span class="p">,</span> <span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">,</span> <span class="n">pertile_range</span><span class="o">=</span><span class="n">pertile_range</span>
    <span class="p">)</span>
    <span class="c1"># line plot</span>
    <span class="n">ax2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

    <span class="c1"># plot ts</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">onclick</span><span class="p">(</span><span class="n">event</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;click event&quot;</span><span class="p">)</span>
        <span class="c1"># refresh the ax2, then new ts data can be showed without previous one</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">cla</span><span class="p">()</span>
        <span class="n">xClick</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">xdata</span>
        <span class="n">yClick</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">ydata</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">xClick</span> <span class="o">-</span> <span class="n">lon</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">yClick</span> <span class="o">-</span> <span class="n">lat</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">ind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
        <span class="n">titleStr</span> <span class="o">=</span> <span class="s2">&quot;site_id </span><span class="si">%s</span><span class="s2">, lat </span><span class="si">%.3f</span><span class="s2">, lon </span><span class="si">%.3f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span>
            <span class="n">sites_id</span><span class="p">[</span><span class="n">ind</span><span class="p">],</span>
            <span class="n">lat</span><span class="p">[</span><span class="n">ind</span><span class="p">],</span>
            <span class="n">lon</span><span class="p">[</span><span class="n">ind</span><span class="p">],</span>
        <span class="p">)</span>
        <span class="n">tsLst</span> <span class="o">=</span> <span class="n">dataTs</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span>
        <span class="n">plot_ts_matplot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">tsLst</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax2</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">titleStr</span><span class="p">)</span>
        <span class="c1"># following funcs both work</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
        <span class="c1"># plt.draw()</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">mpl_connect</span><span class="p">(</span><span class="s2">&quot;button_press_event&quot;</span><span class="p">,</span> <span class="n">onclick</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="hydroutils.plot_ts_matplot" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">plot_ts_matplot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#hydroutils.plot_ts_matplot" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Creates a simple time series plot comparing predicted and observed values.</p>
<p>This function provides a straightforward way to plot and compare two time series,
typically used for showing predicted vs observed values. It supports both creating
new figures and adding to existing axes.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>t</code>
            </td>
            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Time points for x-axis.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>y</code>
            </td>
            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List containing two arrays: [predicted_values, observed_values].</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>color</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Color for predicted values line. Defaults to "r".</p>
              </div>
            </td>
            <td>
                  <code>&#39;r&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ax</code>
            </td>
            <td>
                  <code><span title="matplotlib.axes.Axes">Axes</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Existing axes to plot on. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>title</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Plot title. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Union[Tuple[matplotlib.figure.Figure, matplotlib.axes.Axes], matplotlib.axes.Axes]:
If ax is None, returns (fig, ax), otherwise returns ax.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create new plot</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y_pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">/</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y_obs</span> <span class="o">=</span> <span class="n">y_pred</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plot_ts_matplot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="p">[</span><span class="n">y_pred</span><span class="p">,</span> <span class="n">y_obs</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Add to existing axes</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span> <span class="o">=</span> <span class="n">plot_ts_matplot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="p">[</span><span class="n">y_pred</span><span class="p">,</span> <span class="n">y_obs</span><span class="p">],</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
<span class="gp">... </span>                    <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Sine Wave Prediction&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>


<details class="notes" open>
  <summary>Notes</summary>
  <ul>
<li>Predicted values are plotted first with specified color</li>
<li>Observed values are plotted second with default color</li>
<li>Legend is automatically added with "pred" and "obs" labels</li>
<li>Title is centered if provided</li>
</ul>
</details>

            <details class="quote">
              <summary>Source code in <code>hydroutils/hydro_plot.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1330</span>
<span class="normal">1331</span>
<span class="normal">1332</span>
<span class="normal">1333</span>
<span class="normal">1334</span>
<span class="normal">1335</span>
<span class="normal">1336</span>
<span class="normal">1337</span>
<span class="normal">1338</span>
<span class="normal">1339</span>
<span class="normal">1340</span>
<span class="normal">1341</span>
<span class="normal">1342</span>
<span class="normal">1343</span>
<span class="normal">1344</span>
<span class="normal">1345</span>
<span class="normal">1346</span>
<span class="normal">1347</span>
<span class="normal">1348</span>
<span class="normal">1349</span>
<span class="normal">1350</span>
<span class="normal">1351</span>
<span class="normal">1352</span>
<span class="normal">1353</span>
<span class="normal">1354</span>
<span class="normal">1355</span>
<span class="normal">1356</span>
<span class="normal">1357</span>
<span class="normal">1358</span>
<span class="normal">1359</span>
<span class="normal">1360</span>
<span class="normal">1361</span>
<span class="normal">1362</span>
<span class="normal">1363</span>
<span class="normal">1364</span>
<span class="normal">1365</span>
<span class="normal">1366</span>
<span class="normal">1367</span>
<span class="normal">1368</span>
<span class="normal">1369</span>
<span class="normal">1370</span>
<span class="normal">1371</span>
<span class="normal">1372</span>
<span class="normal">1373</span>
<span class="normal">1374</span>
<span class="normal">1375</span>
<span class="normal">1376</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_ts_matplot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates a simple time series plot comparing predicted and observed values.</span>

<span class="sd">    This function provides a straightforward way to plot and compare two time series,</span>
<span class="sd">    typically used for showing predicted vs observed values. It supports both creating</span>
<span class="sd">    new figures and adding to existing axes.</span>

<span class="sd">    Args:</span>
<span class="sd">        t (list): Time points for x-axis.</span>
<span class="sd">        y (list): List containing two arrays: [predicted_values, observed_values].</span>
<span class="sd">        color (str, optional): Color for predicted values line. Defaults to &quot;r&quot;.</span>
<span class="sd">        ax (matplotlib.axes.Axes, optional): Existing axes to plot on. Defaults to None.</span>
<span class="sd">        title (str, optional): Plot title. Defaults to None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Union[Tuple[matplotlib.figure.Figure, matplotlib.axes.Axes], matplotlib.axes.Axes]:</span>
<span class="sd">            If ax is None, returns (fig, ax), otherwise returns ax.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; # Create new plot</span>
<span class="sd">        &gt;&gt;&gt; t = list(range(100))</span>
<span class="sd">        &gt;&gt;&gt; y_pred = np.sin(np.array(t)/10)</span>
<span class="sd">        &gt;&gt;&gt; y_obs = y_pred + np.random.normal(0, 0.1, 100)</span>
<span class="sd">        &gt;&gt;&gt; fig, ax = plot_ts_matplot(t, [y_pred, y_obs], color=&#39;blue&#39;)</span>

<span class="sd">        &gt;&gt;&gt; # Add to existing axes</span>
<span class="sd">        &gt;&gt;&gt; fig, ax = plt.subplots()</span>
<span class="sd">        &gt;&gt;&gt; ax = plot_ts_matplot(t, [y_pred, y_obs], ax=ax,</span>
<span class="sd">        ...                     title=&#39;Sine Wave Prediction&#39;)</span>

<span class="sd">    Notes:</span>
<span class="sd">        - Predicted values are plotted first with specified color</span>
<span class="sd">        - Observed values are plotted second with default color</span>
<span class="sd">        - Legend is automatically added with &quot;pred&quot; and &quot;obs&quot; labels</span>
<span class="sd">        - Title is centered if provided</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;pred&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;obs&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">title</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span> <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">ax</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="hydroutils.random_choice_no_return" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">random_choice_no_return</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">num_lst</span><span class="p">)</span></code>

<a href="#hydroutils.random_choice_no_return" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Performs multiple sampling without replacement from an array.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>arr</code>
            </td>
            <td>
                  <code><span title="hydroutils.hydro_plot.Union">Union</span>[<span title="list">list</span>, <span title="numpy.ndarray">ndarray</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The source array to sample from.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>num_lst</code>
            </td>
            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of integers specifying the number of elements to sample in each iteration.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>list</code></td>            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of numpy arrays, where each array contains the sampled elements for that iteration.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="AssertionError">AssertionError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the sum of requested samples exceeds the array size.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">num_lst</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>  <span class="c1"># First sample 2 elements, then 1 element</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">random_choice_no_return</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">num_lst</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>  <span class="c1"># Returns 2 (number of sampling iterations)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>  <span class="c1"># Returns 2 (first sample size)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>  <span class="c1"># Returns 1 (second sample size)</span>
</code></pre></div></td></tr></table></div>


            <details class="quote">
              <summary>Source code in <code>hydroutils/hydro_arithmetric.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">random_choice_no_return</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">num_lst</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Performs multiple sampling without replacement from an array.</span>

<span class="sd">    Args:</span>
<span class="sd">        arr (Union[list, np.ndarray]): The source array to sample from.</span>
<span class="sd">        num_lst (list): List of integers specifying the number of elements to sample in each iteration.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: A list of numpy arrays, where each array contains the sampled elements for that iteration.</span>

<span class="sd">    Raises:</span>
<span class="sd">        AssertionError: If the sum of requested samples exceeds the array size.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; arr = [1, 2, 3, 4, 5]</span>
<span class="sd">        &gt;&gt;&gt; num_lst = [2, 1]  # First sample 2 elements, then 1 element</span>
<span class="sd">        &gt;&gt;&gt; result = random_choice_no_return(arr, num_lst)</span>
<span class="sd">        &gt;&gt;&gt; len(result)  # Returns 2 (number of sampling iterations)</span>
<span class="sd">        &gt;&gt;&gt; len(result[0])  # Returns 2 (first sample size)</span>
<span class="sd">        &gt;&gt;&gt; len(result[1])  # Returns 1 (second sample size)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">num_lst_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">num_lst</span><span class="p">)</span>
    <span class="n">num_sum</span> <span class="o">=</span> <span class="n">num_lst_arr</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span> <span class="o">==</span> <span class="nb">list</span><span class="p">:</span>
        <span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">num_sum</span> <span class="o">&lt;=</span> <span class="n">arr</span><span class="o">.</span><span class="n">size</span>
    <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">arr_residue</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="n">num_lst_arr</span><span class="p">:</span>
        <span class="n">idx_chosen</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">arr_residue</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">num</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">chosen_idx_in_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">arr_residue</span><span class="p">[</span><span class="n">idx_chosen</span><span class="p">])</span>
        <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="n">chosen_idx_in_arr</span><span class="p">])</span>
        <span class="n">arr_residue</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">arr_residue</span><span class="p">,</span> <span class="n">idx_chosen</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">results</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="hydroutils.remove_abnormal_data" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">remove_abnormal_data</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">q1</span><span class="o">=</span><span class="mf">1e-05</span><span class="p">,</span> <span class="n">q2</span><span class="o">=</span><span class="mf">0.99999</span><span class="p">)</span></code>

<a href="#hydroutils.remove_abnormal_data" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Removes extreme values from data using quantile thresholds.</p>
<p>Replaces values below q1 quantile and above q2 quantile with NaN.
Useful for removing outliers and extreme values.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>data</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Input data array.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>q1</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Lower quantile threshold (0-1). Defaults to 0.00001.</p>
              </div>
            </td>
            <td>
                  <code>1e-05</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>q2</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Upper quantile threshold (0-1). Defaults to 0.99999.</p>
              </div>
            </td>
            <td>
                  <code>0.99999</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Array with extreme values replaced by NaN.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1"># Remove extreme values from flow data</span>
<span class="n">flows</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">100.0</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">])</span>
<span class="n">cleaned</span> <span class="o">=</span> <span class="n">remove_abnormal_data</span><span class="p">(</span><span class="n">flows</span><span class="p">,</span> <span class="n">q1</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">q2</span><span class="o">=</span><span class="mf">0.99</span><span class="p">)</span>
<span class="c1"># Very low and very high values become NaN</span>
</code></pre></div></td></tr></table></div>
</details>

<details class="note" open>
  <summary>Note</summary>
  <ul>
<li>Values &lt;= q1 quantile become NaN</li>
<li>Values &gt;= q2 quantile become NaN</li>
<li>Useful for pre-processing hydrological data</li>
</ul>
</details>

            <details class="quote">
              <summary>Source code in <code>hydroutils/hydro_stat.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">869</span>
<span class="normal">870</span>
<span class="normal">871</span>
<span class="normal">872</span>
<span class="normal">873</span>
<span class="normal">874</span>
<span class="normal">875</span>
<span class="normal">876</span>
<span class="normal">877</span>
<span class="normal">878</span>
<span class="normal">879</span>
<span class="normal">880</span>
<span class="normal">881</span>
<span class="normal">882</span>
<span class="normal">883</span>
<span class="normal">884</span>
<span class="normal">885</span>
<span class="normal">886</span>
<span class="normal">887</span>
<span class="normal">888</span>
<span class="normal">889</span>
<span class="normal">890</span>
<span class="normal">891</span>
<span class="normal">892</span>
<span class="normal">893</span>
<span class="normal">894</span>
<span class="normal">895</span>
<span class="normal">896</span>
<span class="normal">897</span>
<span class="normal">898</span>
<span class="normal">899</span>
<span class="normal">900</span>
<span class="normal">901</span>
<span class="normal">902</span>
<span class="normal">903</span>
<span class="normal">904</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">remove_abnormal_data</span><span class="p">(</span>
    <span class="n">data</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">q1</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.00001</span><span class="p">,</span>
    <span class="n">q2</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.99999</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Removes extreme values from data using quantile thresholds.</span>

<span class="sd">    Replaces values below q1 quantile and above q2 quantile with NaN.</span>
<span class="sd">    Useful for removing outliers and extreme values.</span>

<span class="sd">    Args:</span>
<span class="sd">        data: Input data array.</span>
<span class="sd">        q1: Lower quantile threshold (0-1). Defaults to 0.00001.</span>
<span class="sd">        q2: Upper quantile threshold (0-1). Defaults to 0.99999.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Array with extreme values replaced by NaN.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        # Remove extreme values from flow data</span>
<span class="sd">        flows = np.array([0.1, 1.0, 2.0, 100.0, 1000.0])</span>
<span class="sd">        cleaned = remove_abnormal_data(flows, q1=0.01, q2=0.99)</span>
<span class="sd">        # Very low and very high values become NaN</span>
<span class="sd">        ```</span>

<span class="sd">    Note:</span>
<span class="sd">        - Values &lt;= q1 quantile become NaN</span>
<span class="sd">        - Values &gt;= q2 quantile become NaN</span>
<span class="sd">        - Useful for pre-processing hydrological data</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># remove abnormal data</span>
    <span class="n">data</span><span class="p">[</span><span class="n">data</span> <span class="o">&lt;</span> <span class="n">np</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">q1</span><span class="p">)]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
    <span class="n">data</span><span class="p">[</span><span class="n">data</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">q2</span><span class="p">)]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
    <span class="k">return</span> <span class="n">data</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="hydroutils.serialize_json" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">serialize_json</span><span class="p">(</span><span class="n">my_dict</span><span class="p">,</span> <span class="n">my_file</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">,</span> <span class="n">ensure_ascii</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#hydroutils.serialize_json" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Saves a dictionary to a JSON file.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>my_dict</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary to serialize.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>my_file</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path where the JSON file should be saved.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>encoding</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Character encoding for the file. Defaults to UTF-8.</p>
              </div>
            </td>
            <td>
                  <code>&#39;utf-8&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ensure_ascii</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, escapes non-ASCII characters. Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;John&#39;</span><span class="p">,</span> <span class="s1">&#39;age&#39;</span><span class="p">:</span> <span class="mi">30</span><span class="p">}</span>
<span class="n">serialize_json</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s1">&#39;person.json&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
</details>

            <details class="quote">
              <summary>Source code in <code>hydroutils/hydro_file.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">serialize_json</span><span class="p">(</span><span class="n">my_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">my_file</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">encoding</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;utf-8&quot;</span><span class="p">,</span> <span class="n">ensure_ascii</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Saves a dictionary to a JSON file.</span>

<span class="sd">    Args:</span>
<span class="sd">        my_dict: Dictionary to serialize.</span>
<span class="sd">        my_file: Path where the JSON file should be saved.</span>
<span class="sd">        encoding: Character encoding for the file. Defaults to UTF-8.</span>
<span class="sd">        ensure_ascii: If True, escapes non-ASCII characters. Defaults to True.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        data = {&#39;name&#39;: &#39;John&#39;, &#39;age&#39;: 30}</span>
<span class="sd">        serialize_json(data, &#39;person.json&#39;, encoding=&#39;utf-8&#39;)</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">my_file</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="n">encoding</span><span class="p">)</span> <span class="k">as</span> <span class="n">FP</span><span class="p">:</span>
        <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">my_dict</span><span class="p">,</span> <span class="n">FP</span><span class="p">,</span> <span class="n">ensure_ascii</span><span class="o">=</span><span class="n">ensure_ascii</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="hydroutils.serialize_json_np" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">serialize_json_np</span><span class="p">(</span><span class="n">my_dict</span><span class="p">,</span> <span class="n">my_file</span><span class="p">)</span></code>

<a href="#hydroutils.serialize_json_np" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Saves a dictionary containing NumPy arrays to a JSON file.</p>
<p>Uses NumpyArrayEncoder to handle NumPy data types.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>my_dict</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary to serialize (may contain NumPy arrays).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>my_file</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path where the JSON file should be saved.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;array&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]),</span>
    <span class="s1">&#39;scalar&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">(</span><span class="mf">3.14</span><span class="p">)</span>
<span class="p">}</span>
<span class="n">serialize_json_np</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s1">&#39;data.json&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
</details>

            <details class="quote">
              <summary>Source code in <code>hydroutils/hydro_file.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">serialize_json_np</span><span class="p">(</span><span class="n">my_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">my_file</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Saves a dictionary containing NumPy arrays to a JSON file.</span>

<span class="sd">    Uses NumpyArrayEncoder to handle NumPy data types.</span>

<span class="sd">    Args:</span>
<span class="sd">        my_dict: Dictionary to serialize (may contain NumPy arrays).</span>
<span class="sd">        my_file: Path where the JSON file should be saved.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        import numpy as np</span>
<span class="sd">        data = {</span>
<span class="sd">            &#39;array&#39;: np.array([1, 2, 3]),</span>
<span class="sd">            &#39;scalar&#39;: np.float32(3.14)</span>
<span class="sd">        }</span>
<span class="sd">        serialize_json_np(data, &#39;data.json&#39;)</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">my_file</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">FP</span><span class="p">:</span>
        <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">my_dict</span><span class="p">,</span> <span class="n">FP</span><span class="p">,</span> <span class="bp">cls</span><span class="o">=</span><span class="n">NumpyArrayEncoder</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="hydroutils.serialize_numpy" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">serialize_numpy</span><span class="p">(</span><span class="n">my_array</span><span class="p">,</span> <span class="n">my_file</span><span class="p">)</span></code>

<a href="#hydroutils.serialize_numpy" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Saves a NumPy array to a .npy file.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>my_array</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>NumPy array to save.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>my_file</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path where the array should be saved.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
<span class="n">serialize_numpy</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="s1">&#39;array.npy&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
</details>

            <details class="quote">
              <summary>Source code in <code>hydroutils/hydro_file.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">serialize_numpy</span><span class="p">(</span><span class="n">my_array</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">my_file</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Saves a NumPy array to a .npy file.</span>

<span class="sd">    Args:</span>
<span class="sd">        my_array: NumPy array to save.</span>
<span class="sd">        my_file: Path where the array should be saved.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        arr = np.array([[1, 2], [3, 4]])</span>
<span class="sd">        serialize_numpy(arr, &#39;array.npy&#39;)</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">my_file</span><span class="p">,</span> <span class="n">my_array</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="hydroutils.serialize_pickle" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">serialize_pickle</span><span class="p">(</span><span class="n">my_object</span><span class="p">,</span> <span class="n">my_file</span><span class="p">)</span></code>

<a href="#hydroutils.serialize_pickle" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Saves an object to a pickle file.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>my_object</code>
            </td>
            <td>
                  <code><span title="object">object</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Any Python object to serialize.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>my_file</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path where the pickle file should be saved.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">MyClass</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">value</span>

<span class="n">obj</span> <span class="o">=</span> <span class="n">MyClass</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">serialize_pickle</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="s1">&#39;object.pkl&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
</details>

            <details class="quote">
              <summary>Source code in <code>hydroutils/hydro_file.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">serialize_pickle</span><span class="p">(</span><span class="n">my_object</span><span class="p">:</span> <span class="nb">object</span><span class="p">,</span> <span class="n">my_file</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Saves an object to a pickle file.</span>

<span class="sd">    Args:</span>
<span class="sd">        my_object: Any Python object to serialize.</span>
<span class="sd">        my_file: Path where the pickle file should be saved.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        class MyClass:</span>
<span class="sd">            def __init__(self, value):</span>
<span class="sd">                self.value = value</span>

<span class="sd">        obj = MyClass(42)</span>
<span class="sd">        serialize_pickle(obj, &#39;object.pkl&#39;)</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">my_file</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">my_object</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="hydroutils.stat_error" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">stat_error</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">pred</span><span class="p">,</span> <span class="n">fill_nan</span><span class="o">=</span><span class="s1">&#39;no&#39;</span><span class="p">)</span></code>

<a href="#hydroutils.stat_error" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Calculates statistical metrics for multiple time series.</p>
<p>Computes error metrics between predicted and target values across multiple basins
or time series, with options for handling NaN values.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>target</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Observed values. Shape: [n_basins, n_timesteps].</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>pred</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Predicted values. Same shape as target.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>fill_nan</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>How to handle NaN values:
- "no": Ignore NaN values (default)
- "sum": Sum values in NaN locations
- "mean": Average values in NaN locations
Example: For obs=[1,nan,nan,2] and pred=[0.3,0.3,0.3,1.5]:
- "no" compares [1,2] vs [0.3,1.5]
- "sum" compares [1,2] vs [0.9,1.5]
- "mean" compares [1,2] vs [0.3,1.5]</p>
              </div>
            </td>
            <td>
                  <code>&#39;no&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary of metrics:
- Bias: Mean error
- RMSE: Root mean square error
- ubRMSE: Unbiased RMSE
- Corr: Pearson correlation
- R2: Coefficient of determination
- NSE: Nash-Sutcliffe efficiency
- KGE: Kling-Gupta efficiency
- FHV: High flow bias (top 2%)
- FLV: Low flow bias (bottom 30%)</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If inputs have wrong dimensions or invalid fill_nan value.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">obs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]])</span>  <span class="c1"># 2 basins, 3 timesteps</span>
<span class="n">pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">2.1</span><span class="p">,</span> <span class="mf">3.1</span><span class="p">],</span> <span class="p">[</span><span class="mf">4.2</span><span class="p">,</span> <span class="mf">5.1</span><span class="p">,</span> <span class="mf">5.9</span><span class="p">]])</span>
<span class="n">metrics</span> <span class="o">=</span> <span class="n">stat_error</span><span class="p">(</span><span class="n">obs</span><span class="p">,</span> <span class="n">pred</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mean RMSE: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">metrics</span><span class="p">[</span><span class="s1">&#39;RMSE&#39;</span><span class="p">])</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
</details>

            <details class="quote">
              <summary>Source code in <code>hydroutils/hydro_stat.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">stat_error</span><span class="p">(</span><span class="n">target</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">pred</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">fill_nan</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;no&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculates statistical metrics for multiple time series.</span>

<span class="sd">    Computes error metrics between predicted and target values across multiple basins</span>
<span class="sd">    or time series, with options for handling NaN values.</span>

<span class="sd">    Args:</span>
<span class="sd">        target: Observed values. Shape: [n_basins, n_timesteps].</span>
<span class="sd">        pred: Predicted values. Same shape as target.</span>
<span class="sd">        fill_nan: How to handle NaN values:</span>
<span class="sd">            - &quot;no&quot;: Ignore NaN values (default)</span>
<span class="sd">            - &quot;sum&quot;: Sum values in NaN locations</span>
<span class="sd">            - &quot;mean&quot;: Average values in NaN locations</span>
<span class="sd">            Example: For obs=[1,nan,nan,2] and pred=[0.3,0.3,0.3,1.5]:</span>
<span class="sd">            - &quot;no&quot; compares [1,2] vs [0.3,1.5]</span>
<span class="sd">            - &quot;sum&quot; compares [1,2] vs [0.9,1.5]</span>
<span class="sd">            - &quot;mean&quot; compares [1,2] vs [0.3,1.5]</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dictionary of metrics:</span>
<span class="sd">            - Bias: Mean error</span>
<span class="sd">            - RMSE: Root mean square error</span>
<span class="sd">            - ubRMSE: Unbiased RMSE</span>
<span class="sd">            - Corr: Pearson correlation</span>
<span class="sd">            - R2: Coefficient of determination</span>
<span class="sd">            - NSE: Nash-Sutcliffe efficiency</span>
<span class="sd">            - KGE: Kling-Gupta efficiency</span>
<span class="sd">            - FHV: High flow bias (top 2%)</span>
<span class="sd">            - FLV: Low flow bias (bottom 30%)</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If inputs have wrong dimensions or invalid fill_nan value.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        obs = np.array([[1, 2, 3], [4, 5, 6]])  # 2 basins, 3 timesteps</span>
<span class="sd">        pred = np.array([[1.1, 2.1, 3.1], [4.2, 5.1, 5.9]])</span>
<span class="sd">        metrics = stat_error(obs, pred)</span>
<span class="sd">        print(f&quot;Mean RMSE: {np.mean(metrics[&#39;RMSE&#39;]):.2f}&quot;)</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">target</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;The input data should be 2-dim, not 3-dim. If you want to calculate metrics for 3-d arrays, please use stat_errors function.&quot;</span>
        <span class="p">)</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">fill_nan</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;fill_nan should be a string.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">target</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="n">pred</span><span class="o">.</span><span class="n">shape</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The shape of target and pred should be the same.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">fill_nan</span> <span class="o">!=</span> <span class="s2">&quot;no&quot;</span><span class="p">:</span>
        <span class="n">each_non_nan_idx</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">all_non_nan_idx</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">target</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
            <span class="n">tmp</span> <span class="o">=</span> <span class="n">target</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">non_nan_idx_tmp</span> <span class="o">=</span> <span class="p">[</span><span class="n">j</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">tmp</span><span class="o">.</span><span class="n">size</span><span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">tmp</span><span class="p">[</span><span class="n">j</span><span class="p">])]</span>
            <span class="n">each_non_nan_idx</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">non_nan_idx_tmp</span><span class="p">)</span>
            <span class="c1"># TODO: now all_non_nan_idx is only set for ET, because of its irregular nan values</span>
            <span class="n">all_non_nan_idx</span> <span class="o">=</span> <span class="n">all_non_nan_idx</span> <span class="o">+</span> <span class="n">non_nan_idx_tmp</span>
            <span class="n">non_nan_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">all_non_nan_idx</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="c1"># some NaN data appear in different dates in different basins, so we have to calculate the metric for each basin</span>
        <span class="c1"># but for ET, it is not very resonable to calculate the metric for each basin in this way, for example,</span>
        <span class="c1"># the non_nan_idx: [1, 9, 17, 33, 41], then there are 16 elements in 17 -&gt; 33, so use all_non_nan_idx is better</span>
        <span class="c1"># hence we don&#39;t use each_non_nan_idx finally</span>
        <span class="n">out_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
            <span class="n">Bias</span><span class="o">=</span><span class="p">[],</span>
            <span class="n">RMSE</span><span class="o">=</span><span class="p">[],</span>
            <span class="n">ubRMSE</span><span class="o">=</span><span class="p">[],</span>
            <span class="n">Corr</span><span class="o">=</span><span class="p">[],</span>
            <span class="n">R2</span><span class="o">=</span><span class="p">[],</span>
            <span class="n">NSE</span><span class="o">=</span><span class="p">[],</span>
            <span class="n">KGE</span><span class="o">=</span><span class="p">[],</span>
            <span class="n">FHV</span><span class="o">=</span><span class="p">[],</span>
            <span class="n">FLV</span><span class="o">=</span><span class="p">[],</span>
        <span class="p">)</span>
    <span class="k">if</span> <span class="n">fill_nan</span> <span class="o">==</span> <span class="s2">&quot;sum&quot;</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">target</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
            <span class="n">tmp</span> <span class="o">=</span> <span class="n">target</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="c1"># non_nan_idx = each_non_nan_idx[i]</span>
            <span class="n">targ_i</span> <span class="o">=</span> <span class="n">tmp</span><span class="p">[</span><span class="n">non_nan_idx</span><span class="p">]</span>
            <span class="n">pred_i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">add</span><span class="o">.</span><span class="n">reduceat</span><span class="p">(</span><span class="n">pred</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">non_nan_idx</span><span class="p">)</span>
            <span class="n">dict_i</span> <span class="o">=</span> <span class="n">stat_error_i</span><span class="p">(</span><span class="n">targ_i</span><span class="p">,</span> <span class="n">pred_i</span><span class="p">)</span>
            <span class="n">out_dict</span><span class="p">[</span><span class="s2">&quot;Bias&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dict_i</span><span class="p">[</span><span class="s2">&quot;Bias&quot;</span><span class="p">])</span>
            <span class="n">out_dict</span><span class="p">[</span><span class="s2">&quot;RMSE&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dict_i</span><span class="p">[</span><span class="s2">&quot;RMSE&quot;</span><span class="p">])</span>
            <span class="n">out_dict</span><span class="p">[</span><span class="s2">&quot;ubRMSE&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dict_i</span><span class="p">[</span><span class="s2">&quot;ubRMSE&quot;</span><span class="p">])</span>
            <span class="n">out_dict</span><span class="p">[</span><span class="s2">&quot;Corr&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dict_i</span><span class="p">[</span><span class="s2">&quot;Corr&quot;</span><span class="p">])</span>
            <span class="n">out_dict</span><span class="p">[</span><span class="s2">&quot;R2&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dict_i</span><span class="p">[</span><span class="s2">&quot;R2&quot;</span><span class="p">])</span>
            <span class="n">out_dict</span><span class="p">[</span><span class="s2">&quot;NSE&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dict_i</span><span class="p">[</span><span class="s2">&quot;NSE&quot;</span><span class="p">])</span>
            <span class="n">out_dict</span><span class="p">[</span><span class="s2">&quot;KGE&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dict_i</span><span class="p">[</span><span class="s2">&quot;KGE&quot;</span><span class="p">])</span>
            <span class="n">out_dict</span><span class="p">[</span><span class="s2">&quot;FHV&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dict_i</span><span class="p">[</span><span class="s2">&quot;FHV&quot;</span><span class="p">])</span>
            <span class="n">out_dict</span><span class="p">[</span><span class="s2">&quot;FLV&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dict_i</span><span class="p">[</span><span class="s2">&quot;FLV&quot;</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">out_dict</span>
    <span class="k">elif</span> <span class="n">fill_nan</span> <span class="o">==</span> <span class="s2">&quot;mean&quot;</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">target</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
            <span class="n">tmp</span> <span class="o">=</span> <span class="n">target</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="c1"># non_nan_idx = each_non_nan_idx[i]</span>
            <span class="n">targ_i</span> <span class="o">=</span> <span class="n">tmp</span><span class="p">[</span><span class="n">non_nan_idx</span><span class="p">]</span>
            <span class="n">pred_i_sum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">add</span><span class="o">.</span><span class="n">reduceat</span><span class="p">(</span><span class="n">pred</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">non_nan_idx</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">non_nan_idx</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">pred</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span>
                <span class="n">idx4mean</span> <span class="o">=</span> <span class="n">non_nan_idx</span> <span class="o">+</span> <span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">pred</span><span class="p">[</span><span class="n">i</span><span class="p">])]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">idx4mean</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">non_nan_idx</span><span class="p">)</span>
            <span class="n">idx_interval</span> <span class="o">=</span> <span class="p">[</span><span class="n">y</span> <span class="o">-</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">idx4mean</span><span class="p">,</span> <span class="n">idx4mean</span><span class="p">[</span><span class="mi">1</span><span class="p">:])]</span>
            <span class="n">pred_i</span> <span class="o">=</span> <span class="n">pred_i_sum</span> <span class="o">/</span> <span class="n">idx_interval</span>
            <span class="n">dict_i</span> <span class="o">=</span> <span class="n">stat_error_i</span><span class="p">(</span><span class="n">targ_i</span><span class="p">,</span> <span class="n">pred_i</span><span class="p">)</span>
            <span class="n">out_dict</span><span class="p">[</span><span class="s2">&quot;Bias&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dict_i</span><span class="p">[</span><span class="s2">&quot;Bias&quot;</span><span class="p">])</span>
            <span class="n">out_dict</span><span class="p">[</span><span class="s2">&quot;RMSE&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dict_i</span><span class="p">[</span><span class="s2">&quot;RMSE&quot;</span><span class="p">])</span>
            <span class="n">out_dict</span><span class="p">[</span><span class="s2">&quot;ubRMSE&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dict_i</span><span class="p">[</span><span class="s2">&quot;ubRMSE&quot;</span><span class="p">])</span>
            <span class="n">out_dict</span><span class="p">[</span><span class="s2">&quot;Corr&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dict_i</span><span class="p">[</span><span class="s2">&quot;Corr&quot;</span><span class="p">])</span>
            <span class="n">out_dict</span><span class="p">[</span><span class="s2">&quot;R2&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dict_i</span><span class="p">[</span><span class="s2">&quot;R2&quot;</span><span class="p">])</span>
            <span class="n">out_dict</span><span class="p">[</span><span class="s2">&quot;NSE&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dict_i</span><span class="p">[</span><span class="s2">&quot;NSE&quot;</span><span class="p">])</span>
            <span class="n">out_dict</span><span class="p">[</span><span class="s2">&quot;KGE&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dict_i</span><span class="p">[</span><span class="s2">&quot;KGE&quot;</span><span class="p">])</span>
            <span class="n">out_dict</span><span class="p">[</span><span class="s2">&quot;FHV&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dict_i</span><span class="p">[</span><span class="s2">&quot;FHV&quot;</span><span class="p">])</span>
            <span class="n">out_dict</span><span class="p">[</span><span class="s2">&quot;FLV&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dict_i</span><span class="p">[</span><span class="s2">&quot;FLV&quot;</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">out_dict</span>
    <span class="n">ngrid</span><span class="p">,</span> <span class="n">nt</span> <span class="o">=</span> <span class="n">pred</span><span class="o">.</span><span class="n">shape</span>
    <span class="c1"># Bias</span>
    <span class="n">Bias</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="n">pred</span> <span class="o">-</span> <span class="n">target</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="c1"># RMSE</span>
    <span class="n">RMSE</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">((</span><span class="n">pred</span> <span class="o">-</span> <span class="n">target</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
    <span class="c1"># ubRMSE</span>
    <span class="n">predMean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="n">pred</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="n">nt</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
    <span class="n">targetMean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="n">nt</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
    <span class="n">predAnom</span> <span class="o">=</span> <span class="n">pred</span> <span class="o">-</span> <span class="n">predMean</span>
    <span class="n">targetAnom</span> <span class="o">=</span> <span class="n">target</span> <span class="o">-</span> <span class="n">targetMean</span>
    <span class="n">ubRMSE</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">((</span><span class="n">predAnom</span> <span class="o">-</span> <span class="n">targetAnom</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
    <span class="c1"># rho R2 NSE</span>
    <span class="n">Corr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">ngrid</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
    <span class="n">R2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">ngrid</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
    <span class="n">NSE</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">ngrid</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
    <span class="n">KGe</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">ngrid</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
    <span class="n">PBiaslow</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">ngrid</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
    <span class="n">PBiashigh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">ngrid</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
    <span class="n">PBias</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">ngrid</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
    <span class="n">num_lowtarget_zero</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ngrid</span><span class="p">):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">pred</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="p">:]</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">target</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="p">:]</span>
        <span class="n">ind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">y</span><span class="p">)))[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">ind</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">xx</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span>
            <span class="n">yy</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span>
            <span class="c1"># percent bias</span>
            <span class="n">PBias</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">xx</span> <span class="o">-</span> <span class="n">yy</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">yy</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>
            <span class="k">if</span> <span class="n">ind</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="c1"># Theoretically at least two points for correlation</span>
                <span class="n">Corr</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">pearsonr</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">yymean</span> <span class="o">=</span> <span class="n">yy</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
                <span class="n">SST</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">yy</span> <span class="o">-</span> <span class="n">yymean</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
                <span class="n">SSReg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">xx</span> <span class="o">-</span> <span class="n">yymean</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
                <span class="n">SSRes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">yy</span> <span class="o">-</span> <span class="n">xx</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
                <span class="n">R2</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">SSRes</span> <span class="o">/</span> <span class="n">SST</span>
                <span class="n">NSE</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">SSRes</span> <span class="o">/</span> <span class="n">SST</span>
                <span class="n">KGe</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">KGE</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">)</span>
            <span class="c1"># FHV the peak flows bias 2%</span>
            <span class="c1"># FLV the low flows bias bottom 30%, log space</span>
            <span class="n">pred_sort</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">xx</span><span class="p">)</span>
            <span class="n">target_sort</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">yy</span><span class="p">)</span>
            <span class="n">indexlow</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="mf">0.3</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">pred_sort</span><span class="p">))</span>
            <span class="n">indexhigh</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="mf">0.98</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">pred_sort</span><span class="p">))</span>
            <span class="n">lowpred</span> <span class="o">=</span> <span class="n">pred_sort</span><span class="p">[:</span><span class="n">indexlow</span><span class="p">]</span>
            <span class="n">highpred</span> <span class="o">=</span> <span class="n">pred_sort</span><span class="p">[</span><span class="n">indexhigh</span><span class="p">:]</span>
            <span class="n">lowtarget</span> <span class="o">=</span> <span class="n">target_sort</span><span class="p">[:</span><span class="n">indexlow</span><span class="p">]</span>
            <span class="n">hightarget</span> <span class="o">=</span> <span class="n">target_sort</span><span class="p">[</span><span class="n">indexhigh</span><span class="p">:]</span>
            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">lowtarget</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">num_lowtarget_zero</span> <span class="o">=</span> <span class="n">num_lowtarget_zero</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="k">with</span> <span class="n">warnings</span><span class="o">.</span><span class="n">catch_warnings</span><span class="p">():</span>
                <span class="c1"># Sometimes the lowtarget is all 0, which will cause a warning</span>
                <span class="c1"># but I know it is not an error, so I ignore it</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="ne">RuntimeWarning</span><span class="p">)</span>
                <span class="n">PBiaslow</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">lowpred</span> <span class="o">-</span> <span class="n">lowtarget</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">lowtarget</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>
            <span class="n">PBiashigh</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">highpred</span> <span class="o">-</span> <span class="n">hightarget</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">hightarget</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>
    <span class="n">outDict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
        <span class="n">Bias</span><span class="o">=</span><span class="n">Bias</span><span class="p">,</span>
        <span class="n">RMSE</span><span class="o">=</span><span class="n">RMSE</span><span class="p">,</span>
        <span class="n">ubRMSE</span><span class="o">=</span><span class="n">ubRMSE</span><span class="p">,</span>
        <span class="n">Corr</span><span class="o">=</span><span class="n">Corr</span><span class="p">,</span>
        <span class="n">R2</span><span class="o">=</span><span class="n">R2</span><span class="p">,</span>
        <span class="n">NSE</span><span class="o">=</span><span class="n">NSE</span><span class="p">,</span>
        <span class="n">KGE</span><span class="o">=</span><span class="n">KGe</span><span class="p">,</span>
        <span class="n">FHV</span><span class="o">=</span><span class="n">PBiashigh</span><span class="p">,</span>
        <span class="n">FLV</span><span class="o">=</span><span class="n">PBiaslow</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="c1"># &quot;The CDF of BFLV will not reach 1.0 because some basins have all zero flow observations for the &quot;</span>
    <span class="c1"># &quot;30% low flow interval, the percent bias can be infinite\n&quot;</span>
    <span class="c1"># &quot;The number of these cases is &quot; + str(num_lowtarget_zero)</span>
    <span class="k">return</span> <span class="n">outDict</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="hydroutils.stat_error_i" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">stat_error_i</span><span class="p">(</span><span class="n">targ_i</span><span class="p">,</span> <span class="n">pred_i</span><span class="p">)</span></code>

<a href="#hydroutils.stat_error_i" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Calculates multiple error metrics between predicted and target values.</p>
<p>Computes a comprehensive set of error metrics including bias, RMSE, correlation,
and flow-specific metrics.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>targ_i</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Target (observed) values.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>pred_i</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Predicted (simulated) values.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary containing:
- Bias: Mean error
- RMSE: Root mean square error
- ubRMSE: Unbiased RMSE
- Corr: Pearson correlation
- R2: Coefficient of determination
- NSE: Nash-Sutcliffe efficiency
- KGE: Kling-Gupta efficiency
- FHV: High flow bias (top 2%)
- FLV: Low flow bias (bottom 30%)</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If input arrays have less than 2 valid points.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">target</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="n">pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">2.1</span><span class="p">,</span> <span class="mf">2.9</span><span class="p">,</span> <span class="mf">4.2</span><span class="p">,</span> <span class="mf">5.1</span><span class="p">])</span>
<span class="n">metrics</span> <span class="o">=</span> <span class="n">stat_error_i</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">pred</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;RMSE: </span><span class="si">{</span><span class="n">metrics</span><span class="p">[</span><span class="s1">&#39;RMSE&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
</details>

            <details class="quote">
              <summary>Source code in <code>hydroutils/hydro_stat.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">stat_error_i</span><span class="p">(</span><span class="n">targ_i</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">pred_i</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculates multiple error metrics between predicted and target values.</span>

<span class="sd">    Computes a comprehensive set of error metrics including bias, RMSE, correlation,</span>
<span class="sd">    and flow-specific metrics.</span>

<span class="sd">    Args:</span>
<span class="sd">        targ_i: Target (observed) values.</span>
<span class="sd">        pred_i: Predicted (simulated) values.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dictionary containing:</span>
<span class="sd">            - Bias: Mean error</span>
<span class="sd">            - RMSE: Root mean square error</span>
<span class="sd">            - ubRMSE: Unbiased RMSE</span>
<span class="sd">            - Corr: Pearson correlation</span>
<span class="sd">            - R2: Coefficient of determination</span>
<span class="sd">            - NSE: Nash-Sutcliffe efficiency</span>
<span class="sd">            - KGE: Kling-Gupta efficiency</span>
<span class="sd">            - FHV: High flow bias (top 2%)</span>
<span class="sd">            - FLV: Low flow bias (bottom 30%)</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If input arrays have less than 2 valid points.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        target = np.array([1, 2, 3, 4, 5])</span>
<span class="sd">        pred = np.array([1.1, 2.1, 2.9, 4.2, 5.1])</span>
<span class="sd">        metrics = stat_error_i(target, pred)</span>
<span class="sd">        print(f&quot;RMSE: {metrics[&#39;RMSE&#39;]:.2f}&quot;)</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">pred_i</span><span class="p">),</span> <span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">targ_i</span><span class="p">)))[</span><span class="mi">0</span><span class="p">]</span>
    <span class="c1"># Theoretically at least two points for correlation</span>
    <span class="k">if</span> <span class="n">ind</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">xx</span> <span class="o">=</span> <span class="n">pred_i</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span>
        <span class="n">yy</span> <span class="o">=</span> <span class="n">targ_i</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span>
        <span class="n">bias</span> <span class="o">=</span> <span class="n">he</span><span class="o">.</span><span class="n">me</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">)</span>
        <span class="c1"># RMSE</span>
        <span class="n">rmse</span> <span class="o">=</span> <span class="n">he</span><span class="o">.</span><span class="n">rmse</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">)</span>
        <span class="c1"># ubRMSE</span>
        <span class="n">pred_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="n">xx</span><span class="p">)</span>
        <span class="n">target_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="n">yy</span><span class="p">)</span>
        <span class="n">pred_anom</span> <span class="o">=</span> <span class="n">xx</span> <span class="o">-</span> <span class="n">pred_mean</span>
        <span class="n">target_anom</span> <span class="o">=</span> <span class="n">yy</span> <span class="o">-</span> <span class="n">target_mean</span>
        <span class="n">ubrmse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">((</span><span class="n">pred_anom</span> <span class="o">-</span> <span class="n">target_anom</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span>
        <span class="c1"># rho R2 NSE</span>
        <span class="n">corr</span> <span class="o">=</span> <span class="n">he</span><span class="o">.</span><span class="n">pearson_r</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">)</span>
        <span class="n">r2</span> <span class="o">=</span> <span class="n">he</span><span class="o">.</span><span class="n">r_squared</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">)</span>
        <span class="n">nse</span> <span class="o">=</span> <span class="n">he</span><span class="o">.</span><span class="n">nse</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">)</span>
        <span class="n">kge</span> <span class="o">=</span> <span class="n">he</span><span class="o">.</span><span class="n">kge_2009</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">)</span>
        <span class="c1"># percent bias</span>
        <span class="n">pbias</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">xx</span> <span class="o">-</span> <span class="n">yy</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">yy</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>
        <span class="c1"># FHV the peak flows bias 2%</span>
        <span class="c1"># FLV the low flows bias bottom 30%, log space</span>
        <span class="n">pred_sort</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">xx</span><span class="p">)</span>
        <span class="n">target_sort</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">yy</span><span class="p">)</span>
        <span class="n">indexlow</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="mf">0.3</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">pred_sort</span><span class="p">))</span>
        <span class="n">indexhigh</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="mf">0.98</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">pred_sort</span><span class="p">))</span>
        <span class="n">lowpred</span> <span class="o">=</span> <span class="n">pred_sort</span><span class="p">[:</span><span class="n">indexlow</span><span class="p">]</span>
        <span class="n">highpred</span> <span class="o">=</span> <span class="n">pred_sort</span><span class="p">[</span><span class="n">indexhigh</span><span class="p">:]</span>
        <span class="n">lowtarget</span> <span class="o">=</span> <span class="n">target_sort</span><span class="p">[:</span><span class="n">indexlow</span><span class="p">]</span>
        <span class="n">hightarget</span> <span class="o">=</span> <span class="n">target_sort</span><span class="p">[</span><span class="n">indexhigh</span><span class="p">:]</span>
        <span class="n">pbiaslow</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">lowpred</span> <span class="o">-</span> <span class="n">lowtarget</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">lowtarget</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>
        <span class="n">pbiashigh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">highpred</span> <span class="o">-</span> <span class="n">hightarget</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">hightarget</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>
        <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span>
            <span class="n">Bias</span><span class="o">=</span><span class="n">bias</span><span class="p">,</span>
            <span class="n">RMSE</span><span class="o">=</span><span class="n">rmse</span><span class="p">,</span>
            <span class="n">ubRMSE</span><span class="o">=</span><span class="n">ubrmse</span><span class="p">,</span>
            <span class="n">Corr</span><span class="o">=</span><span class="n">corr</span><span class="p">,</span>
            <span class="n">R2</span><span class="o">=</span><span class="n">r2</span><span class="p">,</span>
            <span class="n">NSE</span><span class="o">=</span><span class="n">nse</span><span class="p">,</span>
            <span class="n">KGE</span><span class="o">=</span><span class="n">kge</span><span class="p">,</span>
            <span class="n">FHV</span><span class="o">=</span><span class="n">pbiashigh</span><span class="p">,</span>
            <span class="n">FLV</span><span class="o">=</span><span class="n">pbiaslow</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;The number of data is less than 2, we don&#39;t calculate the statistics.&quot;</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="hydroutils.stat_errors" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">stat_errors</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">pred</span><span class="p">,</span> <span class="n">fill_nan</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#hydroutils.stat_errors" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Calculates statistical metrics for multiple variables.</p>
<p>Similar to stat_error but handles 3D arrays where the third dimension represents
different variables.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>target</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Observed values. Shape: [n_basins, n_timesteps, n_variables].</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>pred</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Predicted values. Same shape as target.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>fill_nan</code>
            </td>
            <td>
                  <code><span title="typing.List">List</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of NaN handling methods for each variable:
- "no": Ignore NaN values
- "sum": Sum values in NaN locations
- "mean": Average values in NaN locations
If None, defaults to ["no"] for all variables.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span>[<span title="dict">dict</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of dictionaries, one per variable, each containing:
- Bias: Mean error
- RMSE: Root mean square error
- ubRMSE: Unbiased RMSE
- Corr: Pearson correlation
- R2: Coefficient of determination
- NSE: Nash-Sutcliffe efficiency
- KGE: Kling-Gupta efficiency
- FHV: High flow bias (top 2%)
- FLV: Low flow bias (bottom 30%)</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If inputs have wrong dimensions or invalid fill_nan values.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1"># 2 basins, 3 timesteps, 2 variables</span>
<span class="n">obs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">6</span><span class="p">]],</span> <span class="p">[[</span><span class="mi">4</span><span class="p">,</span><span class="mi">7</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">8</span><span class="p">],</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span><span class="mi">9</span><span class="p">]]])</span>
<span class="n">pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[[</span><span class="mf">1.1</span><span class="p">,</span><span class="mf">4.1</span><span class="p">],</span> <span class="p">[</span><span class="mf">2.1</span><span class="p">,</span><span class="mf">5.1</span><span class="p">],</span> <span class="p">[</span><span class="mf">3.1</span><span class="p">,</span><span class="mf">6.1</span><span class="p">]],</span>
                <span class="p">[[</span><span class="mf">4.2</span><span class="p">,</span><span class="mf">7.2</span><span class="p">],</span> <span class="p">[</span><span class="mf">5.1</span><span class="p">,</span><span class="mf">8.1</span><span class="p">],</span> <span class="p">[</span><span class="mf">5.9</span><span class="p">,</span><span class="mf">9.1</span><span class="p">]]])</span>
<span class="n">metrics</span> <span class="o">=</span> <span class="n">stat_errors</span><span class="p">(</span><span class="n">obs</span><span class="p">,</span> <span class="n">pred</span><span class="p">,</span> <span class="n">fill_nan</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;no&#39;</span><span class="p">,</span> <span class="s1">&#39;no&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;RMSE for var1: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">metrics</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;RMSE&#39;</span><span class="p">])</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
</details>

            <details class="quote">
              <summary>Source code in <code>hydroutils/hydro_stat.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">stat_errors</span><span class="p">(</span><span class="n">target</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">pred</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">fill_nan</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">dict</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculates statistical metrics for multiple variables.</span>

<span class="sd">    Similar to stat_error but handles 3D arrays where the third dimension represents</span>
<span class="sd">    different variables.</span>

<span class="sd">    Args:</span>
<span class="sd">        target: Observed values. Shape: [n_basins, n_timesteps, n_variables].</span>
<span class="sd">        pred: Predicted values. Same shape as target.</span>
<span class="sd">        fill_nan: List of NaN handling methods for each variable:</span>
<span class="sd">            - &quot;no&quot;: Ignore NaN values</span>
<span class="sd">            - &quot;sum&quot;: Sum values in NaN locations</span>
<span class="sd">            - &quot;mean&quot;: Average values in NaN locations</span>
<span class="sd">            If None, defaults to [&quot;no&quot;] for all variables.</span>

<span class="sd">    Returns:</span>
<span class="sd">        List of dictionaries, one per variable, each containing:</span>
<span class="sd">            - Bias: Mean error</span>
<span class="sd">            - RMSE: Root mean square error</span>
<span class="sd">            - ubRMSE: Unbiased RMSE</span>
<span class="sd">            - Corr: Pearson correlation</span>
<span class="sd">            - R2: Coefficient of determination</span>
<span class="sd">            - NSE: Nash-Sutcliffe efficiency</span>
<span class="sd">            - KGE: Kling-Gupta efficiency</span>
<span class="sd">            - FHV: High flow bias (top 2%)</span>
<span class="sd">            - FLV: Low flow bias (bottom 30%)</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If inputs have wrong dimensions or invalid fill_nan values.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        # 2 basins, 3 timesteps, 2 variables</span>
<span class="sd">        obs = np.array([[[1,4], [2,5], [3,6]], [[4,7], [5,8], [6,9]]])</span>
<span class="sd">        pred = np.array([[[1.1,4.1], [2.1,5.1], [3.1,6.1]],</span>
<span class="sd">                        [[4.2,7.2], [5.1,8.1], [5.9,9.1]]])</span>
<span class="sd">        metrics = stat_errors(obs, pred, fill_nan=[&#39;no&#39;, &#39;no&#39;])</span>
<span class="sd">        print(f&quot;RMSE for var1: {np.mean(metrics[0][&#39;RMSE&#39;]):.2f}&quot;)</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">fill_nan</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">fill_nan</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;no&quot;</span><span class="p">]</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">target</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">3</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;The input data should be 3-dim, not 2-dim. If you want to calculate &quot;</span>
            <span class="s2">&quot;metrics for 2-d arrays, please use stat_error function.&quot;</span>
        <span class="p">)</span>
    <span class="k">if</span> <span class="n">target</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="n">pred</span><span class="o">.</span><span class="n">shape</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The shape of target and pred should be the same.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">fill_nan</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">list</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">fill_nan</span><span class="p">)</span> <span class="o">!=</span> <span class="n">target</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;Please give same length of fill_nan as the number of variables.&quot;</span>
        <span class="p">)</span>
    <span class="n">dict_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">target</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]):</span>
        <span class="n">k_dict</span> <span class="o">=</span> <span class="n">stat_error</span><span class="p">(</span><span class="n">target</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">k</span><span class="p">],</span> <span class="n">pred</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">k</span><span class="p">],</span> <span class="n">fill_nan</span><span class="o">=</span><span class="n">fill_nan</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
        <span class="n">dict_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">k_dict</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">dict_list</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="hydroutils.swarmplot_without_legend" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">swarmplot_without_legend</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">hue</span><span class="p">,</span> <span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="p">,</span> <span class="n">cmap</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#hydroutils.swarmplot_without_legend" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Creates a swarm plot using seaborn with colorbar instead of legend.</p>
<p>This function creates a swarm plot where points are colored according to a continuous
variable, replacing the default legend with a colorbar for better visualization of
the color scale.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>x</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Values for x-axis categories.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>y</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Values for y-axis.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>hue</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Values determining the color of each point.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>vmin</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Minimum value for color normalization.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>vmax</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Maximum value for color normalization.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>cmap</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Colormap name or matplotlib colormap object.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>**kwargs</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional keyword arguments passed to sns.swarmplot.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>matplotlib.figure.Figure: The figure containing the swarm plot.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hue</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span> <span class="o">=</span> <span class="n">swarmplot_without_legend</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">hue</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span>
<span class="gp">... </span><span class="p">)</span>
</code></pre></div></td></tr></table></div>


            <details class="quote">
              <summary>Source code in <code>hydroutils/hydro_plot.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">swarmplot_without_legend</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">hue</span><span class="p">,</span> <span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="p">,</span> <span class="n">cmap</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates a swarm plot using seaborn with colorbar instead of legend.</span>

<span class="sd">    This function creates a swarm plot where points are colored according to a continuous</span>
<span class="sd">    variable, replacing the default legend with a colorbar for better visualization of</span>
<span class="sd">    the color scale.</span>

<span class="sd">    Args:</span>
<span class="sd">        x: Values for x-axis categories.</span>
<span class="sd">        y: Values for y-axis.</span>
<span class="sd">        hue: Values determining the color of each point.</span>
<span class="sd">        vmin (float): Minimum value for color normalization.</span>
<span class="sd">        vmax (float): Maximum value for color normalization.</span>
<span class="sd">        cmap (str): Colormap name or matplotlib colormap object.</span>
<span class="sd">        **kwargs: Additional keyword arguments passed to sns.swarmplot.</span>

<span class="sd">    Returns:</span>
<span class="sd">        matplotlib.figure.Figure: The figure containing the swarm plot.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; x = [&#39;A&#39;, &#39;A&#39;, &#39;B&#39;, &#39;B&#39;]</span>
<span class="sd">        &gt;&gt;&gt; y = [1, 2, 3, 4]</span>
<span class="sd">        &gt;&gt;&gt; hue = [0.1, 0.5, 0.8, 0.9]</span>
<span class="sd">        &gt;&gt;&gt; fig = swarmplot_without_legend(</span>
<span class="sd">        ...     x, y, hue,</span>
<span class="sd">        ...     vmin=0, vmax=1,</span>
<span class="sd">        ...     cmap=&#39;viridis&#39;</span>
<span class="sd">        ... )</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">swarmplot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">hue</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="c1"># remove the legend, because we want to set a colorbar instead</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
    <span class="n">norm</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="p">)</span>
    <span class="n">sm</span> <span class="o">=</span> <span class="n">ScalarMappable</span><span class="p">(</span><span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">fig</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="hydroutils.t2str" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">t2str</span><span class="p">(</span><span class="n">t_</span><span class="p">)</span></code>

<a href="#hydroutils.t2str" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Converts between datetime string and datetime object.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>t_</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="str">str</span>, <span title="datetime.datetime">datetime</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Either a date string in 'YYYY-MM-DD' format or a datetime object.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="datetime.datetime">datetime</span>, <span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If input is string: returns datetime object.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="datetime.datetime">datetime</span>, <span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If input is datetime: returns date string in 'YYYY-MM-DD' format.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="NotImplementedError">NotImplementedError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If input type is not supported.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1"># String to datetime</span>
<span class="n">dt</span> <span class="o">=</span> <span class="n">t2str</span><span class="p">(</span><span class="s1">&#39;2023-01-01&#39;</span><span class="p">)</span>  <span class="c1"># Returns datetime(2023, 1, 1)</span>

<span class="c1"># Datetime to string</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">t2str</span><span class="p">(</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2023</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>  <span class="c1"># Returns &#39;2023-01-01&#39;</span>
</code></pre></div></td></tr></table></div>
</details>

            <details class="quote">
              <summary>Source code in <code>hydroutils/hydro_time.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">t2str</span><span class="p">(</span><span class="n">t_</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Converts between datetime string and datetime object.</span>

<span class="sd">    Args:</span>
<span class="sd">        t_: Either a date string in &#39;YYYY-MM-DD&#39; format or a datetime object.</span>

<span class="sd">    Returns:</span>
<span class="sd">        If input is string: returns datetime object.</span>
<span class="sd">        If input is datetime: returns date string in &#39;YYYY-MM-DD&#39; format.</span>

<span class="sd">    Raises:</span>
<span class="sd">        NotImplementedError: If input type is not supported.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        # String to datetime</span>
<span class="sd">        dt = t2str(&#39;2023-01-01&#39;)  # Returns datetime(2023, 1, 1)</span>

<span class="sd">        # Datetime to string</span>
<span class="sd">        s = t2str(datetime(2023, 1, 1))  # Returns &#39;2023-01-01&#39;</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">t_</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">t_</span><span class="p">,</span> <span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">t_</span><span class="p">)</span> <span class="ow">is</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">t_</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;We don&#39;t support this data type yet&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="hydroutils.t_days_lst2range" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">t_days_lst2range</span><span class="p">(</span><span class="n">t_array</span><span class="p">)</span></code>

<a href="#hydroutils.t_days_lst2range" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Converts a list of dates to a date range [start, end].</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>t_array</code>
            </td>
            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of dates, either as np.datetime64 objects or strings in 'YYYY-MM-DD' format.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Two-element list containing start and end dates as strings in 'YYYY-MM-DD' format.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1"># With string dates</span>
<span class="n">dates</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;2000-01-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2000-01-02&#39;</span><span class="p">,</span> <span class="s1">&#39;2000-01-03&#39;</span><span class="p">,</span> <span class="s1">&#39;2000-01-04&#39;</span><span class="p">]</span>
<span class="nb">range</span> <span class="o">=</span> <span class="n">t_days_lst2range</span><span class="p">(</span><span class="n">dates</span><span class="p">)</span>  <span class="c1"># Returns [&#39;2000-01-01&#39;, &#39;2000-01-04&#39;]</span>

<span class="c1"># With datetime64 objects</span>
<span class="n">dates</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;2000-01-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2000-01-04&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;datetime64&#39;</span><span class="p">)</span>
<span class="nb">range</span> <span class="o">=</span> <span class="n">t_days_lst2range</span><span class="p">(</span><span class="n">dates</span><span class="p">)</span>  <span class="c1"># Returns [&#39;2000-01-01&#39;, &#39;2000-01-04&#39;]</span>
</code></pre></div></td></tr></table></div>
</details>

            <details class="quote">
              <summary>Source code in <code>hydroutils/hydro_time.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">t_days_lst2range</span><span class="p">(</span><span class="n">t_array</span><span class="p">:</span> <span class="nb">list</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Converts a list of dates to a date range [start, end].</span>

<span class="sd">    Args:</span>
<span class="sd">        t_array: List of dates, either as np.datetime64 objects or strings in &#39;YYYY-MM-DD&#39; format.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Two-element list containing start and end dates as strings in &#39;YYYY-MM-DD&#39; format.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        # With string dates</span>
<span class="sd">        dates = [&#39;2000-01-01&#39;, &#39;2000-01-02&#39;, &#39;2000-01-03&#39;, &#39;2000-01-04&#39;]</span>
<span class="sd">        range = t_days_lst2range(dates)  # Returns [&#39;2000-01-01&#39;, &#39;2000-01-04&#39;]</span>

<span class="sd">        # With datetime64 objects</span>
<span class="sd">        dates = np.array([&#39;2000-01-01&#39;, &#39;2000-01-04&#39;], dtype=&#39;datetime64&#39;)</span>
<span class="sd">        range = t_days_lst2range(dates)  # Returns [&#39;2000-01-01&#39;, &#39;2000-01-04&#39;]</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">t_array</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">datetime64</span><span class="p">:</span>
        <span class="n">t0</span> <span class="o">=</span> <span class="n">t_array</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">)</span>
        <span class="n">t1</span> <span class="o">=</span> <span class="n">t_array</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">t0</span> <span class="o">=</span> <span class="n">t_array</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">t1</span> <span class="o">=</span> <span class="n">t_array</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">sd</span> <span class="o">=</span> <span class="n">t0</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">ed</span> <span class="o">=</span> <span class="n">t1</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">sd</span><span class="p">,</span> <span class="n">ed</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="hydroutils.t_range_days" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">t_range_days</span><span class="p">(</span><span class="n">t_range</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">timedelta64</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">))</span></code>

<a href="#hydroutils.t_range_days" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Creates a uniformly-spaced array of dates from a date range.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>t_range</code>
            </td>
            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Two-element list containing start and end dates as strings in 'YYYY-MM-DD' format.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>step</code>
            </td>
            <td>
                  <code><span title="numpy.timedelta64">timedelta64</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Time interval between dates. Defaults to 1 day.</p>
              </div>
            </td>
            <td>
                  <code><span title="numpy.timedelta64">timedelta64</span>(1, &#39;D&#39;)</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.array">array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Array of datetime64 objects representing the date range.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">dates</span> <span class="o">=</span> <span class="n">t_range_days</span><span class="p">([</span><span class="s1">&#39;2000-01-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2000-01-05&#39;</span><span class="p">])</span>
<span class="c1"># Returns array([&#39;2000-01-01&#39;, &#39;2000-01-02&#39;, &#39;2000-01-03&#39;, &#39;2000-01-04&#39;],</span>
<span class="c1">#              dtype=&#39;datetime64[D]&#39;)</span>

<span class="c1"># With custom step</span>
<span class="n">dates</span> <span class="o">=</span> <span class="n">t_range_days</span><span class="p">([</span><span class="s1">&#39;2000-01-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2000-01-10&#39;</span><span class="p">],</span> 
                   <span class="n">step</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">timedelta64</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">))</span>
<span class="c1"># Returns dates with 2-day intervals</span>
</code></pre></div></td></tr></table></div>
</details>

            <details class="quote">
              <summary>Source code in <code>hydroutils/hydro_time.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">t_range_days</span><span class="p">(</span><span class="n">t_range</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">step</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">timedelta64</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">timedelta64</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;D&quot;</span><span class="p">))</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates a uniformly-spaced array of dates from a date range.</span>

<span class="sd">    Args:</span>
<span class="sd">        t_range: Two-element list containing start and end dates as strings in &#39;YYYY-MM-DD&#39; format.</span>
<span class="sd">        step: Time interval between dates. Defaults to 1 day.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Array of datetime64 objects representing the date range.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        dates = t_range_days([&#39;2000-01-01&#39;, &#39;2000-01-05&#39;])</span>
<span class="sd">        # Returns array([&#39;2000-01-01&#39;, &#39;2000-01-02&#39;, &#39;2000-01-03&#39;, &#39;2000-01-04&#39;],</span>
<span class="sd">        #              dtype=&#39;datetime64[D]&#39;)</span>

<span class="sd">        # With custom step</span>
<span class="sd">        dates = t_range_days([&#39;2000-01-01&#39;, &#39;2000-01-10&#39;], </span>
<span class="sd">                           step=np.timedelta64(2, &#39;D&#39;))</span>
<span class="sd">        # Returns dates with 2-day intervals</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">sd</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">t_range</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">ed</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">t_range</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">sd</span><span class="p">,</span> <span class="n">ed</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="hydroutils.t_range_days_timedelta" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">t_range_days_timedelta</span><span class="p">(</span><span class="n">t_array</span><span class="p">,</span> <span class="n">td</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">td_type</span><span class="o">=</span><span class="s1">&#39;h&#39;</span><span class="p">)</span></code>

<a href="#hydroutils.t_range_days_timedelta" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Adds a time delta to each date in an array.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>t_array</code>
            </td>
            <td>
                  <code><span title="numpy.array">array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Array of datetime64 objects (typically from t_range_days).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>td</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of time units to add.</p>
              </div>
            </td>
            <td>
                  <code>12</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>td_type</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Time unit type. One of 'Y'(years), 'M'(months), 'D'(days),
    'h'(hours), 'm'(minutes), 's'(seconds).</p>
              </div>
            </td>
            <td>
                  <code>&#39;h&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.array">array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Array of datetime64 objects with added time delta.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="AssertionError">AssertionError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If td_type is not one of the supported types.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">dates</span> <span class="o">=</span> <span class="n">t_range_days</span><span class="p">([</span><span class="s1">&#39;2000-01-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2000-01-03&#39;</span><span class="p">])</span>
<span class="c1"># Add 12 hours to each date</span>
<span class="n">shifted</span> <span class="o">=</span> <span class="n">t_range_days_timedelta</span><span class="p">(</span><span class="n">dates</span><span class="p">,</span> <span class="n">td</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">td_type</span><span class="o">=</span><span class="s1">&#39;h&#39;</span><span class="p">)</span>

<span class="c1"># Add 30 minutes to each date</span>
<span class="n">shifted</span> <span class="o">=</span> <span class="n">t_range_days_timedelta</span><span class="p">(</span><span class="n">dates</span><span class="p">,</span> <span class="n">td</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">td_type</span><span class="o">=</span><span class="s1">&#39;m&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
</details>

            <details class="quote">
              <summary>Source code in <code>hydroutils/hydro_time.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">t_range_days_timedelta</span><span class="p">(</span><span class="n">t_array</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">,</span> <span class="n">td</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">12</span><span class="p">,</span> <span class="n">td_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;h&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Adds a time delta to each date in an array.</span>

<span class="sd">    Args:</span>
<span class="sd">        t_array: Array of datetime64 objects (typically from t_range_days).</span>
<span class="sd">        td: Number of time units to add.</span>
<span class="sd">        td_type: Time unit type. One of &#39;Y&#39;(years), &#39;M&#39;(months), &#39;D&#39;(days),</span>
<span class="sd">                &#39;h&#39;(hours), &#39;m&#39;(minutes), &#39;s&#39;(seconds).</span>

<span class="sd">    Returns:</span>
<span class="sd">        Array of datetime64 objects with added time delta.</span>

<span class="sd">    Raises:</span>
<span class="sd">        AssertionError: If td_type is not one of the supported types.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        dates = t_range_days([&#39;2000-01-01&#39;, &#39;2000-01-03&#39;])</span>
<span class="sd">        # Add 12 hours to each date</span>
<span class="sd">        shifted = t_range_days_timedelta(dates, td=12, td_type=&#39;h&#39;)</span>

<span class="sd">        # Add 30 minutes to each date</span>
<span class="sd">        shifted = t_range_days_timedelta(dates, td=30, td_type=&#39;m&#39;)</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="n">td_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Y&quot;</span><span class="p">,</span> <span class="s2">&quot;M&quot;</span><span class="p">,</span> <span class="s2">&quot;D&quot;</span><span class="p">,</span> <span class="s2">&quot;h&quot;</span><span class="p">,</span> <span class="s2">&quot;m&quot;</span><span class="p">,</span> <span class="s2">&quot;s&quot;</span><span class="p">]</span>
    <span class="n">t_array_final</span> <span class="o">=</span> <span class="p">[</span><span class="n">t</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">timedelta64</span><span class="p">(</span><span class="n">td</span><span class="p">,</span> <span class="n">td_type</span><span class="p">)</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">t_array</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">t_array_final</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="hydroutils.t_range_to_julian" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">t_range_to_julian</span><span class="p">(</span><span class="n">t_range</span><span class="p">)</span></code>

<a href="#hydroutils.t_range_to_julian" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Converts a date range to a list of Julian days.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>t_range</code>
            </td>
            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Two-element list containing start and end dates as strings in 'YYYY-MM-DD' format.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of Julian days (days of year) for each date in the range.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">days</span> <span class="o">=</span> <span class="n">t_range_to_julian</span><span class="p">([</span><span class="s1">&#39;2023-01-31&#39;</span><span class="p">,</span> <span class="s1">&#39;2023-02-03&#39;</span><span class="p">])</span>
<span class="c1"># Returns [31, 32, 33, 34]  # Julian days for Jan 31 - Feb 3</span>
</code></pre></div></td></tr></table></div>
</details>

            <details class="quote">
              <summary>Source code in <code>hydroutils/hydro_time.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">t_range_to_julian</span><span class="p">(</span><span class="n">t_range</span><span class="p">:</span> <span class="nb">list</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Converts a date range to a list of Julian days.</span>

<span class="sd">    Args:</span>
<span class="sd">        t_range: Two-element list containing start and end dates as strings in &#39;YYYY-MM-DD&#39; format.</span>

<span class="sd">    Returns:</span>
<span class="sd">        List of Julian days (days of year) for each date in the range.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        days = t_range_to_julian([&#39;2023-01-31&#39;, &#39;2023-02-03&#39;])</span>
<span class="sd">        # Returns [31, 32, 33, 34]  # Julian days for Jan 31 - Feb 3</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">t_array</span> <span class="o">=</span> <span class="n">t_range_days</span><span class="p">(</span><span class="n">t_range</span><span class="p">)</span>
    <span class="n">t_array_str</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">datetime_as_string</span><span class="p">(</span><span class="n">t_array</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">date_to_julian</span><span class="p">(</span><span class="n">a_time</span><span class="p">[:</span><span class="mi">10</span><span class="p">])</span> <span class="k">for</span> <span class="n">a_time</span> <span class="ow">in</span> <span class="n">t_array_str</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="hydroutils.t_range_years" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">t_range_years</span><span class="p">(</span><span class="n">t_range</span><span class="p">)</span></code>

<a href="#hydroutils.t_range_years" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Extracts years from a date range, handling year boundaries.</p>
<p>The function treats the range as left-closed and right-open. If the end date
is not January 1st, the end year is included in the range.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>t_range</code>
            </td>
            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Two-element list containing start and end dates as strings in 'YYYY-MM-DD' format.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.array">array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Array of years included in the range.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1"># End date is Jan 1st - end year not included</span>
<span class="n">years</span> <span class="o">=</span> <span class="n">t_range_years</span><span class="p">([</span><span class="s1">&#39;2000-01-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2003-01-01&#39;</span><span class="p">])</span>
<span class="c1"># Returns array([2000, 2001, 2002])</span>

<span class="c1"># End date is not Jan 1st - end year included</span>
<span class="n">years</span> <span class="o">=</span> <span class="n">t_range_years</span><span class="p">([</span><span class="s1">&#39;2000-01-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2003-06-01&#39;</span><span class="p">])</span>
<span class="c1"># Returns array([2000, 2001, 2002, 2003])</span>
</code></pre></div></td></tr></table></div>
</details>

            <details class="quote">
              <summary>Source code in <code>hydroutils/hydro_time.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">t_range_years</span><span class="p">(</span><span class="n">t_range</span><span class="p">:</span> <span class="nb">list</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Extracts years from a date range, handling year boundaries.</span>

<span class="sd">    The function treats the range as left-closed and right-open. If the end date</span>
<span class="sd">    is not January 1st, the end year is included in the range.</span>

<span class="sd">    Args:</span>
<span class="sd">        t_range: Two-element list containing start and end dates as strings in &#39;YYYY-MM-DD&#39; format.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Array of years included in the range.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        # End date is Jan 1st - end year not included</span>
<span class="sd">        years = t_range_years([&#39;2000-01-01&#39;, &#39;2003-01-01&#39;])</span>
<span class="sd">        # Returns array([2000, 2001, 2002])</span>

<span class="sd">        # End date is not Jan 1st - end year included</span>
<span class="sd">        years = t_range_years([&#39;2000-01-01&#39;, &#39;2003-06-01&#39;])</span>
<span class="sd">        # Returns array([2000, 2001, 2002, 2003])</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">start_year</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">t_range</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">end_year</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">t_range</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">end_month</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">t_range</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">end_day</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">t_range</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">)[</span><span class="mi">2</span><span class="p">])</span>
    <span class="k">return</span> <span class="p">(</span>
        <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">start_year</span><span class="p">,</span> <span class="n">end_year</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">end_month</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">end_day</span> <span class="o">==</span> <span class="mi">1</span>
        <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">start_year</span><span class="p">,</span> <span class="n">end_year</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="hydroutils.trans_norm" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">trans_norm</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">var_lst</span><span class="p">,</span> <span class="n">stat_dict</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">to_norm</span><span class="p">)</span></code>

<a href="#hydroutils.trans_norm" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Normalizes or denormalizes data using pre-computed statistics.</p>
<p>Performs z-score normalization (x-mean)/std or its inverse on multiple variables.
Handles both 2D and 3D arrays.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>x</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Input data array:
- 2D: [n_sites, n_variables]
- 3D: [n_sites, n_timesteps, n_variables]</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>var_lst</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="str">str</span>, <span title="list">list</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Variable name(s) corresponding to the last dimension of x.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>stat_dict</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary containing [p10, p90, mean, std] for each variable.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>to_norm</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, normalizes data; if False, denormalizes data.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Normalized or denormalized data with same shape as input.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1"># Normalization</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">200</span><span class="p">]])</span>  <span class="c1"># 2 sites, 2 variables</span>
<span class="n">stats</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;flow&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>    <span class="c1"># [p10, p90, mean, std]</span>
    <span class="s1">&#39;precip&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">50</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">50</span><span class="p">]</span>
<span class="p">}</span>
<span class="n">norm_data</span> <span class="o">=</span> <span class="n">trans_norm</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;flow&#39;</span><span class="p">,</span> <span class="s1">&#39;precip&#39;</span><span class="p">],</span> <span class="n">stats</span><span class="p">,</span> <span class="n">to_norm</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Denormalization</span>
<span class="n">orig_data</span> <span class="o">=</span> <span class="n">trans_norm</span><span class="p">(</span><span class="n">norm_data</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;flow&#39;</span><span class="p">,</span> <span class="s1">&#39;precip&#39;</span><span class="p">],</span> <span class="n">stats</span><span class="p">,</span> <span class="n">to_norm</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
</details>

<details class="note" open>
  <summary>Note</summary>
  <ul>
<li>For normalization: (x - mean) / std</li>
<li>For denormalization: x * std + mean</li>
<li>Handles multiple variables simultaneously</li>
</ul>
</details>

            <details class="quote">
              <summary>Source code in <code>hydroutils/hydro_stat.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">trans_norm</span><span class="p">(</span>
    <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">var_lst</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">],</span>
    <span class="n">stat_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">to_norm</span><span class="p">:</span> <span class="nb">bool</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Normalizes or denormalizes data using pre-computed statistics.</span>

<span class="sd">    Performs z-score normalization (x-mean)/std or its inverse on multiple variables.</span>
<span class="sd">    Handles both 2D and 3D arrays.</span>

<span class="sd">    Args:</span>
<span class="sd">        x: Input data array:</span>
<span class="sd">            - 2D: [n_sites, n_variables]</span>
<span class="sd">            - 3D: [n_sites, n_timesteps, n_variables]</span>
<span class="sd">        var_lst: Variable name(s) corresponding to the last dimension of x.</span>
<span class="sd">        stat_dict: Dictionary containing [p10, p90, mean, std] for each variable.</span>
<span class="sd">        to_norm: If True, normalizes data; if False, denormalizes data.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Normalized or denormalized data with same shape as input.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        # Normalization</span>
<span class="sd">        data = np.array([[1, 100], [2, 200]])  # 2 sites, 2 variables</span>
<span class="sd">        stats = {</span>
<span class="sd">            &#39;flow&#39;: [0, 5, 1.5, 0.5],    # [p10, p90, mean, std]</span>
<span class="sd">            &#39;precip&#39;: [50, 250, 150, 50]</span>
<span class="sd">        }</span>
<span class="sd">        norm_data = trans_norm(data, [&#39;flow&#39;, &#39;precip&#39;], stats, to_norm=True)</span>

<span class="sd">        # Denormalization</span>
<span class="sd">        orig_data = trans_norm(norm_data, [&#39;flow&#39;, &#39;precip&#39;], stats, to_norm=False)</span>
<span class="sd">        ```</span>

<span class="sd">    Note:</span>
<span class="sd">        - For normalization: (x - mean) / std</span>
<span class="sd">        - For denormalization: x * std + mean</span>
<span class="sd">        - Handles multiple variables simultaneously</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">var_lst</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">var_lst</span> <span class="o">=</span> <span class="p">[</span><span class="n">var_lst</span><span class="p">]</span>
    <span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">var_lst</span><span class="p">)):</span>
        <span class="n">var</span> <span class="o">=</span> <span class="n">var_lst</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
        <span class="n">stat</span> <span class="o">=</span> <span class="n">stat_dict</span><span class="p">[</span><span class="n">var</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">to_norm</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                <span class="n">out</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="n">stat</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">/</span> <span class="n">stat</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">out</span><span class="p">[:,</span> <span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="p">[:,</span> <span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="n">stat</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">/</span> <span class="n">stat</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="n">out</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">k</span><span class="p">]</span> <span class="o">*</span> <span class="n">stat</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">+</span> <span class="n">stat</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">out</span><span class="p">[:,</span> <span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[:,</span> <span class="n">k</span><span class="p">]</span> <span class="o">*</span> <span class="n">stat</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">+</span> <span class="n">stat</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">out</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="hydroutils.unserialize_json" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">unserialize_json</span><span class="p">(</span><span class="n">my_file</span><span class="p">)</span></code>

<a href="#hydroutils.unserialize_json" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Loads a JSON file into a dictionary.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>my_file</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to the JSON file to load.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary containing the JSON data.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">data</span> <span class="o">=</span> <span class="n">unserialize_json</span><span class="p">(</span><span class="s1">&#39;config.json&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;settings&#39;</span><span class="p">])</span>
</code></pre></div></td></tr></table></div>
</details>

            <details class="quote">
              <summary>Source code in <code>hydroutils/hydro_file.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">unserialize_json</span><span class="p">(</span><span class="n">my_file</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Loads a JSON file into a dictionary.</span>

<span class="sd">    Args:</span>
<span class="sd">        my_file: Path to the JSON file to load.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dictionary containing the JSON data.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        data = unserialize_json(&#39;config.json&#39;)</span>
<span class="sd">        print(data[&#39;settings&#39;])</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">my_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
        <span class="n">my_object</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">fp</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">my_object</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="hydroutils.unserialize_json_ordered" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">unserialize_json_ordered</span><span class="p">(</span><span class="n">my_file</span><span class="p">)</span></code>

<a href="#hydroutils.unserialize_json_ordered" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Loads a JSON file into an OrderedDict, preserving key order.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>my_file</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to the JSON file to load.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="collections.OrderedDict">OrderedDict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>OrderedDict containing the JSON data with preserved key order.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">data</span> <span class="o">=</span> <span class="n">unserialize_json_ordered</span><span class="p">(</span><span class="s1">&#39;config.json&#39;</span><span class="p">)</span>
<span class="c1"># Keys in data maintain their original order from the file</span>
</code></pre></div></td></tr></table></div>
</details>

            <details class="quote">
              <summary>Source code in <code>hydroutils/hydro_file.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">unserialize_json_ordered</span><span class="p">(</span><span class="n">my_file</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">OrderedDict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Loads a JSON file into an OrderedDict, preserving key order.</span>

<span class="sd">    Args:</span>
<span class="sd">        my_file: Path to the JSON file to load.</span>

<span class="sd">    Returns:</span>
<span class="sd">        OrderedDict containing the JSON data with preserved key order.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        data = unserialize_json_ordered(&#39;config.json&#39;)</span>
<span class="sd">        # Keys in data maintain their original order from the file</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">my_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
        <span class="n">m_dict</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="n">object_pairs_hook</span><span class="o">=</span><span class="n">OrderedDict</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">m_dict</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="hydroutils.unserialize_numpy" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">unserialize_numpy</span><span class="p">(</span><span class="n">my_file</span><span class="p">)</span></code>

<a href="#hydroutils.unserialize_numpy" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Loads a NumPy array from a .npy file.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>my_file</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to the .npy file to load.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The loaded NumPy array.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">arr</span> <span class="o">=</span> <span class="n">unserialize_numpy</span><span class="p">(</span><span class="s1">&#39;array.npy&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># Shows array dimensions</span>
</code></pre></div></td></tr></table></div>
</details>

            <details class="quote">
              <summary>Source code in <code>hydroutils/hydro_file.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">unserialize_numpy</span><span class="p">(</span><span class="n">my_file</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Loads a NumPy array from a .npy file.</span>

<span class="sd">    Args:</span>
<span class="sd">        my_file: Path to the .npy file to load.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The loaded NumPy array.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        arr = unserialize_numpy(&#39;array.npy&#39;)</span>
<span class="sd">        print(arr.shape)  # Shows array dimensions</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">my_file</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="hydroutils.unserialize_pickle" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">unserialize_pickle</span><span class="p">(</span><span class="n">my_file</span><span class="p">)</span></code>

<a href="#hydroutils.unserialize_pickle" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Loads an object from a pickle file.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>my_file</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to the pickle file to load.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="object">object</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The deserialized Python object.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">obj</span> <span class="o">=</span> <span class="n">unserialize_pickle</span><span class="p">(</span><span class="s1">&#39;object.pkl&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>  <span class="c1"># Assuming obj has a &#39;value&#39; attribute</span>
</code></pre></div></td></tr></table></div>
</details>

            <details class="quote">
              <summary>Source code in <code>hydroutils/hydro_file.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">unserialize_pickle</span><span class="p">(</span><span class="n">my_file</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">object</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Loads an object from a pickle file.</span>

<span class="sd">    Args:</span>
<span class="sd">        my_file: Path to the pickle file to load.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The deserialized Python object.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        obj = unserialize_pickle(&#39;object.pkl&#39;)</span>
<span class="sd">        print(obj.value)  # Assuming obj has a &#39;value&#39; attribute</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">my_file</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">my_object</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">my_object</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="hydroutils.unzip_file" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">unzip_file</span><span class="p">(</span><span class="n">data_zip</span><span class="p">,</span> <span class="n">path_unzip</span><span class="p">)</span></code>

<a href="#hydroutils.unzip_file" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Extracts a zip file to a specified directory.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>data_zip</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to the zip file.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>path_unzip</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Directory where contents should be extracted.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">unzip_file</span><span class="p">(</span><span class="s1">&#39;data.zip&#39;</span><span class="p">,</span> <span class="s1">&#39;./extracted&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
</details>

            <details class="quote">
              <summary>Source code in <code>hydroutils/hydro_file.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">unzip_file</span><span class="p">(</span><span class="n">data_zip</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">path_unzip</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Extracts a zip file to a specified directory.</span>

<span class="sd">    Args:</span>
<span class="sd">        data_zip: Path to the zip file.</span>
<span class="sd">        path_unzip: Directory where contents should be extracted.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        unzip_file(&#39;data.zip&#39;, &#39;./extracted&#39;)</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="n">zipfile</span><span class="o">.</span><span class="n">ZipFile</span><span class="p">(</span><span class="n">data_zip</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">zip_temp</span><span class="p">:</span>
        <span class="n">zip_temp</span><span class="o">.</span><span class="n">extractall</span><span class="p">(</span><span class="n">path_unzip</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="hydroutils.unzip_nested_zip" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">unzip_nested_zip</span><span class="p">(</span><span class="n">dataset_zip</span><span class="p">,</span> <span class="n">path_unzip</span><span class="p">)</span></code>

<a href="#hydroutils.unzip_nested_zip" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Recursively extracts a zip file and any nested zip files within it.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>dataset_zip</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to the zip file.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>path_unzip</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Directory where contents should be extracted.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Note</summary>
  <p>If a file's name ends with underscore (e.g., "xxx_"), the zipfile library
may raise an OSError. In such cases, check the extracted files manually.</p>
</details>

<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1"># Extract main.zip containing nested archives</span>
<span class="n">unzip_nested_zip</span><span class="p">(</span><span class="s1">&#39;main.zip&#39;</span><span class="p">,</span> <span class="s1">&#39;./extracted&#39;</span><span class="p">)</span>
<span class="c1"># Extracts:</span>
<span class="c1"># - main.zip -&gt; ./extracted/*</span>
<span class="c1"># - Any *.zip in extracted/* -&gt; ./extracted/*/subdir/*</span>
</code></pre></div></td></tr></table></div>
</details>

            <details class="quote">
              <summary>Source code in <code>hydroutils/hydro_file.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">unzip_nested_zip</span><span class="p">(</span><span class="n">dataset_zip</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">path_unzip</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Recursively extracts a zip file and any nested zip files within it.</span>

<span class="sd">    Args:</span>
<span class="sd">        dataset_zip: Path to the zip file.</span>
<span class="sd">        path_unzip: Directory where contents should be extracted.</span>

<span class="sd">    Note:</span>
<span class="sd">        If a file&#39;s name ends with underscore (e.g., &quot;xxx_&quot;), the zipfile library</span>
<span class="sd">        may raise an OSError. In such cases, check the extracted files manually.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        # Extract main.zip containing nested archives</span>
<span class="sd">        unzip_nested_zip(&#39;main.zip&#39;, &#39;./extracted&#39;)</span>
<span class="sd">        # Extracts:</span>
<span class="sd">        # - main.zip -&gt; ./extracted/*</span>
<span class="sd">        # - Any *.zip in extracted/* -&gt; ./extracted/*/subdir/*</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">with</span> <span class="n">zipfile</span><span class="o">.</span><span class="n">ZipFile</span><span class="p">(</span><span class="n">dataset_zip</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">zfile</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">zfile</span><span class="o">.</span><span class="n">extractall</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="n">path_unzip</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">OSError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="s2">&quot;Please check the unzipped files manually. There may be some missed important files.&quot;</span>
            <span class="p">)</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The directory is: </span><span class="si">{</span><span class="n">path_unzip</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error message: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">root</span><span class="p">,</span> <span class="n">dirs</span><span class="p">,</span> <span class="n">files</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">path_unzip</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\.zip$&quot;</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
                <span class="n">file_spec</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
                <span class="n">new_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">filename</span><span class="p">[:</span><span class="o">-</span><span class="mi">4</span><span class="p">])</span>
                <span class="n">unzip_nested_zip</span><span class="p">(</span><span class="n">file_spec</span><span class="p">,</span> <span class="n">new_dir</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="hydroutils.validate_correction_quality" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">validate_correction_quality</span><span class="p">(</span><span class="n">original_data</span><span class="p">,</span> <span class="n">corrected_data</span><span class="p">,</span> <span class="n">discharge_column</span><span class="o">=</span><span class="s1">&#39;gen_discharge&#39;</span><span class="p">)</span></code>

<a href="#hydroutils.validate_correction_quality" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>验证修正质量</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>original_data</code>
            </td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>原始数据</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>corrected_data</code>
            </td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>修正后数据</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>discharge_column</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>径流列名</p>
              </div>
            </td>
            <td>
                  <code>&#39;gen_discharge&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>质量指标字典</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>hydroutils/hydro_correct.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">validate_correction_quality</span><span class="p">(</span>
    <span class="n">original_data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">corrected_data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">discharge_column</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;gen_discharge&quot;</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    验证修正质量</span>

<span class="sd">    Args:</span>
<span class="sd">        original_data: 原始数据</span>
<span class="sd">        corrected_data: 修正后数据</span>
<span class="sd">        discharge_column: 径流列名</span>

<span class="sd">    Returns:</span>
<span class="sd">        质量指标字典</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="p">(</span>
        <span class="n">discharge_column</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">original_data</span><span class="o">.</span><span class="n">columns</span>
        <span class="ow">or</span> <span class="n">discharge_column</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">corrected_data</span><span class="o">.</span><span class="n">columns</span>
    <span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;数据中缺少径流列: </span><span class="si">{</span><span class="n">discharge_column</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">original_values</span> <span class="o">=</span> <span class="n">original_data</span><span class="p">[</span><span class="n">discharge_column</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
    <span class="n">corrected_values</span> <span class="o">=</span> <span class="n">corrected_data</span><span class="p">[</span><span class="n">discharge_column</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

    <span class="c1"># 计算质量指标</span>
    <span class="n">mse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="n">corrected_values</span> <span class="o">-</span> <span class="n">original_values</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">rmse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mse</span><span class="p">)</span>
    <span class="n">mae</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">corrected_values</span> <span class="o">-</span> <span class="n">original_values</span><span class="p">))</span>

    <span class="c1"># 相对误差</span>
    <span class="n">relative_error</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">corrected_values</span> <span class="o">-</span> <span class="n">original_values</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">original_values</span> <span class="o">+</span> <span class="mf">1e-8</span><span class="p">))</span>
        <span class="o">*</span> <span class="mi">100</span>
    <span class="p">)</span>

    <span class="c1"># 峰值保持度</span>
    <span class="n">original_peak</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">original_values</span><span class="p">)</span>
    <span class="n">corrected_peak</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">corrected_values</span><span class="p">)</span>
    <span class="n">peak_preservation</span> <span class="o">=</span> <span class="n">corrected_peak</span> <span class="o">/</span> <span class="n">original_peak</span> <span class="k">if</span> <span class="n">original_peak</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mf">1.0</span>

    <span class="k">return</span> <span class="p">{</span>
        <span class="s2">&quot;mse&quot;</span><span class="p">:</span> <span class="n">mse</span><span class="p">,</span>
        <span class="s2">&quot;rmse&quot;</span><span class="p">:</span> <span class="n">rmse</span><span class="p">,</span>
        <span class="s2">&quot;mae&quot;</span><span class="p">:</span> <span class="n">mae</span><span class="p">,</span>
        <span class="s2">&quot;relative_error_percent&quot;</span><span class="p">:</span> <span class="n">relative_error</span><span class="p">,</span>
        <span class="s2">&quot;peak_preservation_ratio&quot;</span><span class="p">:</span> <span class="n">peak_preservation</span><span class="p">,</span>
        <span class="s2">&quot;original_peak&quot;</span><span class="p">:</span> <span class="n">original_peak</span><span class="p">,</span>
        <span class="s2">&quot;corrected_peak&quot;</span><span class="p">:</span> <span class="n">corrected_peak</span><span class="p">,</span>
    <span class="p">}</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="hydroutils.wilcoxon_t_test" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">wilcoxon_t_test</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">xo</span><span class="p">)</span></code>

<a href="#hydroutils.wilcoxon_t_test" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Performs Wilcoxon signed-rank test on paired samples.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>xs</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>First sample array.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>xo</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Second sample array (same length as xs).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Tuple">Tuple</span>[<span title="float">float</span>, <span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Tuple of (test_statistic, p_value).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">x1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="n">x2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">2.2</span><span class="p">,</span> <span class="mf">2.9</span><span class="p">,</span> <span class="mf">4.2</span><span class="p">,</span> <span class="mf">5.1</span><span class="p">])</span>
<span class="n">w</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">wilcoxon_t_test</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;p-value: </span><span class="si">{</span><span class="n">p</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># Test significance</span>
</code></pre></div></td></tr></table></div>
</details>

<details class="note" open>
  <summary>Note</summary>
  <p>Tests the null hypothesis that two related paired samples
come from the same distribution.</p>
</details>

            <details class="quote">
              <summary>Source code in <code>hydroutils/hydro_stat.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">wilcoxon_t_test</span><span class="p">(</span><span class="n">xs</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">xo</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Performs Wilcoxon signed-rank test on paired samples.</span>

<span class="sd">    Args:</span>
<span class="sd">        xs: First sample array.</span>
<span class="sd">        xo: Second sample array (same length as xs).</span>

<span class="sd">    Returns:</span>
<span class="sd">        Tuple of (test_statistic, p_value).</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        x1 = np.array([1, 2, 3, 4, 5])</span>
<span class="sd">        x2 = np.array([1.1, 2.2, 2.9, 4.2, 5.1])</span>
<span class="sd">        w, p = wilcoxon_t_test(x1, x2)</span>
<span class="sd">        print(f&quot;p-value: {p:.3f}&quot;)  # Test significance</span>
<span class="sd">        ```</span>

<span class="sd">    Note:</span>
<span class="sd">        Tests the null hypothesis that two related paired samples</span>
<span class="sd">        come from the same distribution.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">diff</span> <span class="o">=</span> <span class="n">xs</span> <span class="o">-</span> <span class="n">xo</span>  <span class="c1"># same result when using xo-xs</span>
    <span class="n">w</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">wilcoxon</span><span class="p">(</span><span class="n">diff</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">w</span><span class="p">,</span> <span class="n">p</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="hydroutils.wilcoxon_t_test_for_lst" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">wilcoxon_t_test_for_lst</span><span class="p">(</span><span class="n">x_lst</span><span class="p">,</span> <span class="n">rnd_num</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span></code>

<a href="#hydroutils.wilcoxon_t_test_for_lst" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Performs pairwise Wilcoxon tests between all arrays in a list.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>x_lst</code>
            </td>
            <td>
                  <code><span title="typing.List">List</span>[<span title="numpy.ndarray">ndarray</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of arrays to compare.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>rnd_num</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of decimal places to round results. Defaults to 2.</p>
              </div>
            </td>
            <td>
                  <code>2</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Tuple of (test_statistics, p_values), where each element is a list of</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>rounded values for each pairwise comparison.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">arrays</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]),</span>
    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">2.2</span><span class="p">,</span> <span class="mf">2.9</span><span class="p">,</span> <span class="mf">4.2</span><span class="p">,</span> <span class="mf">5.1</span><span class="p">]),</span>
    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.2</span><span class="p">,</span> <span class="mf">2.1</span><span class="p">,</span> <span class="mf">3.1</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">,</span> <span class="mf">5.2</span><span class="p">])</span>
<span class="p">]</span>
<span class="n">w</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">wilcoxon_t_test_for_lst</span><span class="p">(</span><span class="n">arrays</span><span class="p">)</span>
<span class="c1"># Returns test statistics and p-values for:</span>
<span class="c1"># - arrays[0] vs arrays[1]</span>
<span class="c1"># - arrays[0] vs arrays[2]</span>
<span class="c1"># - arrays[1] vs arrays[2]</span>
</code></pre></div></td></tr></table></div>
</details>

            <details class="quote">
              <summary>Source code in <code>hydroutils/hydro_stat.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">wilcoxon_t_test_for_lst</span><span class="p">(</span><span class="n">x_lst</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span> <span class="n">rnd_num</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Performs pairwise Wilcoxon tests between all arrays in a list.</span>

<span class="sd">    Args:</span>
<span class="sd">        x_lst: List of arrays to compare.</span>
<span class="sd">        rnd_num: Number of decimal places to round results. Defaults to 2.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Tuple of (test_statistics, p_values), where each element is a list of</span>
<span class="sd">        rounded values for each pairwise comparison.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        arrays = [</span>
<span class="sd">            np.array([1, 2, 3, 4, 5]),</span>
<span class="sd">            np.array([1.1, 2.2, 2.9, 4.2, 5.1]),</span>
<span class="sd">            np.array([1.2, 2.1, 3.1, 4.0, 5.2])</span>
<span class="sd">        ]</span>
<span class="sd">        w, p = wilcoxon_t_test_for_lst(arrays)</span>
<span class="sd">        # Returns test statistics and p-values for:</span>
<span class="sd">        # - arrays[0] vs arrays[1]</span>
<span class="sd">        # - arrays[0] vs arrays[2]</span>
<span class="sd">        # - arrays[1] vs arrays[2]</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">arr_lst</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">x_lst</span><span class="p">)</span>
    <span class="n">w</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="n">arr_lst_pair</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">combinations</span><span class="p">(</span><span class="n">arr_lst</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">arr_pair</span> <span class="ow">in</span> <span class="n">arr_lst_pair</span><span class="p">:</span>
        <span class="n">wi</span><span class="p">,</span> <span class="n">pi</span> <span class="o">=</span> <span class="n">wilcoxon_t_test</span><span class="p">(</span><span class="n">arr_pair</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">arr_pair</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">w</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">wi</span><span class="p">,</span> <span class="n">rnd_num</span><span class="p">))</span>
        <span class="n">p</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">pi</span><span class="p">,</span> <span class="n">rnd_num</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">w</span><span class="p">,</span> <span class="n">p</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="hydroutils.zip_extract" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">zip_extract</span><span class="p">(</span><span class="n">the_dir</span><span class="p">)</span></code>

<a href="#hydroutils.zip_extract" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Extracts all zip files in a directory.</p>
<p>Each zip file is extracted to a subdirectory named after the zip file
(without the .zip extension).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>the_dir</code>
            </td>
            <td>
                  <code><span title="pathlib.Path">Path</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Directory containing zip files to extract.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
<span class="n">zip_extract</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="s1">&#39;./downloads&#39;</span><span class="p">))</span>
<span class="c1"># Extracts:</span>
<span class="c1"># - ./downloads/file1.zip -&gt; ./downloads/file1/*</span>
<span class="c1"># - ./downloads/file2.zip -&gt; ./downloads/file2/*</span>
</code></pre></div></td></tr></table></div>
</details>

            <details class="quote">
              <summary>Source code in <code>hydroutils/hydro_file.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">zip_extract</span><span class="p">(</span><span class="n">the_dir</span><span class="p">:</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Extracts all zip files in a directory.</span>

<span class="sd">    Each zip file is extracted to a subdirectory named after the zip file</span>
<span class="sd">    (without the .zip extension).</span>

<span class="sd">    Args:</span>
<span class="sd">        the_dir: Directory containing zip files to extract.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        from pathlib import Path</span>
<span class="sd">        zip_extract(Path(&#39;./downloads&#39;))</span>
<span class="sd">        # Extracts:</span>
<span class="sd">        # - ./downloads/file1.zip -&gt; ./downloads/file1/*</span>
<span class="sd">        # - ./downloads/file2.zip -&gt; ./downloads/file2/*</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">the_dir</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s2">&quot;*.zip&quot;</span><span class="p">):</span>
        <span class="k">with</span> <span class="n">zipfile</span><span class="o">.</span><span class="n">ZipFile</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="k">as</span> <span class="n">zf</span><span class="p">:</span>
            <span class="c1"># extract files to a directory named by f.stem</span>
            <span class="n">zf</span><span class="o">.</span><span class="n">extractall</span><span class="p">(</span><span class="n">the_dir</span><span class="o">.</span><span class="n">joinpath</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">stem</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="hydroutils.zip_file_name_from_url" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">zip_file_name_from_url</span><span class="p">(</span><span class="n">data_url</span><span class="p">,</span> <span class="n">data_dir</span><span class="p">)</span></code>

<a href="#hydroutils.zip_file_name_from_url" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Generates local file paths for a zip file from its URL.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>data_url</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>URL of the zip file.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>data_dir</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Local directory where the file will be saved.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="tuple">tuple</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Tuple of (zip_file_path, unzip_directory_path).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;https://example.com/data.zip&#39;</span>
<span class="n">zip_path</span><span class="p">,</span> <span class="n">extract_path</span> <span class="o">=</span> <span class="n">zip_file_name_from_url</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="s1">&#39;./downloads&#39;</span><span class="p">)</span>
<span class="c1"># Returns:</span>
<span class="c1"># - zip_path = &#39;./downloads/data.zip&#39;</span>
<span class="c1"># - extract_path = &#39;./downloads/data&#39;</span>
</code></pre></div></td></tr></table></div>
</details>

            <details class="quote">
              <summary>Source code in <code>hydroutils/hydro_file.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">zip_file_name_from_url</span><span class="p">(</span><span class="n">data_url</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">data_dir</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generates local file paths for a zip file from its URL.</span>

<span class="sd">    Args:</span>
<span class="sd">        data_url: URL of the zip file.</span>
<span class="sd">        data_dir: Local directory where the file will be saved.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Tuple of (zip_file_path, unzip_directory_path).</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        url = &#39;https://example.com/data.zip&#39;</span>
<span class="sd">        zip_path, extract_path = zip_file_name_from_url(url, &#39;./downloads&#39;)</span>
<span class="sd">        # Returns:</span>
<span class="sd">        # - zip_path = &#39;./downloads/data.zip&#39;</span>
<span class="sd">        # - extract_path = &#39;./downloads/data&#39;</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_url_str</span> <span class="o">=</span> <span class="n">data_url</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="n">parse</span><span class="o">.</span><span class="n">unquote</span><span class="p">(</span><span class="n">data_url_str</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">zipfile_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
    <span class="n">unzip_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span> <span class="n">filename</span><span class="p">[:</span><span class="o">-</span><span class="mi">4</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">zipfile_path</span><span class="p">,</span> <span class="n">unzip_dir</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><h2 id="submodules">Submodules<a class="headerlink" href="#submodules" title="Permanent link">&para;</a></h2>
<p>The <code>hydroutils</code> package consists of several specialized modules:</p>
<ul>
<li><strong><a href="../hydro_stat/">hydro_stat</a></strong> - Statistical analysis and performance metrics</li>
<li><strong><a href="../hydro_plot/">hydro_plot</a></strong> - Visualization tools for hydrological data  </li>
<li><strong><a href="../hydro_time/">hydro_time</a></strong> - Time series processing utilities</li>
<li><strong><a href="../hydro_file/">hydro_file</a></strong> - File I/O operations</li>
<li><strong><a href="../hydro_arithmetric/">hydro_arithmetric</a></strong> - Mathematical operations</li>
<li><strong><a href="../hydro_s3/">hydro_s3</a></strong> - AWS S3 integration</li>
<li><strong><a href="../hydro_log/">hydro_log</a></strong> - Logging utilities</li>
</ul>
<p>Click on any module above for detailed function documentation.</p>







  
    
  
  


  <aside class="md-source-file">
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Last update">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg>
    </span>
    2025-08-19
  </span>

    
    
    
    
  </aside>





                

              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.instant", "search.highlight"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.92b07e13.min.js"></script>
      
    
  </body>
</html>