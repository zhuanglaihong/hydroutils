
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://zhuanglaihong.github.io/hydroutils/api/hydroutils/">
      
      
        <link rel="prev" href="../../faq/">
      
      
        <link rel="next" href="../hydro_stat/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.17">
    
    
      
        <title>Overview - hydroutils</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.7e37652d.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="preference" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#api-reference" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="hydroutils" class="md-header__button md-logo" aria-label="hydroutils" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            hydroutils
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Overview
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/zhuanglaihong/hydroutils" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="hydroutils" class="md-nav__button md-logo" aria-label="hydroutils" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    hydroutils
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/zhuanglaihong/hydroutils" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Getting Started
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Getting Started
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../installation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Installation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../usage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Quick Start
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    FAQ
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    API Reference
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            API Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#core-module" class="md-nav__link">
    <span class="md-ellipsis">
      Core Module
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils" class="md-nav__link">
    <span class="md-ellipsis">
      hydroutils
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.hydro_arithmetric" class="md-nav__link">
    <span class="md-ellipsis">
      hydro_arithmetric
    </span>
  </a>
  
    <nav class="md-nav" aria-label="hydro_arithmetric">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_arithmetric.random_choice_no_return" class="md-nav__link">
    <span class="md-ellipsis">
      random_choice_no_return()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.hydro_file" class="md-nav__link">
    <span class="md-ellipsis">
      hydro_file
    </span>
  </a>
  
    <nav class="md-nav" aria-label="hydro_file">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_file.NumpyArrayEncoder" class="md-nav__link">
    <span class="md-ellipsis">
      NumpyArrayEncoder
    </span>
  </a>
  
    <nav class="md-nav" aria-label="NumpyArrayEncoder">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_file.NumpyArrayEncoder.convert_ndarray" class="md-nav__link">
    <span class="md-ellipsis">
      convert_ndarray()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_file.NumpyArrayEncoder.default" class="md-nav__link">
    <span class="md-ellipsis">
      default()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_file.download_a_file_from_google_drive" class="md-nav__link">
    <span class="md-ellipsis">
      download_a_file_from_google_drive()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_file.download_excel" class="md-nav__link">
    <span class="md-ellipsis">
      download_excel()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_file.download_one_zip" class="md-nav__link">
    <span class="md-ellipsis">
      download_one_zip()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_file.download_small_file" class="md-nav__link">
    <span class="md-ellipsis">
      download_small_file()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_file.download_small_zip" class="md-nav__link">
    <span class="md-ellipsis">
      download_small_zip()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_file.download_zip_files" class="md-nav__link">
    <span class="md-ellipsis">
      download_zip_files()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_file.get_cache_dir" class="md-nav__link">
    <span class="md-ellipsis">
      get_cache_dir()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_file.get_lastest_file_in_a_dir" class="md-nav__link">
    <span class="md-ellipsis">
      get_lastest_file_in_a_dir()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_file.get_latest_file_in_a_lst" class="md-nav__link">
    <span class="md-ellipsis">
      get_latest_file_in_a_lst()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_file.is_there_file" class="md-nav__link">
    <span class="md-ellipsis">
      is_there_file()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_file.serialize_json" class="md-nav__link">
    <span class="md-ellipsis">
      serialize_json()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_file.serialize_json_np" class="md-nav__link">
    <span class="md-ellipsis">
      serialize_json_np()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_file.serialize_numpy" class="md-nav__link">
    <span class="md-ellipsis">
      serialize_numpy()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_file.serialize_pickle" class="md-nav__link">
    <span class="md-ellipsis">
      serialize_pickle()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_file.unserialize_json" class="md-nav__link">
    <span class="md-ellipsis">
      unserialize_json()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_file.unserialize_json_ordered" class="md-nav__link">
    <span class="md-ellipsis">
      unserialize_json_ordered()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_file.unserialize_numpy" class="md-nav__link">
    <span class="md-ellipsis">
      unserialize_numpy()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_file.unserialize_pickle" class="md-nav__link">
    <span class="md-ellipsis">
      unserialize_pickle()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_file.unzip_file" class="md-nav__link">
    <span class="md-ellipsis">
      unzip_file()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_file.unzip_nested_zip" class="md-nav__link">
    <span class="md-ellipsis">
      unzip_nested_zip()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_file.zip_extract" class="md-nav__link">
    <span class="md-ellipsis">
      zip_extract()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_file.zip_file_name_from_url" class="md-nav__link">
    <span class="md-ellipsis">
      zip_file_name_from_url()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.hydro_log" class="md-nav__link">
    <span class="md-ellipsis">
      hydro_log
    </span>
  </a>
  
    <nav class="md-nav" aria-label="hydro_log">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_log.HydroWarning" class="md-nav__link">
    <span class="md-ellipsis">
      HydroWarning
    </span>
  </a>
  
    <nav class="md-nav" aria-label="HydroWarning">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_log.HydroWarning.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_log.HydroWarning.file_not_found" class="md-nav__link">
    <span class="md-ellipsis">
      file_not_found()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_log.HydroWarning.no_directory" class="md-nav__link">
    <span class="md-ellipsis">
      no_directory()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_log.HydroWarning.operation_successful" class="md-nav__link">
    <span class="md-ellipsis">
      operation_successful()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_log.hydro_logger" class="md-nav__link">
    <span class="md-ellipsis">
      hydro_logger()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.hydro_plot" class="md-nav__link">
    <span class="md-ellipsis">
      hydro_plot
    </span>
  </a>
  
    <nav class="md-nav" aria-label="hydro_plot">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_plot.create_median_labels" class="md-nav__link">
    <span class="md-ellipsis">
      create_median_labels()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_plot.plot_boxes_matplotlib" class="md-nav__link">
    <span class="md-ellipsis">
      plot_boxes_matplotlib()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_plot.plot_boxs" class="md-nav__link">
    <span class="md-ellipsis">
      plot_boxs()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_plot.plot_diff_boxes" class="md-nav__link">
    <span class="md-ellipsis">
      plot_diff_boxes()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_plot.plot_ecdf" class="md-nav__link">
    <span class="md-ellipsis">
      plot_ecdf()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_plot.plot_ecdfs" class="md-nav__link">
    <span class="md-ellipsis">
      plot_ecdfs()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_plot.plot_ecdfs_matplot" class="md-nav__link">
    <span class="md-ellipsis">
      plot_ecdfs_matplot()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_plot.plot_heat_map" class="md-nav__link">
    <span class="md-ellipsis">
      plot_heat_map()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_plot.plot_map_carto" class="md-nav__link">
    <span class="md-ellipsis">
      plot_map_carto()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_plot.plot_pdf_cdf" class="md-nav__link">
    <span class="md-ellipsis">
      plot_pdf_cdf()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_plot.plot_quiver" class="md-nav__link">
    <span class="md-ellipsis">
      plot_quiver()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_plot.plot_rainfall_runoff" class="md-nav__link">
    <span class="md-ellipsis">
      plot_rainfall_runoff()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_plot.plot_rainfall_runoff_chai" class="md-nav__link">
    <span class="md-ellipsis">
      plot_rainfall_runoff_chai()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_plot.plot_rainfall_runoff_xu" class="md-nav__link">
    <span class="md-ellipsis">
      plot_rainfall_runoff_xu()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_plot.plot_scatter_with_11line" class="md-nav__link">
    <span class="md-ellipsis">
      plot_scatter_with_11line()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_plot.plot_scatter_xyc" class="md-nav__link">
    <span class="md-ellipsis">
      plot_scatter_xyc()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_plot.plot_ts" class="md-nav__link">
    <span class="md-ellipsis">
      plot_ts()
    </span>
  </a>
  
    <nav class="md-nav" aria-label="plot_ts()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_plot.plot_ts--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_plot.plot_ts--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_plot.plot_ts_map" class="md-nav__link">
    <span class="md-ellipsis">
      plot_ts_map()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_plot.plot_ts_matplot" class="md-nav__link">
    <span class="md-ellipsis">
      plot_ts_matplot()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_plot.swarmplot_without_legend" class="md-nav__link">
    <span class="md-ellipsis">
      swarmplot_without_legend()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.hydro_s3" class="md-nav__link">
    <span class="md-ellipsis">
      hydro_s3
    </span>
  </a>
  
    <nav class="md-nav" aria-label="hydro_s3">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_s3.boto3_download_file" class="md-nav__link">
    <span class="md-ellipsis">
      boto3_download_file()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_s3.boto3_upload_file" class="md-nav__link">
    <span class="md-ellipsis">
      boto3_upload_file()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_s3.minio_download_file" class="md-nav__link">
    <span class="md-ellipsis">
      minio_download_file()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_s3.minio_upload_file" class="md-nav__link">
    <span class="md-ellipsis">
      minio_upload_file()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.hydro_stat" class="md-nav__link">
    <span class="md-ellipsis">
      hydro_stat
    </span>
  </a>
  
    <nav class="md-nav" aria-label="hydro_stat">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_stat.KGE" class="md-nav__link">
    <span class="md-ellipsis">
      KGE()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_stat.cal_4_stat_inds" class="md-nav__link">
    <span class="md-ellipsis">
      cal_4_stat_inds()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_stat.cal_fdc" class="md-nav__link">
    <span class="md-ellipsis">
      cal_fdc()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_stat.cal_stat" class="md-nav__link">
    <span class="md-ellipsis">
      cal_stat()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_stat.cal_stat_gamma" class="md-nav__link">
    <span class="md-ellipsis">
      cal_stat_gamma()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_stat.cal_stat_prcp_norm" class="md-nav__link">
    <span class="md-ellipsis">
      cal_stat_prcp_norm()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_stat.ecdf" class="md-nav__link">
    <span class="md-ellipsis">
      ecdf()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_stat.fms" class="md-nav__link">
    <span class="md-ellipsis">
      fms()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_stat.mean_peak_timing" class="md-nav__link">
    <span class="md-ellipsis">
      mean_peak_timing()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_stat.month_stat_for_daily_df" class="md-nav__link">
    <span class="md-ellipsis">
      month_stat_for_daily_df()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_stat.remove_abnormal_data" class="md-nav__link">
    <span class="md-ellipsis">
      remove_abnormal_data()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_stat.stat_error" class="md-nav__link">
    <span class="md-ellipsis">
      stat_error()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_stat.stat_error_i" class="md-nav__link">
    <span class="md-ellipsis">
      stat_error_i()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_stat.stat_errors" class="md-nav__link">
    <span class="md-ellipsis">
      stat_errors()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_stat.trans_norm" class="md-nav__link">
    <span class="md-ellipsis">
      trans_norm()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_stat.wilcoxon_t_test" class="md-nav__link">
    <span class="md-ellipsis">
      wilcoxon_t_test()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_stat.wilcoxon_t_test_for_lst" class="md-nav__link">
    <span class="md-ellipsis">
      wilcoxon_t_test_for_lst()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.hydro_time" class="md-nav__link">
    <span class="md-ellipsis">
      hydro_time
    </span>
  </a>
  
    <nav class="md-nav" aria-label="hydro_time">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_time.assign_time_start_end" class="md-nav__link">
    <span class="md-ellipsis">
      assign_time_start_end()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_time.calculate_utc_offset" class="md-nav__link">
    <span class="md-ellipsis">
      calculate_utc_offset()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_time.date_to_julian" class="md-nav__link">
    <span class="md-ellipsis">
      date_to_julian()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_time.generate_start0101_time_range" class="md-nav__link">
    <span class="md-ellipsis">
      generate_start0101_time_range()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_time.get_year" class="md-nav__link">
    <span class="md-ellipsis">
      get_year()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_time.intersect" class="md-nav__link">
    <span class="md-ellipsis">
      intersect()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_time.t2str" class="md-nav__link">
    <span class="md-ellipsis">
      t2str()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_time.t_days_lst2range" class="md-nav__link">
    <span class="md-ellipsis">
      t_days_lst2range()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_time.t_range_days" class="md-nav__link">
    <span class="md-ellipsis">
      t_range_days()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_time.t_range_days_timedelta" class="md-nav__link">
    <span class="md-ellipsis">
      t_range_days_timedelta()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_time.t_range_to_julian" class="md-nav__link">
    <span class="md-ellipsis">
      t_range_to_julian()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_time.t_range_years" class="md-nav__link">
    <span class="md-ellipsis">
      t_range_years()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#submodules" class="md-nav__link">
    <span class="md-ellipsis">
      Submodules
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Core Modules
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            Core Modules
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../hydro_stat/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Statistical Analysis
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../hydro_plot/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Visualization
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../hydro_time/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Time Processing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../hydro_file/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    File Operations
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" >
        
          
          <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Advanced Modules
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            Advanced Modules
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../hydro_arithmetric/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Mathematical Operations
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../hydro_s3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    AWS S3 Integration
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../hydro_log/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Logging Utilities
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Development
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Development
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../contributing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Contributing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../changelog/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Changelog
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="https://github.com/zhuanglaihong/hydroutils/issues" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Report Issues
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#core-module" class="md-nav__link">
    <span class="md-ellipsis">
      Core Module
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils" class="md-nav__link">
    <span class="md-ellipsis">
      hydroutils
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.hydro_arithmetric" class="md-nav__link">
    <span class="md-ellipsis">
      hydro_arithmetric
    </span>
  </a>
  
    <nav class="md-nav" aria-label="hydro_arithmetric">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_arithmetric.random_choice_no_return" class="md-nav__link">
    <span class="md-ellipsis">
      random_choice_no_return()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.hydro_file" class="md-nav__link">
    <span class="md-ellipsis">
      hydro_file
    </span>
  </a>
  
    <nav class="md-nav" aria-label="hydro_file">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_file.NumpyArrayEncoder" class="md-nav__link">
    <span class="md-ellipsis">
      NumpyArrayEncoder
    </span>
  </a>
  
    <nav class="md-nav" aria-label="NumpyArrayEncoder">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_file.NumpyArrayEncoder.convert_ndarray" class="md-nav__link">
    <span class="md-ellipsis">
      convert_ndarray()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_file.NumpyArrayEncoder.default" class="md-nav__link">
    <span class="md-ellipsis">
      default()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_file.download_a_file_from_google_drive" class="md-nav__link">
    <span class="md-ellipsis">
      download_a_file_from_google_drive()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_file.download_excel" class="md-nav__link">
    <span class="md-ellipsis">
      download_excel()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_file.download_one_zip" class="md-nav__link">
    <span class="md-ellipsis">
      download_one_zip()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_file.download_small_file" class="md-nav__link">
    <span class="md-ellipsis">
      download_small_file()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_file.download_small_zip" class="md-nav__link">
    <span class="md-ellipsis">
      download_small_zip()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_file.download_zip_files" class="md-nav__link">
    <span class="md-ellipsis">
      download_zip_files()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_file.get_cache_dir" class="md-nav__link">
    <span class="md-ellipsis">
      get_cache_dir()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_file.get_lastest_file_in_a_dir" class="md-nav__link">
    <span class="md-ellipsis">
      get_lastest_file_in_a_dir()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_file.get_latest_file_in_a_lst" class="md-nav__link">
    <span class="md-ellipsis">
      get_latest_file_in_a_lst()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_file.is_there_file" class="md-nav__link">
    <span class="md-ellipsis">
      is_there_file()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_file.serialize_json" class="md-nav__link">
    <span class="md-ellipsis">
      serialize_json()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_file.serialize_json_np" class="md-nav__link">
    <span class="md-ellipsis">
      serialize_json_np()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_file.serialize_numpy" class="md-nav__link">
    <span class="md-ellipsis">
      serialize_numpy()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_file.serialize_pickle" class="md-nav__link">
    <span class="md-ellipsis">
      serialize_pickle()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_file.unserialize_json" class="md-nav__link">
    <span class="md-ellipsis">
      unserialize_json()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_file.unserialize_json_ordered" class="md-nav__link">
    <span class="md-ellipsis">
      unserialize_json_ordered()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_file.unserialize_numpy" class="md-nav__link">
    <span class="md-ellipsis">
      unserialize_numpy()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_file.unserialize_pickle" class="md-nav__link">
    <span class="md-ellipsis">
      unserialize_pickle()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_file.unzip_file" class="md-nav__link">
    <span class="md-ellipsis">
      unzip_file()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_file.unzip_nested_zip" class="md-nav__link">
    <span class="md-ellipsis">
      unzip_nested_zip()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_file.zip_extract" class="md-nav__link">
    <span class="md-ellipsis">
      zip_extract()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_file.zip_file_name_from_url" class="md-nav__link">
    <span class="md-ellipsis">
      zip_file_name_from_url()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.hydro_log" class="md-nav__link">
    <span class="md-ellipsis">
      hydro_log
    </span>
  </a>
  
    <nav class="md-nav" aria-label="hydro_log">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_log.HydroWarning" class="md-nav__link">
    <span class="md-ellipsis">
      HydroWarning
    </span>
  </a>
  
    <nav class="md-nav" aria-label="HydroWarning">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_log.HydroWarning.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_log.HydroWarning.file_not_found" class="md-nav__link">
    <span class="md-ellipsis">
      file_not_found()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_log.HydroWarning.no_directory" class="md-nav__link">
    <span class="md-ellipsis">
      no_directory()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_log.HydroWarning.operation_successful" class="md-nav__link">
    <span class="md-ellipsis">
      operation_successful()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_log.hydro_logger" class="md-nav__link">
    <span class="md-ellipsis">
      hydro_logger()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.hydro_plot" class="md-nav__link">
    <span class="md-ellipsis">
      hydro_plot
    </span>
  </a>
  
    <nav class="md-nav" aria-label="hydro_plot">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_plot.create_median_labels" class="md-nav__link">
    <span class="md-ellipsis">
      create_median_labels()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_plot.plot_boxes_matplotlib" class="md-nav__link">
    <span class="md-ellipsis">
      plot_boxes_matplotlib()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_plot.plot_boxs" class="md-nav__link">
    <span class="md-ellipsis">
      plot_boxs()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_plot.plot_diff_boxes" class="md-nav__link">
    <span class="md-ellipsis">
      plot_diff_boxes()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_plot.plot_ecdf" class="md-nav__link">
    <span class="md-ellipsis">
      plot_ecdf()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_plot.plot_ecdfs" class="md-nav__link">
    <span class="md-ellipsis">
      plot_ecdfs()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_plot.plot_ecdfs_matplot" class="md-nav__link">
    <span class="md-ellipsis">
      plot_ecdfs_matplot()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_plot.plot_heat_map" class="md-nav__link">
    <span class="md-ellipsis">
      plot_heat_map()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_plot.plot_map_carto" class="md-nav__link">
    <span class="md-ellipsis">
      plot_map_carto()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_plot.plot_pdf_cdf" class="md-nav__link">
    <span class="md-ellipsis">
      plot_pdf_cdf()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_plot.plot_quiver" class="md-nav__link">
    <span class="md-ellipsis">
      plot_quiver()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_plot.plot_rainfall_runoff" class="md-nav__link">
    <span class="md-ellipsis">
      plot_rainfall_runoff()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_plot.plot_rainfall_runoff_chai" class="md-nav__link">
    <span class="md-ellipsis">
      plot_rainfall_runoff_chai()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_plot.plot_rainfall_runoff_xu" class="md-nav__link">
    <span class="md-ellipsis">
      plot_rainfall_runoff_xu()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_plot.plot_scatter_with_11line" class="md-nav__link">
    <span class="md-ellipsis">
      plot_scatter_with_11line()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_plot.plot_scatter_xyc" class="md-nav__link">
    <span class="md-ellipsis">
      plot_scatter_xyc()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_plot.plot_ts" class="md-nav__link">
    <span class="md-ellipsis">
      plot_ts()
    </span>
  </a>
  
    <nav class="md-nav" aria-label="plot_ts()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_plot.plot_ts--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_plot.plot_ts--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_plot.plot_ts_map" class="md-nav__link">
    <span class="md-ellipsis">
      plot_ts_map()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_plot.plot_ts_matplot" class="md-nav__link">
    <span class="md-ellipsis">
      plot_ts_matplot()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_plot.swarmplot_without_legend" class="md-nav__link">
    <span class="md-ellipsis">
      swarmplot_without_legend()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.hydro_s3" class="md-nav__link">
    <span class="md-ellipsis">
      hydro_s3
    </span>
  </a>
  
    <nav class="md-nav" aria-label="hydro_s3">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_s3.boto3_download_file" class="md-nav__link">
    <span class="md-ellipsis">
      boto3_download_file()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_s3.boto3_upload_file" class="md-nav__link">
    <span class="md-ellipsis">
      boto3_upload_file()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_s3.minio_download_file" class="md-nav__link">
    <span class="md-ellipsis">
      minio_download_file()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_s3.minio_upload_file" class="md-nav__link">
    <span class="md-ellipsis">
      minio_upload_file()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.hydro_stat" class="md-nav__link">
    <span class="md-ellipsis">
      hydro_stat
    </span>
  </a>
  
    <nav class="md-nav" aria-label="hydro_stat">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_stat.KGE" class="md-nav__link">
    <span class="md-ellipsis">
      KGE()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_stat.cal_4_stat_inds" class="md-nav__link">
    <span class="md-ellipsis">
      cal_4_stat_inds()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_stat.cal_fdc" class="md-nav__link">
    <span class="md-ellipsis">
      cal_fdc()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_stat.cal_stat" class="md-nav__link">
    <span class="md-ellipsis">
      cal_stat()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_stat.cal_stat_gamma" class="md-nav__link">
    <span class="md-ellipsis">
      cal_stat_gamma()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_stat.cal_stat_prcp_norm" class="md-nav__link">
    <span class="md-ellipsis">
      cal_stat_prcp_norm()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_stat.ecdf" class="md-nav__link">
    <span class="md-ellipsis">
      ecdf()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_stat.fms" class="md-nav__link">
    <span class="md-ellipsis">
      fms()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_stat.mean_peak_timing" class="md-nav__link">
    <span class="md-ellipsis">
      mean_peak_timing()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_stat.month_stat_for_daily_df" class="md-nav__link">
    <span class="md-ellipsis">
      month_stat_for_daily_df()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_stat.remove_abnormal_data" class="md-nav__link">
    <span class="md-ellipsis">
      remove_abnormal_data()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_stat.stat_error" class="md-nav__link">
    <span class="md-ellipsis">
      stat_error()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_stat.stat_error_i" class="md-nav__link">
    <span class="md-ellipsis">
      stat_error_i()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_stat.stat_errors" class="md-nav__link">
    <span class="md-ellipsis">
      stat_errors()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_stat.trans_norm" class="md-nav__link">
    <span class="md-ellipsis">
      trans_norm()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_stat.wilcoxon_t_test" class="md-nav__link">
    <span class="md-ellipsis">
      wilcoxon_t_test()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_stat.wilcoxon_t_test_for_lst" class="md-nav__link">
    <span class="md-ellipsis">
      wilcoxon_t_test_for_lst()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.hydro_time" class="md-nav__link">
    <span class="md-ellipsis">
      hydro_time
    </span>
  </a>
  
    <nav class="md-nav" aria-label="hydro_time">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_time.assign_time_start_end" class="md-nav__link">
    <span class="md-ellipsis">
      assign_time_start_end()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_time.calculate_utc_offset" class="md-nav__link">
    <span class="md-ellipsis">
      calculate_utc_offset()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_time.date_to_julian" class="md-nav__link">
    <span class="md-ellipsis">
      date_to_julian()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_time.generate_start0101_time_range" class="md-nav__link">
    <span class="md-ellipsis">
      generate_start0101_time_range()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_time.get_year" class="md-nav__link">
    <span class="md-ellipsis">
      get_year()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_time.intersect" class="md-nav__link">
    <span class="md-ellipsis">
      intersect()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_time.t2str" class="md-nav__link">
    <span class="md-ellipsis">
      t2str()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_time.t_days_lst2range" class="md-nav__link">
    <span class="md-ellipsis">
      t_days_lst2range()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_time.t_range_days" class="md-nav__link">
    <span class="md-ellipsis">
      t_range_days()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_time.t_range_days_timedelta" class="md-nav__link">
    <span class="md-ellipsis">
      t_range_days_timedelta()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_time.t_range_to_julian" class="md-nav__link">
    <span class="md-ellipsis">
      t_range_to_julian()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_time.t_range_years" class="md-nav__link">
    <span class="md-ellipsis">
      t_range_years()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#submodules" class="md-nav__link">
    <span class="md-ellipsis">
      Submodules
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                



                  


  
  


<h1 id="api-reference">API Reference<a class="headerlink" href="#api-reference" title="Permanent link">&para;</a></h1>
<p>This section provides detailed documentation for all modules and functions in the <code>hydroutils</code> package.</p>
<h2 id="core-module">Core Module<a class="headerlink" href="#core-module" title="Permanent link">&para;</a></h2>


  <div class="doc doc-object doc-module">

<a id="hydroutils"></a>
    <div class="doc doc-contents first">

      <p>Author: Wenyu Ouyang
Date: 2022-12-02 10:42:19
LastEditTime: 2023-10-27 14:53:16
LastEditors: Wenyu Ouyang
Description: Top-level package for hydroutils.
FilePath: /hydroutils/hydroutils/<strong>init</strong>.py
Copyright (c) 2023-2024 Wenyu Ouyang. All rights reserved.</p>



  <div class="doc doc-children">













  <div class="doc doc-object doc-module">



<h2 id="hydroutils.hydro_arithmetric" class="doc doc-heading">
        <code>hydro_arithmetric</code>



<a href="#hydroutils.hydro_arithmetric" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Author: Wenyu Ouyang
Date: 2023-07-29 14:07:03
LastEditTime: 2023-07-29 14:08:22
LastEditors: Wenyu Ouyang
Description: some common arithmetric calculations
FilePath: /hydroutils/hydroutils/hydro_arithmetric.py
Copyright (c) 2023-2024 Wenyu Ouyang. All rights reserved.</p>



  <div class="doc doc-children">








  <div class="doc doc-object doc-function">



<h3 id="hydroutils.hydro_arithmetric.random_choice_no_return" class="doc doc-heading">
<code class="highlight language-python"><span class="n">random_choice_no_return</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">num_lst</span><span class="p">)</span></code>


<a href="#hydroutils.hydro_arithmetric.random_choice_no_return" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Performs multiple sampling without replacement from an array.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>arr</code></td>
        <td><code>Union[list, np.ndarray]</code></td>
        <td><p>The source array to sample from.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>num_lst</code></td>
        <td><code>list</code></td>
        <td><p>List of integers specifying the number of elements to sample in each iteration.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>list</code></td>
      <td><p>A list of numpy arrays, where each array contains the sampled elements for that iteration.</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>AssertionError</code></td>
        <td><p>If the sum of requested samples exceeds the array size.</p></td>
      </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">arr</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">num_lst</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>  <span class="c1"># First sample 2 elements, then 1 element</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">result</span> <span class="o">=</span> <span class="n">random_choice_no_return</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">num_lst</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>  <span class="c1"># Returns 2 (number of sampling iterations)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>  <span class="c1"># Returns 2 (first sample size)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>  <span class="c1"># Returns 1 (second sample size)</span>
</code></pre></div>

        <details class="quote">
          <summary>Source code in <code>hydroutils/hydro_arithmetric.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">random_choice_no_return</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">num_lst</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Performs multiple sampling without replacement from an array.</span>

<span class="sd">    Args:</span>
<span class="sd">        arr (Union[list, np.ndarray]): The source array to sample from.</span>
<span class="sd">        num_lst (list): List of integers specifying the number of elements to sample in each iteration.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: A list of numpy arrays, where each array contains the sampled elements for that iteration.</span>

<span class="sd">    Raises:</span>
<span class="sd">        AssertionError: If the sum of requested samples exceeds the array size.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; arr = [1, 2, 3, 4, 5]</span>
<span class="sd">        &gt;&gt;&gt; num_lst = [2, 1]  # First sample 2 elements, then 1 element</span>
<span class="sd">        &gt;&gt;&gt; result = random_choice_no_return(arr, num_lst)</span>
<span class="sd">        &gt;&gt;&gt; len(result)  # Returns 2 (number of sampling iterations)</span>
<span class="sd">        &gt;&gt;&gt; len(result[0])  # Returns 2 (first sample size)</span>
<span class="sd">        &gt;&gt;&gt; len(result[1])  # Returns 1 (second sample size)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">num_lst_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">num_lst</span><span class="p">)</span>
    <span class="n">num_sum</span> <span class="o">=</span> <span class="n">num_lst_arr</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span> <span class="o">==</span> <span class="nb">list</span><span class="p">:</span>
        <span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">num_sum</span> <span class="o">&lt;=</span> <span class="n">arr</span><span class="o">.</span><span class="n">size</span>
    <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">arr_residue</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="n">num_lst_arr</span><span class="p">:</span>
        <span class="n">idx_chosen</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">arr_residue</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">num</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">chosen_idx_in_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">arr_residue</span><span class="p">[</span><span class="n">idx_chosen</span><span class="p">])</span>
        <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="n">chosen_idx_in_arr</span><span class="p">])</span>
        <span class="n">arr_residue</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">arr_residue</span><span class="p">,</span> <span class="n">idx_chosen</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">results</span>
</code></pre></div>
        </details>
    </div>

  </div>






  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h2 id="hydroutils.hydro_file" class="doc doc-heading">
        <code>hydro_file</code>



<a href="#hydroutils.hydro_file" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Author: Wenyu Ouyang
Date: 2024-08-15 10:08:59
LastEditTime: 2025-02-02 06:27:44
LastEditors: Wenyu Ouyang
Description: some methods for file operations
FilePath: /hydroutils/hydroutils/hydro_file.py
Copyright (c) 2023-2024 Wenyu Ouyang. All rights reserved.</p>



  <div class="doc doc-children">







  <div class="doc doc-object doc-class">



<h3 id="hydroutils.hydro_file.NumpyArrayEncoder" class="doc doc-heading">
        <code>
NumpyArrayEncoder            (<span title="json.encoder.JSONEncoder">JSONEncoder</span>)
        </code>



<a href="#hydroutils.hydro_file.NumpyArrayEncoder" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>JSON encoder that handles NumPy arrays and scalars.</p>
<p>This encoder converts NumPy arrays and scalars to native Python types
that can be serialized to JSON.</p>

<p><strong>Examples:</strong></p>
    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;array&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])}</span>
<span class="n">json_str</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="bp">cls</span><span class="o">=</span><span class="n">NumpyArrayEncoder</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>

        <details class="quote">
          <summary>Source code in <code>hydroutils/hydro_file.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">NumpyArrayEncoder</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">JSONEncoder</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;JSON encoder that handles NumPy arrays and scalars.</span>

<span class="sd">    This encoder converts NumPy arrays and scalars to native Python types</span>
<span class="sd">    that can be serialized to JSON.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        import numpy as np</span>
<span class="sd">        data = {&#39;array&#39;: np.array([1, 2, 3])}</span>
<span class="sd">        json_str = json.dumps(data, cls=NumpyArrayEncoder)</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">default</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Converts NumPy objects to JSON-serializable types.</span>

<span class="sd">        Args:</span>
<span class="sd">            obj: Object to convert.</span>

<span class="sd">        Returns:</span>
<span class="sd">            JSON-serializable version of the object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">convert_ndarray</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">floating</span><span class="p">)):</span>
            <span class="k">return</span> <span class="n">obj</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">JSONEncoder</span><span class="o">.</span><span class="n">default</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">convert_ndarray</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">array</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Recursively converts a NumPy array to a Python list.</span>

<span class="sd">        Args:</span>
<span class="sd">            array: NumPy array to convert.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Python list or scalar value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">array</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">array</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
        <span class="k">return</span> <span class="p">[</span>
            <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">convert_ndarray</span><span class="p">(</span><span class="n">element</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">element</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span>
                <span class="k">else</span> <span class="n">element</span>
            <span class="p">)</span>
            <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">array</span>
        <span class="p">]</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">









  <div class="doc doc-object doc-method">



<h4 id="hydroutils.hydro_file.NumpyArrayEncoder.convert_ndarray" class="doc doc-heading">
<code class="highlight language-python"><span class="n">convert_ndarray</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">array</span><span class="p">)</span></code>


<a href="#hydroutils.hydro_file.NumpyArrayEncoder.convert_ndarray" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Recursively converts a NumPy array to a Python list.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>array</code></td>
        <td></td>
        <td><p>NumPy array to convert.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td></td>
      <td><p>Python list or scalar value.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>hydroutils/hydro_file.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">convert_ndarray</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">array</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Recursively converts a NumPy array to a Python list.</span>

<span class="sd">    Args:</span>
<span class="sd">        array: NumPy array to convert.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Python list or scalar value.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">array</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">array</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
    <span class="k">return</span> <span class="p">[</span>
        <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">convert_ndarray</span><span class="p">(</span><span class="n">element</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">element</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span>
            <span class="k">else</span> <span class="n">element</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">array</span>
    <span class="p">]</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="hydroutils.hydro_file.NumpyArrayEncoder.default" class="doc doc-heading">
<code class="highlight language-python"><span class="n">default</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">)</span></code>


<a href="#hydroutils.hydro_file.NumpyArrayEncoder.default" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Converts NumPy objects to JSON-serializable types.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>obj</code></td>
        <td></td>
        <td><p>Object to convert.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td></td>
      <td><p>JSON-serializable version of the object.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>hydroutils/hydro_file.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">default</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Converts NumPy objects to JSON-serializable types.</span>

<span class="sd">    Args:</span>
<span class="sd">        obj: Object to convert.</span>

<span class="sd">    Returns:</span>
<span class="sd">        JSON-serializable version of the object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">convert_ndarray</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">floating</span><span class="p">)):</span>
        <span class="k">return</span> <span class="n">obj</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">JSONEncoder</span><span class="o">.</span><span class="n">default</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>




  <div class="doc doc-object doc-function">



<h3 id="hydroutils.hydro_file.download_a_file_from_google_drive" class="doc doc-heading">
<code class="highlight language-python"><span class="n">download_a_file_from_google_drive</span><span class="p">(</span><span class="n">drive</span><span class="p">,</span> <span class="n">dir_id</span><span class="p">,</span> <span class="n">download_dir</span><span class="p">)</span></code>


<a href="#hydroutils.hydro_file.download_a_file_from_google_drive" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Downloads files and folders from Google Drive recursively.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>drive</code></td>
        <td></td>
        <td><p>Google Drive API client instance.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>dir_id</code></td>
        <td><code>str</code></td>
        <td><p>ID of the Google Drive folder to download from.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>download_dir</code></td>
        <td><code>str</code></td>
        <td><p>Local directory where files should be saved.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span>
<span class="normal">9</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">pydrive.auth</span><span class="w"> </span><span class="kn">import</span> <span class="n">GoogleAuth</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pydrive.drive</span><span class="w"> </span><span class="kn">import</span> <span class="n">GoogleDrive</span>

<span class="n">gauth</span> <span class="o">=</span> <span class="n">GoogleAuth</span><span class="p">()</span>
<span class="n">gauth</span><span class="o">.</span><span class="n">LocalWebserverAuth</span><span class="p">()</span>
<span class="n">drive</span> <span class="o">=</span> <span class="n">GoogleDrive</span><span class="p">(</span><span class="n">gauth</span><span class="p">)</span>

<span class="c1"># Download folder with ID &#39;1234...&#39; to &#39;./downloads&#39;</span>
<span class="n">download_a_file_from_google_drive</span><span class="p">(</span><span class="n">drive</span><span class="p">,</span> <span class="s1">&#39;1234...&#39;</span><span class="p">,</span> <span class="s1">&#39;./downloads&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      <p>!!! note
    - Handles both files and folders recursively
    - Skips already downloaded files
    - Creates subdirectories as needed
    - Prints progress information</p>

        <details class="quote">
          <summary>Source code in <code>hydroutils/hydro_file.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">download_a_file_from_google_drive</span><span class="p">(</span><span class="n">drive</span><span class="p">,</span> <span class="n">dir_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">download_dir</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Downloads files and folders from Google Drive recursively.</span>

<span class="sd">    Args:</span>
<span class="sd">        drive: Google Drive API client instance.</span>
<span class="sd">        dir_id: ID of the Google Drive folder to download from.</span>
<span class="sd">        download_dir: Local directory where files should be saved.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        from pydrive.auth import GoogleAuth</span>
<span class="sd">        from pydrive.drive import GoogleDrive</span>

<span class="sd">        gauth = GoogleAuth()</span>
<span class="sd">        gauth.LocalWebserverAuth()</span>
<span class="sd">        drive = GoogleDrive(gauth)</span>

<span class="sd">        # Download folder with ID &#39;1234...&#39; to &#39;./downloads&#39;</span>
<span class="sd">        download_a_file_from_google_drive(drive, &#39;1234...&#39;, &#39;./downloads&#39;)</span>
<span class="sd">        ```</span>

<span class="sd">    Note:</span>
<span class="sd">        - Handles both files and folders recursively</span>
<span class="sd">        - Skips already downloaded files</span>
<span class="sd">        - Creates subdirectories as needed</span>
<span class="sd">        - Prints progress information</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">file_list</span> <span class="o">=</span> <span class="n">drive</span><span class="o">.</span><span class="n">ListFile</span><span class="p">(</span>
        <span class="p">{</span><span class="s2">&quot;q&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;&#39;</span><span class="si">{</span><span class="n">dir_id</span><span class="si">}</span><span class="s2">&#39; in parents and trashed=false&quot;</span><span class="p">}</span>
    <span class="p">)</span><span class="o">.</span><span class="n">GetList</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">file_list</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;title: </span><span class="si">{</span><span class="n">file</span><span class="p">[</span><span class="s2">&quot;title&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1">, id: </span><span class="si">{</span><span class="n">file</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">file_dl</span> <span class="o">=</span> <span class="n">drive</span><span class="o">.</span><span class="n">CreateFile</span><span class="p">({</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="n">file</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]})</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;mimetype is </span><span class="si">{</span><span class="n">file_dl</span><span class="p">[</span><span class="s2">&quot;mimeType&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">file_dl</span><span class="p">[</span><span class="s2">&quot;mimeType&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;application/vnd.google-apps.folder&quot;</span><span class="p">:</span>
            <span class="n">download_dir_sub</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">download_dir</span><span class="p">,</span> <span class="n">file_dl</span><span class="p">[</span><span class="s2">&quot;title&quot;</span><span class="p">])</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">download_dir_sub</span><span class="p">):</span>
                <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">download_dir_sub</span><span class="p">)</span>
            <span class="n">download_a_file_from_google_drive</span><span class="p">(</span><span class="n">drive</span><span class="p">,</span> <span class="n">file_dl</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">],</span> <span class="n">download_dir_sub</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># download</span>
            <span class="n">temp_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">download_dir</span><span class="p">,</span> <span class="n">file_dl</span><span class="p">[</span><span class="s2">&quot;title&quot;</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">temp_file</span><span class="p">):</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;file has been downloaded&quot;</span><span class="p">)</span>
                <span class="k">continue</span>
            <span class="n">file_dl</span><span class="o">.</span><span class="n">GetContentFile</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">download_dir</span><span class="p">,</span> <span class="n">file_dl</span><span class="p">[</span><span class="s2">&quot;title&quot;</span><span class="p">]))</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Downloading file finished&quot;</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="hydroutils.hydro_file.download_excel" class="doc doc-heading">
<code class="highlight language-python"><span class="n">download_excel</span><span class="p">(</span><span class="n">data_url</span><span class="p">,</span> <span class="n">temp_file</span><span class="p">)</span></code>


<a href="#hydroutils.hydro_file.download_excel" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Downloads an Excel file from a URL.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>data_url</code></td>
        <td><code>str</code></td>
        <td><p>URL of the Excel file.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>temp_file</code></td>
        <td><code>str</code></td>
        <td><p>Path where the file should be saved.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;https://example.com/data.xlsx&#39;</span>
<span class="n">download_excel</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="s1">&#39;./data.xlsx&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      <p>!!! note
    Only downloads if the file doesn't already exist locally.</p>

        <details class="quote">
          <summary>Source code in <code>hydroutils/hydro_file.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">download_excel</span><span class="p">(</span><span class="n">data_url</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">temp_file</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Downloads an Excel file from a URL.</span>

<span class="sd">    Args:</span>
<span class="sd">        data_url: URL of the Excel file.</span>
<span class="sd">        temp_file: Path where the file should be saved.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        url = &#39;https://example.com/data.xlsx&#39;</span>
<span class="sd">        download_excel(url, &#39;./data.xlsx&#39;)</span>
<span class="sd">        ```</span>

<span class="sd">    Note:</span>
<span class="sd">        Only downloads if the file doesn&#39;t already exist locally.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">temp_file</span><span class="p">):</span>
        <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">urlretrieve</span><span class="p">(</span><span class="n">data_url</span><span class="p">,</span> <span class="n">temp_file</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="hydroutils.hydro_file.download_one_zip" class="doc doc-heading">
<code class="highlight language-python"><span class="n">download_one_zip</span><span class="p">(</span><span class="n">data_url</span><span class="p">,</span> <span class="n">data_dir</span><span class="p">)</span></code>


<a href="#hydroutils.hydro_file.download_one_zip" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Downloads and extracts a zip file from a URL.</p>
<p>Creates the target directory and bucket if they don't exist.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>data_url</code></td>
        <td><code>str</code></td>
        <td><p>URL of the zip file to download.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>data_dir</code></td>
        <td><code>str</code></td>
        <td><p>Directory where the file should be downloaded and extracted.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>list</code></td>
      <td><p>List of object names in the extracted contents.</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;https://example.com/data.zip&#39;</span>
<span class="n">files</span> <span class="o">=</span> <span class="n">download_one_zip</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="s1">&#39;./downloads&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Downloaded and extracted: </span><span class="si">{</span><span class="n">files</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>

        <details class="quote">
          <summary>Source code in <code>hydroutils/hydro_file.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">download_one_zip</span><span class="p">(</span><span class="n">data_url</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">data_dir</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Downloads and extracts a zip file from a URL.</span>

<span class="sd">    Creates the target directory and bucket if they don&#39;t exist.</span>

<span class="sd">    Args:</span>
<span class="sd">        data_url: URL of the zip file to download.</span>
<span class="sd">        data_dir: Directory where the file should be downloaded and extracted.</span>

<span class="sd">    Returns:</span>
<span class="sd">        List of object names in the extracted contents.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        url = &#39;https://example.com/data.zip&#39;</span>
<span class="sd">        files = download_one_zip(url, &#39;./downloads&#39;)</span>
<span class="sd">        print(f&quot;Downloaded and extracted: {files}&quot;)</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">zipfile_path</span><span class="p">,</span> <span class="n">unzip_dir</span> <span class="o">=</span> <span class="n">zip_file_name_from_url</span><span class="p">(</span><span class="n">data_url</span><span class="p">,</span> <span class="n">data_dir</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">is_there_file</span><span class="p">(</span><span class="n">zipfile_path</span><span class="p">,</span> <span class="n">unzip_dir</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">unzip_dir</span><span class="p">):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">unzip_dir</span><span class="p">)</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">data_url</span><span class="p">,</span> <span class="n">stream</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">zipfile_path</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">py_file</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="n">r</span><span class="o">.</span><span class="n">iter_content</span><span class="p">(</span><span class="n">chunk_size</span><span class="o">=</span><span class="mi">1024</span><span class="p">):</span>  <span class="c1"># 1024 bytes</span>
                <span class="k">if</span> <span class="n">chunk</span><span class="p">:</span>
                    <span class="n">py_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">chunk</span><span class="p">)</span>
        <span class="n">unzip_nested_zip</span><span class="p">(</span><span class="n">zipfile_path</span><span class="p">,</span> <span class="n">unzip_dir</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="hydroutils.hydro_file.download_small_file" class="doc doc-heading">
<code class="highlight language-python"><span class="n">download_small_file</span><span class="p">(</span><span class="n">data_url</span><span class="p">,</span> <span class="n">temp_file</span><span class="p">)</span></code>


<a href="#hydroutils.hydro_file.download_small_file" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Downloads a small text file from a URL.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>data_url</code></td>
        <td><code>str</code></td>
        <td><p>URL of the file to download.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>temp_file</code></td>
        <td><code>str</code></td>
        <td><p>Path where the file should be saved.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;https://example.com/data.txt&#39;</span>
<span class="n">download_small_file</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="s1">&#39;./data.txt&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      <p>!!! note
    This function is designed for text files. For binary files,
    use download_small_zip or download_one_zip instead.</p>

        <details class="quote">
          <summary>Source code in <code>hydroutils/hydro_file.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">download_small_file</span><span class="p">(</span><span class="n">data_url</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">temp_file</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Downloads a small text file from a URL.</span>

<span class="sd">    Args:</span>
<span class="sd">        data_url: URL of the file to download.</span>
<span class="sd">        temp_file: Path where the file should be saved.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        url = &#39;https://example.com/data.txt&#39;</span>
<span class="sd">        download_small_file(url, &#39;./data.txt&#39;)</span>
<span class="sd">        ```</span>

<span class="sd">    Note:</span>
<span class="sd">        This function is designed for text files. For binary files,</span>
<span class="sd">        use download_small_zip or download_one_zip instead.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">data_url</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">temp_file</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="hydroutils.hydro_file.download_small_zip" class="doc doc-heading">
<code class="highlight language-python"><span class="n">download_small_zip</span><span class="p">(</span><span class="n">data_url</span><span class="p">,</span> <span class="n">data_dir</span><span class="p">)</span></code>


<a href="#hydroutils.hydro_file.download_small_zip" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Downloads and extracts a small zip file using urllib.</p>
<p>This function is optimized for small files. For large files,
use download_one_zip instead.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>data_url</code></td>
        <td><code>str</code></td>
        <td><p>URL of the zip file to download.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>data_dir</code></td>
        <td><code>str</code></td>
        <td><p>Directory where the file should be downloaded and extracted.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;https://example.com/small_data.zip&#39;</span>
<span class="n">download_small_zip</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="s1">&#39;./downloads&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>

        <details class="quote">
          <summary>Source code in <code>hydroutils/hydro_file.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">download_small_zip</span><span class="p">(</span><span class="n">data_url</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">data_dir</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Downloads and extracts a small zip file using urllib.</span>

<span class="sd">    This function is optimized for small files. For large files,</span>
<span class="sd">    use download_one_zip instead.</span>

<span class="sd">    Args:</span>
<span class="sd">        data_url: URL of the zip file to download.</span>
<span class="sd">        data_dir: Directory where the file should be downloaded and extracted.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        url = &#39;https://example.com/small_data.zip&#39;</span>
<span class="sd">        download_small_zip(url, &#39;./downloads&#39;)</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">zipfile_path</span><span class="p">,</span> <span class="n">unzip_dir</span> <span class="o">=</span> <span class="n">zip_file_name_from_url</span><span class="p">(</span><span class="n">data_url</span><span class="p">,</span> <span class="n">data_dir</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">is_there_file</span><span class="p">(</span><span class="n">zipfile_path</span><span class="p">,</span> <span class="n">unzip_dir</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">unzip_dir</span><span class="p">):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">unzip_dir</span><span class="p">)</span>
        <span class="n">zipfile_path</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">urlretrieve</span><span class="p">(</span><span class="n">data_url</span><span class="p">,</span> <span class="n">zipfile_path</span><span class="p">)</span>
        <span class="n">unzip_nested_zip</span><span class="p">(</span><span class="n">zipfile_path</span><span class="p">,</span> <span class="n">unzip_dir</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="hydroutils.hydro_file.download_zip_files" class="doc doc-heading">
<code class="highlight language-python"><span class="n">download_zip_files</span><span class="p">(</span><span class="n">urls</span><span class="p">,</span> <span class="n">the_dir</span><span class="p">)</span></code>


<a href="#hydroutils.hydro_file.download_zip_files" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Downloads multiple files from multiple URLs.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>urls</code></td>
        <td><code>list</code></td>
        <td><p>List of URLs to download from.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>the_dir</code></td>
        <td><code>Path</code></td>
        <td><p>Directory where downloaded files will be saved.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
<span class="n">urls</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;https://example.com/file1.zip&#39;</span><span class="p">,</span>
    <span class="s1">&#39;https://example.com/file2.zip&#39;</span>
<span class="p">]</span>
<span class="n">download_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s1">&#39;./downloads&#39;</span><span class="p">)</span>
<span class="n">download_zip_files</span><span class="p">(</span><span class="n">urls</span><span class="p">,</span> <span class="n">download_dir</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      <p>!!! note
    Uses async_retriever for efficient parallel downloads.
    Files are named based on the last component of their URLs.</p>

        <details class="quote">
          <summary>Source code in <code>hydroutils/hydro_file.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">download_zip_files</span><span class="p">(</span><span class="n">urls</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">the_dir</span><span class="p">:</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Downloads multiple files from multiple URLs.</span>

<span class="sd">    Args:</span>
<span class="sd">        urls: List of URLs to download from.</span>
<span class="sd">        the_dir: Directory where downloaded files will be saved.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        from pathlib import Path</span>
<span class="sd">        urls = [</span>
<span class="sd">            &#39;https://example.com/file1.zip&#39;,</span>
<span class="sd">            &#39;https://example.com/file2.zip&#39;</span>
<span class="sd">        ]</span>
<span class="sd">        download_dir = Path(&#39;./downloads&#39;)</span>
<span class="sd">        download_zip_files(urls, download_dir)</span>
<span class="sd">        ```</span>

<span class="sd">    Note:</span>
<span class="sd">        Uses async_retriever for efficient parallel downloads.</span>
<span class="sd">        Files are named based on the last component of their URLs.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">TemporaryDirectory</span><span class="p">()</span> <span class="k">as</span> <span class="n">tmpdir</span><span class="p">:</span>
        <span class="n">cache_names</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">tmpdir</span><span class="p">)</span><span class="o">.</span><span class="n">joinpath</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">the_dir</span><span class="o">.</span><span class="n">stem</span><span class="si">}</span><span class="s2">.sqlite&quot;</span><span class="p">)</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">ar</span><span class="o">.</span><span class="n">retrieve</span><span class="p">(</span><span class="n">urls</span><span class="p">,</span> <span class="s2">&quot;binary&quot;</span><span class="p">,</span> <span class="n">cache_name</span><span class="o">=</span><span class="n">cache_names</span><span class="p">,</span> <span class="n">ssl</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">files</span> <span class="o">=</span> <span class="p">[</span><span class="n">the_dir</span><span class="o">.</span><span class="n">joinpath</span><span class="p">(</span><span class="n">url</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">url</span> <span class="ow">in</span> <span class="n">urls</span><span class="p">]</span>
        <span class="p">[</span><span class="n">files</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">write_bytes</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n">getbuffer</span><span class="p">())</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">files</span><span class="p">))]</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="hydroutils.hydro_file.get_cache_dir" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_cache_dir</span><span class="p">(</span><span class="n">app_name</span><span class="o">=</span><span class="s1">&#39;hydro&#39;</span><span class="p">)</span></code>


<a href="#hydroutils.hydro_file.get_cache_dir" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Gets the appropriate cache directory for the current platform.</p>
<p>Creates the directory if it doesn't exist.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>app_name</code></td>
        <td><code>str</code></td>
        <td><p>Name of the application (used in path). Defaults to "hydro".</p></td>
        <td><code>&#39;hydro&#39;</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>str</code></td>
      <td><p>Path to the cache directory.</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1"># Get default cache directory</span>
<span class="n">cache_dir</span> <span class="o">=</span> <span class="n">get_cache_dir</span><span class="p">()</span>

<span class="c1"># Get cache directory for custom app</span>
<span class="n">cache_dir</span> <span class="o">=</span> <span class="n">get_cache_dir</span><span class="p">(</span><span class="s1">&#39;myapp&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      <p>!!! note
    Uses platform-specific paths:
    - Windows: ~/AppData/Local/{app_name}/Cache
    - macOS: ~/Library/Caches/{app_name}
    - Linux/Unix: ~/.cache/{app_name}</p>

        <details class="quote">
          <summary>Source code in <code>hydroutils/hydro_file.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_cache_dir</span><span class="p">(</span><span class="n">app_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;hydro&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Gets the appropriate cache directory for the current platform.</span>

<span class="sd">    Creates the directory if it doesn&#39;t exist.</span>

<span class="sd">    Args:</span>
<span class="sd">        app_name: Name of the application (used in path). Defaults to &quot;hydro&quot;.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Path to the cache directory.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        # Get default cache directory</span>
<span class="sd">        cache_dir = get_cache_dir()</span>

<span class="sd">        # Get cache directory for custom app</span>
<span class="sd">        cache_dir = get_cache_dir(&#39;myapp&#39;)</span>
<span class="sd">        ```</span>

<span class="sd">    Note:</span>
<span class="sd">        Uses platform-specific paths:</span>
<span class="sd">        - Windows: ~/AppData/Local/{app_name}/Cache</span>
<span class="sd">        - macOS: ~/Library/Caches/{app_name}</span>
<span class="sd">        - Linux/Unix: ~/.cache/{app_name}</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">home</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s2">&quot;~&quot;</span><span class="p">)</span>
    <span class="n">system</span> <span class="o">=</span> <span class="n">platform</span><span class="o">.</span><span class="n">system</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">system</span> <span class="o">==</span> <span class="s2">&quot;Windows&quot;</span><span class="p">:</span>
        <span class="n">cache_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">home</span><span class="p">,</span> <span class="s2">&quot;AppData&quot;</span><span class="p">,</span> <span class="s2">&quot;Local&quot;</span><span class="p">,</span> <span class="n">app_name</span><span class="p">,</span> <span class="s2">&quot;Cache&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">system</span> <span class="o">==</span> <span class="s2">&quot;Darwin&quot;</span><span class="p">:</span>
        <span class="n">cache_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">home</span><span class="p">,</span> <span class="s2">&quot;Library&quot;</span><span class="p">,</span> <span class="s2">&quot;Caches&quot;</span><span class="p">,</span> <span class="n">app_name</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">cache_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">home</span><span class="p">,</span> <span class="s2">&quot;.cache&quot;</span><span class="p">,</span> <span class="n">app_name</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">cache_dir</span><span class="p">):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">cache_dir</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">cache_dir</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="hydroutils.hydro_file.get_lastest_file_in_a_dir" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_lastest_file_in_a_dir</span><span class="p">(</span><span class="n">dir_path</span><span class="p">)</span></code>


<a href="#hydroutils.hydro_file.get_lastest_file_in_a_dir" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Gets the most recently modified .pth file in a directory.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>dir_path</code></td>
        <td><code>str</code></td>
        <td><p>Directory to search in.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>str</code></td>
      <td><p>Path to the most recently modified .pth file.</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1"># Get latest model weights file</span>
<span class="n">latest</span> <span class="o">=</span> <span class="n">get_lastest_file_in_a_dir</span><span class="p">(</span><span class="s1">&#39;./models&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Latest weights: </span><span class="si">{</span><span class="n">latest</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>

        <details class="quote">
          <summary>Source code in <code>hydroutils/hydro_file.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_lastest_file_in_a_dir</span><span class="p">(</span><span class="n">dir_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Gets the most recently modified .pth file in a directory.</span>

<span class="sd">    Args:</span>
<span class="sd">        dir_path: Directory to search in.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Path to the most recently modified .pth file.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        # Get latest model weights file</span>
<span class="sd">        latest = get_lastest_file_in_a_dir(&#39;./models&#39;)</span>
<span class="sd">        print(f&quot;Latest weights: {latest}&quot;)</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">pth_files_lst</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dir_path</span><span class="p">,</span> <span class="n">file</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">dir_path</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">fnmatch</span><span class="o">.</span><span class="n">fnmatch</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="s2">&quot;*.pth&quot;</span><span class="p">)</span>
    <span class="p">]</span>
    <span class="k">return</span> <span class="n">get_latest_file_in_a_lst</span><span class="p">(</span><span class="n">pth_files_lst</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="hydroutils.hydro_file.get_latest_file_in_a_lst" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_latest_file_in_a_lst</span><span class="p">(</span><span class="n">lst</span><span class="p">)</span></code>


<a href="#hydroutils.hydro_file.get_latest_file_in_a_lst" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Gets the most recently modified file from a list of files.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>lst</code></td>
        <td><code>list</code></td>
        <td><p>List of file paths.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>str</code></td>
      <td><p>Path to the most recently modified file.</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">files</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;model_v1.pth&#39;</span><span class="p">,</span> <span class="s1">&#39;model_v2.pth&#39;</span><span class="p">,</span> <span class="s1">&#39;model_v3.pth&#39;</span><span class="p">]</span>
<span class="n">latest</span> <span class="o">=</span> <span class="n">get_latest_file_in_a_lst</span><span class="p">(</span><span class="n">files</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Latest version: </span><span class="si">{</span><span class="n">latest</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>

        <details class="quote">
          <summary>Source code in <code>hydroutils/hydro_file.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_latest_file_in_a_lst</span><span class="p">(</span><span class="n">lst</span><span class="p">:</span> <span class="nb">list</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Gets the most recently modified file from a list of files.</span>

<span class="sd">    Args:</span>
<span class="sd">        lst: List of file paths.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Path to the most recently modified file.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        files = [&#39;model_v1.pth&#39;, &#39;model_v2.pth&#39;, &#39;model_v3.pth&#39;]</span>
<span class="sd">        latest = get_latest_file_in_a_lst(files)</span>
<span class="sd">        print(f&quot;Latest version: {latest}&quot;)</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">lst_ctime</span> <span class="o">=</span> <span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">getctime</span><span class="p">(</span><span class="n">file</span><span class="p">)</span> <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">lst</span><span class="p">]</span>
    <span class="n">sort_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">lst_ctime</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">lst</span><span class="p">[</span><span class="n">sort_idx</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="hydroutils.hydro_file.is_there_file" class="doc doc-heading">
<code class="highlight language-python"><span class="n">is_there_file</span><span class="p">(</span><span class="n">zipfile_path</span><span class="p">,</span> <span class="n">unzip_dir</span><span class="p">)</span></code>


<a href="#hydroutils.hydro_file.is_there_file" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Checks if a zip file exists and is properly extracted.</p>
<p>If the zip file exists but hasn't been extracted, extracts it.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>zipfile_path</code></td>
        <td><code>str</code></td>
        <td><p>Path to the zip file.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>unzip_dir</code></td>
        <td><code>str</code></td>
        <td><p>Directory where the file should be/has been extracted.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>bool</code></td>
      <td><p>True if the file exists (and is extracted), False otherwise.</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">if</span> <span class="n">is_there_file</span><span class="p">(</span><span class="s1">&#39;data.zip&#39;</span><span class="p">,</span> <span class="s1">&#39;./extracted&#39;</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;File exists and is extracted&#39;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;File not found&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>

        <details class="quote">
          <summary>Source code in <code>hydroutils/hydro_file.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">is_there_file</span><span class="p">(</span><span class="n">zipfile_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">unzip_dir</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Checks if a zip file exists and is properly extracted.</span>

<span class="sd">    If the zip file exists but hasn&#39;t been extracted, extracts it.</span>

<span class="sd">    Args:</span>
<span class="sd">        zipfile_path: Path to the zip file.</span>
<span class="sd">        unzip_dir: Directory where the file should be/has been extracted.</span>

<span class="sd">    Returns:</span>
<span class="sd">        True if the file exists (and is extracted), False otherwise.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        if is_there_file(&#39;data.zip&#39;, &#39;./extracted&#39;):</span>
<span class="sd">            print(&#39;File exists and is extracted&#39;)</span>
<span class="sd">        else:</span>
<span class="sd">            print(&#39;File not found&#39;)</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">zipfile_path</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">unzip_dir</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="n">unzip_nested_zip</span><span class="p">(</span><span class="n">zipfile_path</span><span class="p">,</span> <span class="n">unzip_dir</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">True</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="hydroutils.hydro_file.serialize_json" class="doc doc-heading">
<code class="highlight language-python"><span class="n">serialize_json</span><span class="p">(</span><span class="n">my_dict</span><span class="p">,</span> <span class="n">my_file</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">,</span> <span class="n">ensure_ascii</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>


<a href="#hydroutils.hydro_file.serialize_json" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Saves a dictionary to a JSON file.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>my_dict</code></td>
        <td><code>dict</code></td>
        <td><p>Dictionary to serialize.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>my_file</code></td>
        <td><code>str</code></td>
        <td><p>Path where the JSON file should be saved.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>encoding</code></td>
        <td><code>str</code></td>
        <td><p>Character encoding for the file. Defaults to UTF-8.</p></td>
        <td><code>&#39;utf-8&#39;</code></td>
      </tr>
      <tr>
        <td><code>ensure_ascii</code></td>
        <td><code>bool</code></td>
        <td><p>If True, escapes non-ASCII characters. Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;John&#39;</span><span class="p">,</span> <span class="s1">&#39;age&#39;</span><span class="p">:</span> <span class="mi">30</span><span class="p">}</span>
<span class="n">serialize_json</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s1">&#39;person.json&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>

        <details class="quote">
          <summary>Source code in <code>hydroutils/hydro_file.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">serialize_json</span><span class="p">(</span><span class="n">my_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">my_file</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">encoding</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;utf-8&quot;</span><span class="p">,</span> <span class="n">ensure_ascii</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Saves a dictionary to a JSON file.</span>

<span class="sd">    Args:</span>
<span class="sd">        my_dict: Dictionary to serialize.</span>
<span class="sd">        my_file: Path where the JSON file should be saved.</span>
<span class="sd">        encoding: Character encoding for the file. Defaults to UTF-8.</span>
<span class="sd">        ensure_ascii: If True, escapes non-ASCII characters. Defaults to True.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        data = {&#39;name&#39;: &#39;John&#39;, &#39;age&#39;: 30}</span>
<span class="sd">        serialize_json(data, &#39;person.json&#39;, encoding=&#39;utf-8&#39;)</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">my_file</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="n">encoding</span><span class="p">)</span> <span class="k">as</span> <span class="n">FP</span><span class="p">:</span>
        <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">my_dict</span><span class="p">,</span> <span class="n">FP</span><span class="p">,</span> <span class="n">ensure_ascii</span><span class="o">=</span><span class="n">ensure_ascii</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="hydroutils.hydro_file.serialize_json_np" class="doc doc-heading">
<code class="highlight language-python"><span class="n">serialize_json_np</span><span class="p">(</span><span class="n">my_dict</span><span class="p">,</span> <span class="n">my_file</span><span class="p">)</span></code>


<a href="#hydroutils.hydro_file.serialize_json_np" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Saves a dictionary containing NumPy arrays to a JSON file.</p>
<p>Uses NumpyArrayEncoder to handle NumPy data types.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>my_dict</code></td>
        <td><code>dict</code></td>
        <td><p>Dictionary to serialize (may contain NumPy arrays).</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>my_file</code></td>
        <td><code>str</code></td>
        <td><p>Path where the JSON file should be saved.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;array&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]),</span>
    <span class="s1">&#39;scalar&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">(</span><span class="mf">3.14</span><span class="p">)</span>
<span class="p">}</span>
<span class="n">serialize_json_np</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s1">&#39;data.json&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>

        <details class="quote">
          <summary>Source code in <code>hydroutils/hydro_file.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">serialize_json_np</span><span class="p">(</span><span class="n">my_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">my_file</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Saves a dictionary containing NumPy arrays to a JSON file.</span>

<span class="sd">    Uses NumpyArrayEncoder to handle NumPy data types.</span>

<span class="sd">    Args:</span>
<span class="sd">        my_dict: Dictionary to serialize (may contain NumPy arrays).</span>
<span class="sd">        my_file: Path where the JSON file should be saved.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        import numpy as np</span>
<span class="sd">        data = {</span>
<span class="sd">            &#39;array&#39;: np.array([1, 2, 3]),</span>
<span class="sd">            &#39;scalar&#39;: np.float32(3.14)</span>
<span class="sd">        }</span>
<span class="sd">        serialize_json_np(data, &#39;data.json&#39;)</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">my_file</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">FP</span><span class="p">:</span>
        <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">my_dict</span><span class="p">,</span> <span class="n">FP</span><span class="p">,</span> <span class="bp">cls</span><span class="o">=</span><span class="n">NumpyArrayEncoder</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="hydroutils.hydro_file.serialize_numpy" class="doc doc-heading">
<code class="highlight language-python"><span class="n">serialize_numpy</span><span class="p">(</span><span class="n">my_array</span><span class="p">,</span> <span class="n">my_file</span><span class="p">)</span></code>


<a href="#hydroutils.hydro_file.serialize_numpy" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Saves a NumPy array to a .npy file.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>my_array</code></td>
        <td><code>ndarray</code></td>
        <td><p>NumPy array to save.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>my_file</code></td>
        <td><code>str</code></td>
        <td><p>Path where the array should be saved.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
<span class="n">serialize_numpy</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="s1">&#39;array.npy&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>

        <details class="quote">
          <summary>Source code in <code>hydroutils/hydro_file.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">serialize_numpy</span><span class="p">(</span><span class="n">my_array</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">my_file</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Saves a NumPy array to a .npy file.</span>

<span class="sd">    Args:</span>
<span class="sd">        my_array: NumPy array to save.</span>
<span class="sd">        my_file: Path where the array should be saved.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        arr = np.array([[1, 2], [3, 4]])</span>
<span class="sd">        serialize_numpy(arr, &#39;array.npy&#39;)</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">my_file</span><span class="p">,</span> <span class="n">my_array</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="hydroutils.hydro_file.serialize_pickle" class="doc doc-heading">
<code class="highlight language-python"><span class="n">serialize_pickle</span><span class="p">(</span><span class="n">my_object</span><span class="p">,</span> <span class="n">my_file</span><span class="p">)</span></code>


<a href="#hydroutils.hydro_file.serialize_pickle" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Saves an object to a pickle file.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>my_object</code></td>
        <td><code>object</code></td>
        <td><p>Any Python object to serialize.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>my_file</code></td>
        <td><code>str</code></td>
        <td><p>Path where the pickle file should be saved.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">MyClass</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">value</span>

<span class="n">obj</span> <span class="o">=</span> <span class="n">MyClass</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">serialize_pickle</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="s1">&#39;object.pkl&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>

        <details class="quote">
          <summary>Source code in <code>hydroutils/hydro_file.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">serialize_pickle</span><span class="p">(</span><span class="n">my_object</span><span class="p">:</span> <span class="nb">object</span><span class="p">,</span> <span class="n">my_file</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Saves an object to a pickle file.</span>

<span class="sd">    Args:</span>
<span class="sd">        my_object: Any Python object to serialize.</span>
<span class="sd">        my_file: Path where the pickle file should be saved.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        class MyClass:</span>
<span class="sd">            def __init__(self, value):</span>
<span class="sd">                self.value = value</span>

<span class="sd">        obj = MyClass(42)</span>
<span class="sd">        serialize_pickle(obj, &#39;object.pkl&#39;)</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">my_file</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">my_object</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="hydroutils.hydro_file.unserialize_json" class="doc doc-heading">
<code class="highlight language-python"><span class="n">unserialize_json</span><span class="p">(</span><span class="n">my_file</span><span class="p">)</span></code>


<a href="#hydroutils.hydro_file.unserialize_json" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Loads a JSON file into a dictionary.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>my_file</code></td>
        <td><code>str</code></td>
        <td><p>Path to the JSON file to load.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>dict</code></td>
      <td><p>Dictionary containing the JSON data.</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">data</span> <span class="o">=</span> <span class="n">unserialize_json</span><span class="p">(</span><span class="s1">&#39;config.json&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;settings&#39;</span><span class="p">])</span>
</code></pre></div></td></tr></table></div>

        <details class="quote">
          <summary>Source code in <code>hydroutils/hydro_file.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">unserialize_json</span><span class="p">(</span><span class="n">my_file</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Loads a JSON file into a dictionary.</span>

<span class="sd">    Args:</span>
<span class="sd">        my_file: Path to the JSON file to load.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dictionary containing the JSON data.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        data = unserialize_json(&#39;config.json&#39;)</span>
<span class="sd">        print(data[&#39;settings&#39;])</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">my_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
        <span class="n">my_object</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">fp</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">my_object</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="hydroutils.hydro_file.unserialize_json_ordered" class="doc doc-heading">
<code class="highlight language-python"><span class="n">unserialize_json_ordered</span><span class="p">(</span><span class="n">my_file</span><span class="p">)</span></code>


<a href="#hydroutils.hydro_file.unserialize_json_ordered" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Loads a JSON file into an OrderedDict, preserving key order.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>my_file</code></td>
        <td><code>str</code></td>
        <td><p>Path to the JSON file to load.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>OrderedDict</code></td>
      <td><p>OrderedDict containing the JSON data with preserved key order.</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">data</span> <span class="o">=</span> <span class="n">unserialize_json_ordered</span><span class="p">(</span><span class="s1">&#39;config.json&#39;</span><span class="p">)</span>
<span class="c1"># Keys in data maintain their original order from the file</span>
</code></pre></div></td></tr></table></div>

        <details class="quote">
          <summary>Source code in <code>hydroutils/hydro_file.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">unserialize_json_ordered</span><span class="p">(</span><span class="n">my_file</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">OrderedDict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Loads a JSON file into an OrderedDict, preserving key order.</span>

<span class="sd">    Args:</span>
<span class="sd">        my_file: Path to the JSON file to load.</span>

<span class="sd">    Returns:</span>
<span class="sd">        OrderedDict containing the JSON data with preserved key order.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        data = unserialize_json_ordered(&#39;config.json&#39;)</span>
<span class="sd">        # Keys in data maintain their original order from the file</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">my_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
        <span class="n">m_dict</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="n">object_pairs_hook</span><span class="o">=</span><span class="n">OrderedDict</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">m_dict</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="hydroutils.hydro_file.unserialize_numpy" class="doc doc-heading">
<code class="highlight language-python"><span class="n">unserialize_numpy</span><span class="p">(</span><span class="n">my_file</span><span class="p">)</span></code>


<a href="#hydroutils.hydro_file.unserialize_numpy" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Loads a NumPy array from a .npy file.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>my_file</code></td>
        <td><code>str</code></td>
        <td><p>Path to the .npy file to load.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>ndarray</code></td>
      <td><p>The loaded NumPy array.</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">arr</span> <span class="o">=</span> <span class="n">unserialize_numpy</span><span class="p">(</span><span class="s1">&#39;array.npy&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># Shows array dimensions</span>
</code></pre></div></td></tr></table></div>

        <details class="quote">
          <summary>Source code in <code>hydroutils/hydro_file.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">unserialize_numpy</span><span class="p">(</span><span class="n">my_file</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Loads a NumPy array from a .npy file.</span>

<span class="sd">    Args:</span>
<span class="sd">        my_file: Path to the .npy file to load.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The loaded NumPy array.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        arr = unserialize_numpy(&#39;array.npy&#39;)</span>
<span class="sd">        print(arr.shape)  # Shows array dimensions</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">my_file</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="hydroutils.hydro_file.unserialize_pickle" class="doc doc-heading">
<code class="highlight language-python"><span class="n">unserialize_pickle</span><span class="p">(</span><span class="n">my_file</span><span class="p">)</span></code>


<a href="#hydroutils.hydro_file.unserialize_pickle" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Loads an object from a pickle file.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>my_file</code></td>
        <td><code>str</code></td>
        <td><p>Path to the pickle file to load.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>object</code></td>
      <td><p>The deserialized Python object.</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">obj</span> <span class="o">=</span> <span class="n">unserialize_pickle</span><span class="p">(</span><span class="s1">&#39;object.pkl&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>  <span class="c1"># Assuming obj has a &#39;value&#39; attribute</span>
</code></pre></div></td></tr></table></div>

        <details class="quote">
          <summary>Source code in <code>hydroutils/hydro_file.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">unserialize_pickle</span><span class="p">(</span><span class="n">my_file</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">object</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Loads an object from a pickle file.</span>

<span class="sd">    Args:</span>
<span class="sd">        my_file: Path to the pickle file to load.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The deserialized Python object.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        obj = unserialize_pickle(&#39;object.pkl&#39;)</span>
<span class="sd">        print(obj.value)  # Assuming obj has a &#39;value&#39; attribute</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">my_file</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">my_object</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">my_object</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="hydroutils.hydro_file.unzip_file" class="doc doc-heading">
<code class="highlight language-python"><span class="n">unzip_file</span><span class="p">(</span><span class="n">data_zip</span><span class="p">,</span> <span class="n">path_unzip</span><span class="p">)</span></code>


<a href="#hydroutils.hydro_file.unzip_file" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Extracts a zip file to a specified directory.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>data_zip</code></td>
        <td><code>str</code></td>
        <td><p>Path to the zip file.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>path_unzip</code></td>
        <td><code>str</code></td>
        <td><p>Directory where contents should be extracted.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">unzip_file</span><span class="p">(</span><span class="s1">&#39;data.zip&#39;</span><span class="p">,</span> <span class="s1">&#39;./extracted&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>

        <details class="quote">
          <summary>Source code in <code>hydroutils/hydro_file.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">unzip_file</span><span class="p">(</span><span class="n">data_zip</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">path_unzip</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Extracts a zip file to a specified directory.</span>

<span class="sd">    Args:</span>
<span class="sd">        data_zip: Path to the zip file.</span>
<span class="sd">        path_unzip: Directory where contents should be extracted.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        unzip_file(&#39;data.zip&#39;, &#39;./extracted&#39;)</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="n">zipfile</span><span class="o">.</span><span class="n">ZipFile</span><span class="p">(</span><span class="n">data_zip</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">zip_temp</span><span class="p">:</span>
        <span class="n">zip_temp</span><span class="o">.</span><span class="n">extractall</span><span class="p">(</span><span class="n">path_unzip</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="hydroutils.hydro_file.unzip_nested_zip" class="doc doc-heading">
<code class="highlight language-python"><span class="n">unzip_nested_zip</span><span class="p">(</span><span class="n">dataset_zip</span><span class="p">,</span> <span class="n">path_unzip</span><span class="p">)</span></code>


<a href="#hydroutils.hydro_file.unzip_nested_zip" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Recursively extracts a zip file and any nested zip files within it.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>dataset_zip</code></td>
        <td><code>str</code></td>
        <td><p>Path to the zip file.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>path_unzip</code></td>
        <td><code>str</code></td>
        <td><p>Directory where contents should be extracted.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>      <p>!!! note
    If a file's name ends with underscore (e.g., "xxx_"), the zipfile library
    may raise an OSError. In such cases, check the extracted files manually.</p>

<p><strong>Examples:</strong></p>
    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1"># Extract main.zip containing nested archives</span>
<span class="n">unzip_nested_zip</span><span class="p">(</span><span class="s1">&#39;main.zip&#39;</span><span class="p">,</span> <span class="s1">&#39;./extracted&#39;</span><span class="p">)</span>
<span class="c1"># Extracts:</span>
<span class="c1"># - main.zip -&gt; ./extracted/*</span>
<span class="c1"># - Any *.zip in extracted/* -&gt; ./extracted/*/subdir/*</span>
</code></pre></div></td></tr></table></div>

        <details class="quote">
          <summary>Source code in <code>hydroutils/hydro_file.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">unzip_nested_zip</span><span class="p">(</span><span class="n">dataset_zip</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">path_unzip</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Recursively extracts a zip file and any nested zip files within it.</span>

<span class="sd">    Args:</span>
<span class="sd">        dataset_zip: Path to the zip file.</span>
<span class="sd">        path_unzip: Directory where contents should be extracted.</span>

<span class="sd">    Note:</span>
<span class="sd">        If a file&#39;s name ends with underscore (e.g., &quot;xxx_&quot;), the zipfile library</span>
<span class="sd">        may raise an OSError. In such cases, check the extracted files manually.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        # Extract main.zip containing nested archives</span>
<span class="sd">        unzip_nested_zip(&#39;main.zip&#39;, &#39;./extracted&#39;)</span>
<span class="sd">        # Extracts:</span>
<span class="sd">        # - main.zip -&gt; ./extracted/*</span>
<span class="sd">        # - Any *.zip in extracted/* -&gt; ./extracted/*/subdir/*</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">with</span> <span class="n">zipfile</span><span class="o">.</span><span class="n">ZipFile</span><span class="p">(</span><span class="n">dataset_zip</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">zfile</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">zfile</span><span class="o">.</span><span class="n">extractall</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="n">path_unzip</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">OSError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="s2">&quot;Please check the unzipped files manually. There may be some missed important files.&quot;</span>
            <span class="p">)</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The directory is: </span><span class="si">{</span><span class="n">path_unzip</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error message: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">root</span><span class="p">,</span> <span class="n">dirs</span><span class="p">,</span> <span class="n">files</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">path_unzip</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\.zip$&quot;</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
                <span class="n">file_spec</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
                <span class="n">new_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">filename</span><span class="p">[:</span><span class="o">-</span><span class="mi">4</span><span class="p">])</span>
                <span class="n">unzip_nested_zip</span><span class="p">(</span><span class="n">file_spec</span><span class="p">,</span> <span class="n">new_dir</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="hydroutils.hydro_file.zip_extract" class="doc doc-heading">
<code class="highlight language-python"><span class="n">zip_extract</span><span class="p">(</span><span class="n">the_dir</span><span class="p">)</span></code>


<a href="#hydroutils.hydro_file.zip_extract" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Extracts all zip files in a directory.</p>
<p>Each zip file is extracted to a subdirectory named after the zip file
(without the .zip extension).</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>the_dir</code></td>
        <td><code>Path</code></td>
        <td><p>Directory containing zip files to extract.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
<span class="n">zip_extract</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="s1">&#39;./downloads&#39;</span><span class="p">))</span>
<span class="c1"># Extracts:</span>
<span class="c1"># - ./downloads/file1.zip -&gt; ./downloads/file1/*</span>
<span class="c1"># - ./downloads/file2.zip -&gt; ./downloads/file2/*</span>
</code></pre></div></td></tr></table></div>

        <details class="quote">
          <summary>Source code in <code>hydroutils/hydro_file.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">zip_extract</span><span class="p">(</span><span class="n">the_dir</span><span class="p">:</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Extracts all zip files in a directory.</span>

<span class="sd">    Each zip file is extracted to a subdirectory named after the zip file</span>
<span class="sd">    (without the .zip extension).</span>

<span class="sd">    Args:</span>
<span class="sd">        the_dir: Directory containing zip files to extract.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        from pathlib import Path</span>
<span class="sd">        zip_extract(Path(&#39;./downloads&#39;))</span>
<span class="sd">        # Extracts:</span>
<span class="sd">        # - ./downloads/file1.zip -&gt; ./downloads/file1/*</span>
<span class="sd">        # - ./downloads/file2.zip -&gt; ./downloads/file2/*</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">the_dir</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s2">&quot;*.zip&quot;</span><span class="p">):</span>
        <span class="k">with</span> <span class="n">zipfile</span><span class="o">.</span><span class="n">ZipFile</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="k">as</span> <span class="n">zf</span><span class="p">:</span>
            <span class="c1"># extract files to a directory named by f.stem</span>
            <span class="n">zf</span><span class="o">.</span><span class="n">extractall</span><span class="p">(</span><span class="n">the_dir</span><span class="o">.</span><span class="n">joinpath</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">stem</span><span class="p">))</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="hydroutils.hydro_file.zip_file_name_from_url" class="doc doc-heading">
<code class="highlight language-python"><span class="n">zip_file_name_from_url</span><span class="p">(</span><span class="n">data_url</span><span class="p">,</span> <span class="n">data_dir</span><span class="p">)</span></code>


<a href="#hydroutils.hydro_file.zip_file_name_from_url" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Generates local file paths for a zip file from its URL.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>data_url</code></td>
        <td><code>str</code></td>
        <td><p>URL of the zip file.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>data_dir</code></td>
        <td><code>str</code></td>
        <td><p>Local directory where the file will be saved.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>tuple</code></td>
      <td><p>Tuple of (zip_file_path, unzip_directory_path).</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;https://example.com/data.zip&#39;</span>
<span class="n">zip_path</span><span class="p">,</span> <span class="n">extract_path</span> <span class="o">=</span> <span class="n">zip_file_name_from_url</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="s1">&#39;./downloads&#39;</span><span class="p">)</span>
<span class="c1"># Returns:</span>
<span class="c1"># - zip_path = &#39;./downloads/data.zip&#39;</span>
<span class="c1"># - extract_path = &#39;./downloads/data&#39;</span>
</code></pre></div></td></tr></table></div>

        <details class="quote">
          <summary>Source code in <code>hydroutils/hydro_file.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">zip_file_name_from_url</span><span class="p">(</span><span class="n">data_url</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">data_dir</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generates local file paths for a zip file from its URL.</span>

<span class="sd">    Args:</span>
<span class="sd">        data_url: URL of the zip file.</span>
<span class="sd">        data_dir: Local directory where the file will be saved.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Tuple of (zip_file_path, unzip_directory_path).</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        url = &#39;https://example.com/data.zip&#39;</span>
<span class="sd">        zip_path, extract_path = zip_file_name_from_url(url, &#39;./downloads&#39;)</span>
<span class="sd">        # Returns:</span>
<span class="sd">        # - zip_path = &#39;./downloads/data.zip&#39;</span>
<span class="sd">        # - extract_path = &#39;./downloads/data&#39;</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_url_str</span> <span class="o">=</span> <span class="n">data_url</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="n">parse</span><span class="o">.</span><span class="n">unquote</span><span class="p">(</span><span class="n">data_url_str</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">zipfile_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
    <span class="n">unzip_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span> <span class="n">filename</span><span class="p">[:</span><span class="o">-</span><span class="mi">4</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">zipfile_path</span><span class="p">,</span> <span class="n">unzip_dir</span>
</code></pre></div>
        </details>
    </div>

  </div>






  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h2 id="hydroutils.hydro_log" class="doc doc-heading">
        <code>hydro_log</code>



<a href="#hydroutils.hydro_log" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Author: Wenyu Ouyang
Date: 2023-10-25 20:07:14
LastEditTime: 2025-01-15 11:55:24
LastEditors: Wenyu Ouyang
Description: Use rich to log: https://rich.readthedocs.io/en/latest/
FilePath: /hydroutils/hydroutils/hydro_log.py
Copyright (c) 2023-2024 Wenyu Ouyang. All rights reserved.</p>



  <div class="doc doc-children">







  <div class="doc doc-object doc-class">



<h3 id="hydroutils.hydro_log.HydroWarning" class="doc doc-heading">
        <code>
HydroWarning        </code>



<a href="#hydroutils.hydro_log.HydroWarning" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>A class for handling and displaying hydrology-related warnings and messages.</p>
<p>This class provides methods for displaying formatted warning messages and operation
status using the rich library's console features.</p>

<p><strong>Attributes:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>console</code></td>
        <td></td>
        <td><p>A rich.console.Console instance for formatted terminal output.</p></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>hydroutils/hydro_log.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">HydroWarning</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A class for handling and displaying hydrology-related warnings and messages.</span>

<span class="sd">    This class provides methods for displaying formatted warning messages and operation</span>
<span class="sd">    status using the rich library&#39;s console features.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        console: A rich.console.Console instance for formatted terminal output.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initializes the HydroWarning with a rich console.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">console</span> <span class="o">=</span> <span class="n">Console</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">no_directory</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">directory_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="n">Text</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Displays a warning message for a missing directory.</span>

<span class="sd">        Args:</span>
<span class="sd">            directory_name: Name of the directory that was not found.</span>
<span class="sd">            message: Optional custom message. If None, a default message is used.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">message</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">message</span> <span class="o">=</span> <span class="n">Text</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;There is no such directory: </span><span class="si">{</span><span class="n">directory_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;bold red&quot;</span>
            <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">file_not_found</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="n">Text</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Displays a warning message for a missing file.</span>

<span class="sd">        Args:</span>
<span class="sd">            file_name: Name of the file that was not found.</span>
<span class="sd">            message: Optional custom message. If None, a default message is used.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">message</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">message</span> <span class="o">=</span> <span class="n">Text</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;We didn&#39;t find this file: </span><span class="si">{</span><span class="n">file_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;bold yellow&quot;</span>
            <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">operation_successful</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">operation_detail</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="n">Text</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Displays a success message for a completed operation.</span>

<span class="sd">        Args:</span>
<span class="sd">            operation_detail: Description of the successful operation.</span>
<span class="sd">            message: Optional custom message. If None, a default message is used.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">message</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">message</span> <span class="o">=</span> <span class="n">Text</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Operation Success: </span><span class="si">{</span><span class="n">operation_detail</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;bold green&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">









  <div class="doc doc-object doc-method">



<h4 id="hydroutils.hydro_log.HydroWarning.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#hydroutils.hydro_log.HydroWarning.__init__" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Initializes the HydroWarning with a rich console.</p>

        <details class="quote">
          <summary>Source code in <code>hydroutils/hydro_log.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initializes the HydroWarning with a rich console.&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">console</span> <span class="o">=</span> <span class="n">Console</span><span class="p">()</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="hydroutils.hydro_log.HydroWarning.file_not_found" class="doc doc-heading">
<code class="highlight language-python"><span class="n">file_not_found</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_name</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#hydroutils.hydro_log.HydroWarning.file_not_found" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Displays a warning message for a missing file.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>file_name</code></td>
        <td><code>str</code></td>
        <td><p>Name of the file that was not found.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>message</code></td>
        <td><code>Text</code></td>
        <td><p>Optional custom message. If None, a default message is used.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>hydroutils/hydro_log.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">file_not_found</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="n">Text</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Displays a warning message for a missing file.</span>

<span class="sd">    Args:</span>
<span class="sd">        file_name: Name of the file that was not found.</span>
<span class="sd">        message: Optional custom message. If None, a default message is used.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">message</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">message</span> <span class="o">=</span> <span class="n">Text</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;We didn&#39;t find this file: </span><span class="si">{</span><span class="n">file_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;bold yellow&quot;</span>
        <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="hydroutils.hydro_log.HydroWarning.no_directory" class="doc doc-heading">
<code class="highlight language-python"><span class="n">no_directory</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">directory_name</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#hydroutils.hydro_log.HydroWarning.no_directory" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Displays a warning message for a missing directory.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>directory_name</code></td>
        <td><code>str</code></td>
        <td><p>Name of the directory that was not found.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>message</code></td>
        <td><code>Text</code></td>
        <td><p>Optional custom message. If None, a default message is used.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>hydroutils/hydro_log.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">no_directory</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">directory_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="n">Text</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Displays a warning message for a missing directory.</span>

<span class="sd">    Args:</span>
<span class="sd">        directory_name: Name of the directory that was not found.</span>
<span class="sd">        message: Optional custom message. If None, a default message is used.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">message</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">message</span> <span class="o">=</span> <span class="n">Text</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;There is no such directory: </span><span class="si">{</span><span class="n">directory_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;bold red&quot;</span>
        <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="hydroutils.hydro_log.HydroWarning.operation_successful" class="doc doc-heading">
<code class="highlight language-python"><span class="n">operation_successful</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">operation_detail</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#hydroutils.hydro_log.HydroWarning.operation_successful" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Displays a success message for a completed operation.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>operation_detail</code></td>
        <td><code>str</code></td>
        <td><p>Description of the successful operation.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>message</code></td>
        <td><code>Text</code></td>
        <td><p>Optional custom message. If None, a default message is used.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>hydroutils/hydro_log.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">operation_successful</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">operation_detail</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="n">Text</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Displays a success message for a completed operation.</span>

<span class="sd">    Args:</span>
<span class="sd">        operation_detail: Description of the successful operation.</span>
<span class="sd">        message: Optional custom message. If None, a default message is used.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">message</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">message</span> <span class="o">=</span> <span class="n">Text</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Operation Success: </span><span class="si">{</span><span class="n">operation_detail</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;bold green&quot;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>




  <div class="doc doc-object doc-function">



<h3 id="hydroutils.hydro_log.hydro_logger" class="doc doc-heading">
<code class="highlight language-python"><span class="n">hydro_logger</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span></code>


<a href="#hydroutils.hydro_log.hydro_logger" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>A class decorator that adds logging capabilities to a class.</p>
<p>This decorator sets up both file and console logging for the decorated class.
Logs are stored in a cache directory with timestamps in the filename.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>cls</code></td>
        <td></td>
        <td><p>The class to be decorated.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td></td>
      <td><p>The decorated class with an added logger attribute.</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@hydro_logger</span>
<span class="k">class</span><span class="w"> </span><span class="nc">MyHydroClass</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">some_method</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Processing data...&quot;</span><span class="p">)</span>
        <span class="c1"># Method implementation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Processing complete&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>

        <details class="quote">
          <summary>Source code in <code>hydroutils/hydro_log.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">hydro_logger</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A class decorator that adds logging capabilities to a class.</span>

<span class="sd">    This decorator sets up both file and console logging for the decorated class.</span>
<span class="sd">    Logs are stored in a cache directory with timestamps in the filename.</span>

<span class="sd">    Args:</span>
<span class="sd">        cls: The class to be decorated.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The decorated class with an added logger attribute.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        @hydro_logger</span>
<span class="sd">        class MyHydroClass:</span>
<span class="sd">            def some_method(self):</span>
<span class="sd">                self.logger.info(&quot;Processing data...&quot;)</span>
<span class="sd">                # Method implementation</span>
<span class="sd">                self.logger.debug(&quot;Processing complete&quot;)</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Use the class name as the logger name</span>
    <span class="n">logger_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="n">logger_name</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">)</span>
    <span class="n">cache_dir</span> <span class="o">=</span> <span class="n">get_cache_dir</span><span class="p">()</span>
    <span class="n">log_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">cache_dir</span><span class="p">,</span> <span class="s2">&quot;logs&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">log_dir</span><span class="p">):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">log_dir</span><span class="p">)</span>
    <span class="n">current_time</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y%m</span><span class="si">%d</span><span class="s2">_%H%M%S&quot;</span><span class="p">)</span>
    <span class="n">log_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">log_dir</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">logger_name</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">current_time</span><span class="si">}</span><span class="s2">.log&quot;</span><span class="p">)</span>
    <span class="c1"># Check if handlers have already been added to avoid duplication</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">logger</span><span class="o">.</span><span class="n">handlers</span><span class="p">:</span>
        <span class="c1"># Create a file handler to write logs to the specified file</span>
        <span class="n">file_handler</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">FileHandler</span><span class="p">(</span><span class="n">log_file</span><span class="p">)</span>
        <span class="n">file_handler</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">)</span>

        <span class="c1"># Create a console handler to output logs to the console (optional)</span>
        <span class="n">console_handler</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">StreamHandler</span><span class="p">()</span>
        <span class="n">console_handler</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>

        <span class="c1"># set the format of the log</span>
        <span class="n">formatter</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">Formatter</span><span class="p">(</span>
            <span class="s2">&quot;</span><span class="si">%(asctime)s</span><span class="s2"> - </span><span class="si">%(name)s</span><span class="s2"> - </span><span class="si">%(levelname)s</span><span class="s2"> - </span><span class="si">%(message)s</span><span class="s2">&quot;</span>
        <span class="p">)</span>
        <span class="n">file_handler</span><span class="o">.</span><span class="n">setFormatter</span><span class="p">(</span><span class="n">formatter</span><span class="p">)</span>
        <span class="n">console_handler</span><span class="o">.</span><span class="n">setFormatter</span><span class="p">(</span><span class="n">formatter</span><span class="p">)</span>

        <span class="c1"># Add handlers to the logger</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">addHandler</span><span class="p">(</span><span class="n">file_handler</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">addHandler</span><span class="p">(</span><span class="n">console_handler</span><span class="p">)</span>

    <span class="c1"># Bind the logger to the class attribute</span>
    <span class="bp">cls</span><span class="o">.</span><span class="n">logger</span> <span class="o">=</span> <span class="n">logger</span>
    <span class="k">return</span> <span class="bp">cls</span>
</code></pre></div>
        </details>
    </div>

  </div>






  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h2 id="hydroutils.hydro_plot" class="doc doc-heading">
        <code>hydro_plot</code>



<a href="#hydroutils.hydro_plot" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Author: Wenyu Ouyang
Date: 2022-12-02 10:59:30
LastEditTime: 2025-01-17 17:30:55
LastEditors: Wenyu Ouyang
Description: Some common plots for hydrology
FilePath: /hydroutils/hydroutils/hydro_plot.py
Copyright (c) 2021-2022 Wenyu Ouyang. All rights reserved.</p>



  <div class="doc doc-children">








  <div class="doc doc-object doc-function">



<h3 id="hydroutils.hydro_plot.create_median_labels" class="doc doc-heading">
<code class="highlight language-python"><span class="n">create_median_labels</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">medians_value</span><span class="p">,</span> <span class="n">percent25value</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">percent75value</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="s1">&#39;small&#39;</span><span class="p">)</span></code>


<a href="#hydroutils.hydro_plot.create_median_labels" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>"create median labels for boxes in a boxplot
Parameters</p>
<hr />
<p>ax : plt.AxesSubplot
    an ax in a fig
medians_value : np.array
    <em>description</em>
percent25value : <em>type</em>, optional
    <em>description</em>, by default None
percent75value : <em>type</em>, optional
    <em>description</em>, by default None
size : str, optional
    the size of median-value labels, by default small</p>

        <details class="quote">
          <summary>Source code in <code>hydroutils/hydro_plot.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">create_median_labels</span><span class="p">(</span>
    <span class="n">ax</span><span class="p">,</span> <span class="n">medians_value</span><span class="p">,</span> <span class="n">percent25value</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">percent75value</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="s2">&quot;small&quot;</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; &quot;create median labels for boxes in a boxplot</span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    ax : plt.AxesSubplot</span>
<span class="sd">        an ax in a fig</span>
<span class="sd">    medians_value : np.array</span>
<span class="sd">        _description_</span>
<span class="sd">    percent25value : _type_, optional</span>
<span class="sd">        _description_, by default None</span>
<span class="sd">    percent75value : _type_, optional</span>
<span class="sd">        _description_, by default None</span>
<span class="sd">    size : str, optional</span>
<span class="sd">        the size of median-value labels, by default small</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">decimal_places</span> <span class="o">=</span> <span class="s2">&quot;2&quot;</span>
    <span class="k">if</span> <span class="n">percent25value</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">percent75value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">vertical_offset</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">medians_value</span> <span class="o">*</span> <span class="mf">0.01</span><span class="p">)</span>  <span class="c1"># offset from median for display</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">per25min</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">percent25value</span><span class="p">)</span>
        <span class="n">per75max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">percent75value</span><span class="p">)</span>
        <span class="n">vertical_offset</span> <span class="o">=</span> <span class="p">(</span><span class="n">per75max</span> <span class="o">-</span> <span class="n">per25min</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.01</span>
    <span class="n">median_labels</span> <span class="o">=</span> <span class="p">[</span><span class="nb">format</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;.</span><span class="si">{</span><span class="n">decimal_places</span><span class="si">}</span><span class="s2">f&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">medians_value</span><span class="p">]</span>
    <span class="n">pos</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">medians_value</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">xtick</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_xticks</span><span class="p">():</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
            <span class="n">pos</span><span class="p">[</span><span class="n">xtick</span><span class="p">],</span>
            <span class="n">medians_value</span><span class="p">[</span><span class="n">xtick</span><span class="p">]</span> <span class="o">+</span> <span class="n">vertical_offset</span><span class="p">,</span>
            <span class="n">median_labels</span><span class="p">[</span><span class="n">xtick</span><span class="p">],</span>
            <span class="n">horizontalalignment</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="s2">&quot;w&quot;</span><span class="p">,</span>
            <span class="c1"># https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.text.html</span>
            <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">,</span>
            <span class="n">weight</span><span class="o">=</span><span class="s2">&quot;semibold&quot;</span><span class="p">,</span>
        <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="hydroutils.hydro_plot.plot_boxes_matplotlib" class="doc doc-heading">
<code class="highlight language-python"><span class="n">plot_boxes_matplotlib</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">label1</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">label2</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">leg_col</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">colorlst</span><span class="o">=</span><span class="s1">&#39;rbgcmywrbgcmyw&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">xticklabel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">axin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ylim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">notch</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">widths</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">subplots_adjust_wspace</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">show_median</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">median_line_color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">median_font_size</span><span class="o">=</span><span class="s1">&#39;small&#39;</span><span class="p">)</span></code>


<a href="#hydroutils.hydro_plot.plot_boxes_matplotlib" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Creates multiple boxplots for comparing multiple indicators or groups.</p>
<p>This function generates a sophisticated boxplot visualization with multiple customization
options, including median display, notched boxes, and flexible layout options. It's
particularly useful for comparing distributions across different groups or indicators.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>data</code></td>
        <td><code>list</code></td>
        <td><p>List of arrays, where each array contains the data for one indicator
or group to be displayed as a boxplot.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>label1</code></td>
        <td><code>list</code></td>
        <td><p>Labels for each subplot. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>label2</code></td>
        <td><code>list</code></td>
        <td><p>Legend labels for boxes within each subplot. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>leg_col</code></td>
        <td><code>int</code></td>
        <td><p>Number of columns in the legend. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>colorlst</code></td>
        <td><code>str</code></td>
        <td><p>String of color characters for box colors. Defaults to
"rbgcmywrbgcmyw".</p></td>
        <td><code>&#39;rbgcmywrbgcmyw&#39;</code></td>
      </tr>
      <tr>
        <td><code>title</code></td>
        <td><code>str</code></td>
        <td><p>Title of the plot. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>figsize</code></td>
        <td><code>tuple</code></td>
        <td><p>Figure size as (width, height). Defaults to (8, 6).</p></td>
        <td><code>(8, 6)</code></td>
      </tr>
      <tr>
        <td><code>sharey</code></td>
        <td><code>bool</code></td>
        <td><p>If True, all subplots share the same y-axis scale.
Defaults to False.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>xticklabel</code></td>
        <td><code>list</code></td>
        <td><p>Custom x-axis tick labels. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>axin</code></td>
        <td><code>matplotlib.axes.Axes</code></td>
        <td><p>Existing axes to plot on. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>ylim</code></td>
        <td><code>list</code></td>
        <td><p>Y-axis limits as [min, max]. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>ylabel</code></td>
        <td><code>list</code></td>
        <td><p>Y-axis labels for each subplot. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>notch</code></td>
        <td><code>bool</code></td>
        <td><p>If True, creates notched boxes. Defaults to False.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>widths</code></td>
        <td><code>float</code></td>
        <td><p>Width of the boxes. Defaults to 0.5.</p></td>
        <td><code>0.5</code></td>
      </tr>
      <tr>
        <td><code>subplots_adjust_wspace</code></td>
        <td><code>float</code></td>
        <td><p>Width space between subplots.
Defaults to 0.2.</p></td>
        <td><code>0.2</code></td>
      </tr>
      <tr>
        <td><code>show_median</code></td>
        <td><code>bool</code></td>
        <td><p>If True, displays median values. Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>median_line_color</code></td>
        <td><code>str</code></td>
        <td><p>Color of median lines. Defaults to "black".</p></td>
        <td><code>&#39;black&#39;</code></td>
      </tr>
      <tr>
        <td><code>median_font_size</code></td>
        <td><code>str</code></td>
        <td><p>Font size for median values. Defaults to "small".</p></td>
        <td><code>&#39;small&#39;</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Union[matplotlib.figure.Figure, Tuple[matplotlib.axes.Axes, dict]]</code></td>
      <td><p>If axin is None, returns the Figure object.
    If axin is provided, returns a tuple of (Axes, boxplot_dict).</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">fig</span> <span class="o">=</span> <span class="n">plot_boxes_matplotlib</span><span class="p">(</span>
<span class="o">...</span>     <span class="n">data</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">label1</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Group A&#39;</span><span class="p">,</span> <span class="s1">&#39;Group B&#39;</span><span class="p">,</span> <span class="s1">&#39;Group C&#39;</span><span class="p">],</span>
<span class="o">...</span>     <span class="n">show_median</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">notch</span><span class="o">=</span><span class="kc">True</span>
<span class="o">...</span> <span class="p">)</span>
</code></pre></div>
      <p>!!! notes
    - The function automatically handles NaN values in the data.
    - Median values can be displayed with customizable formatting.
    - Supports both single and multiple subplot layouts.</p>

        <details class="quote">
          <summary>Source code in <code>hydroutils/hydro_plot.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_boxes_matplotlib</span><span class="p">(</span>
    <span class="n">data</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span>
    <span class="n">label1</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">label2</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">leg_col</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">colorlst</span><span class="o">=</span><span class="s2">&quot;rbgcmywrbgcmyw&quot;</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span>
    <span class="n">sharey</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">xticklabel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">axin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">ylim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">ylabel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">notch</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">widths</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
    <span class="n">subplots_adjust_wspace</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
    <span class="n">show_median</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">median_line_color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span>
    <span class="n">median_font_size</span><span class="o">=</span><span class="s2">&quot;small&quot;</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates multiple boxplots for comparing multiple indicators or groups.</span>

<span class="sd">    This function generates a sophisticated boxplot visualization with multiple customization</span>
<span class="sd">    options, including median display, notched boxes, and flexible layout options. It&#39;s</span>
<span class="sd">    particularly useful for comparing distributions across different groups or indicators.</span>

<span class="sd">    Args:</span>
<span class="sd">        data (list): List of arrays, where each array contains the data for one indicator</span>
<span class="sd">            or group to be displayed as a boxplot.</span>
<span class="sd">        label1 (list, optional): Labels for each subplot. Defaults to None.</span>
<span class="sd">        label2 (list, optional): Legend labels for boxes within each subplot. Defaults to None.</span>
<span class="sd">        leg_col (int, optional): Number of columns in the legend. Defaults to None.</span>
<span class="sd">        colorlst (str, optional): String of color characters for box colors. Defaults to</span>
<span class="sd">            &quot;rbgcmywrbgcmyw&quot;.</span>
<span class="sd">        title (str, optional): Title of the plot. Defaults to None.</span>
<span class="sd">        figsize (tuple, optional): Figure size as (width, height). Defaults to (8, 6).</span>
<span class="sd">        sharey (bool, optional): If True, all subplots share the same y-axis scale.</span>
<span class="sd">            Defaults to False.</span>
<span class="sd">        xticklabel (list, optional): Custom x-axis tick labels. Defaults to None.</span>
<span class="sd">        axin (matplotlib.axes.Axes, optional): Existing axes to plot on. Defaults to None.</span>
<span class="sd">        ylim (list, optional): Y-axis limits as [min, max]. Defaults to None.</span>
<span class="sd">        ylabel (list, optional): Y-axis labels for each subplot. Defaults to None.</span>
<span class="sd">        notch (bool, optional): If True, creates notched boxes. Defaults to False.</span>
<span class="sd">        widths (float, optional): Width of the boxes. Defaults to 0.5.</span>
<span class="sd">        subplots_adjust_wspace (float, optional): Width space between subplots.</span>
<span class="sd">            Defaults to 0.2.</span>
<span class="sd">        show_median (bool, optional): If True, displays median values. Defaults to True.</span>
<span class="sd">        median_line_color (str, optional): Color of median lines. Defaults to &quot;black&quot;.</span>
<span class="sd">        median_font_size (str, optional): Font size for median values. Defaults to &quot;small&quot;.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Union[matplotlib.figure.Figure, Tuple[matplotlib.axes.Axes, dict]]:</span>
<span class="sd">            If axin is None, returns the Figure object.</span>
<span class="sd">            If axin is provided, returns a tuple of (Axes, boxplot_dict).</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; data = [np.random.normal(0, 1, 100) for _ in range(3)]</span>
<span class="sd">        &gt;&gt;&gt; fig = plot_boxes_matplotlib(</span>
<span class="sd">        ...     data,</span>
<span class="sd">        ...     label1=[&#39;Group A&#39;, &#39;Group B&#39;, &#39;Group C&#39;],</span>
<span class="sd">        ...     show_median=True,</span>
<span class="sd">        ...     notch=True</span>
<span class="sd">        ... )</span>

<span class="sd">    Notes:</span>
<span class="sd">        - The function automatically handles NaN values in the data.</span>
<span class="sd">        - Median values can be displayed with customizable formatting.</span>
<span class="sd">        - Supports both single and multiple subplot layouts.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">nc</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">axin</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span>
            <span class="n">ncols</span><span class="o">=</span><span class="n">nc</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="n">sharey</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">,</span> <span class="n">constrained_layout</span><span class="o">=</span><span class="kc">False</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">axes</span> <span class="o">=</span> <span class="n">axin</span>

    <span class="c1"># the next few lines are for showing median values</span>
    <span class="n">decimal_places</span> <span class="o">=</span> <span class="s2">&quot;2&quot;</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nc</span><span class="p">):</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="k">if</span> <span class="n">nc</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">axes</span>
        <span class="n">temp</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">kk</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">temp</span><span class="p">)):</span>
                <span class="n">tt</span> <span class="o">=</span> <span class="n">temp</span><span class="p">[</span><span class="n">kk</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">tt</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">tt</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">tt</span> <span class="o">=</span> <span class="n">tt</span><span class="p">[</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">tt</span><span class="p">)]</span>
                    <span class="n">temp</span><span class="p">[</span><span class="n">kk</span><span class="p">]</span> <span class="o">=</span> <span class="n">tt</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">temp</span><span class="p">[</span><span class="n">kk</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">temp</span> <span class="o">=</span> <span class="n">temp</span><span class="p">[</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">temp</span><span class="p">)]</span>
        <span class="n">bp</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span>
            <span class="n">temp</span><span class="p">,</span> <span class="n">patch_artist</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">notch</span><span class="o">=</span><span class="n">notch</span><span class="p">,</span> <span class="n">showfliers</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">widths</span><span class="o">=</span><span class="n">widths</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">median</span> <span class="ow">in</span> <span class="n">bp</span><span class="p">[</span><span class="s2">&quot;medians&quot;</span><span class="p">]:</span>
            <span class="n">median</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="n">median_line_color</span><span class="p">)</span>
        <span class="n">medians_value</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span> <span class="k">for</span> <span class="n">tmp</span> <span class="ow">in</span> <span class="n">temp</span><span class="p">]</span>
        <span class="n">percent25value</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">tmp</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span> <span class="k">for</span> <span class="n">tmp</span> <span class="ow">in</span> <span class="n">temp</span><span class="p">]</span>
        <span class="n">percent75value</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">tmp</span><span class="p">,</span> <span class="mi">75</span><span class="p">)</span> <span class="k">for</span> <span class="n">tmp</span> <span class="ow">in</span> <span class="n">temp</span><span class="p">]</span>
        <span class="n">per25min</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">percent25value</span><span class="p">)</span>
        <span class="n">per75max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">percent75value</span><span class="p">)</span>
        <span class="n">median_labels</span> <span class="o">=</span> <span class="p">[</span><span class="nb">format</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;.</span><span class="si">{</span><span class="n">decimal_places</span><span class="si">}</span><span class="s2">f&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">medians_value</span><span class="p">]</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">medians_value</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">show_median</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">tick</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">()):</span>
                <span class="c1"># params of ax.text could be seen here: https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.text.html</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
                    <span class="n">pos</span><span class="p">[</span><span class="n">tick</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
                    <span class="n">medians_value</span><span class="p">[</span><span class="n">tick</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">per75max</span> <span class="o">-</span> <span class="n">per25min</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.01</span><span class="p">,</span>
                    <span class="n">median_labels</span><span class="p">[</span><span class="n">tick</span><span class="p">],</span>
                    <span class="n">horizontalalignment</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
                    <span class="c1"># https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.text.html</span>
                    <span class="n">size</span><span class="o">=</span><span class="n">median_font_size</span><span class="p">,</span>
                    <span class="n">weight</span><span class="o">=</span><span class="s2">&quot;semibold&quot;</span><span class="p">,</span>
                    <span class="n">color</span><span class="o">=</span><span class="n">median_line_color</span><span class="p">,</span>
                <span class="p">)</span>
        <span class="k">for</span> <span class="n">kk</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">bp</span><span class="p">[</span><span class="s2">&quot;boxes&quot;</span><span class="p">])):</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">bp</span><span class="p">[</span><span class="s2">&quot;boxes&quot;</span><span class="p">][</span><span class="n">kk</span><span class="p">],</span> <span class="n">facecolor</span><span class="o">=</span><span class="n">colorlst</span><span class="p">[</span><span class="n">kk</span><span class="p">])</span>

        <span class="k">if</span> <span class="n">label1</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">label1</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">xticklabel</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([</span><span class="n">y</span> <span class="o">+</span> <span class="mi">1</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">k</span><span class="p">]),</span> <span class="mi">2</span><span class="p">)])</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">xticklabel</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ylabel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">ylim</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ylim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">label2</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span>
            <span class="n">bp</span><span class="p">[</span><span class="s2">&quot;boxes&quot;</span><span class="p">],</span>
            <span class="n">label2</span><span class="p">,</span>
            <span class="c1"># explanation for bbox_to_anchor: https://zhuanlan.zhihu.com/p/101059179</span>
            <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.02</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">),</span>
            <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper right&quot;</span><span class="p">,</span>
            <span class="n">borderaxespad</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
            <span class="n">ncol</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">label2</span><span class="p">)</span> <span class="k">if</span> <span class="n">leg_col</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">leg_col</span><span class="p">,</span>
            <span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">if</span> <span class="n">title</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># fig.suptitle(title)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">wspace</span><span class="o">=</span><span class="n">subplots_adjust_wspace</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">fig</span> <span class="k">if</span> <span class="n">axin</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">bp</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="hydroutils.hydro_plot.plot_boxs" class="doc doc-heading">
<code class="highlight language-python"><span class="n">plot_boxs</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">x_name</span><span class="p">,</span> <span class="n">y_name</span><span class="p">,</span> <span class="n">uniform_color</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">swarm_plot</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">colormap</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ylim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="s1">&#39;serif&#39;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span> <span class="n">show_median</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


<a href="#hydroutils.hydro_plot.plot_boxs" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>plot multiple boxes in one ax with seaborn
Parameters</p>
<hr />
<p>data : pd.DataFrame
    a tidy pandas dataframe;
    if you don't know what is "tidy data", please read: https://github.com/jizhang/pandas-tidy-data
x_name : str
    the names of each box
y_name : str
    what is shown
uniform_color : str, optional
    unified color for all boxes, by default None
swarm_plot : bool, optional
    <em>description</em>, by default False
hue : <em>type</em>, optional
    <em>description</em>, by default None
colormap : bool, optional
    <em>description</em>, by default False
xlim : <em>type</em>, optional
    <em>description</em>, by default None
ylim : <em>type</em>, optional
    <em>description</em>, by default None
order : <em>type</em>, optional
    <em>description</em>, by default None
font : str, optional
    <em>description</em>, by default "serif"
rotation : int, optional
    rotation for labels in x-axis, by default 45
!!! show_median "bool, optional"
    if True, show median value for each box, by default False
Returns</p>
<hr />
<p><em>type</em>
    <em>description</em></p>

        <details class="quote">
          <summary>Source code in <code>hydroutils/hydro_plot.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_boxs</span><span class="p">(</span>
    <span class="n">data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">x_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">y_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">uniform_color</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">swarm_plot</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">hue</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">colormap</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">xlim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">ylim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">order</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">font</span><span class="o">=</span><span class="s2">&quot;serif&quot;</span><span class="p">,</span>
    <span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span>
    <span class="n">show_median</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;plot multiple boxes in one ax with seaborn</span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : pd.DataFrame</span>
<span class="sd">        a tidy pandas dataframe;</span>
<span class="sd">        if you don&#39;t know what is &quot;tidy data&quot;, please read: https://github.com/jizhang/pandas-tidy-data</span>
<span class="sd">    x_name : str</span>
<span class="sd">        the names of each box</span>
<span class="sd">    y_name : str</span>
<span class="sd">        what is shown</span>
<span class="sd">    uniform_color : str, optional</span>
<span class="sd">        unified color for all boxes, by default None</span>
<span class="sd">    swarm_plot : bool, optional</span>
<span class="sd">        _description_, by default False</span>
<span class="sd">    hue : _type_, optional</span>
<span class="sd">        _description_, by default None</span>
<span class="sd">    colormap : bool, optional</span>
<span class="sd">        _description_, by default False</span>
<span class="sd">    xlim : _type_, optional</span>
<span class="sd">        _description_, by default None</span>
<span class="sd">    ylim : _type_, optional</span>
<span class="sd">        _description_, by default None</span>
<span class="sd">    order : _type_, optional</span>
<span class="sd">        _description_, by default None</span>
<span class="sd">    font : str, optional</span>
<span class="sd">        _description_, by default &quot;serif&quot;</span>
<span class="sd">    rotation : int, optional</span>
<span class="sd">        rotation for labels in x-axis, by default 45</span>
<span class="sd">    show_median: bool, optional</span>
<span class="sd">        if True, show median value for each box, by default False</span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    _type_</span>
<span class="sd">        _description_</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s2">&quot;ticks&quot;</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s2">&quot;pastel&quot;</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="n">font</span><span class="p">,</span> <span class="n">font_scale</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
    <span class="c1"># Draw a nested boxplot to show bills by day and time</span>
    <span class="k">if</span> <span class="n">uniform_color</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">sns_box</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span>
            <span class="n">x</span><span class="o">=</span><span class="n">x_name</span><span class="p">,</span>
            <span class="n">y</span><span class="o">=</span><span class="n">y_name</span><span class="p">,</span>
            <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="n">uniform_color</span><span class="p">,</span>
            <span class="n">showfliers</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">order</span><span class="o">=</span><span class="n">order</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">sns_box</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span>
            <span class="n">x</span><span class="o">=</span><span class="n">x_name</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y_name</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">showfliers</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="n">order</span>
        <span class="p">)</span>
    <span class="k">if</span> <span class="n">swarm_plot</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">hue</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">sns_box</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">swarmplot</span><span class="p">(</span>
                <span class="n">x</span><span class="o">=</span><span class="n">x_name</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y_name</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;.2&quot;</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="n">order</span>
            <span class="p">)</span>
        <span class="k">elif</span> <span class="n">colormap</span><span class="p">:</span>
            <span class="c1"># Create a matplotlib colormap from the sns seagreen color palette</span>
            <span class="n">cmap</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">light_palette</span><span class="p">(</span><span class="s2">&quot;seagreen&quot;</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">as_cmap</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="c1"># Normalize to the range of possible values from df[&quot;c&quot;]</span>
            <span class="n">norm</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span>
                <span class="n">vmin</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="n">hue</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">vmax</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="n">hue</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
            <span class="p">)</span>
            <span class="n">colors</span> <span class="o">=</span> <span class="p">{</span><span class="n">cval</span><span class="p">:</span> <span class="n">cmap</span><span class="p">(</span><span class="n">norm</span><span class="p">(</span><span class="n">cval</span><span class="p">))</span> <span class="k">for</span> <span class="n">cval</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="n">hue</span><span class="p">]}</span>
            <span class="c1"># plot the swarmplot with the colors dictionary as palette, s=2 means size is 2</span>
            <span class="n">sns_box</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">swarmplot</span><span class="p">(</span>
                <span class="n">x</span><span class="o">=</span><span class="n">x_name</span><span class="p">,</span>
                <span class="n">y</span><span class="o">=</span><span class="n">y_name</span><span class="p">,</span>
                <span class="n">hue</span><span class="o">=</span><span class="n">hue</span><span class="p">,</span>
                <span class="n">s</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
                <span class="n">palette</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span>
                <span class="n">order</span><span class="o">=</span><span class="n">order</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="c1"># remove the legend, because we want to set a colorbar instead</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">legend_</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
            <span class="c1"># create colorbar</span>
            <span class="n">divider</span> <span class="o">=</span> <span class="n">make_axes_locatable</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">())</span>
            <span class="n">ax_cb</span> <span class="o">=</span> <span class="n">divider</span><span class="o">.</span><span class="n">new_horizontal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="s2">&quot;5%&quot;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
            <span class="n">fig</span> <span class="o">=</span> <span class="n">sns_box</span><span class="o">.</span><span class="n">get_figure</span><span class="p">()</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">(</span><span class="n">ax_cb</span><span class="p">)</span>
            <span class="n">cb1</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">colorbar</span><span class="o">.</span><span class="n">ColorbarBase</span><span class="p">(</span>
                <span class="n">ax_cb</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s2">&quot;vertical&quot;</span>
            <span class="p">)</span>
            <span class="n">cb1</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s2">&quot;Some Units&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">palette</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">light_palette</span><span class="p">(</span><span class="s2">&quot;seagreen&quot;</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">n_colors</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
            <span class="n">sns_box</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">swarmplot</span><span class="p">(</span>
                <span class="n">x</span><span class="o">=</span><span class="n">x_name</span><span class="p">,</span>
                <span class="n">y</span><span class="o">=</span><span class="n">y_name</span><span class="p">,</span>
                <span class="n">hue</span><span class="o">=</span><span class="n">hue</span><span class="p">,</span>
                <span class="n">s</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
                <span class="n">palette</span><span class="o">=</span><span class="n">palette</span><span class="p">,</span>
                <span class="n">order</span><span class="o">=</span><span class="n">order</span><span class="p">,</span>
            <span class="p">)</span>
    <span class="k">if</span> <span class="n">xlim</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">xlim</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">ylim</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="n">ylim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ylim</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">show_median</span><span class="p">:</span>
        <span class="n">medians</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="n">x_name</span><span class="p">],</span> <span class="n">sort</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="n">y_name</span><span class="p">]</span><span class="o">.</span><span class="n">median</span><span class="p">()</span><span class="o">.</span><span class="n">values</span>
        <span class="n">create_median_labels</span><span class="p">(</span><span class="n">sns_box</span><span class="p">,</span> <span class="n">medians_value</span><span class="o">=</span><span class="n">medians</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="s2">&quot;x-small&quot;</span><span class="p">)</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>
    <span class="n">locs</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="n">rotation</span><span class="p">)</span>
    <span class="c1"># plt.show()</span>
    <span class="k">return</span> <span class="n">sns_box</span><span class="o">.</span><span class="n">get_figure</span><span class="p">()</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="hydroutils.hydro_plot.plot_diff_boxes" class="doc doc-heading">
<code class="highlight language-python"><span class="n">plot_diff_boxes</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">row_and_col</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">y_col</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">x_col</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">title_str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">title_font_size</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span></code>


<a href="#hydroutils.hydro_plot.plot_diff_boxes" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>plot boxplots in rows and cols</p>

        <details class="quote">
          <summary>Source code in <code>hydroutils/hydro_plot.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_diff_boxes</span><span class="p">(</span>
    <span class="n">data</span><span class="p">,</span>
    <span class="n">row_and_col</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">y_col</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">x_col</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">hspace</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>
    <span class="n">wspace</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">title_str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">title_font_size</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;plot boxplots in rows and cols&quot;&quot;&quot;</span>
    <span class="c1"># matplotlib.use(&#39;TkAgg&#39;)</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="n">subplot_num</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="n">y_col</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_col</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">row_and_col</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">row_num</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">col_num</span> <span class="o">=</span> <span class="n">subplot_num</span>
        <span class="n">f</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">row_num</span><span class="p">,</span> <span class="n">col_num</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">hspace</span><span class="o">=</span><span class="n">hspace</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="n">wspace</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">assert</span> <span class="n">subplot_num</span> <span class="o">&lt;=</span> <span class="n">row_and_col</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">row_and_col</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">row_num</span> <span class="o">=</span> <span class="n">row_and_col</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">col_num</span> <span class="o">=</span> <span class="n">row_and_col</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">f</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">row_num</span><span class="p">,</span> <span class="n">col_num</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">subplot_num</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">y_col</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">row_num</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">col_num</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span>
                    <span class="n">y</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                    <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
                    <span class="n">width</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
                    <span class="n">orient</span><span class="o">=</span><span class="s2">&quot;v&quot;</span><span class="p">,</span>
                    <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                    <span class="n">showfliers</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="p">)</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">row_idx</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">i</span> <span class="o">/</span> <span class="n">col_num</span><span class="p">)</span>
                <span class="n">col_idx</span> <span class="o">=</span> <span class="n">i</span> <span class="o">%</span> <span class="n">col_num</span>
                <span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span>
                    <span class="n">y</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                    <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
                    <span class="n">orient</span><span class="o">=</span><span class="s2">&quot;v&quot;</span><span class="p">,</span>
                    <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="n">row_idx</span><span class="p">,</span> <span class="n">col_idx</span><span class="p">],</span>
                    <span class="n">showfliers</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">assert</span> <span class="n">x_col</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
            <span class="k">if</span> <span class="n">row_num</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">col_num</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span>
                    <span class="n">x</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">x_col</span><span class="p">],</span>
                    <span class="n">y</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">y_col</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span>
                    <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
                    <span class="n">orient</span><span class="o">=</span><span class="s2">&quot;v&quot;</span><span class="p">,</span>
                    <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                    <span class="n">showfliers</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">row_idx</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">i</span> <span class="o">/</span> <span class="n">col_num</span><span class="p">)</span>
                <span class="n">col_idx</span> <span class="o">=</span> <span class="n">i</span> <span class="o">%</span> <span class="n">col_num</span>
                <span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span>
                    <span class="n">x</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">x_col</span><span class="p">],</span>
                    <span class="n">y</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">y_col</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span>
                    <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
                    <span class="n">orient</span><span class="o">=</span><span class="s2">&quot;v&quot;</span><span class="p">,</span>
                    <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="n">row_idx</span><span class="p">,</span> <span class="n">col_idx</span><span class="p">],</span>
                    <span class="n">showfliers</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="p">)</span>
    <span class="k">if</span> <span class="n">title_str</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">f</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">title_str</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">title_font_size</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">f</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="hydroutils.hydro_plot.plot_ecdf" class="doc doc-heading">
<code class="highlight language-python"><span class="n">plot_ecdf</span><span class="p">(</span><span class="n">mydataframe</span><span class="p">,</span> <span class="n">mycolumn</span><span class="p">,</span> <span class="n">save_file</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#hydroutils.hydro_plot.plot_ecdf" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Creates an empirical cumulative distribution function (ECDF) plot for a single column.</p>
<p>This function generates an ECDF plot for a single column of data from a pandas
DataFrame. It provides a simple interface for quick visualization of data
distributions.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>mydataframe</code></td>
        <td><code>pd.DataFrame</code></td>
        <td><p>DataFrame containing the data to plot.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>mycolumn</code></td>
        <td><code>str</code></td>
        <td><p>Name of the column to create ECDF for.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>save_file</code></td>
        <td><code>str</code></td>
        <td><p>Path to save the plot. If None, plot is only
displayed. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;values&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)})</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">plot_ecdf</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s1">&#39;values&#39;</span><span class="p">,</span> <span class="s1">&#39;normal_dist_ecdf.png&#39;</span><span class="p">)</span>
</code></pre></div>
      <p>!!! notes
    - Uses seaborn's styling for better visualization
    - Automatically handles NaN values
    - Plot range is set to [0, 1] for both axes
    - Uses 0.05 intervals for axis ticks</p>

        <details class="quote">
          <summary>Source code in <code>hydroutils/hydro_plot.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_ecdf</span><span class="p">(</span><span class="n">mydataframe</span><span class="p">,</span> <span class="n">mycolumn</span><span class="p">,</span> <span class="n">save_file</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates an empirical cumulative distribution function (ECDF) plot for a single column.</span>

<span class="sd">    This function generates an ECDF plot for a single column of data from a pandas</span>
<span class="sd">    DataFrame. It provides a simple interface for quick visualization of data</span>
<span class="sd">    distributions.</span>

<span class="sd">    Args:</span>
<span class="sd">        mydataframe (pd.DataFrame): DataFrame containing the data to plot.</span>
<span class="sd">        mycolumn (str): Name of the column to create ECDF for.</span>
<span class="sd">        save_file (str, optional): Path to save the plot. If None, plot is only</span>
<span class="sd">            displayed. Defaults to None.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; df = pd.DataFrame({&#39;values&#39;: np.random.normal(0, 1, 1000)})</span>
<span class="sd">        &gt;&gt;&gt; plot_ecdf(df, &#39;values&#39;, &#39;normal_dist_ecdf.png&#39;)</span>

<span class="sd">    Notes:</span>
<span class="sd">        - Uses seaborn&#39;s styling for better visualization</span>
<span class="sd">        - Automatically handles NaN values</span>
<span class="sd">        - Plot range is set to [0, 1] for both axes</span>
<span class="sd">        - Uses 0.05 intervals for axis ticks</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">ecdf</span><span class="p">(</span><span class="n">mydataframe</span><span class="p">[</span><span class="n">mycolumn</span><span class="p">])</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="n">x</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="n">y</span><span class="p">})</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s2">&quot;ticks&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;axes.grid&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">estimator</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span><span class="o">.</span><span class="n">set</span><span class="p">(</span>
        <span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">xticks</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">),</span> <span class="n">yticks</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">save_file</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">save_file</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="hydroutils.hydro_plot.plot_ecdfs" class="doc doc-heading">
<code class="highlight language-python"><span class="n">plot_ecdfs</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">ys</span><span class="p">,</span> <span class="n">legends</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">case_str</span><span class="o">=</span><span class="s1">&#39;case&#39;</span><span class="p">,</span> <span class="n">event_str</span><span class="o">=</span><span class="s1">&#39;event&#39;</span><span class="p">,</span> <span class="n">x_str</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">y_str</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">ax_as_subplot</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span></code>


<a href="#hydroutils.hydro_plot.plot_ecdfs" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Creates empirical cumulative distribution function (ECDF) plots for multiple datasets.</p>
<p>This function generates ECDF plots for multiple datasets with customizable styling
and labeling options. It's particularly useful for comparing distributions of
different datasets or experimental conditions.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>xs</code></td>
        <td><code>list[np.array]</code></td>
        <td><p>List of x-values arrays for each ECDF.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>ys</code></td>
        <td><code>list[np.array]</code></td>
        <td><p>List of y-values arrays for each ECDF.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>legends</code></td>
        <td><code>list[str]</code></td>
        <td><p>Legend labels for each ECDF. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>style</code></td>
        <td><code>list[str]</code></td>
        <td><p>Line styles for each ECDF. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>case_str</code></td>
        <td><code>str</code></td>
        <td><p>Label for different cases in the plot.
Defaults to "case".</p></td>
        <td><code>&#39;case&#39;</code></td>
      </tr>
      <tr>
        <td><code>event_str</code></td>
        <td><code>str</code></td>
        <td><p>Label for different events in the plot.
Defaults to "event".</p></td>
        <td><code>&#39;event&#39;</code></td>
      </tr>
      <tr>
        <td><code>x_str</code></td>
        <td><code>str</code></td>
        <td><p>X-axis label. Defaults to "x".</p></td>
        <td><code>&#39;x&#39;</code></td>
      </tr>
      <tr>
        <td><code>y_str</code></td>
        <td><code>str</code></td>
        <td><p>Y-axis label. Defaults to "y".</p></td>
        <td><code>&#39;y&#39;</code></td>
      </tr>
      <tr>
        <td><code>ax_as_subplot</code></td>
        <td><code>matplotlib.axes.Axes</code></td>
        <td><p>Existing axes to plot on.
Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>interval</code></td>
        <td><code>float</code></td>
        <td><p>Interval for axis ticks. Defaults to 0.1.</p></td>
        <td><code>0.1</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>matplotlib.axes.Axes</code></td>
      <td><p>The axes object containing the ECDF plots.</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="c1"># Compare two distributions</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">x1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">x2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">,</span> <span class="mi">1000</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">x1</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">x2</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plot_ecdfs</span><span class="p">(</span>
<span class="o">...</span>     <span class="p">[</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">],</span> <span class="p">[</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">],</span>
<span class="o">...</span>     <span class="n">legends</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Distribution 1&#39;</span><span class="p">,</span> <span class="s1">&#39;Distribution 2&#39;</span><span class="p">],</span>
<span class="o">...</span>     <span class="n">x_str</span><span class="o">=</span><span class="s1">&#39;Value&#39;</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">y_str</span><span class="o">=</span><span class="s1">&#39;Cumulative Probability&#39;</span>
<span class="o">...</span> <span class="p">)</span>
</code></pre></div>
    <div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="c1"># Multiple distributions with different styles</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plot_ecdfs</span><span class="p">(</span>
<span class="o">...</span>     <span class="p">[</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">],</span> <span class="p">[</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">],</span>
<span class="o">...</span>     <span class="n">legends</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Group A&#39;</span><span class="p">,</span> <span class="s1">&#39;Group B&#39;</span><span class="p">],</span>
<span class="o">...</span>     <span class="n">style</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">],</span>
<span class="o">...</span>     <span class="n">interval</span><span class="o">=</span><span class="mf">0.2</span>
<span class="o">...</span> <span class="p">)</span>
</code></pre></div>
      <p>!!! notes
    - Input arrays must be sorted in ascending order
    - Function automatically validates data ordering
    - Supports both single and multiple subplot layouts
    - Uses seaborn for enhanced visual styling</p>

        <details class="quote">
          <summary>Source code in <code>hydroutils/hydro_plot.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_ecdfs</span><span class="p">(</span>
    <span class="n">xs</span><span class="p">,</span>
    <span class="n">ys</span><span class="p">,</span>
    <span class="n">legends</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">style</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">case_str</span><span class="o">=</span><span class="s2">&quot;case&quot;</span><span class="p">,</span>
    <span class="n">event_str</span><span class="o">=</span><span class="s2">&quot;event&quot;</span><span class="p">,</span>
    <span class="n">x_str</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span>
    <span class="n">y_str</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span>
    <span class="n">ax_as_subplot</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">interval</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates empirical cumulative distribution function (ECDF) plots for multiple datasets.</span>

<span class="sd">    This function generates ECDF plots for multiple datasets with customizable styling</span>
<span class="sd">    and labeling options. It&#39;s particularly useful for comparing distributions of</span>
<span class="sd">    different datasets or experimental conditions.</span>

<span class="sd">    Args:</span>
<span class="sd">        xs (list[np.array]): List of x-values arrays for each ECDF.</span>
<span class="sd">        ys (list[np.array]): List of y-values arrays for each ECDF.</span>
<span class="sd">        legends (list[str], optional): Legend labels for each ECDF. Defaults to None.</span>
<span class="sd">        style (list[str], optional): Line styles for each ECDF. Defaults to None.</span>
<span class="sd">        case_str (str, optional): Label for different cases in the plot.</span>
<span class="sd">            Defaults to &quot;case&quot;.</span>
<span class="sd">        event_str (str, optional): Label for different events in the plot.</span>
<span class="sd">            Defaults to &quot;event&quot;.</span>
<span class="sd">        x_str (str, optional): X-axis label. Defaults to &quot;x&quot;.</span>
<span class="sd">        y_str (str, optional): Y-axis label. Defaults to &quot;y&quot;.</span>
<span class="sd">        ax_as_subplot (matplotlib.axes.Axes, optional): Existing axes to plot on.</span>
<span class="sd">            Defaults to None.</span>
<span class="sd">        interval (float, optional): Interval for axis ticks. Defaults to 0.1.</span>

<span class="sd">    Returns:</span>
<span class="sd">        matplotlib.axes.Axes: The axes object containing the ECDF plots.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; # Compare two distributions</span>
<span class="sd">        &gt;&gt;&gt; x1 = np.sort(np.random.normal(0, 1, 1000))</span>
<span class="sd">        &gt;&gt;&gt; x2 = np.sort(np.random.normal(0.5, 1.2, 1000))</span>
<span class="sd">        &gt;&gt;&gt; y1 = np.linspace(0, 1, len(x1))</span>
<span class="sd">        &gt;&gt;&gt; y2 = np.linspace(0, 1, len(x2))</span>
<span class="sd">        &gt;&gt;&gt; ax = plot_ecdfs(</span>
<span class="sd">        ...     [x1, x2], [y1, y2],</span>
<span class="sd">        ...     legends=[&#39;Distribution 1&#39;, &#39;Distribution 2&#39;],</span>
<span class="sd">        ...     x_str=&#39;Value&#39;,</span>
<span class="sd">        ...     y_str=&#39;Cumulative Probability&#39;</span>
<span class="sd">        ... )</span>

<span class="sd">        &gt;&gt;&gt; # Multiple distributions with different styles</span>
<span class="sd">        &gt;&gt;&gt; ax = plot_ecdfs(</span>
<span class="sd">        ...     [x1, x2], [y1, y2],</span>
<span class="sd">        ...     legends=[&#39;Group A&#39;, &#39;Group B&#39;],</span>
<span class="sd">        ...     style=[&#39;-&#39;, &#39;--&#39;],</span>
<span class="sd">        ...     interval=0.2</span>
<span class="sd">        ... )</span>

<span class="sd">    Notes:</span>
<span class="sd">        - Input arrays must be sorted in ascending order</span>
<span class="sd">        - Function automatically validates data ordering</span>
<span class="sd">        - Supports both single and multiple subplot layouts</span>
<span class="sd">        - Uses seaborn for enhanced visual styling</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ys</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">xs</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">ys</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">legends</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">legends</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">ys</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">legends</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">style</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">style</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">ys</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">style</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">ys</span><span class="p">:</span>
        <span class="k">assert</span> <span class="nb">all</span><span class="p">(</span><span class="n">xi</span> <span class="o">&lt;</span> <span class="n">yi</span> <span class="k">for</span> <span class="n">xi</span><span class="p">,</span> <span class="n">yi</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">:]))</span>
    <span class="n">frames</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">xs</span><span class="p">)):</span>
        <span class="n">str_i</span> <span class="o">=</span> <span class="n">x_str</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">if</span> <span class="n">legends</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">legends</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">assert</span> <span class="nb">all</span><span class="p">(</span><span class="n">xi</span> <span class="o">&lt;</span> <span class="n">yi</span> <span class="k">for</span> <span class="n">xi</span><span class="p">,</span> <span class="n">yi</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">xs</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">xs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">:]))</span>
        <span class="n">df_dict_i</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">x_str</span><span class="p">:</span> <span class="n">xs</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
            <span class="n">y_str</span><span class="p">:</span> <span class="n">ys</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
            <span class="n">case_str</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">([</span><span class="n">xs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">size</span><span class="p">],</span> <span class="n">str_i</span><span class="p">),</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="n">style</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">df_dict_i</span><span class="p">[</span><span class="n">event_str</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">([</span><span class="n">xs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">size</span><span class="p">],</span> <span class="n">style</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="n">df_i</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">df_dict_i</span><span class="p">)</span>
        <span class="n">frames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df_i</span><span class="p">)</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">frames</span><span class="p">)</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s2">&quot;ticks&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;axes.grid&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
    <span class="k">if</span> <span class="n">style</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x_str</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y_str</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="n">case_str</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">estimator</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span><span class="o">.</span><span class="n">set</span><span class="p">(</span>
                <span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                <span class="n">xticks</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">interval</span><span class="p">),</span>
                <span class="n">yticks</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">interval</span><span class="p">),</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">ax_as_subplot</span> <span class="ow">is</span> <span class="kc">None</span>
            <span class="k">else</span> <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span>
                <span class="n">ax</span><span class="o">=</span><span class="n">ax_as_subplot</span><span class="p">,</span>
                <span class="n">x</span><span class="o">=</span><span class="n">x_str</span><span class="p">,</span>
                <span class="n">y</span><span class="o">=</span><span class="n">y_str</span><span class="p">,</span>
                <span class="n">hue</span><span class="o">=</span><span class="n">case_str</span><span class="p">,</span>
                <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span>
                <span class="n">estimator</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="p">)</span><span class="o">.</span><span class="n">set</span><span class="p">(</span>
                <span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                <span class="n">xticks</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">interval</span><span class="p">),</span>
                <span class="n">yticks</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">interval</span><span class="p">),</span>
            <span class="p">)</span>
        <span class="p">)</span>
    <span class="k">elif</span> <span class="n">ax_as_subplot</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span>
            <span class="n">x</span><span class="o">=</span><span class="n">x_str</span><span class="p">,</span>
            <span class="n">y</span><span class="o">=</span><span class="n">y_str</span><span class="p">,</span>
            <span class="n">hue</span><span class="o">=</span><span class="n">case_str</span><span class="p">,</span>
            <span class="n">style</span><span class="o">=</span><span class="n">event_str</span><span class="p">,</span>
            <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span>
            <span class="n">estimator</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="p">)</span><span class="o">.</span><span class="n">set</span><span class="p">(</span>
            <span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="n">xticks</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">interval</span><span class="p">),</span>
            <span class="n">yticks</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">interval</span><span class="p">),</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span>
            <span class="n">ax</span><span class="o">=</span><span class="n">ax_as_subplot</span><span class="p">,</span>
            <span class="n">x</span><span class="o">=</span><span class="n">x_str</span><span class="p">,</span>
            <span class="n">y</span><span class="o">=</span><span class="n">y_str</span><span class="p">,</span>
            <span class="n">hue</span><span class="o">=</span><span class="n">case_str</span><span class="p">,</span>
            <span class="n">style</span><span class="o">=</span><span class="n">event_str</span><span class="p">,</span>
            <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span>
            <span class="n">estimator</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="p">)</span><span class="o">.</span><span class="n">set</span><span class="p">(</span>
            <span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="n">xticks</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">interval</span><span class="p">),</span>
            <span class="n">yticks</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">interval</span><span class="p">),</span>
        <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="hydroutils.hydro_plot.plot_ecdfs_matplot" class="doc doc-heading">
<code class="highlight language-python"><span class="n">plot_ecdfs_matplot</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">ys</span><span class="p">,</span> <span class="n">legends</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;rbkgcmy&#39;</span><span class="p">,</span> <span class="n">dash_lines</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">x_str</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">y_str</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">x_interval</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">y_interval</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">x_lim</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">y_lim</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">show_legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">legend_font_size</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">fig_size</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span></code>


<a href="#hydroutils.hydro_plot.plot_ecdfs_matplot" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Creates ECDF plots using matplotlib with extensive customization options.</p>
<p>This function provides a more customizable alternative to the seaborn-based ECDF
plotting functions, offering direct control over matplotlib parameters and styling.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>xs</code></td>
        <td><code>list[np.array]</code></td>
        <td><p>List of x-values arrays for each ECDF.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>ys</code></td>
        <td><code>list[np.array]</code></td>
        <td><p>List of y-values arrays for each ECDF.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>legends</code></td>
        <td><code>list[str]</code></td>
        <td><p>Legend labels for each ECDF. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>colors</code></td>
        <td><code>str</code></td>
        <td><p>String of color characters for different lines.
Defaults to "rbkgcmy".</p></td>
        <td><code>&#39;rbkgcmy&#39;</code></td>
      </tr>
      <tr>
        <td><code>dash_lines</code></td>
        <td><code>list[bool]</code></td>
        <td><p>Specifies which lines should be dashed.
Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>x_str</code></td>
        <td><code>str</code></td>
        <td><p>X-axis label. Defaults to "x".</p></td>
        <td><code>&#39;x&#39;</code></td>
      </tr>
      <tr>
        <td><code>y_str</code></td>
        <td><code>str</code></td>
        <td><p>Y-axis label. Defaults to "y".</p></td>
        <td><code>&#39;y&#39;</code></td>
      </tr>
      <tr>
        <td><code>x_interval</code></td>
        <td><code>float</code></td>
        <td><p>Interval for x-axis ticks. Defaults to 0.1.</p></td>
        <td><code>0.1</code></td>
      </tr>
      <tr>
        <td><code>y_interval</code></td>
        <td><code>float</code></td>
        <td><p>Interval for y-axis ticks. Defaults to 0.1.</p></td>
        <td><code>0.1</code></td>
      </tr>
      <tr>
        <td><code>x_lim</code></td>
        <td><code>tuple</code></td>
        <td><p>X-axis limits as (min, max). Defaults to (0, 1).</p></td>
        <td><code>(0, 1)</code></td>
      </tr>
      <tr>
        <td><code>y_lim</code></td>
        <td><code>tuple</code></td>
        <td><p>Y-axis limits as (min, max). Defaults to (0, 1).</p></td>
        <td><code>(0, 1)</code></td>
      </tr>
      <tr>
        <td><code>show_legend</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to show legend. Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>legend_font_size</code></td>
        <td><code>int</code></td>
        <td><p>Font size for legend. Defaults to 16.</p></td>
        <td><code>16</code></td>
      </tr>
      <tr>
        <td><code>fig_size</code></td>
        <td><code>tuple</code></td>
        <td><p>Figure size as (width, height). Defaults to (8, 6).</p></td>
        <td><code>(8, 6)</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Tuple[matplotlib.figure.Figure, matplotlib.axes.Axes]</code></td>
      <td><p>The figure and axes
    objects containing the ECDF plots.</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="c1"># Compare multiple distributions</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">x1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">x2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">,</span> <span class="mi">1000</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plot_ecdfs_matplot</span><span class="p">(</span>
<span class="o">...</span>     <span class="p">[</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">],</span> <span class="p">[</span><span class="n">y</span><span class="p">,</span> <span class="n">y</span><span class="p">],</span>
<span class="o">...</span>     <span class="n">legends</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Normal(0,1)&#39;</span><span class="p">,</span> <span class="s1">&#39;Normal(0.5,1.2)&#39;</span><span class="p">],</span>
<span class="o">...</span>     <span class="n">x_str</span><span class="o">=</span><span class="s1">&#39;Value&#39;</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">y_str</span><span class="o">=</span><span class="s1">&#39;Probability&#39;</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">x_lim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="o">...</span> <span class="p">)</span>
</code></pre></div>
    <div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="c1"># Custom styling</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plot_ecdfs_matplot</span><span class="p">(</span>
<span class="o">...</span>     <span class="p">[</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">],</span> <span class="p">[</span><span class="n">y</span><span class="p">,</span> <span class="n">y</span><span class="p">],</span>
<span class="o">...</span>     <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;rb&#39;</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">dash_lines</span><span class="o">=</span><span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">],</span>
<span class="o">...</span>     <span class="n">legend_font_size</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">fig_size</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="o">...</span> <span class="p">)</span>
</code></pre></div>
      <p>!!! notes
    - Uses clean plotting style with minimal spines
    - Supports both continuous and dashed lines
    - Provides fine-grained control over axis properties
    - Input arrays must be sorted in ascending order
    - Automatically validates data ordering</p>

        <details class="quote">
          <summary>Source code in <code>hydroutils/hydro_plot.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_ecdfs_matplot</span><span class="p">(</span>
    <span class="n">xs</span><span class="p">,</span>
    <span class="n">ys</span><span class="p">,</span>
    <span class="n">legends</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">colors</span><span class="o">=</span><span class="s2">&quot;rbkgcmy&quot;</span><span class="p">,</span>
    <span class="n">dash_lines</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">x_str</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span>
    <span class="n">y_str</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span>
    <span class="n">x_interval</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
    <span class="n">y_interval</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
    <span class="n">x_lim</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
    <span class="n">y_lim</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
    <span class="n">show_legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">legend_font_size</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span>
    <span class="n">fig_size</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates ECDF plots using matplotlib with extensive customization options.</span>

<span class="sd">    This function provides a more customizable alternative to the seaborn-based ECDF</span>
<span class="sd">    plotting functions, offering direct control over matplotlib parameters and styling.</span>

<span class="sd">    Args:</span>
<span class="sd">        xs (list[np.array]): List of x-values arrays for each ECDF.</span>
<span class="sd">        ys (list[np.array]): List of y-values arrays for each ECDF.</span>
<span class="sd">        legends (list[str], optional): Legend labels for each ECDF. Defaults to None.</span>
<span class="sd">        colors (str, optional): String of color characters for different lines.</span>
<span class="sd">            Defaults to &quot;rbkgcmy&quot;.</span>
<span class="sd">        dash_lines (list[bool], optional): Specifies which lines should be dashed.</span>
<span class="sd">            Defaults to None.</span>
<span class="sd">        x_str (str, optional): X-axis label. Defaults to &quot;x&quot;.</span>
<span class="sd">        y_str (str, optional): Y-axis label. Defaults to &quot;y&quot;.</span>
<span class="sd">        x_interval (float, optional): Interval for x-axis ticks. Defaults to 0.1.</span>
<span class="sd">        y_interval (float, optional): Interval for y-axis ticks. Defaults to 0.1.</span>
<span class="sd">        x_lim (tuple, optional): X-axis limits as (min, max). Defaults to (0, 1).</span>
<span class="sd">        y_lim (tuple, optional): Y-axis limits as (min, max). Defaults to (0, 1).</span>
<span class="sd">        show_legend (bool, optional): Whether to show legend. Defaults to True.</span>
<span class="sd">        legend_font_size (int, optional): Font size for legend. Defaults to 16.</span>
<span class="sd">        fig_size (tuple, optional): Figure size as (width, height). Defaults to (8, 6).</span>

<span class="sd">    Returns:</span>
<span class="sd">        Tuple[matplotlib.figure.Figure, matplotlib.axes.Axes]: The figure and axes</span>
<span class="sd">            objects containing the ECDF plots.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; # Compare multiple distributions</span>
<span class="sd">        &gt;&gt;&gt; x1 = np.sort(np.random.normal(0, 1, 1000))</span>
<span class="sd">        &gt;&gt;&gt; x2 = np.sort(np.random.normal(0.5, 1.2, 1000))</span>
<span class="sd">        &gt;&gt;&gt; y = np.linspace(0, 1, 1000)</span>
<span class="sd">        &gt;&gt;&gt; fig, ax = plot_ecdfs_matplot(</span>
<span class="sd">        ...     [x1, x2], [y, y],</span>
<span class="sd">        ...     legends=[&#39;Normal(0,1)&#39;, &#39;Normal(0.5,1.2)&#39;],</span>
<span class="sd">        ...     x_str=&#39;Value&#39;,</span>
<span class="sd">        ...     y_str=&#39;Probability&#39;,</span>
<span class="sd">        ...     x_lim=(-3, 3)</span>
<span class="sd">        ... )</span>

<span class="sd">        &gt;&gt;&gt; # Custom styling</span>
<span class="sd">        &gt;&gt;&gt; fig, ax = plot_ecdfs_matplot(</span>
<span class="sd">        ...     [x1, x2], [y, y],</span>
<span class="sd">        ...     colors=&#39;rb&#39;,</span>
<span class="sd">        ...     dash_lines=[False, True],</span>
<span class="sd">        ...     legend_font_size=12,</span>
<span class="sd">        ...     fig_size=(10, 8)</span>
<span class="sd">        ... )</span>

<span class="sd">    Notes:</span>
<span class="sd">        - Uses clean plotting style with minimal spines</span>
<span class="sd">        - Supports both continuous and dashed lines</span>
<span class="sd">        - Provides fine-grained control over axis properties</span>
<span class="sd">        - Input arrays must be sorted in ascending order</span>
<span class="sd">        - Automatically validates data ordering</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ys</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">xs</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">ys</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">legends</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">legends</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">ys</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">legends</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">dash_lines</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dash_lines</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">dash_lines</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">xs</span><span class="p">),</span> <span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">ys</span><span class="p">:</span>
        <span class="k">assert</span> <span class="nb">all</span><span class="p">(</span><span class="n">xi</span> <span class="o">&lt;</span> <span class="n">yi</span> <span class="k">for</span> <span class="n">xi</span><span class="p">,</span> <span class="n">yi</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">:]))</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">fig_size</span><span class="p">)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">xs</span><span class="p">)):</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">xs</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span>
            <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">xs</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span> <span class="o">==</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span>
        <span class="p">):</span>
            <span class="k">assert</span> <span class="nb">all</span><span class="p">(</span><span class="n">xi</span> <span class="o">&lt;=</span> <span class="n">yi</span> <span class="k">for</span> <span class="n">xi</span><span class="p">,</span> <span class="n">yi</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">xs</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">xs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">:]))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">all</span><span class="p">(</span><span class="n">xi</span> <span class="o">&lt;=</span> <span class="n">yi</span> <span class="k">for</span> <span class="n">xi</span><span class="p">,</span> <span class="n">yi</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">xs</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">xs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">:]))</span>
        <span class="p">(</span><span class="n">line_i</span><span class="p">,)</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xs</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">ys</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="n">legends</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">dash_lines</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
            <span class="n">line_i</span><span class="o">.</span><span class="n">set_dashes</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">x_str</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="n">y_str</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">x_lim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x_lim</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">y_lim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">y_lim</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="c1"># set x y number font size</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">x_lim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x_lim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">x_lim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="mi">100</span><span class="p">,</span> <span class="n">x_interval</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">y_lim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">y_lim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">y_lim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="mi">100</span><span class="p">,</span> <span class="n">y_interval</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">show_legend</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;size&quot;</span><span class="p">:</span> <span class="n">legend_font_size</span><span class="p">})</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="c1"># Hide the right and top spines</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="hydroutils.hydro_plot.plot_heat_map" class="doc doc-heading">
<code class="highlight language-python"><span class="n">plot_heat_map</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fig_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="n">square</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">xticklabels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">yticklabels</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>


<a href="#hydroutils.hydro_plot.plot_heat_map" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Creates a heatmap visualization of 2D data using seaborn.</p>
<p>This function creates a heatmap visualization with customizable formatting,
annotations, and masking options. It uses seaborn's heatmap function with
additional customization options.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>data</code></td>
        <td><code>pd.DataFrame</code></td>
        <td><p>2D array or DataFrame to be visualized.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>mask</code></td>
        <td><code>np.array</code></td>
        <td><p>Boolean array of same shape as data. True values will
be masked (not shown). Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>fig_size</code></td>
        <td><code>tuple</code></td>
        <td><p>Figure size as (width, height). Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>fmt</code></td>
        <td><code>str</code></td>
        <td><p>String formatting code for cell annotations. Defaults to "d"
for integer formatting.</p></td>
        <td><code>&#39;d&#39;</code></td>
      </tr>
      <tr>
        <td><code>square</code></td>
        <td><code>bool</code></td>
        <td><p>If True, set the Axes aspect to "equal". Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>annot</code></td>
        <td><code>bool</code></td>
        <td><p>If True, write the data value in each cell. Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>xticklabels</code></td>
        <td><code>bool</code></td>
        <td><p>If True, show x-axis labels. Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>yticklabels</code></td>
        <td><code>bool</code></td>
        <td><p>If True, show y-axis labels. Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>matplotlib.axes.Axes</code></td>
      <td><p>The matplotlib Axes object containing the heatmap.</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">plot_heat_map</span><span class="p">(</span>
<span class="o">...</span>     <span class="n">data</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;.2f&#39;</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">fig_size</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span>
<span class="o">...</span>     <span class="n">annot</span><span class="o">=</span><span class="kc">True</span>
<span class="o">...</span> <span class="p">)</span>
</code></pre></div>
      <p>!!! notes
    The function uses a red-blue diverging colormap ('RdBu_r') by default.
    For more details on the underlying implementation, see:
    https://zhuanlan.zhihu.com/p/96040773</p>

        <details class="quote">
          <summary>Source code in <code>hydroutils/hydro_plot.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_heat_map</span><span class="p">(</span>
    <span class="n">data</span><span class="p">,</span>
    <span class="n">mask</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">fig_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">fmt</span><span class="o">=</span><span class="s2">&quot;d&quot;</span><span class="p">,</span>
    <span class="n">square</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">xticklabels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">yticklabels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates a heatmap visualization of 2D data using seaborn.</span>

<span class="sd">    This function creates a heatmap visualization with customizable formatting,</span>
<span class="sd">    annotations, and masking options. It uses seaborn&#39;s heatmap function with</span>
<span class="sd">    additional customization options.</span>

<span class="sd">    Args:</span>
<span class="sd">        data (pd.DataFrame): 2D array or DataFrame to be visualized.</span>
<span class="sd">        mask (np.array, optional): Boolean array of same shape as data. True values will</span>
<span class="sd">            be masked (not shown). Defaults to None.</span>
<span class="sd">        fig_size (tuple, optional): Figure size as (width, height). Defaults to None.</span>
<span class="sd">        fmt (str, optional): String formatting code for cell annotations. Defaults to &quot;d&quot;</span>
<span class="sd">            for integer formatting.</span>
<span class="sd">        square (bool, optional): If True, set the Axes aspect to &quot;equal&quot;. Defaults to True.</span>
<span class="sd">        annot (bool, optional): If True, write the data value in each cell. Defaults to True.</span>
<span class="sd">        xticklabels (bool, optional): If True, show x-axis labels. Defaults to True.</span>
<span class="sd">        yticklabels (bool, optional): If True, show y-axis labels. Defaults to True.</span>

<span class="sd">    Returns:</span>
<span class="sd">        matplotlib.axes.Axes: The matplotlib Axes object containing the heatmap.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; data = pd.DataFrame(np.random.rand(5, 5))</span>
<span class="sd">        &gt;&gt;&gt; plot_heat_map(</span>
<span class="sd">        ...     data,</span>
<span class="sd">        ...     fmt=&#39;.2f&#39;,</span>
<span class="sd">        ...     fig_size=(8, 6),</span>
<span class="sd">        ...     annot=True</span>
<span class="sd">        ... )</span>

<span class="sd">    Notes:</span>
<span class="sd">        The function uses a red-blue diverging colormap (&#39;RdBu_r&#39;) by default.</span>
<span class="sd">        For more details on the underlying implementation, see:</span>
<span class="sd">        https://zhuanlan.zhihu.com/p/96040773</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">fig_size</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">fig_size</span><span class="p">)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span>
        <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
        <span class="n">square</span><span class="o">=</span><span class="n">square</span><span class="p">,</span>
        <span class="n">annot</span><span class="o">=</span><span class="n">annot</span><span class="p">,</span>
        <span class="n">fmt</span><span class="o">=</span><span class="n">fmt</span><span class="p">,</span>
        <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;RdBu_r&quot;</span><span class="p">,</span>
        <span class="n">mask</span><span class="o">=</span><span class="n">mask</span><span class="p">,</span>
        <span class="n">xticklabels</span><span class="o">=</span><span class="n">xticklabels</span><span class="p">,</span>
        <span class="n">yticklabels</span><span class="o">=</span><span class="n">yticklabels</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="hydroutils.hydro_plot.plot_map_carto" class="doc doc-heading">
<code class="highlight language-python"><span class="n">plot_map_carto</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span> <span class="n">fig</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">pertile_range</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">value_range</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fig_size</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="n">need_colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">colorbar_size</span><span class="o">=</span><span class="p">[</span><span class="mf">0.91</span><span class="p">,</span> <span class="mf">0.318</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">,</span> <span class="mf">0.354</span><span class="p">],</span> <span class="n">cmap_str</span><span class="o">=</span><span class="s1">&#39;jet&#39;</span><span class="p">,</span> <span class="n">idx_lst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">markers</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">marker_size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">is_discrete</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;rbkgcmywrbkgcmyw&#39;</span><span class="p">,</span> <span class="n">category_names</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">legend_font_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">colorbar_font_size</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#hydroutils.hydro_plot.plot_map_carto" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Creates a cartographic map visualization using Cartopy with extensive customization options.</p>
<p>This function generates a map visualization for spatial data with support for continuous
and discrete color scales, multiple marker types, and various styling options. It's
particularly useful for visualizing hydrological data in a geographic context.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>data</code></td>
        <td><code>np.array</code></td>
        <td><p>1-D array of values to be plotted on the map.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>lat</code></td>
        <td><code>np.array</code></td>
        <td><p>1-D array of latitude values for each data point.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>lon</code></td>
        <td><code>np.array</code></td>
        <td><p>1-D array of longitude values for each data point.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>fig</code></td>
        <td><code>matplotlib.figure.Figure</code></td>
        <td><p>Existing figure to plot on.
Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>ax</code></td>
        <td><code>matplotlib.axes.Axes</code></td>
        <td><p>Existing axes to plot on. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>pertile_range</code></td>
        <td><code>list</code></td>
        <td><p>Percentile range for color scaling, e.g.,
[25, 75] for interquartile range. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>value_range</code></td>
        <td><code>list</code></td>
        <td><p>Explicit value range for color scaling. Takes
precedence over pertile_range. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>fig_size</code></td>
        <td><code>tuple</code></td>
        <td><p>Figure size as (width, height). Defaults to (8, 8).</p></td>
        <td><code>(8, 8)</code></td>
      </tr>
      <tr>
        <td><code>need_colorbar</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to add a colorbar. Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>colorbar_size</code></td>
        <td><code>list</code></td>
        <td><p>Colorbar dimensions [left, bottom, width, height].
Defaults to [0.91, 0.318, 0.02, 0.354].</p></td>
        <td><code>[0.91, 0.318, 0.02, 0.354]</code></td>
      </tr>
      <tr>
        <td><code>cmap_str</code></td>
        <td><code>str</code></td>
        <td><p>Colormap name. Defaults to "jet".</p></td>
        <td><code>&#39;jet&#39;</code></td>
      </tr>
      <tr>
        <td><code>idx_lst</code></td>
        <td><code>list</code></td>
        <td><p>List of index arrays for plotting multiple point
categories. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>markers</code></td>
        <td><code>list</code></td>
        <td><p>Marker styles for each category. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>marker_size</code></td>
        <td><code>Union[int, list]</code></td>
        <td><p>Size(s) of markers. Defaults to 20.</p></td>
        <td><code>20</code></td>
      </tr>
      <tr>
        <td><code>is_discrete</code></td>
        <td><code>bool</code></td>
        <td><p>If True, uses discrete colors with legend instead
of continuous colorbar. Defaults to False.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>colors</code></td>
        <td><code>str</code></td>
        <td><p>Color characters for discrete categories.
Defaults to "rbkgcmywrbkgcmyw".</p></td>
        <td><code>&#39;rbkgcmywrbkgcmyw&#39;</code></td>
      </tr>
      <tr>
        <td><code>category_names</code></td>
        <td><code>list</code></td>
        <td><p>Names for discrete categories in legend.
Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>legend_font_size</code></td>
        <td><code>float</code></td>
        <td><p>Font size for legend. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>colorbar_font_size</code></td>
        <td><code>float</code></td>
        <td><p>Font size for colorbar. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>matplotlib.axes.Axes</code></td>
      <td><p>The axes object containing the map.</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="c1"># Simple continuous color map</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">lat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">lon</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mi">120</span><span class="p">,</span> <span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plot_map_carto</span><span class="p">(</span>
<span class="o">...</span>     <span class="n">data</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">value_range</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="o">...</span>     <span class="n">cmap_str</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span>
<span class="o">...</span> <span class="p">)</span>
</code></pre></div>
    <div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="c1"># Discrete categories with custom markers</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">categories</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">idx_lst</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">categories</span> <span class="o">==</span> <span class="n">i</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plot_map_carto</span><span class="p">(</span>
<span class="o">...</span>     <span class="n">data</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">idx_lst</span><span class="o">=</span><span class="n">idx_lst</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">markers</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="s1">&#39;^&#39;</span><span class="p">],</span>
<span class="o">...</span>     <span class="n">is_discrete</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">category_names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Low&#39;</span><span class="p">,</span> <span class="s1">&#39;Medium&#39;</span><span class="p">,</span> <span class="s1">&#39;High&#39;</span><span class="p">]</span>
<span class="o">...</span> <span class="p">)</span>
</code></pre></div>
      <p>!!! notes
    - Uses Cartopy for map projections and features
    - Automatically adds state boundaries and coastlines
    - Supports both continuous and categorical data visualization
    - Handles NaN values appropriately
    - Provides flexible control over color scaling</p>

        <details class="quote">
          <summary>Source code in <code>hydroutils/hydro_plot.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_map_carto</span><span class="p">(</span>
    <span class="n">data</span><span class="p">,</span>
    <span class="n">lat</span><span class="p">,</span>
    <span class="n">lon</span><span class="p">,</span>
    <span class="n">fig</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">pertile_range</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">value_range</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">fig_size</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span>
    <span class="n">need_colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">colorbar_size</span><span class="o">=</span><span class="p">[</span><span class="mf">0.91</span><span class="p">,</span> <span class="mf">0.318</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">,</span> <span class="mf">0.354</span><span class="p">],</span>
    <span class="n">cmap_str</span><span class="o">=</span><span class="s2">&quot;jet&quot;</span><span class="p">,</span>
    <span class="n">idx_lst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">markers</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">marker_size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
    <span class="n">is_discrete</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">colors</span><span class="o">=</span><span class="s2">&quot;rbkgcmywrbkgcmyw&quot;</span><span class="p">,</span>
    <span class="n">category_names</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">legend_font_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">colorbar_font_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates a cartographic map visualization using Cartopy with extensive customization options.</span>

<span class="sd">    This function generates a map visualization for spatial data with support for continuous</span>
<span class="sd">    and discrete color scales, multiple marker types, and various styling options. It&#39;s</span>
<span class="sd">    particularly useful for visualizing hydrological data in a geographic context.</span>

<span class="sd">    Args:</span>
<span class="sd">        data (np.array): 1-D array of values to be plotted on the map.</span>
<span class="sd">        lat (np.array): 1-D array of latitude values for each data point.</span>
<span class="sd">        lon (np.array): 1-D array of longitude values for each data point.</span>
<span class="sd">        fig (matplotlib.figure.Figure, optional): Existing figure to plot on.</span>
<span class="sd">            Defaults to None.</span>
<span class="sd">        ax (matplotlib.axes.Axes, optional): Existing axes to plot on. Defaults to None.</span>
<span class="sd">        pertile_range (list, optional): Percentile range for color scaling, e.g.,</span>
<span class="sd">            [25, 75] for interquartile range. Defaults to None.</span>
<span class="sd">        value_range (list, optional): Explicit value range for color scaling. Takes</span>
<span class="sd">            precedence over pertile_range. Defaults to None.</span>
<span class="sd">        fig_size (tuple, optional): Figure size as (width, height). Defaults to (8, 8).</span>
<span class="sd">        need_colorbar (bool, optional): Whether to add a colorbar. Defaults to True.</span>
<span class="sd">        colorbar_size (list, optional): Colorbar dimensions [left, bottom, width, height].</span>
<span class="sd">            Defaults to [0.91, 0.318, 0.02, 0.354].</span>
<span class="sd">        cmap_str (str, optional): Colormap name. Defaults to &quot;jet&quot;.</span>
<span class="sd">        idx_lst (list, optional): List of index arrays for plotting multiple point</span>
<span class="sd">            categories. Defaults to None.</span>
<span class="sd">        markers (list, optional): Marker styles for each category. Defaults to None.</span>
<span class="sd">        marker_size (Union[int, list], optional): Size(s) of markers. Defaults to 20.</span>
<span class="sd">        is_discrete (bool, optional): If True, uses discrete colors with legend instead</span>
<span class="sd">            of continuous colorbar. Defaults to False.</span>
<span class="sd">        colors (str, optional): Color characters for discrete categories.</span>
<span class="sd">            Defaults to &quot;rbkgcmywrbkgcmyw&quot;.</span>
<span class="sd">        category_names (list, optional): Names for discrete categories in legend.</span>
<span class="sd">            Defaults to None.</span>
<span class="sd">        legend_font_size (float, optional): Font size for legend. Defaults to None.</span>
<span class="sd">        colorbar_font_size (float, optional): Font size for colorbar. Defaults to None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        matplotlib.axes.Axes: The axes object containing the map.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; # Simple continuous color map</span>
<span class="sd">        &gt;&gt;&gt; data = np.random.rand(100)</span>
<span class="sd">        &gt;&gt;&gt; lat = np.random.uniform(30, 45, 100)</span>
<span class="sd">        &gt;&gt;&gt; lon = np.random.uniform(-120, -100, 100)</span>
<span class="sd">        &gt;&gt;&gt; ax = plot_map_carto(</span>
<span class="sd">        ...     data, lat, lon,</span>
<span class="sd">        ...     value_range=[0, 1],</span>
<span class="sd">        ...     cmap_str=&#39;viridis&#39;</span>
<span class="sd">        ... )</span>

<span class="sd">        &gt;&gt;&gt; # Discrete categories with custom markers</span>
<span class="sd">        &gt;&gt;&gt; categories = np.random.randint(0, 3, 100)</span>
<span class="sd">        &gt;&gt;&gt; idx_lst = [np.where(categories == i)[0] for i in range(3)]</span>
<span class="sd">        &gt;&gt;&gt; ax = plot_map_carto(</span>
<span class="sd">        ...     data, lat, lon,</span>
<span class="sd">        ...     idx_lst=idx_lst,</span>
<span class="sd">        ...     markers=[&#39;o&#39;, &#39;s&#39;, &#39;^&#39;],</span>
<span class="sd">        ...     is_discrete=True,</span>
<span class="sd">        ...     category_names=[&#39;Low&#39;, &#39;Medium&#39;, &#39;High&#39;]</span>
<span class="sd">        ... )</span>

<span class="sd">    Notes:</span>
<span class="sd">        - Uses Cartopy for map projections and features</span>
<span class="sd">        - Automatically adds state boundaries and coastlines</span>
<span class="sd">        - Supports both continuous and categorical data visualization</span>
<span class="sd">        - Handles NaN values appropriately</span>
<span class="sd">        - Provides flexible control over color scaling</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">value_range</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">vmin</span> <span class="o">=</span> <span class="n">value_range</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">vmax</span> <span class="o">=</span> <span class="n">value_range</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">elif</span> <span class="n">pertile_range</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># https://blog.csdn.net/chenirene510/article/details/111318539</span>
        <span class="n">mask_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">masked_invalid</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">vmin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">mask_data</span><span class="p">)</span>
        <span class="n">vmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">mask_data</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">assert</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">pertile_range</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">pertile_range</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">100</span>
        <span class="n">vmin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanpercentile</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">pertile_range</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">vmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanpercentile</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">pertile_range</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">llcrnrlat</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">lat</span><span class="p">),)</span>
    <span class="n">urcrnrlat</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">lat</span><span class="p">),)</span>
    <span class="n">llcrnrlon</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">lon</span><span class="p">),)</span>
    <span class="n">urcrnrlon</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">lon</span><span class="p">),)</span>
    <span class="n">extent</span> <span class="o">=</span> <span class="p">[</span><span class="n">llcrnrlon</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">urcrnrlon</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">llcrnrlat</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">urcrnrlat</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
    <span class="c1"># Figure</span>
    <span class="k">if</span> <span class="n">fig</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span>
            <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="n">fig_size</span><span class="p">,</span> <span class="n">subplot_kw</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;projection&quot;</span><span class="p">:</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">()}</span>
        <span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_extent</span><span class="p">(</span><span class="n">extent</span><span class="p">)</span>
    <span class="n">states</span> <span class="o">=</span> <span class="n">NaturalEarthFeature</span><span class="p">(</span>
        <span class="n">category</span><span class="o">=</span><span class="s2">&quot;cultural&quot;</span><span class="p">,</span>
        <span class="n">scale</span><span class="o">=</span><span class="s2">&quot;50m&quot;</span><span class="p">,</span>
        <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">,</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;admin_1_states_provinces_shp&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">states</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">(</span><span class="s2">&quot;50m&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">idx_lst</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">marker_size</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">marker_size</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">idx_lst</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">marker_size</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">idx_lst</span><span class="p">),</span> <span class="n">marker_size</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">marker_size</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">markers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">idx_lst</span><span class="p">),</span> <span class="n">markers</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">markers</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">idx_lst</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cmap_str</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">cmap_str</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">idx_lst</span><span class="p">),</span> <span class="n">cmap_str</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">cmap_str</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">idx_lst</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">is_discrete</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">idx_lst</span><span class="p">)):</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
                    <span class="n">lon</span><span class="p">[</span><span class="n">idx_lst</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span>
                    <span class="n">lat</span><span class="p">[</span><span class="n">idx_lst</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span>
                    <span class="n">marker</span><span class="o">=</span><span class="n">markers</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                    <span class="n">ms</span><span class="o">=</span><span class="n">marker_size</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                    <span class="n">label</span><span class="o">=</span><span class="n">category_names</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                    <span class="n">c</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                    <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">prop</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">legend_font_size</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">scatter</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">idx_lst</span><span class="p">)):</span>
                <span class="n">scat</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
                    <span class="n">lon</span><span class="p">[</span><span class="n">idx_lst</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span>
                    <span class="n">lat</span><span class="p">[</span><span class="n">idx_lst</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span>
                    <span class="n">c</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="n">idx_lst</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span>
                    <span class="n">marker</span><span class="o">=</span><span class="n">markers</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                    <span class="n">s</span><span class="o">=</span><span class="n">marker_size</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                    <span class="n">cmap</span><span class="o">=</span><span class="n">cmap_str</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                    <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span>
                    <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="n">scatter</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">scat</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">need_colorbar</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">colorbar_size</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">cbar_ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">(</span><span class="n">colorbar_size</span><span class="p">)</span>
                    <span class="n">cbar</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">scat</span><span class="p">,</span> <span class="n">cax</span><span class="o">=</span><span class="n">cbar_ax</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s2">&quot;vertical&quot;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">cbar</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">scat</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">colorbar_font_size</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="n">colorbar_font_size</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">category_names</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span>
                    <span class="n">scatter</span><span class="p">,</span> <span class="n">category_names</span><span class="p">,</span> <span class="n">prop</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">legend_font_size</span><span class="p">),</span> <span class="n">ncol</span><span class="o">=</span><span class="mi">2</span>
                <span class="p">)</span>
    <span class="k">elif</span> <span class="n">is_discrete</span><span class="p">:</span>
        <span class="n">scatter</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="n">marker_size</span><span class="p">)</span>
        <span class="c1"># produce a legend with the unique colors from the scatter</span>
        <span class="n">legend1</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span>
            <span class="o">*</span><span class="n">scatter</span><span class="o">.</span><span class="n">legend_elements</span><span class="p">(),</span> <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;lower left&quot;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Classes&quot;</span>
        <span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">add_artist</span><span class="p">(</span><span class="n">legend1</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">scat</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
            <span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="n">marker_size</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap_str</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">need_colorbar</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">colorbar_size</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">cbar_ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">(</span><span class="n">colorbar_size</span><span class="p">)</span>
                <span class="n">cbar</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">scat</span><span class="p">,</span> <span class="n">cax</span><span class="o">=</span><span class="n">cbar_ax</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s2">&quot;vertical&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">cbar</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">scat</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">colorbar_font_size</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="n">colorbar_font_size</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ax</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="hydroutils.hydro_plot.plot_pdf_cdf" class="doc doc-heading">
<code class="highlight language-python"><span class="n">plot_pdf_cdf</span><span class="p">(</span><span class="n">mydataframe</span><span class="p">,</span> <span class="n">mycolumn</span><span class="p">)</span></code>


<a href="#hydroutils.hydro_plot.plot_pdf_cdf" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Creates side-by-side plots of probability density function (PDF) and cumulative
distribution function (CDF).</p>
<p>This function generates a figure with two subplots: a PDF plot on the left and
a CDF plot on the right. The PDF includes both histogram and kernel density
estimation, while the CDF shows the cumulative histogram.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>mydataframe</code></td>
        <td><code>pd.DataFrame</code></td>
        <td><p>DataFrame containing the data to plot.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>mycolumn</code></td>
        <td><code>str</code></td>
        <td><p>Name of the column to create distributions for.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="c1"># Create sample data</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
<span class="o">...</span>     <span class="s1">&#39;values&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span>
<span class="o">...</span>         <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">),</span>
<span class="o">...</span>         <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="o">...</span>     <span class="p">])</span>
<span class="o">...</span> <span class="p">})</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">plot_pdf_cdf</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s1">&#39;values&#39;</span><span class="p">)</span>
</code></pre></div>
      <p>!!! notes
    - Uses seaborn's distplot for both PDF and CDF
    - PDF includes both histogram and kernel density estimation
    - CDF shows cumulative histogram with step-style line
    - Both plots are set to range [0, 1] on x-axis
    - CDF y-axis is also set to range [0, 1]
    - High DPI (320) for publication-quality figures
    - Large figure size (18x6) for clear visualization</p>

        <details class="quote">
          <summary>Source code in <code>hydroutils/hydro_plot.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_pdf_cdf</span><span class="p">(</span><span class="n">mydataframe</span><span class="p">,</span> <span class="n">mycolumn</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates side-by-side plots of probability density function (PDF) and cumulative</span>
<span class="sd">    distribution function (CDF).</span>

<span class="sd">    This function generates a figure with two subplots: a PDF plot on the left and</span>
<span class="sd">    a CDF plot on the right. The PDF includes both histogram and kernel density</span>
<span class="sd">    estimation, while the CDF shows the cumulative histogram.</span>

<span class="sd">    Args:</span>
<span class="sd">        mydataframe (pd.DataFrame): DataFrame containing the data to plot.</span>
<span class="sd">        mycolumn (str): Name of the column to create distributions for.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; # Create sample data</span>
<span class="sd">        &gt;&gt;&gt; df = pd.DataFrame({</span>
<span class="sd">        ...     &#39;values&#39;: np.concatenate([</span>
<span class="sd">        ...         np.random.normal(0.3, 0.1, 1000),</span>
<span class="sd">        ...         np.random.normal(0.7, 0.1, 1000)</span>
<span class="sd">        ...     ])</span>
<span class="sd">        ... })</span>
<span class="sd">        &gt;&gt;&gt; plot_pdf_cdf(df, &#39;values&#39;)</span>

<span class="sd">    Notes:</span>
<span class="sd">        - Uses seaborn&#39;s distplot for both PDF and CDF</span>
<span class="sd">        - PDF includes both histogram and kernel density estimation</span>
<span class="sd">        - CDF shows cumulative histogram with step-style line</span>
<span class="sd">        - Both plots are set to range [0, 1] on x-axis</span>
<span class="sd">        - CDF y-axis is also set to range [0, 1]</span>
<span class="sd">        - High DPI (320) for publication-quality figures</span>
<span class="sd">        - Large figure size (18x6) for clear visualization</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># settings</span>
    <span class="n">f</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">320</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;fraction (PDF)&quot;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;fraction (CDF)&quot;</span><span class="p">)</span>

    <span class="c1"># left plot (PDF) # REMEMBER TO CHANGE bins, xlim PROPERLY!!</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span>
        <span class="n">mydataframe</span><span class="p">[</span><span class="n">mycolumn</span><span class="p">],</span>
        <span class="n">kde</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">axlabel</span><span class="o">=</span><span class="n">mycolumn</span><span class="p">,</span>
        <span class="n">hist_kws</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;density&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">},</span>
        <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
    <span class="p">)</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

    <span class="c1"># right plot (CDF) # REMEMBER TO CHANGE bins, xlim PROPERLY!!</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span>
        <span class="n">mydataframe</span><span class="p">[</span><span class="n">mycolumn</span><span class="p">],</span>
        <span class="n">kde</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">axlabel</span><span class="o">=</span><span class="n">mycolumn</span><span class="p">,</span>
        <span class="n">hist_kws</span><span class="o">=</span><span class="p">{</span>
            <span class="s2">&quot;density&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
            <span class="s2">&quot;cumulative&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
            <span class="s2">&quot;histtype&quot;</span><span class="p">:</span> <span class="s2">&quot;step&quot;</span><span class="p">,</span>
            <span class="s2">&quot;linewidth&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
    <span class="p">)</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="hydroutils.hydro_plot.plot_quiver" class="doc doc-heading">
<code class="highlight language-python"><span class="n">plot_quiver</span><span class="p">(</span><span class="n">exps_q_ssm_result_show</span><span class="p">,</span> <span class="n">exps_ssm_q_result_show</span><span class="p">,</span> <span class="n">q_diff_show</span><span class="p">,</span> <span class="n">ssm_diff_show</span><span class="p">,</span> <span class="n">x_label</span><span class="p">,</span> <span class="n">y_label</span><span class="p">)</span></code>


<a href="#hydroutils.hydro_plot.plot_quiver" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Creates a quiver plot showing vector field with normalized arrows.</p>
<p>This function generates a quiver plot where arrows represent the direction and
magnitude of differences between two variables. The arrows are normalized to have
uniform length, with color indicating the actual magnitude of the difference.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>exps_q_ssm_result_show</code></td>
        <td><code>np.array</code></td>
        <td><p>X-coordinates for arrow origins.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>exps_ssm_q_result_show</code></td>
        <td><code>np.array</code></td>
        <td><p>Y-coordinates for arrow origins.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>q_diff_show</code></td>
        <td><code>np.array</code></td>
        <td><p>X-components of the difference vectors.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>ssm_diff_show</code></td>
        <td><code>np.array</code></td>
        <td><p>Y-components of the difference vectors.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>x_label</code></td>
        <td><code>str</code></td>
        <td><p>Label for x-axis.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>y_label</code></td>
        <td><code>str</code></td>
        <td><p>Label for y-axis.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Tuple[matplotlib.figure.Figure, matplotlib.axes.Axes]</code></td>
      <td><p>The figure and axes
    objects containing the quiver plot.</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="c1"># Create sample data</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">dx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">dy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plot_quiver</span><span class="p">(</span>
<span class="o">...</span>     <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">,</span>
<span class="o">...</span>     <span class="s1">&#39;X Variable&#39;</span><span class="p">,</span>
<span class="o">...</span>     <span class="s1">&#39;Y Variable&#39;</span>
<span class="o">...</span> <span class="p">)</span>
</code></pre></div>
      <p>!!! notes
    - Arrows are normalized to uniform length for better visualization
    - Color indicates the actual magnitude of the difference vector
    - Plot includes a colorbar showing the magnitude scale
    - Uses clean plotting style with minimal spines
    - Default plot range is [0, 1] for both axes</p>

        <details class="quote">
          <summary>Source code in <code>hydroutils/hydro_plot.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_quiver</span><span class="p">(</span>
    <span class="n">exps_q_ssm_result_show</span><span class="p">,</span>
    <span class="n">exps_ssm_q_result_show</span><span class="p">,</span>
    <span class="n">q_diff_show</span><span class="p">,</span>
    <span class="n">ssm_diff_show</span><span class="p">,</span>
    <span class="n">x_label</span><span class="p">,</span>
    <span class="n">y_label</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates a quiver plot showing vector field with normalized arrows.</span>

<span class="sd">    This function generates a quiver plot where arrows represent the direction and</span>
<span class="sd">    magnitude of differences between two variables. The arrows are normalized to have</span>
<span class="sd">    uniform length, with color indicating the actual magnitude of the difference.</span>

<span class="sd">    Args:</span>
<span class="sd">        exps_q_ssm_result_show (np.array): X-coordinates for arrow origins.</span>
<span class="sd">        exps_ssm_q_result_show (np.array): Y-coordinates for arrow origins.</span>
<span class="sd">        q_diff_show (np.array): X-components of the difference vectors.</span>
<span class="sd">        ssm_diff_show (np.array): Y-components of the difference vectors.</span>
<span class="sd">        x_label (str): Label for x-axis.</span>
<span class="sd">        y_label (str): Label for y-axis.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Tuple[matplotlib.figure.Figure, matplotlib.axes.Axes]: The figure and axes</span>
<span class="sd">            objects containing the quiver plot.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; # Create sample data</span>
<span class="sd">        &gt;&gt;&gt; x = np.random.rand(50)</span>
<span class="sd">        &gt;&gt;&gt; y = np.random.rand(50)</span>
<span class="sd">        &gt;&gt;&gt; dx = np.random.normal(0, 0.1, 50)</span>
<span class="sd">        &gt;&gt;&gt; dy = np.random.normal(0, 0.1, 50)</span>
<span class="sd">        &gt;&gt;&gt; fig, ax = plot_quiver(</span>
<span class="sd">        ...     x, y, dx, dy,</span>
<span class="sd">        ...     &#39;X Variable&#39;,</span>
<span class="sd">        ...     &#39;Y Variable&#39;</span>
<span class="sd">        ... )</span>

<span class="sd">    Notes:</span>
<span class="sd">        - Arrows are normalized to uniform length for better visualization</span>
<span class="sd">        - Color indicates the actual magnitude of the difference vector</span>
<span class="sd">        - Plot includes a colorbar showing the magnitude scale</span>
<span class="sd">        - Uses clean plotting style with minimal spines</span>
<span class="sd">        - Default plot range is [0, 1] for both axes</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
    <span class="n">color</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">q_diff_show</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">ssm_diff_show</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="c1"># normalize to get same length arrows</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">q_diff_show</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">ssm_diff_show</span><span class="p">,</span> <span class="mi">2</span><span class="p">)),</span> <span class="mf">0.5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span>
        <span class="n">exps_q_ssm_result_show</span><span class="p">,</span>
        <span class="n">exps_ssm_q_result_show</span><span class="p">,</span>
        <span class="n">q_diff_show</span> <span class="o">/</span> <span class="n">r</span><span class="p">,</span>
        <span class="n">ssm_diff_show</span> <span class="o">/</span> <span class="n">r</span><span class="p">,</span>
        <span class="n">color</span><span class="p">,</span>
        <span class="n">scale</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span>
        <span class="n">width</span><span class="o">=</span><span class="mf">0.005</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="c1"># Defining color</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.01</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.01</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
    <span class="c1"># Hide the right and top spines</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">x_label</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="n">y_label</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="hydroutils.hydro_plot.plot_rainfall_runoff" class="doc doc-heading">
<code class="highlight language-python"><span class="n">plot_rainfall_runoff</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">qs</span><span class="p">,</span> <span class="n">fig_size</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">c_lst</span><span class="o">=</span><span class="s1">&#39;rbkgcmy&#39;</span><span class="p">,</span> <span class="n">leg_lst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dash_lines</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">prcp_ylabel</span><span class="o">=</span><span class="s1">&#39;prcp(mm/day)&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">prcp_interval</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span></code>


<a href="#hydroutils.hydro_plot.plot_rainfall_runoff" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Creates a combined rainfall-runoff plot with precipitation bars and streamflow lines.</p>
<p>This function generates a dual-axis plot showing precipitation as inverted bars from
the top and streamflow as lines on the bottom. This is a common visualization in
hydrology for analyzing rainfall-runoff relationships.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>t</code></td>
        <td><code>Union[np.array, List[np.array]]</code></td>
        <td><p>Time values. If multiple streamflow series
are provided, t can be a list of time arrays matching qs.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>p</code></td>
        <td><code>np.array</code></td>
        <td><p>Precipitation time series data in mm/day.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>qs</code></td>
        <td><code>Union[np.array, List[np.array]]</code></td>
        <td><p>Streamflow time series data. Can be a
single array or list of arrays for multiple streamflow series.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>fig_size</code></td>
        <td><code>tuple</code></td>
        <td><p>Figure size as (width, height). Defaults to (8, 6).</p></td>
        <td><code>(8, 6)</code></td>
      </tr>
      <tr>
        <td><code>c_lst</code></td>
        <td><code>str</code></td>
        <td><p>String of color characters for streamflow lines.
Defaults to "rbkgcmy".</p></td>
        <td><code>&#39;rbkgcmy&#39;</code></td>
      </tr>
      <tr>
        <td><code>leg_lst</code></td>
        <td><code>list</code></td>
        <td><p>Legend labels for streamflow series. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>dash_lines</code></td>
        <td><code>list[bool]</code></td>
        <td><p>Specifies which streamflow lines should be
dashed. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>title</code></td>
        <td><code>str</code></td>
        <td><p>Plot title. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>xlabel</code></td>
        <td><code>str</code></td>
        <td><p>X-axis label. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>ylabel</code></td>
        <td><code>str</code></td>
        <td><p>Y-axis label for streamflow. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>prcp_ylabel</code></td>
        <td><code>str</code></td>
        <td><p>Y-axis label for precipitation. Defaults to
"prcp(mm/day)".</p></td>
        <td><code>&#39;prcp(mm/day)&#39;</code></td>
      </tr>
      <tr>
        <td><code>linewidth</code></td>
        <td><code>int</code></td>
        <td><p>Width of streamflow lines. Defaults to 1.</p></td>
        <td><code>1</code></td>
      </tr>
      <tr>
        <td><code>prcp_interval</code></td>
        <td><code>int</code></td>
        <td><p>Interval for precipitation y-axis ticks.
Defaults to 20.</p></td>
        <td><code>20</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Tuple[matplotlib.figure.Figure, matplotlib.axes.Axes]</code></td>
      <td><p>The figure and axes
    objects containing the plot.</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="c1"># Simple rainfall-runoff plot</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="s1">&#39;2020-01-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2020-12-31&#39;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;datetime64[D]&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">exponential</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>  <span class="c1"># precipitation</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">q</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">)</span>  <span class="c1"># simulated streamflow</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plot_rainfall_runoff</span><span class="p">(</span>
<span class="o">...</span>     <span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Rainfall-Runoff Analysis&#39;</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Date&#39;</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Streamflow (m/s)&#39;</span>
<span class="o">...</span> <span class="p">)</span>
</code></pre></div>
    <div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="c1"># Multiple streamflow series</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">qs</span> <span class="o">=</span> <span class="p">[</span><span class="n">q</span><span class="p">,</span> <span class="n">q</span><span class="o">*</span><span class="mf">1.2</span><span class="p">]</span>  <span class="c1"># observed and simulated</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plot_rainfall_runoff</span><span class="p">(</span>
<span class="o">...</span>     <span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">qs</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">leg_lst</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Observed&#39;</span><span class="p">,</span> <span class="s1">&#39;Simulated&#39;</span><span class="p">],</span>
<span class="o">...</span>     <span class="n">dash_lines</span><span class="o">=</span><span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">]</span>
<span class="o">...</span> <span class="p">)</span>
</code></pre></div>
      <p>!!! notes
    - Precipitation is plotted as blue bars from the top of the plot
    - Streamflow is plotted as lines on the bottom
    - The precipitation y-axis is inverted for better visualization
    - Grid lines are added automatically</p>

        <details class="quote">
          <summary>Source code in <code>hydroutils/hydro_plot.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_rainfall_runoff</span><span class="p">(</span>
    <span class="n">t</span><span class="p">,</span>
    <span class="n">p</span><span class="p">,</span>
    <span class="n">qs</span><span class="p">,</span>
    <span class="n">fig_size</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span>
    <span class="n">c_lst</span><span class="o">=</span><span class="s2">&quot;rbkgcmy&quot;</span><span class="p">,</span>
    <span class="n">leg_lst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">dash_lines</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">xlabel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">ylabel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">prcp_ylabel</span><span class="o">=</span><span class="s2">&quot;prcp(mm/day)&quot;</span><span class="p">,</span>
    <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">prcp_interval</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates a combined rainfall-runoff plot with precipitation bars and streamflow lines.</span>

<span class="sd">    This function generates a dual-axis plot showing precipitation as inverted bars from</span>
<span class="sd">    the top and streamflow as lines on the bottom. This is a common visualization in</span>
<span class="sd">    hydrology for analyzing rainfall-runoff relationships.</span>

<span class="sd">    Args:</span>
<span class="sd">        t (Union[np.array, List[np.array]]): Time values. If multiple streamflow series</span>
<span class="sd">            are provided, t can be a list of time arrays matching qs.</span>
<span class="sd">        p (np.array): Precipitation time series data in mm/day.</span>
<span class="sd">        qs (Union[np.array, List[np.array]]): Streamflow time series data. Can be a</span>
<span class="sd">            single array or list of arrays for multiple streamflow series.</span>
<span class="sd">        fig_size (tuple, optional): Figure size as (width, height). Defaults to (8, 6).</span>
<span class="sd">        c_lst (str, optional): String of color characters for streamflow lines.</span>
<span class="sd">            Defaults to &quot;rbkgcmy&quot;.</span>
<span class="sd">        leg_lst (list, optional): Legend labels for streamflow series. Defaults to None.</span>
<span class="sd">        dash_lines (list[bool], optional): Specifies which streamflow lines should be</span>
<span class="sd">            dashed. Defaults to None.</span>
<span class="sd">        title (str, optional): Plot title. Defaults to None.</span>
<span class="sd">        xlabel (str, optional): X-axis label. Defaults to None.</span>
<span class="sd">        ylabel (str, optional): Y-axis label for streamflow. Defaults to None.</span>
<span class="sd">        prcp_ylabel (str, optional): Y-axis label for precipitation. Defaults to</span>
<span class="sd">            &quot;prcp(mm/day)&quot;.</span>
<span class="sd">        linewidth (int, optional): Width of streamflow lines. Defaults to 1.</span>
<span class="sd">        prcp_interval (int, optional): Interval for precipitation y-axis ticks.</span>
<span class="sd">            Defaults to 20.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Tuple[matplotlib.figure.Figure, matplotlib.axes.Axes]: The figure and axes</span>
<span class="sd">            objects containing the plot.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; # Simple rainfall-runoff plot</span>
<span class="sd">        &gt;&gt;&gt; t = np.arange(&#39;2020-01-01&#39;, &#39;2020-12-31&#39;, dtype=&#39;datetime64[D]&#39;)</span>
<span class="sd">        &gt;&gt;&gt; p = np.random.exponential(2, size=len(t))  # precipitation</span>
<span class="sd">        &gt;&gt;&gt; q = np.convolve(p, np.ones(5)/5, mode=&#39;same&#39;)  # simulated streamflow</span>
<span class="sd">        &gt;&gt;&gt; fig, ax = plot_rainfall_runoff(</span>
<span class="sd">        ...     t, p, q,</span>
<span class="sd">        ...     title=&#39;Rainfall-Runoff Analysis&#39;,</span>
<span class="sd">        ...     xlabel=&#39;Date&#39;,</span>
<span class="sd">        ...     ylabel=&#39;Streamflow (m/s)&#39;</span>
<span class="sd">        ... )</span>

<span class="sd">        &gt;&gt;&gt; # Multiple streamflow series</span>
<span class="sd">        &gt;&gt;&gt; qs = [q, q*1.2]  # observed and simulated</span>
<span class="sd">        &gt;&gt;&gt; fig, ax = plot_rainfall_runoff(</span>
<span class="sd">        ...     t, p, qs,</span>
<span class="sd">        ...     leg_lst=[&#39;Observed&#39;, &#39;Simulated&#39;],</span>
<span class="sd">        ...     dash_lines=[False, True]</span>
<span class="sd">        ... )</span>

<span class="sd">    Notes:</span>
<span class="sd">        - Precipitation is plotted as blue bars from the top of the plot</span>
<span class="sd">        - Streamflow is plotted as lines on the bottom</span>
<span class="sd">        - The precipitation y-axis is inverted for better visualization</span>
<span class="sd">        - Grid lines are added automatically</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">fig_size</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">dash_lines</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dash_lines</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">dash_lines</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">qs</span><span class="p">),</span> <span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">qs</span><span class="p">)):</span>
        <span class="n">tt</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span> <span class="k">else</span> <span class="n">t</span>
        <span class="n">q</span> <span class="o">=</span> <span class="n">qs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
        <span class="n">leg_str</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">leg_lst</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">leg_str</span> <span class="o">=</span> <span class="n">leg_lst</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
        <span class="p">(</span><span class="n">line_i</span><span class="p">,)</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tt</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">c_lst</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="n">leg_str</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="n">linewidth</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">dash_lines</span><span class="p">[</span><span class="n">k</span><span class="p">]:</span>
            <span class="n">line_i</span><span class="o">.</span><span class="n">set_dashes</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1.2</span><span class="p">)</span>
    <span class="c1"># Create second axes, in order to get the bars from the top you can multiply by -1</span>
    <span class="n">ax2</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
    <span class="c1"># ax2.bar(tt, -p, color=&quot;b&quot;)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">tt</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="n">p</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="s2">&quot;mid&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="c1"># ax2.plot(tt, -p, color=&quot;b&quot;, alpha=0.7, linewidth=1.5)</span>

    <span class="c1"># Now need to fix the axis labels</span>
    <span class="c1"># max_pre = max(p)</span>
    <span class="n">max_pre</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="n">max_pre</span> <span class="o">*</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">y2_ticks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">max_pre</span><span class="p">,</span> <span class="n">prcp_interval</span><span class="p">)</span>
    <span class="n">y2_ticklabels</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">y2_ticks</span><span class="p">]</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">y2_ticks</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="n">y2_ticklabels</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="c1"># ax2.set_yticklabels([lab.get_text()[1:] for lab in ax2.get_yticklabels()])</span>
    <span class="k">if</span> <span class="n">title</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">fontdict</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;fontsize&quot;</span><span class="p">:</span> <span class="mi">17</span><span class="p">})</span>
    <span class="k">if</span> <span class="n">ylabel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">xlabel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">xlabel</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">prcp_ylabel</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;top&quot;</span><span class="p">)</span>
    <span class="c1"># ax2.set_ylabel(&quot;precipitation (mm/day)&quot;, fontsize=12, loc=&#39;top&#39;)</span>
    <span class="c1"># https://github.com/matplotlib/matplotlib/issues/12318</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.85</span><span class="p">),</span> <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper left&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="hydroutils.hydro_plot.plot_rainfall_runoff_chai" class="doc doc-heading">
<code class="highlight language-python"><span class="n">plot_rainfall_runoff_chai</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">ps</span><span class="p">,</span> <span class="n">qs</span><span class="p">,</span> <span class="n">c_lst</span><span class="o">=</span><span class="s1">&#39;rbkgcmy&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Observation of Precipitation and Streamflow&#39;</span><span class="p">,</span> <span class="n">alpha_lst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">p_labels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">q_labels</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#hydroutils.hydro_plot.plot_rainfall_runoff_chai" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Creates a two-panel rainfall-runoff plot following Chai's style.</p>
<p>This function generates a figure with two vertically stacked panels: precipitation
on top and streamflow below. It supports multiple precipitation sources and
streamflow series with customizable styling.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>t</code></td>
        <td><code>array-like</code></td>
        <td><p>Time points for x-axis.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>ps</code></td>
        <td><code>list[np.array]</code></td>
        <td><p>List of precipitation arrays from different sources.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>qs</code></td>
        <td><code>list[np.array]</code></td>
        <td><p>List of streamflow arrays (e.g., observed and simulated).</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>c_lst</code></td>
        <td><code>str</code></td>
        <td><p>String of color characters. Defaults to "rbkgcmy".</p></td>
        <td><code>&#39;rbkgcmy&#39;</code></td>
      </tr>
      <tr>
        <td><code>title</code></td>
        <td><code>str</code></td>
        <td><p>Figure title. Defaults to "Observation of Precipitation
and Streamflow".</p></td>
        <td><code>&#39;Observation of Precipitation and Streamflow&#39;</code></td>
      </tr>
      <tr>
        <td><code>alpha_lst</code></td>
        <td><code>list[float]</code></td>
        <td><p>Transparency values for each series.
Defaults to [0.5, 0.5].</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>p_labels</code></td>
        <td><code>list[str]</code></td>
        <td><p>Labels for precipitation sources.
Defaults to ["era5land", "gauge"].</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>q_labels</code></td>
        <td><code>list[str]</code></td>
        <td><p>Labels for streamflow series.
Defaults to ["observation", "simulation"].</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Tuple[matplotlib.figure.Figure, matplotlib.axes.Axes]</code></td>
      <td><p>The figure and bottom
    axes (streamflow plot).</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="c1"># Create sample data</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">t</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s1">&#39;2020-01-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2020-12-31&#39;</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;D&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="c1"># Two precipitation sources</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">p1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">exponential</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>  <span class="c1"># ERA5</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">p2</span> <span class="o">=</span> <span class="n">p1</span> <span class="o">*</span> <span class="mf">1.2</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>  <span class="c1"># Gauge</span>
<span class="o">&gt;&gt;&gt;</span> <span class="c1"># Observed and simulated streamflow</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">q_obs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">q_sim</span> <span class="o">=</span> <span class="n">q_obs</span> <span class="o">*</span> <span class="mf">1.1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">q_obs</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> 
<span class="o">&gt;&gt;&gt;</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plot_rainfall_runoff_chai</span><span class="p">(</span>
<span class="o">...</span>     <span class="n">t</span><span class="p">,</span> <span class="p">[</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">],</span> <span class="p">[</span><span class="n">q_obs</span><span class="p">,</span> <span class="n">q_sim</span><span class="p">],</span>
<span class="o">...</span>     <span class="n">title</span><span class="o">=</span><span class="s1">&#39;2020 Rainfall-Runoff Comparison&#39;</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">p_labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;ERA5&#39;</span><span class="p">,</span> <span class="s1">&#39;Rain Gauge&#39;</span><span class="p">],</span>
<span class="o">...</span>     <span class="n">q_labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Observed&#39;</span><span class="p">,</span> <span class="s1">&#39;Simulated&#39;</span><span class="p">]</span>
<span class="o">...</span> <span class="p">)</span>
</code></pre></div>
      <p>!!! notes
    - Top panel shows precipitation with bars
    - Bottom panel shows streamflow with lines
    - Precipitation y-axis is inverted and blue
    - Streamflow y-axis is red
    - Both panels share x-axis limits
    - Legends included for both panels
    - Uses large figure size (20x8) by default
    - Includes "Streamflow" text box in bottom panel</p>

        <details class="quote">
          <summary>Source code in <code>hydroutils/hydro_plot.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_rainfall_runoff_chai</span><span class="p">(</span>
    <span class="n">t</span><span class="p">,</span>
    <span class="n">ps</span><span class="p">,</span>
    <span class="n">qs</span><span class="p">,</span>
    <span class="n">c_lst</span><span class="o">=</span><span class="s2">&quot;rbkgcmy&quot;</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Observation of Precipitation and Streamflow&quot;</span><span class="p">,</span>
    <span class="n">alpha_lst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">p_labels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">q_labels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates a two-panel rainfall-runoff plot following Chai&#39;s style.</span>

<span class="sd">    This function generates a figure with two vertically stacked panels: precipitation</span>
<span class="sd">    on top and streamflow below. It supports multiple precipitation sources and</span>
<span class="sd">    streamflow series with customizable styling.</span>

<span class="sd">    Args:</span>
<span class="sd">        t (array-like): Time points for x-axis.</span>
<span class="sd">        ps (list[np.array]): List of precipitation arrays from different sources.</span>
<span class="sd">        qs (list[np.array]): List of streamflow arrays (e.g., observed and simulated).</span>
<span class="sd">        c_lst (str, optional): String of color characters. Defaults to &quot;rbkgcmy&quot;.</span>
<span class="sd">        title (str, optional): Figure title. Defaults to &quot;Observation of Precipitation</span>
<span class="sd">            and Streamflow&quot;.</span>
<span class="sd">        alpha_lst (list[float], optional): Transparency values for each series.</span>
<span class="sd">            Defaults to [0.5, 0.5].</span>
<span class="sd">        p_labels (list[str], optional): Labels for precipitation sources.</span>
<span class="sd">            Defaults to [&quot;era5land&quot;, &quot;gauge&quot;].</span>
<span class="sd">        q_labels (list[str], optional): Labels for streamflow series.</span>
<span class="sd">            Defaults to [&quot;observation&quot;, &quot;simulation&quot;].</span>

<span class="sd">    Returns:</span>
<span class="sd">        Tuple[matplotlib.figure.Figure, matplotlib.axes.Axes]: The figure and bottom</span>
<span class="sd">            axes (streamflow plot).</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; # Create sample data</span>
<span class="sd">        &gt;&gt;&gt; t = pd.date_range(&#39;2020-01-01&#39;, &#39;2020-12-31&#39;, freq=&#39;D&#39;)</span>
<span class="sd">        &gt;&gt;&gt; # Two precipitation sources</span>
<span class="sd">        &gt;&gt;&gt; p1 = np.random.exponential(2, size=len(t))  # ERA5</span>
<span class="sd">        &gt;&gt;&gt; p2 = p1 * 1.2 + np.random.normal(0, 0.2, len(t))  # Gauge</span>
<span class="sd">        &gt;&gt;&gt; # Observed and simulated streamflow</span>
<span class="sd">        &gt;&gt;&gt; q_obs = np.convolve(p1, np.ones(5)/5, mode=&#39;same&#39;)</span>
<span class="sd">        &gt;&gt;&gt; q_sim = q_obs * 1.1 + np.random.normal(0, 0.1, len(q_obs))</span>
<span class="sd">        &gt;&gt;&gt; </span>
<span class="sd">        &gt;&gt;&gt; fig, ax = plot_rainfall_runoff_chai(</span>
<span class="sd">        ...     t, [p1, p2], [q_obs, q_sim],</span>
<span class="sd">        ...     title=&#39;2020 Rainfall-Runoff Comparison&#39;,</span>
<span class="sd">        ...     p_labels=[&#39;ERA5&#39;, &#39;Rain Gauge&#39;],</span>
<span class="sd">        ...     q_labels=[&#39;Observed&#39;, &#39;Simulated&#39;]</span>
<span class="sd">        ... )</span>

<span class="sd">    Notes:</span>
<span class="sd">        - Top panel shows precipitation with bars</span>
<span class="sd">        - Bottom panel shows streamflow with lines</span>
<span class="sd">        - Precipitation y-axis is inverted and blue</span>
<span class="sd">        - Streamflow y-axis is red</span>
<span class="sd">        - Both panels share x-axis limits</span>
<span class="sd">        - Legends included for both panels</span>
<span class="sd">        - Uses large figure size (20x8) by default</span>
<span class="sd">        - Includes &quot;Streamflow&quot; text box in bottom panel</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">alpha_lst</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">alpha_lst</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">p_labels</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">p_labels</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;era5land&quot;</span><span class="p">,</span> <span class="s2">&quot;gauge&quot;</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">q_labels</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">q_labels</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;observation&quot;</span><span class="p">,</span> <span class="s2">&quot;simulation&quot;</span><span class="p">]</span>
    <span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">ps</span><span class="p">):</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span>
            <span class="n">t</span><span class="p">,</span>
            <span class="n">p</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="n">c_lst</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
            <span class="n">label</span><span class="o">=</span><span class="n">p_labels</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
            <span class="n">width</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="n">alpha_lst</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
        <span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Precipitation (mm/d)&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;b&quot;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">invert_yaxis</span><span class="p">()</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">labelcolor</span><span class="o">=</span><span class="s2">&quot;b&quot;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">q</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">qs</span><span class="p">):</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">c_lst</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="n">q_labels</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha_lst</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Streamflow (m$^3$/s)&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">labelcolor</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">ax1</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">())</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
        <span class="mf">0.05</span><span class="p">,</span>
        <span class="mf">0.95</span><span class="p">,</span>
        <span class="s2">&quot;Streamflow&quot;</span><span class="p">,</span>
        <span class="n">transform</span><span class="o">=</span><span class="n">ax2</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span>
        <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>
        <span class="n">verticalalignment</span><span class="o">=</span><span class="s2">&quot;top&quot;</span><span class="p">,</span>
        <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">),</span>
    <span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax2</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="hydroutils.hydro_plot.plot_rainfall_runoff_xu" class="doc doc-heading">
<code class="highlight language-python"><span class="n">plot_rainfall_runoff_xu</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">qs</span><span class="p">,</span> <span class="n">fig_size</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;prcp-streamflow&#39;</span><span class="p">,</span> <span class="n">leg_lst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;streamflow(m^3/s)&#39;</span><span class="p">,</span> <span class="n">prcp_ylabel</span><span class="o">=</span><span class="s1">&#39;prcp(mm/day)&#39;</span><span class="p">)</span></code>


<a href="#hydroutils.hydro_plot.plot_rainfall_runoff_xu" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Creates a dual-axis plot for rainfall-runoff analysis with Xu's style.</p>
<p>This function generates a specialized plot with precipitation bars from the top
and streamflow lines on the bottom, following Xu's visualization style. It uses
dual y-axes with color-coded labels and ticks.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>t</code></td>
        <td><code>array-like</code></td>
        <td><p>Time points for x-axis.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>p</code></td>
        <td><code>np.array</code></td>
        <td><p>Precipitation values.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>qs</code></td>
        <td><code>tuple</code></td>
        <td><p>Tuple of (observed, predicted) streamflow values.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>fig_size</code></td>
        <td><code>tuple</code></td>
        <td><p>Figure size as (width, height). Defaults to (10, 6).</p></td>
        <td><code>(10, 6)</code></td>
      </tr>
      <tr>
        <td><code>title</code></td>
        <td><code>str</code></td>
        <td><p>Plot title. Defaults to "prcp-streamflow".</p></td>
        <td><code>&#39;prcp-streamflow&#39;</code></td>
      </tr>
      <tr>
        <td><code>leg_lst</code></td>
        <td><code>list</code></td>
        <td><p>Legend labels. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>ylabel</code></td>
        <td><code>str</code></td>
        <td><p>Y-axis label for streamflow. Defaults to "streamflow(m^3/s)".</p></td>
        <td><code>&#39;streamflow(m^3/s)&#39;</code></td>
      </tr>
      <tr>
        <td><code>prcp_ylabel</code></td>
        <td><code>str</code></td>
        <td><p>Y-axis label for precipitation.
Defaults to "prcp(mm/day)".</p></td>
        <td><code>&#39;prcp(mm/day)&#39;</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="c1"># Create sample data</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="s1">&#39;2020-01-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2020-12-31&#39;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;datetime64[D]&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">exponential</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>  <span class="c1"># precipitation</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">obs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">)</span>  <span class="c1"># observed flow</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">pred</span> <span class="o">=</span> <span class="n">obs</span> <span class="o">*</span> <span class="mf">1.1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">obs</span><span class="p">))</span>  <span class="c1"># predicted flow</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">plot_rainfall_runoff_xu</span><span class="p">(</span>
<span class="o">...</span>     <span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="p">(</span><span class="n">obs</span><span class="p">,</span> <span class="n">pred</span><span class="p">),</span>
<span class="o">...</span>     <span class="n">title</span><span class="o">=</span><span class="s1">&#39;2020 Rainfall-Runoff Analysis&#39;</span>
<span class="o">...</span> <span class="p">)</span>
</code></pre></div>
      <p>!!! notes
    - Precipitation shown as blue bars from top
    - Observed streamflow as solid green line
    - Predicted streamflow as dashed red line
    - Y-axes labels and ticks color-coded
    - Precipitation axis inverted
    - Legend positioned at upper left
    - Precipitation bars semi-transparent (alpha=0.6)</p>

        <details class="quote">
          <summary>Source code in <code>hydroutils/hydro_plot.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_rainfall_runoff_xu</span><span class="p">(</span>
    <span class="n">t</span><span class="p">,</span>
    <span class="n">p</span><span class="p">,</span>
    <span class="n">qs</span><span class="p">,</span>
    <span class="n">fig_size</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;prcp-streamflow&quot;</span><span class="p">,</span>
    <span class="n">leg_lst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;streamflow(m^3/s)&quot;</span><span class="p">,</span>
    <span class="n">prcp_ylabel</span><span class="o">=</span><span class="s2">&quot;prcp(mm/day)&quot;</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates a dual-axis plot for rainfall-runoff analysis with Xu&#39;s style.</span>

<span class="sd">    This function generates a specialized plot with precipitation bars from the top</span>
<span class="sd">    and streamflow lines on the bottom, following Xu&#39;s visualization style. It uses</span>
<span class="sd">    dual y-axes with color-coded labels and ticks.</span>

<span class="sd">    Args:</span>
<span class="sd">        t (array-like): Time points for x-axis.</span>
<span class="sd">        p (np.array): Precipitation values.</span>
<span class="sd">        qs (tuple): Tuple of (observed, predicted) streamflow values.</span>
<span class="sd">        fig_size (tuple, optional): Figure size as (width, height). Defaults to (10, 6).</span>
<span class="sd">        title (str, optional): Plot title. Defaults to &quot;prcp-streamflow&quot;.</span>
<span class="sd">        leg_lst (list, optional): Legend labels. Defaults to None.</span>
<span class="sd">        ylabel (str, optional): Y-axis label for streamflow. Defaults to &quot;streamflow(m^3/s)&quot;.</span>
<span class="sd">        prcp_ylabel (str, optional): Y-axis label for precipitation.</span>
<span class="sd">            Defaults to &quot;prcp(mm/day)&quot;.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; # Create sample data</span>
<span class="sd">        &gt;&gt;&gt; t = np.arange(&#39;2020-01-01&#39;, &#39;2020-12-31&#39;, dtype=&#39;datetime64[D]&#39;)</span>
<span class="sd">        &gt;&gt;&gt; p = np.random.exponential(2, size=len(t))  # precipitation</span>
<span class="sd">        &gt;&gt;&gt; obs = np.convolve(p, np.ones(5)/5, mode=&#39;same&#39;)  # observed flow</span>
<span class="sd">        &gt;&gt;&gt; pred = obs * 1.1 + np.random.normal(0, 0.1, len(obs))  # predicted flow</span>
<span class="sd">        &gt;&gt;&gt; plot_rainfall_runoff_xu(</span>
<span class="sd">        ...     t, p, (obs, pred),</span>
<span class="sd">        ...     title=&#39;2020 Rainfall-Runoff Analysis&#39;</span>
<span class="sd">        ... )</span>

<span class="sd">    Notes:</span>
<span class="sd">        - Precipitation shown as blue bars from top</span>
<span class="sd">        - Observed streamflow as solid green line</span>
<span class="sd">        - Predicted streamflow as dashed red line</span>
<span class="sd">        - Y-axes labels and ticks color-coded</span>
<span class="sd">        - Precipitation axis inverted</span>
<span class="sd">        - Legend positioned at upper left</span>
<span class="sd">        - Precipitation bars semi-transparent (alpha=0.6)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">obs</span><span class="p">,</span> <span class="n">pred</span> <span class="o">=</span> <span class="n">qs</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">fig_size</span><span class="p">)</span>

    <span class="n">ax1</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Precipitation&quot;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">prcp_ylabel</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">labelcolor</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">)</span>

    <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">p</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">*</span> <span class="mi">5</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">invert_yaxis</span><span class="p">()</span>

    <span class="n">ax2</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>

    <span class="c1"># transform the unit of obs and pred</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <span class="n">t</span><span class="p">,</span>
        <span class="n">obs</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">,</span>
        <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="s2">&quot;observed value&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <span class="n">t</span><span class="p">,</span>
        <span class="n">pred</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span>
        <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="s2">&quot;predicted value&quot;</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">labelcolor</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper left&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="hydroutils.hydro_plot.plot_scatter_with_11line" class="doc doc-heading">
<code class="highlight language-python"><span class="n">plot_scatter_with_11line</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">point_color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">line_color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span> <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span> <span class="n">xlabel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#hydroutils.hydro_plot.plot_scatter_with_11line" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Creates a scatter plot comparing two variables with a 1:1 line.</p>
<p>This function generates a scatter plot with a 1:1 line (diagonal) for comparing
two variables, commonly used in model evaluation to compare observed vs predicted values.
The plot includes customizable colors, axis limits, and labels.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>x</code></td>
        <td><code>np.array</code></td>
        <td><p>First variable to be plotted (typically observed values).</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>y</code></td>
        <td><code>np.array</code></td>
        <td><p>Second variable to be plotted (typically predicted values).</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>point_color</code></td>
        <td><code>str</code></td>
        <td><p>Color of scatter points. Defaults to "blue".</p></td>
        <td><code>&#39;blue&#39;</code></td>
      </tr>
      <tr>
        <td><code>line_color</code></td>
        <td><code>str</code></td>
        <td><p>Color of the 1:1 line. Defaults to "black".</p></td>
        <td><code>&#39;black&#39;</code></td>
      </tr>
      <tr>
        <td><code>xlim</code></td>
        <td><code>list</code></td>
        <td><p>X-axis range as [min, max]. Defaults to [0.0, 1.0].</p></td>
        <td><code>[0.0, 1.0]</code></td>
      </tr>
      <tr>
        <td><code>ylim</code></td>
        <td><code>list</code></td>
        <td><p>Y-axis range as [min, max]. Defaults to [0.0, 1.0].</p></td>
        <td><code>[0.0, 1.0]</code></td>
      </tr>
      <tr>
        <td><code>xlabel</code></td>
        <td><code>str</code></td>
        <td><p>Label for x-axis. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>ylabel</code></td>
        <td><code>str</code></td>
        <td><p>Label for y-axis. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>tuple[matplotlib.figure.Figure, matplotlib.axes.Axes]</code></td>
      <td><p>A tuple containing the figure and axes objects.</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">obs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">2.2</span><span class="p">,</span> <span class="mf">2.9</span><span class="p">,</span> <span class="mf">4.1</span><span class="p">,</span> <span class="mf">5.2</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plot_scatter_with_11line</span><span class="p">(</span>
<span class="o">...</span>     <span class="n">obs</span><span class="p">,</span> <span class="n">pred</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Observed&#39;</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Predicted&#39;</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
<span class="o">...</span>     <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>
<span class="o">...</span> <span class="p">)</span>
</code></pre></div>

        <details class="quote">
          <summary>Source code in <code>hydroutils/hydro_plot.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_scatter_with_11line</span><span class="p">(</span>
    <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">,</span>
    <span class="n">y</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">,</span>
    <span class="n">point_color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span>
    <span class="n">line_color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span>
    <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span>
    <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span>
    <span class="n">xlabel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">ylabel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates a scatter plot comparing two variables with a 1:1 line.</span>

<span class="sd">    This function generates a scatter plot with a 1:1 line (diagonal) for comparing</span>
<span class="sd">    two variables, commonly used in model evaluation to compare observed vs predicted values.</span>
<span class="sd">    The plot includes customizable colors, axis limits, and labels.</span>

<span class="sd">    Args:</span>
<span class="sd">        x (np.array): First variable to be plotted (typically observed values).</span>
<span class="sd">        y (np.array): Second variable to be plotted (typically predicted values).</span>
<span class="sd">        point_color (str, optional): Color of scatter points. Defaults to &quot;blue&quot;.</span>
<span class="sd">        line_color (str, optional): Color of the 1:1 line. Defaults to &quot;black&quot;.</span>
<span class="sd">        xlim (list, optional): X-axis range as [min, max]. Defaults to [0.0, 1.0].</span>
<span class="sd">        ylim (list, optional): Y-axis range as [min, max]. Defaults to [0.0, 1.0].</span>
<span class="sd">        xlabel (str, optional): Label for x-axis. Defaults to None.</span>
<span class="sd">        ylabel (str, optional): Label for y-axis. Defaults to None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple[matplotlib.figure.Figure, matplotlib.axes.Axes]: </span>
<span class="sd">            A tuple containing the figure and axes objects.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; obs = np.array([1, 2, 3, 4, 5])</span>
<span class="sd">        &gt;&gt;&gt; pred = np.array([1.1, 2.2, 2.9, 4.1, 5.2])</span>
<span class="sd">        &gt;&gt;&gt; fig, ax = plot_scatter_with_11line(</span>
<span class="sd">        ...     obs, pred,</span>
<span class="sd">        ...     xlabel=&#39;Observed&#39;,</span>
<span class="sd">        ...     ylabel=&#39;Predicted&#39;,</span>
<span class="sd">        ...     xlim=[0, 6],</span>
<span class="sd">        ...     ylim=[0, 6]</span>
<span class="sd">        ... )</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
    <span class="c1"># set background color for ax</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_facecolor</span><span class="p">(</span><span class="s2">&quot;whitesmoke&quot;</span><span class="p">)</span>
    <span class="c1"># plot the grid of the figure</span>
    <span class="c1"># plt.grid(color=&quot;whitesmoke&quot;)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">point_color</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">line</span> <span class="o">=</span> <span class="n">mlines</span><span class="o">.</span><span class="n">Line2D</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">line_color</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">)</span>
    <span class="n">transform</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span>
    <span class="n">line</span><span class="o">.</span><span class="n">set_transform</span><span class="p">(</span><span class="n">transform</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">add_line</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">xlim</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ylim</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">xlim</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mf">0.1</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">ylim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ylim</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mf">0.1</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="c1"># set xlable and ylabel</span>
    <span class="k">if</span> <span class="n">xlabel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">xlabel</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">ylabel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;bottom&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="hydroutils.hydro_plot.plot_scatter_xyc" class="doc doc-heading">
<code class="highlight language-python"><span class="n">plot_scatter_xyc</span><span class="p">(</span><span class="n">x_label</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y_label</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">c_label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">is_reg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ylim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">quadrant</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#hydroutils.hydro_plot.plot_scatter_xyc" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Creates a scatter plot with optional color mapping and quadrant analysis.</p>
<p>This function generates a scatter plot with optional color mapping for points,
regression line, and quadrant analysis. It's particularly useful for analyzing
relationships between variables with an additional dimension represented by color.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>x_label</code></td>
        <td><code>str</code></td>
        <td><p>Label for x-axis.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>x</code></td>
        <td><code>Union[np.array, List[np.array]]</code></td>
        <td><p>X-axis data values.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>y_label</code></td>
        <td><code>str</code></td>
        <td><p>Label for y-axis.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>y</code></td>
        <td><code>Union[np.array, List[np.array]]</code></td>
        <td><p>Y-axis data values.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>c_label</code></td>
        <td><code>Union[str, List[str]]</code></td>
        <td><p>Label(s) for color mapping or
multiple series. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>c</code></td>
        <td><code>Union[np.array, List[str]]</code></td>
        <td><p>Values for color mapping or
colors for multiple series. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>size</code></td>
        <td><code>int</code></td>
        <td><p>Size of scatter points. Defaults to 20.</p></td>
        <td><code>20</code></td>
      </tr>
      <tr>
        <td><code>is_reg</code></td>
        <td><code>bool</code></td>
        <td><p>If True, adds regression line. Defaults to False.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>xlim</code></td>
        <td><code>list</code></td>
        <td><p>X-axis limits as [min, max]. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>ylim</code></td>
        <td><code>list</code></td>
        <td><p>Y-axis limits as [min, max]. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>quadrant</code></td>
        <td><code>list</code></td>
        <td><p>Reference points [x, y] for quadrant analysis.
Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="c1"># Simple scatter plot</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">y</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">plot_scatter_xyc</span><span class="p">(</span>
<span class="o">...</span>     <span class="s1">&#39;X Values&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span>
<span class="o">...</span>     <span class="s1">&#39;Y Values&#39;</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">is_reg</span><span class="o">=</span><span class="kc">True</span>
<span class="o">...</span> <span class="p">)</span>
</code></pre></div>
    <div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="c1"># Scatter plot with color mapping</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">plot_scatter_xyc</span><span class="p">(</span>
<span class="o">...</span>     <span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">c_label</span><span class="o">=</span><span class="s1">&#39;Z Values&#39;</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">c</span><span class="o">=</span><span class="n">c</span>
<span class="o">...</span> <span class="p">)</span>
</code></pre></div>
    <div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="c1"># Quadrant analysis</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">plot_scatter_xyc</span><span class="p">(</span>
<span class="o">...</span>     <span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">quadrant</span><span class="o">=</span><span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>
<span class="o">...</span>     <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="o">...</span>     <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="o">...</span> <span class="p">)</span>
</code></pre></div>
      <p>!!! notes
    - Supports both single and multiple series plotting
    - Automatically handles NaN values
    - Provides quadrant statistics when quadrant analysis is enabled
    - Uses clean plotting style with minimal spines
    - Supports regression line with seaborn's regplot</p>

        <details class="quote">
          <summary>Source code in <code>hydroutils/hydro_plot.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_scatter_xyc</span><span class="p">(</span>
    <span class="n">x_label</span><span class="p">,</span>
    <span class="n">x</span><span class="p">,</span>
    <span class="n">y_label</span><span class="p">,</span>
    <span class="n">y</span><span class="p">,</span>
    <span class="n">c_label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">c</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
    <span class="n">is_reg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">xlim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">ylim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">quadrant</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates a scatter plot with optional color mapping and quadrant analysis.</span>

<span class="sd">    This function generates a scatter plot with optional color mapping for points,</span>
<span class="sd">    regression line, and quadrant analysis. It&#39;s particularly useful for analyzing</span>
<span class="sd">    relationships between variables with an additional dimension represented by color.</span>

<span class="sd">    Args:</span>
<span class="sd">        x_label (str): Label for x-axis.</span>
<span class="sd">        x (Union[np.array, List[np.array]]): X-axis data values.</span>
<span class="sd">        y_label (str): Label for y-axis.</span>
<span class="sd">        y (Union[np.array, List[np.array]]): Y-axis data values.</span>
<span class="sd">        c_label (Union[str, List[str]], optional): Label(s) for color mapping or</span>
<span class="sd">            multiple series. Defaults to None.</span>
<span class="sd">        c (Union[np.array, List[str]], optional): Values for color mapping or</span>
<span class="sd">            colors for multiple series. Defaults to None.</span>
<span class="sd">        size (int, optional): Size of scatter points. Defaults to 20.</span>
<span class="sd">        is_reg (bool, optional): If True, adds regression line. Defaults to False.</span>
<span class="sd">        xlim (list, optional): X-axis limits as [min, max]. Defaults to None.</span>
<span class="sd">        ylim (list, optional): Y-axis limits as [min, max]. Defaults to None.</span>
<span class="sd">        quadrant (list, optional): Reference points [x, y] for quadrant analysis.</span>
<span class="sd">            Defaults to None.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; # Simple scatter plot</span>
<span class="sd">        &gt;&gt;&gt; x = np.random.rand(100)</span>
<span class="sd">        &gt;&gt;&gt; y = x + np.random.normal(0, 0.1, 100)</span>
<span class="sd">        &gt;&gt;&gt; plot_scatter_xyc(</span>
<span class="sd">        ...     &#39;X Values&#39;, x,</span>
<span class="sd">        ...     &#39;Y Values&#39;, y,</span>
<span class="sd">        ...     is_reg=True</span>
<span class="sd">        ... )</span>

<span class="sd">        &gt;&gt;&gt; # Scatter plot with color mapping</span>
<span class="sd">        &gt;&gt;&gt; c = np.random.rand(100)</span>
<span class="sd">        &gt;&gt;&gt; plot_scatter_xyc(</span>
<span class="sd">        ...     &#39;X&#39;, x, &#39;Y&#39;, y,</span>
<span class="sd">        ...     c_label=&#39;Z Values&#39;,</span>
<span class="sd">        ...     c=c</span>
<span class="sd">        ... )</span>

<span class="sd">        &gt;&gt;&gt; # Quadrant analysis</span>
<span class="sd">        &gt;&gt;&gt; plot_scatter_xyc(</span>
<span class="sd">        ...     &#39;X&#39;, x, &#39;Y&#39;, y,</span>
<span class="sd">        ...     quadrant=[0.5, 0.5],</span>
<span class="sd">        ...     xlim=[0, 1],</span>
<span class="sd">        ...     ylim=[0, 1]</span>
<span class="sd">        ... )</span>

<span class="sd">    Notes:</span>
<span class="sd">        - Supports both single and multiple series plotting</span>
<span class="sd">        - Automatically handles NaN values</span>
<span class="sd">        - Provides quadrant statistics when quadrant analysis is enabled</span>
<span class="sd">        - Uses clean plotting style with minimal spines</span>
<span class="sd">        - Supports regression line with seaborn&#39;s regplot</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)):</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
                <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="n">size</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">c_label</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">c</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

    <span class="k">elif</span> <span class="n">c</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="n">x_label</span><span class="p">:</span> <span class="n">x</span><span class="p">,</span> <span class="n">y_label</span><span class="p">:</span> <span class="n">y</span><span class="p">})</span>
        <span class="n">points</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">x_label</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="n">y_label</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">quadrant</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">quadrant</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;grey&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">quadrant</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;grey&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">)</span>
            <span class="n">q2</span> <span class="o">=</span> <span class="n">df</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="n">x_label</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">y_label</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">q3</span> <span class="o">=</span> <span class="n">df</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="n">x_label</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">y_label</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">q4</span> <span class="o">=</span> <span class="n">df</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="n">x_label</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">y_label</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">q5</span> <span class="o">=</span> <span class="n">df</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="n">x_label</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">y_label</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">q1</span> <span class="o">=</span> <span class="n">df</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="n">x_label</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">y_label</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">q</span> <span class="o">=</span> <span class="n">q1</span> <span class="o">+</span> <span class="n">q2</span> <span class="o">+</span> <span class="n">q3</span> <span class="o">+</span> <span class="n">q4</span> <span class="o">+</span> <span class="n">q5</span>
            <span class="n">r1</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">q1</span> <span class="o">/</span> <span class="n">q</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span>
            <span class="n">r2</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">q2</span> <span class="o">/</span> <span class="n">q</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span>
            <span class="n">r3</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">q3</span> <span class="o">/</span> <span class="n">q</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span>
            <span class="n">r4</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">q4</span> <span class="o">/</span> <span class="n">q</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span>
            <span class="n">r5</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">-</span> <span class="n">r1</span> <span class="o">-</span> <span class="n">r2</span> <span class="o">-</span> <span class="n">r3</span> <span class="o">-</span> <span class="n">r4</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
                <span class="n">xlim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="p">(</span><span class="n">xlim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="mf">0.1</span><span class="p">,</span>
                <span class="n">ylim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="p">(</span><span class="n">ylim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">ylim</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="mf">0.1</span><span class="p">,</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">r1</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">,</span>
                <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
                <span class="n">xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">xlim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="mf">0.1</span><span class="p">,</span>
                <span class="n">ylim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="p">(</span><span class="n">ylim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">ylim</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="mf">0.1</span><span class="p">,</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">r2</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">,</span>
                <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
                <span class="n">xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">xlim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="mf">0.1</span><span class="p">,</span>
                <span class="n">ylim</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">ylim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">ylim</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="mf">0.1</span><span class="p">,</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">r3</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">,</span>
                <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
                <span class="n">xlim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="p">(</span><span class="n">xlim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="mf">0.1</span><span class="p">,</span>
                <span class="n">ylim</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">ylim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">ylim</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="mf">0.1</span><span class="p">,</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">r4</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">,</span>
                <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">r5</span><span class="p">)</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="n">x_label</span><span class="p">:</span> <span class="n">x</span><span class="p">,</span> <span class="n">y_label</span><span class="p">:</span> <span class="n">y</span><span class="p">,</span> <span class="n">c_label</span><span class="p">:</span> <span class="n">c</span><span class="p">})</span>
        <span class="n">points</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
            <span class="n">df</span><span class="p">[</span><span class="n">x_label</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="n">y_label</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">c_label</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="n">size</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;Spectral&quot;</span>
        <span class="p">)</span>  <span class="c1"># set style options</span>
        <span class="c1"># add a color bar</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>

    <span class="c1"># set limits</span>
    <span class="k">if</span> <span class="n">xlim</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">xlim</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">ylim</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="n">ylim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ylim</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="c1"># Hide the right and top spines</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="c1"># build the regression plot</span>
    <span class="k">if</span> <span class="n">is_reg</span><span class="p">:</span>
        <span class="n">plot</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">regplot</span><span class="p">(</span><span class="n">x_label</span><span class="p">,</span> <span class="n">y_label</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">scatter</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>  <span class="c1"># , color=&quot;.1&quot;</span>
        <span class="n">plot</span> <span class="o">=</span> <span class="n">plot</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="n">x_label</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="n">y_label</span><span class="p">)</span>  <span class="c1"># add labels</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">x_label</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="n">y_label</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="hydroutils.hydro_plot.plot_ts" class="doc doc-heading">
<code class="highlight language-python"><span class="n">plot_ts</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">t_bar</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fig_size</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">c_lst</span><span class="o">=</span><span class="s1">&#39;rbkgcmyrbkgcmyrbkgcmy&#39;</span><span class="p">,</span> <span class="n">leg_lst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">marker_lst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">linespec</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dash_lines</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span></code>


<a href="#hydroutils.hydro_plot.plot_ts" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Plot time series for multi arrays with matplotlib</p>
<h5 id="hydroutils.hydro_plot.plot_ts--parameters">Parameters<a class="headerlink" href="#hydroutils.hydro_plot.plot_ts--parameters" title="Permanent link">&para;</a></h5>
<p>t : Union[list, np.array]
    time series but not just date; it can also be numbers like 1, 2, 3, ...
y : Union[list, np.array]
    shown data series; the len of y should be equal to t's
ax : <em>type</em>, optional
    <em>description</em>, by default None
t_bar : <em>type</em>, optional
    <em>description</em>, by default None
title : <em>type</em>, optional
    <em>description</em>, by default None
!!! xlabel "str, optional"
    the name of x axis, by default None
ylabel : str, optional
    the name of y axis, by default None
fig_size : tuple, optional
    <em>description</em>, by default (12, 4)
c_lst : str, optional
    <em>description</em>, by default "rbkgcmy"
leg_lst : <em>type</em>, optional
    <em>description</em>, by default None
marker_lst : <em>type</em>, optional
    <em>description</em>, by default None
linewidth : int, optional
    <em>description</em>, by default 2
linespec : <em>type</em>, optional
    <em>description</em>, by default None
dash_lines : <em>type</em>, optional
    if dash_line, then we will plot dashed line, by default None</p>
<h5 id="hydroutils.hydro_plot.plot_ts--returns">Returns<a class="headerlink" href="#hydroutils.hydro_plot.plot_ts--returns" title="Permanent link">&para;</a></h5>
<p><em>type</em>
    <em>description</em></p>

        <details class="quote">
          <summary>Source code in <code>hydroutils/hydro_plot.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_ts</span><span class="p">(</span>
    <span class="n">t</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">list</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">],</span>
    <span class="n">y</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">list</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">],</span>
    <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">t_bar</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">xlabel</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">ylabel</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">fig_size</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>
    <span class="n">c_lst</span><span class="o">=</span><span class="s2">&quot;rbkgcmyrbkgcmyrbkgcmy&quot;</span><span class="p">,</span>
    <span class="n">leg_lst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">marker_lst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">linespec</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">dash_lines</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plot time series for multi arrays with matplotlib</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    t : Union[list, np.array]</span>
<span class="sd">        time series but not just date; it can also be numbers like 1, 2, 3, ...</span>
<span class="sd">    y : Union[list, np.array]</span>
<span class="sd">        shown data series; the len of y should be equal to t&#39;s</span>
<span class="sd">    ax : _type_, optional</span>
<span class="sd">        _description_, by default None</span>
<span class="sd">    t_bar : _type_, optional</span>
<span class="sd">        _description_, by default None</span>
<span class="sd">    title : _type_, optional</span>
<span class="sd">        _description_, by default None</span>
<span class="sd">    xlabel: str, optional</span>
<span class="sd">        the name of x axis, by default None</span>
<span class="sd">    ylabel : str, optional</span>
<span class="sd">        the name of y axis, by default None</span>
<span class="sd">    fig_size : tuple, optional</span>
<span class="sd">        _description_, by default (12, 4)</span>
<span class="sd">    c_lst : str, optional</span>
<span class="sd">        _description_, by default &quot;rbkgcmy&quot;</span>
<span class="sd">    leg_lst : _type_, optional</span>
<span class="sd">        _description_, by default None</span>
<span class="sd">    marker_lst : _type_, optional</span>
<span class="sd">        _description_, by default None</span>
<span class="sd">    linewidth : int, optional</span>
<span class="sd">        _description_, by default 2</span>
<span class="sd">    linespec : _type_, optional</span>
<span class="sd">        _description_, by default None</span>
<span class="sd">    dash_lines : _type_, optional</span>
<span class="sd">        if dash_line, then we will plot dashed line, by default None</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    _type_</span>
<span class="sd">        _description_</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">is_new_fig</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">fig_size</span><span class="p">)</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
        <span class="n">is_new_fig</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">if</span> <span class="n">dash_lines</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dash_lines</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">dash_lines</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="c1"># dash_lines[-1] = True</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="ow">is</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
        <span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="n">y</span><span class="p">]</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">linewidth</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">list</span><span class="p">:</span>
        <span class="n">linewidth</span> <span class="o">=</span> <span class="p">[</span><span class="n">linewidth</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">list</span><span class="p">:</span>
        <span class="n">alpha</span> <span class="o">=</span> <span class="p">[</span><span class="n">alpha</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)):</span>
        <span class="n">tt</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span> <span class="k">else</span> <span class="n">t</span>
        <span class="n">yy</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
        <span class="n">leg_str</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">leg_lst</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">leg_str</span> <span class="o">=</span> <span class="n">leg_lst</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">marker_lst</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="p">(</span><span class="n">line_i</span><span class="p">,)</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tt</span><span class="p">,</span> <span class="n">yy</span><span class="p">,</span> <span class="s2">&quot;*&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">c_lst</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="n">leg_str</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                <span class="k">if</span> <span class="kc">True</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">yy</span><span class="p">)</span>
                <span class="k">else</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
                    <span class="n">tt</span><span class="p">,</span>
                    <span class="n">yy</span><span class="p">,</span>
                    <span class="n">color</span><span class="o">=</span><span class="n">c_lst</span><span class="p">[</span><span class="n">k</span><span class="p">],</span>
                    <span class="n">label</span><span class="o">=</span><span class="n">leg_str</span><span class="p">,</span>
                    <span class="n">linewidth</span><span class="o">=</span><span class="n">linewidth</span><span class="p">[</span><span class="n">k</span><span class="p">],</span>
                    <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">[</span><span class="n">k</span><span class="p">],</span>
                <span class="p">)</span>
            <span class="p">)</span>
        <span class="k">elif</span> <span class="n">marker_lst</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;-&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">linespec</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="p">(</span><span class="n">line_i</span><span class="p">,)</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
                    <span class="n">tt</span><span class="p">,</span>
                    <span class="n">yy</span><span class="p">,</span>
                    <span class="n">color</span><span class="o">=</span><span class="n">c_lst</span><span class="p">[</span><span class="n">k</span><span class="p">],</span>
                    <span class="n">label</span><span class="o">=</span><span class="n">leg_str</span><span class="p">,</span>
                    <span class="n">linestyle</span><span class="o">=</span><span class="n">linespec</span><span class="p">[</span><span class="n">k</span><span class="p">],</span>
                    <span class="n">lw</span><span class="o">=</span><span class="n">linewidth</span><span class="p">[</span><span class="n">k</span><span class="p">],</span>
                    <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">[</span><span class="n">k</span><span class="p">],</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="p">(</span><span class="n">line_i</span><span class="p">,)</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
                    <span class="n">tt</span><span class="p">,</span>
                    <span class="n">yy</span><span class="p">,</span>
                    <span class="n">color</span><span class="o">=</span><span class="n">c_lst</span><span class="p">[</span><span class="n">k</span><span class="p">],</span>
                    <span class="n">label</span><span class="o">=</span><span class="n">leg_str</span><span class="p">,</span>
                    <span class="n">lw</span><span class="o">=</span><span class="n">linewidth</span><span class="p">[</span><span class="n">k</span><span class="p">],</span>
                    <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">[</span><span class="n">k</span><span class="p">],</span>
                <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="p">(</span><span class="n">line_i</span><span class="p">,)</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
                <span class="n">tt</span><span class="p">,</span>
                <span class="n">yy</span><span class="p">,</span>
                <span class="n">color</span><span class="o">=</span><span class="n">c_lst</span><span class="p">[</span><span class="n">k</span><span class="p">],</span>
                <span class="n">label</span><span class="o">=</span><span class="n">leg_str</span><span class="p">,</span>
                <span class="n">marker</span><span class="o">=</span><span class="n">marker_lst</span><span class="p">[</span><span class="n">k</span><span class="p">],</span>
                <span class="n">lw</span><span class="o">=</span><span class="n">linewidth</span><span class="p">[</span><span class="n">k</span><span class="p">],</span>
                <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">[</span><span class="n">k</span><span class="p">],</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="n">dash_lines</span><span class="p">[</span><span class="n">k</span><span class="p">]:</span>
            <span class="n">line_i</span><span class="o">.</span><span class="n">set_dashes</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">ylabel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">xlabel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">xlabel</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">t_bar</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ylim</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span>
        <span class="n">t_bar</span> <span class="o">=</span> <span class="p">[</span><span class="n">t_bar</span><span class="p">]</span> <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">t_bar</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">list</span> <span class="k">else</span> <span class="n">t_bar</span>
        <span class="k">for</span> <span class="n">tt</span> <span class="ow">in</span> <span class="n">t_bar</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">tt</span><span class="p">,</span> <span class="n">tt</span><span class="p">],</span> <span class="n">ylim</span><span class="p">,</span> <span class="s2">&quot;-k&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">leg_lst</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper right&quot;</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;size&quot;</span><span class="p">:</span> <span class="mi">16</span><span class="p">})</span>
    <span class="k">if</span> <span class="n">title</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">fontdict</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;fontsize&quot;</span><span class="p">:</span> <span class="mi">17</span><span class="p">})</span>
    <span class="c1"># plot the grid of the figure</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="c1"># Hide the right and top spines</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span> <span class="k">if</span> <span class="n">is_new_fig</span> <span class="k">else</span> <span class="n">ax</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="hydroutils.hydro_plot.plot_ts_map" class="doc doc-heading">
<code class="highlight language-python"><span class="n">plot_ts_map</span><span class="p">(</span><span class="n">dataMap</span><span class="p">,</span> <span class="n">dataTs</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">sites_id</span><span class="p">,</span> <span class="n">pertile_range</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#hydroutils.hydro_plot.plot_ts_map" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Creates an interactive map with linked time series plots.</p>
<p>This function generates a figure with two subplots: a map on top and a time series
plot below. Clicking on a location in the map updates the time series plot to show
data from the nearest site.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>dataMap</code></td>
        <td><code>list</code></td>
        <td><p>Data values to be shown on the map.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>dataTs</code></td>
        <td><code>list</code></td>
        <td><p>List of time series data for each site.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>lat</code></td>
        <td><code>np.array</code></td>
        <td><p>Latitude values for each site.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>lon</code></td>
        <td><code>np.array</code></td>
        <td><p>Longitude values for each site.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>t</code></td>
        <td><code>list</code></td>
        <td><p>Time points for x-axis of time series.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>sites_id</code></td>
        <td><code>list</code></td>
        <td><p>Identifiers for each site.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>pertile_range</code></td>
        <td><code>list</code></td>
        <td><p>Percentile range for color scaling on map.
Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="c1"># Create sample data</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">n_sites</span> <span class="o">=</span> <span class="mi">10</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">n_times</span> <span class="o">=</span> <span class="mi">100</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">lat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="n">n_sites</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">lon</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mi">120</span><span class="p">,</span> <span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="n">n_sites</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">sites_id</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;SITE_</span><span class="si">{</span><span class="n">i</span><span class="si">:</span><span class="s1">03d</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_sites</span><span class="p">)]</span>
<span class="o">&gt;&gt;&gt;</span> 
<span class="o">&gt;&gt;&gt;</span> <span class="c1"># Generate sample time series for each site</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">t</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n_times</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">dataTs</span> <span class="o">=</span> <span class="p">[]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_sites</span><span class="p">):</span>
<span class="o">...</span>     <span class="n">pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">/</span><span class="mi">10</span> <span class="o">+</span> <span class="n">i</span><span class="o">/</span><span class="mi">5</span><span class="p">)</span>
<span class="o">...</span>     <span class="n">obs</span> <span class="o">=</span> <span class="n">pred</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="n">n_times</span><span class="p">)</span>
<span class="o">...</span>     <span class="n">dataTs</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">pred</span><span class="p">,</span> <span class="n">obs</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> 
<span class="o">&gt;&gt;&gt;</span> <span class="c1"># Map data could be mean values</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">dataMap</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">ts</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="k">for</span> <span class="n">ts</span> <span class="ow">in</span> <span class="n">dataTs</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> 
<span class="o">&gt;&gt;&gt;</span> <span class="n">plot_ts_map</span><span class="p">(</span><span class="n">dataMap</span><span class="p">,</span> <span class="n">dataTs</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">sites_id</span><span class="p">)</span>
</code></pre></div>
      <p>!!! notes
    - Uses TkAgg backend for interactive display
    - Map uses Cartopy for proper geographic projection
    - Time series updates automatically on map click
    - Shows site ID and coordinates in time series title
    - Finds nearest site to click location
    - Both predicted and observed values shown in time series</p>

        <details class="quote">
          <summary>Source code in <code>hydroutils/hydro_plot.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_ts_map</span><span class="p">(</span><span class="n">dataMap</span><span class="p">,</span> <span class="n">dataTs</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">sites_id</span><span class="p">,</span> <span class="n">pertile_range</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates an interactive map with linked time series plots.</span>

<span class="sd">    This function generates a figure with two subplots: a map on top and a time series</span>
<span class="sd">    plot below. Clicking on a location in the map updates the time series plot to show</span>
<span class="sd">    data from the nearest site.</span>

<span class="sd">    Args:</span>
<span class="sd">        dataMap (list): Data values to be shown on the map.</span>
<span class="sd">        dataTs (list): List of time series data for each site.</span>
<span class="sd">        lat (np.array): Latitude values for each site.</span>
<span class="sd">        lon (np.array): Longitude values for each site.</span>
<span class="sd">        t (list): Time points for x-axis of time series.</span>
<span class="sd">        sites_id (list): Identifiers for each site.</span>
<span class="sd">        pertile_range (list, optional): Percentile range for color scaling on map.</span>
<span class="sd">            Defaults to None.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; # Create sample data</span>
<span class="sd">        &gt;&gt;&gt; n_sites = 10</span>
<span class="sd">        &gt;&gt;&gt; n_times = 100</span>
<span class="sd">        &gt;&gt;&gt; lat = np.random.uniform(30, 45, n_sites)</span>
<span class="sd">        &gt;&gt;&gt; lon = np.random.uniform(-120, -100, n_sites)</span>
<span class="sd">        &gt;&gt;&gt; sites_id = [f&#39;SITE_{i:03d}&#39; for i in range(n_sites)]</span>
<span class="sd">        &gt;&gt;&gt; </span>
<span class="sd">        &gt;&gt;&gt; # Generate sample time series for each site</span>
<span class="sd">        &gt;&gt;&gt; t = list(range(n_times))</span>
<span class="sd">        &gt;&gt;&gt; dataTs = []</span>
<span class="sd">        &gt;&gt;&gt; for i in range(n_sites):</span>
<span class="sd">        ...     pred = np.sin(np.array(t)/10 + i/5)</span>
<span class="sd">        ...     obs = pred + np.random.normal(0, 0.1, n_times)</span>
<span class="sd">        ...     dataTs.append([pred, obs])</span>
<span class="sd">        &gt;&gt;&gt; </span>
<span class="sd">        &gt;&gt;&gt; # Map data could be mean values</span>
<span class="sd">        &gt;&gt;&gt; dataMap = [np.mean(ts[0]) for ts in dataTs]</span>
<span class="sd">        &gt;&gt;&gt; </span>
<span class="sd">        &gt;&gt;&gt; plot_ts_map(dataMap, dataTs, lat, lon, t, sites_id)</span>

<span class="sd">    Notes:</span>
<span class="sd">        - Uses TkAgg backend for interactive display</span>
<span class="sd">        - Map uses Cartopy for proper geographic projection</span>
<span class="sd">        - Time series updates automatically on map click</span>
<span class="sd">        - Shows site ID and coordinates in time series title</span>
<span class="sd">        - Finds nearest site to click location</span>
<span class="sd">        - Both predicted and observed values shown in time series</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># show the map in a pop-up window</span>
    <span class="n">matplotlib</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">&quot;TkAgg&quot;</span><span class="p">)</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dataMap</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dataTs</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span>
    <span class="c1"># setup axes</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
    <span class="n">gs</span> <span class="o">=</span> <span class="n">gridspec</span><span class="o">.</span><span class="n">GridSpec</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="c1"># plt.subplots_adjust(left=0.13, right=0.89, bottom=0.05)</span>
    <span class="c1"># plot maps</span>
    <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
    <span class="n">ax1</span> <span class="o">=</span> <span class="n">plot_map_carto</span><span class="p">(</span>
        <span class="n">dataMap</span><span class="p">,</span> <span class="n">lat</span><span class="o">=</span><span class="n">lat</span><span class="p">,</span> <span class="n">lon</span><span class="o">=</span><span class="n">lon</span><span class="p">,</span> <span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">,</span> <span class="n">pertile_range</span><span class="o">=</span><span class="n">pertile_range</span>
    <span class="p">)</span>
    <span class="c1"># line plot</span>
    <span class="n">ax2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

    <span class="c1"># plot ts</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">onclick</span><span class="p">(</span><span class="n">event</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;click event&quot;</span><span class="p">)</span>
        <span class="c1"># refresh the ax2, then new ts data can be showed without previous one</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">cla</span><span class="p">()</span>
        <span class="n">xClick</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">xdata</span>
        <span class="n">yClick</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">ydata</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">xClick</span> <span class="o">-</span> <span class="n">lon</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">yClick</span> <span class="o">-</span> <span class="n">lat</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">ind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
        <span class="n">titleStr</span> <span class="o">=</span> <span class="s2">&quot;site_id </span><span class="si">%s</span><span class="s2">, lat </span><span class="si">%.3f</span><span class="s2">, lon </span><span class="si">%.3f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span>
            <span class="n">sites_id</span><span class="p">[</span><span class="n">ind</span><span class="p">],</span>
            <span class="n">lat</span><span class="p">[</span><span class="n">ind</span><span class="p">],</span>
            <span class="n">lon</span><span class="p">[</span><span class="n">ind</span><span class="p">],</span>
        <span class="p">)</span>
        <span class="n">tsLst</span> <span class="o">=</span> <span class="n">dataTs</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span>
        <span class="n">plot_ts_matplot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">tsLst</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax2</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">titleStr</span><span class="p">)</span>
        <span class="c1"># following funcs both work</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
        <span class="c1"># plt.draw()</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">mpl_connect</span><span class="p">(</span><span class="s2">&quot;button_press_event&quot;</span><span class="p">,</span> <span class="n">onclick</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="hydroutils.hydro_plot.plot_ts_matplot" class="doc doc-heading">
<code class="highlight language-python"><span class="n">plot_ts_matplot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#hydroutils.hydro_plot.plot_ts_matplot" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Creates a simple time series plot comparing predicted and observed values.</p>
<p>This function provides a straightforward way to plot and compare two time series,
typically used for showing predicted vs observed values. It supports both creating
new figures and adding to existing axes.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>t</code></td>
        <td><code>list</code></td>
        <td><p>Time points for x-axis.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>y</code></td>
        <td><code>list</code></td>
        <td><p>List containing two arrays: [predicted_values, observed_values].</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>color</code></td>
        <td><code>str</code></td>
        <td><p>Color for predicted values line. Defaults to "r".</p></td>
        <td><code>&#39;r&#39;</code></td>
      </tr>
      <tr>
        <td><code>ax</code></td>
        <td><code>matplotlib.axes.Axes</code></td>
        <td><p>Existing axes to plot on. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>title</code></td>
        <td><code>str</code></td>
        <td><p>Plot title. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Union[Tuple[matplotlib.figure.Figure, matplotlib.axes.Axes], matplotlib.axes.Axes]</code></td>
      <td><p>If ax is None, returns (fig, ax), otherwise returns ax.</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="c1"># Create new plot</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">t</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">/</span><span class="mi">10</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">y_obs</span> <span class="o">=</span> <span class="n">y_pred</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plot_ts_matplot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="p">[</span><span class="n">y_pred</span><span class="p">,</span> <span class="n">y_obs</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
</code></pre></div>
    <div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="c1"># Add to existing axes</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plot_ts_matplot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="p">[</span><span class="n">y_pred</span><span class="p">,</span> <span class="n">y_obs</span><span class="p">],</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
<span class="o">...</span>                     <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Sine Wave Prediction&#39;</span><span class="p">)</span>
</code></pre></div>
      <p>!!! notes
    - Predicted values are plotted first with specified color
    - Observed values are plotted second with default color
    - Legend is automatically added with "pred" and "obs" labels
    - Title is centered if provided</p>

        <details class="quote">
          <summary>Source code in <code>hydroutils/hydro_plot.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_ts_matplot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates a simple time series plot comparing predicted and observed values.</span>

<span class="sd">    This function provides a straightforward way to plot and compare two time series,</span>
<span class="sd">    typically used for showing predicted vs observed values. It supports both creating</span>
<span class="sd">    new figures and adding to existing axes.</span>

<span class="sd">    Args:</span>
<span class="sd">        t (list): Time points for x-axis.</span>
<span class="sd">        y (list): List containing two arrays: [predicted_values, observed_values].</span>
<span class="sd">        color (str, optional): Color for predicted values line. Defaults to &quot;r&quot;.</span>
<span class="sd">        ax (matplotlib.axes.Axes, optional): Existing axes to plot on. Defaults to None.</span>
<span class="sd">        title (str, optional): Plot title. Defaults to None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Union[Tuple[matplotlib.figure.Figure, matplotlib.axes.Axes], matplotlib.axes.Axes]:</span>
<span class="sd">            If ax is None, returns (fig, ax), otherwise returns ax.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; # Create new plot</span>
<span class="sd">        &gt;&gt;&gt; t = list(range(100))</span>
<span class="sd">        &gt;&gt;&gt; y_pred = np.sin(np.array(t)/10)</span>
<span class="sd">        &gt;&gt;&gt; y_obs = y_pred + np.random.normal(0, 0.1, 100)</span>
<span class="sd">        &gt;&gt;&gt; fig, ax = plot_ts_matplot(t, [y_pred, y_obs], color=&#39;blue&#39;)</span>

<span class="sd">        &gt;&gt;&gt; # Add to existing axes</span>
<span class="sd">        &gt;&gt;&gt; fig, ax = plt.subplots()</span>
<span class="sd">        &gt;&gt;&gt; ax = plot_ts_matplot(t, [y_pred, y_obs], ax=ax,</span>
<span class="sd">        ...                     title=&#39;Sine Wave Prediction&#39;)</span>

<span class="sd">    Notes:</span>
<span class="sd">        - Predicted values are plotted first with specified color</span>
<span class="sd">        - Observed values are plotted second with default color</span>
<span class="sd">        - Legend is automatically added with &quot;pred&quot; and &quot;obs&quot; labels</span>
<span class="sd">        - Title is centered if provided</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;pred&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;obs&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">title</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span> <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">ax</span>
</code></pre></div>
        </details>
    </div>

  </div>




  <div class="doc doc-object doc-function">



<h3 id="hydroutils.hydro_plot.swarmplot_without_legend" class="doc doc-heading">
<code class="highlight language-python"><span class="n">swarmplot_without_legend</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">hue</span><span class="p">,</span> <span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="p">,</span> <span class="n">cmap</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#hydroutils.hydro_plot.swarmplot_without_legend" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Creates a swarm plot using seaborn with colorbar instead of legend.</p>
<p>This function creates a swarm plot where points are colored according to a continuous
variable, replacing the default legend with a colorbar for better visualization of
the color scale.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>x</code></td>
        <td></td>
        <td><p>Values for x-axis categories.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>y</code></td>
        <td></td>
        <td><p>Values for y-axis.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>hue</code></td>
        <td></td>
        <td><p>Values determining the color of each point.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>vmin</code></td>
        <td><code>float</code></td>
        <td><p>Minimum value for color normalization.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>vmax</code></td>
        <td><code>float</code></td>
        <td><p>Maximum value for color normalization.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>cmap</code></td>
        <td><code>str</code></td>
        <td><p>Colormap name or matplotlib colormap object.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>**kwargs</code></td>
        <td></td>
        <td><p>Additional keyword arguments passed to sns.swarmplot.</p></td>
        <td><code>{}</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>matplotlib.figure.Figure</code></td>
      <td><p>The figure containing the swarm plot.</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">hue</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">fig</span> <span class="o">=</span> <span class="n">swarmplot_without_legend</span><span class="p">(</span>
<span class="o">...</span>     <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">hue</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span>
<span class="o">...</span> <span class="p">)</span>
</code></pre></div>

        <details class="quote">
          <summary>Source code in <code>hydroutils/hydro_plot.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">swarmplot_without_legend</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">hue</span><span class="p">,</span> <span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="p">,</span> <span class="n">cmap</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates a swarm plot using seaborn with colorbar instead of legend.</span>

<span class="sd">    This function creates a swarm plot where points are colored according to a continuous</span>
<span class="sd">    variable, replacing the default legend with a colorbar for better visualization of</span>
<span class="sd">    the color scale.</span>

<span class="sd">    Args:</span>
<span class="sd">        x: Values for x-axis categories.</span>
<span class="sd">        y: Values for y-axis.</span>
<span class="sd">        hue: Values determining the color of each point.</span>
<span class="sd">        vmin (float): Minimum value for color normalization.</span>
<span class="sd">        vmax (float): Maximum value for color normalization.</span>
<span class="sd">        cmap (str): Colormap name or matplotlib colormap object.</span>
<span class="sd">        **kwargs: Additional keyword arguments passed to sns.swarmplot.</span>

<span class="sd">    Returns:</span>
<span class="sd">        matplotlib.figure.Figure: The figure containing the swarm plot.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; x = [&#39;A&#39;, &#39;A&#39;, &#39;B&#39;, &#39;B&#39;]</span>
<span class="sd">        &gt;&gt;&gt; y = [1, 2, 3, 4]</span>
<span class="sd">        &gt;&gt;&gt; hue = [0.1, 0.5, 0.8, 0.9]</span>
<span class="sd">        &gt;&gt;&gt; fig = swarmplot_without_legend(</span>
<span class="sd">        ...     x, y, hue,</span>
<span class="sd">        ...     vmin=0, vmax=1,</span>
<span class="sd">        ...     cmap=&#39;viridis&#39;</span>
<span class="sd">        ... )</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">swarmplot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">hue</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="c1"># remove the legend, because we want to set a colorbar instead</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
    <span class="n">norm</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="p">)</span>
    <span class="n">sm</span> <span class="o">=</span> <span class="n">ScalarMappable</span><span class="p">(</span><span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">fig</span>
</code></pre></div>
        </details>
    </div>

  </div>






  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h2 id="hydroutils.hydro_s3" class="doc doc-heading">
        <code>hydro_s3</code>



<a href="#hydroutils.hydro_s3" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Author: Wenyu Ouyang
Date: 2023-10-27 15:08:16
LastEditTime: 2023-10-27 15:31:13
LastEditors: Wenyu Ouyang
Description: Some functions to deal with s3 file system
FilePath: /hydroutils/hydroutils/hydro_s3.py
Copyright (c) 2023-2024 Wenyu Ouyang. All rights reserved.</p>



  <div class="doc doc-children">








  <div class="doc doc-object doc-function">



<h3 id="hydroutils.hydro_s3.boto3_download_file" class="doc doc-heading">
<code class="highlight language-python"><span class="n">boto3_download_file</span><span class="p">(</span><span class="n">client</span><span class="p">,</span> <span class="n">bucket_name</span><span class="p">,</span> <span class="n">object_name</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span></code>


<a href="#hydroutils.hydro_s3.boto3_download_file" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Downloads a file from AWS S3 using boto3.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>client</code></td>
        <td></td>
        <td><p>boto3 S3 client instance.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>bucket_name</code></td>
        <td><code>str</code></td>
        <td><p>Name of the bucket containing the object.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>object_name</code></td>
        <td><code>str</code></td>
        <td><p>Name of the object to download.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>file_path</code></td>
        <td><code>str</code></td>
        <td><p>Local path where the file should be saved.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">boto3</span>
<span class="n">client</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">(</span><span class="s1">&#39;s3&#39;</span><span class="p">)</span>
<span class="n">boto3_download_file</span><span class="p">(</span><span class="n">client</span><span class="p">,</span> <span class="s1">&#39;mybucket&#39;</span><span class="p">,</span> <span class="s1">&#39;data.csv&#39;</span><span class="p">,</span> <span class="s1">&#39;./downloaded.csv&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>

        <details class="quote">
          <summary>Source code in <code>hydroutils/hydro_s3.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">boto3_download_file</span><span class="p">(</span><span class="n">client</span><span class="p">,</span> <span class="n">bucket_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">object_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Downloads a file from AWS S3 using boto3.</span>

<span class="sd">    Args:</span>
<span class="sd">        client: boto3 S3 client instance.</span>
<span class="sd">        bucket_name: Name of the bucket containing the object.</span>
<span class="sd">        object_name: Name of the object to download.</span>
<span class="sd">        file_path: Local path where the file should be saved.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        import boto3</span>
<span class="sd">        client = boto3.client(&#39;s3&#39;)</span>
<span class="sd">        boto3_download_file(client, &#39;mybucket&#39;, &#39;data.csv&#39;, &#39;./downloaded.csv&#39;)</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">client</span><span class="o">.</span><span class="n">download_file</span><span class="p">(</span><span class="n">bucket_name</span><span class="p">,</span> <span class="n">object_name</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="hydroutils.hydro_s3.boto3_upload_file" class="doc doc-heading">
<code class="highlight language-python"><span class="n">boto3_upload_file</span><span class="p">(</span><span class="n">client</span><span class="p">,</span> <span class="n">bucket_name</span><span class="p">,</span> <span class="n">object_name</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span></code>


<a href="#hydroutils.hydro_s3.boto3_upload_file" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Uploads a file to AWS S3 using boto3.</p>
<p>Creates the bucket if it doesn't exist, uploads the file, and returns a list of
all objects in the bucket.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>client</code></td>
        <td></td>
        <td><p>boto3 S3 client instance.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>bucket_name</code></td>
        <td><code>str</code></td>
        <td><p>Name of the bucket to upload to.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>object_name</code></td>
        <td><code>str</code></td>
        <td><p>Name to give the object in S3.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>file_path</code></td>
        <td><code>str</code></td>
        <td><p>Local path of the file to upload.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>list</code></td>
      <td><p>List of object keys in the bucket after upload.</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">boto3</span>
<span class="n">client</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">(</span><span class="s1">&#39;s3&#39;</span><span class="p">)</span>
<span class="n">objects</span> <span class="o">=</span> <span class="n">boto3_upload_file</span><span class="p">(</span><span class="n">client</span><span class="p">,</span> <span class="s1">&#39;mybucket&#39;</span><span class="p">,</span> <span class="s1">&#39;data.csv&#39;</span><span class="p">,</span> <span class="s1">&#39;./data.csv&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Bucket contents: </span><span class="si">{</span><span class="n">objects</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>

        <details class="quote">
          <summary>Source code in <code>hydroutils/hydro_s3.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">boto3_upload_file</span><span class="p">(</span><span class="n">client</span><span class="p">,</span> <span class="n">bucket_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">object_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Uploads a file to AWS S3 using boto3.</span>

<span class="sd">    Creates the bucket if it doesn&#39;t exist, uploads the file, and returns a list of</span>
<span class="sd">    all objects in the bucket.</span>

<span class="sd">    Args:</span>
<span class="sd">        client: boto3 S3 client instance.</span>
<span class="sd">        bucket_name: Name of the bucket to upload to.</span>
<span class="sd">        object_name: Name to give the object in S3.</span>
<span class="sd">        file_path: Local path of the file to upload.</span>

<span class="sd">    Returns:</span>
<span class="sd">        List of object keys in the bucket after upload.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        import boto3</span>
<span class="sd">        client = boto3.client(&#39;s3&#39;)</span>
<span class="sd">        objects = boto3_upload_file(client, &#39;mybucket&#39;, &#39;data.csv&#39;, &#39;./data.csv&#39;)</span>
<span class="sd">        print(f&quot;Bucket contents: {objects}&quot;)</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Make a bucket</span>
    <span class="n">bucket_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">dic</span><span class="p">[</span><span class="s2">&quot;Name&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">dic</span> <span class="ow">in</span> <span class="n">client</span><span class="o">.</span><span class="n">list_buckets</span><span class="p">()[</span><span class="s2">&quot;Buckets&quot;</span><span class="p">]]</span>
    <span class="k">if</span> <span class="n">bucket_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">bucket_names</span><span class="p">:</span>
        <span class="n">client</span><span class="o">.</span><span class="n">create_bucket</span><span class="p">(</span><span class="n">Bucket</span><span class="o">=</span><span class="n">bucket_name</span><span class="p">)</span>
    <span class="c1"># Upload an object</span>
    <span class="n">client</span><span class="o">.</span><span class="n">upload_file</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">bucket_name</span><span class="p">,</span> <span class="n">object_name</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">dic</span><span class="p">[</span><span class="s2">&quot;Key&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">dic</span> <span class="ow">in</span> <span class="n">client</span><span class="o">.</span><span class="n">list_objects</span><span class="p">(</span><span class="n">Bucket</span><span class="o">=</span><span class="n">bucket_name</span><span class="p">)[</span><span class="s2">&quot;Contents&quot;</span><span class="p">]]</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="hydroutils.hydro_s3.minio_download_file" class="doc doc-heading">
<code class="highlight language-python"><span class="n">minio_download_file</span><span class="p">(</span><span class="n">client</span><span class="p">,</span> <span class="n">bucket_name</span><span class="p">,</span> <span class="n">object_name</span><span class="p">,</span> <span class="n">file_path</span><span class="p">,</span> <span class="n">version_id</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#hydroutils.hydro_s3.minio_download_file" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Downloads a file from MinIO S3-compatible storage.</p>
<p>Downloads an object from S3 and saves it to a local file. Handles UTF-8 encoded text files.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>client</code></td>
        <td><code>Minio</code></td>
        <td><p>MinIO client instance.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>bucket_name</code></td>
        <td><code>str</code></td>
        <td><p>Name of the bucket containing the object.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>object_name</code></td>
        <td><code>str</code></td>
        <td><p>Name of the object to download.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>file_path</code></td>
        <td><code>str</code></td>
        <td><p>Local path where the file should be saved.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>version_id</code></td>
        <td><code>str</code></td>
        <td><p>Optional version ID for versioned objects.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">minio</span><span class="w"> </span><span class="kn">import</span> <span class="n">Minio</span>
<span class="n">client</span> <span class="o">=</span> <span class="n">Minio</span><span class="p">(</span><span class="s1">&#39;play.min.io&#39;</span><span class="p">,</span> <span class="n">access_key</span><span class="o">=</span><span class="s1">&#39;...&#39;</span><span class="p">,</span> <span class="n">secret_key</span><span class="o">=</span><span class="s1">&#39;...&#39;</span><span class="p">)</span>
<span class="n">minio_download_file</span><span class="p">(</span><span class="n">client</span><span class="p">,</span> <span class="s1">&#39;mybucket&#39;</span><span class="p">,</span> <span class="s1">&#39;data.csv&#39;</span><span class="p">,</span> <span class="s1">&#39;./downloaded.csv&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>

        <details class="quote">
          <summary>Source code in <code>hydroutils/hydro_s3.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">minio_download_file</span><span class="p">(</span>
    <span class="n">client</span><span class="p">:</span> <span class="n">Minio</span><span class="p">,</span> <span class="n">bucket_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">object_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">version_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Downloads a file from MinIO S3-compatible storage.</span>

<span class="sd">    Downloads an object from S3 and saves it to a local file. Handles UTF-8 encoded text files.</span>

<span class="sd">    Args:</span>
<span class="sd">        client: MinIO client instance.</span>
<span class="sd">        bucket_name: Name of the bucket containing the object.</span>
<span class="sd">        object_name: Name of the object to download.</span>
<span class="sd">        file_path: Local path where the file should be saved.</span>
<span class="sd">        version_id: Optional version ID for versioned objects.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        from minio import Minio</span>
<span class="sd">        client = Minio(&#39;play.min.io&#39;, access_key=&#39;...&#39;, secret_key=&#39;...&#39;)</span>
<span class="sd">        minio_download_file(client, &#39;mybucket&#39;, &#39;data.csv&#39;, &#39;./downloaded.csv&#39;)</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">get_object</span><span class="p">(</span><span class="n">bucket_name</span><span class="p">,</span> <span class="n">object_name</span><span class="p">,</span> <span class="n">version_id</span><span class="p">)</span>
        <span class="n">res_csv</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf8&quot;</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s2">&quot;w+&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
            <span class="n">fp</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">res_csv</span><span class="p">)</span>
    <span class="k">finally</span><span class="p">:</span>
        <span class="n">response</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">response</span><span class="o">.</span><span class="n">release_conn</span><span class="p">()</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="hydroutils.hydro_s3.minio_upload_file" class="doc doc-heading">
<code class="highlight language-python"><span class="n">minio_upload_file</span><span class="p">(</span><span class="n">client</span><span class="p">,</span> <span class="n">bucket_name</span><span class="p">,</span> <span class="n">object_name</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span></code>


<a href="#hydroutils.hydro_s3.minio_upload_file" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Uploads a file to MinIO S3-compatible storage.</p>
<p>Creates the bucket if it doesn't exist, uploads the file, and returns a list of
all objects in the bucket.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>client</code></td>
        <td><code>Minio</code></td>
        <td><p>MinIO client instance.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>bucket_name</code></td>
        <td><code>str</code></td>
        <td><p>Name of the bucket to upload to.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>object_name</code></td>
        <td><code>str</code></td>
        <td><p>Name to give the object in S3.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>file_path</code></td>
        <td><code>str</code></td>
        <td><p>Local path of the file to upload.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>list</code></td>
      <td><p>List of object names in the bucket after upload.</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">minio</span><span class="w"> </span><span class="kn">import</span> <span class="n">Minio</span>
<span class="n">client</span> <span class="o">=</span> <span class="n">Minio</span><span class="p">(</span><span class="s1">&#39;play.min.io&#39;</span><span class="p">,</span> <span class="n">access_key</span><span class="o">=</span><span class="s1">&#39;...&#39;</span><span class="p">,</span> <span class="n">secret_key</span><span class="o">=</span><span class="s1">&#39;...&#39;</span><span class="p">)</span>
<span class="n">objects</span> <span class="o">=</span> <span class="n">minio_upload_file</span><span class="p">(</span><span class="n">client</span><span class="p">,</span> <span class="s1">&#39;mybucket&#39;</span><span class="p">,</span> <span class="s1">&#39;data.csv&#39;</span><span class="p">,</span> <span class="s1">&#39;./data.csv&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Bucket contents: </span><span class="si">{</span><span class="n">objects</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>

        <details class="quote">
          <summary>Source code in <code>hydroutils/hydro_s3.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">minio_upload_file</span><span class="p">(</span><span class="n">client</span><span class="p">:</span> <span class="n">Minio</span><span class="p">,</span> <span class="n">bucket_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">object_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Uploads a file to MinIO S3-compatible storage.</span>

<span class="sd">    Creates the bucket if it doesn&#39;t exist, uploads the file, and returns a list of</span>
<span class="sd">    all objects in the bucket.</span>

<span class="sd">    Args:</span>
<span class="sd">        client: MinIO client instance.</span>
<span class="sd">        bucket_name: Name of the bucket to upload to.</span>
<span class="sd">        object_name: Name to give the object in S3.</span>
<span class="sd">        file_path: Local path of the file to upload.</span>

<span class="sd">    Returns:</span>
<span class="sd">        List of object names in the bucket after upload.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        from minio import Minio</span>
<span class="sd">        client = Minio(&#39;play.min.io&#39;, access_key=&#39;...&#39;, secret_key=&#39;...&#39;)</span>
<span class="sd">        objects = minio_upload_file(client, &#39;mybucket&#39;, &#39;data.csv&#39;, &#39;./data.csv&#39;)</span>
<span class="sd">        print(f&quot;Bucket contents: {objects}&quot;)</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Make a bucket</span>
    <span class="n">bucket_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">bucket</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">bucket</span> <span class="ow">in</span> <span class="n">client</span><span class="o">.</span><span class="n">list_buckets</span><span class="p">()]</span>
    <span class="k">if</span> <span class="n">bucket_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">bucket_names</span><span class="p">:</span>
        <span class="n">client</span><span class="o">.</span><span class="n">make_bucket</span><span class="p">(</span><span class="n">bucket_name</span><span class="p">)</span>
    <span class="c1"># Upload an object</span>
    <span class="n">client</span><span class="o">.</span><span class="n">fput_object</span><span class="p">(</span><span class="n">bucket_name</span><span class="p">,</span> <span class="n">object_name</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span>
    <span class="c1"># List objects</span>
    <span class="n">objects</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">list_objects</span><span class="p">(</span><span class="n">bucket_name</span><span class="p">,</span> <span class="n">recursive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">obj</span><span class="o">.</span><span class="n">object_name</span> <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">objects</span><span class="p">]</span>
</code></pre></div>
        </details>
    </div>

  </div>






  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h2 id="hydroutils.hydro_stat" class="doc doc-heading">
        <code>hydro_stat</code>



<a href="#hydroutils.hydro_stat" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Author: MHPI group, Wenyu Ouyang
Date: 2021-12-31 11:08:29
LastEditTime: 2025-01-06 19:47:33
LastEditors: Wenyu Ouyang
Description: statistics calculation
FilePath: /hydroutils/hydroutils/hydro_stat.py
Copyright (c) 2021-2022 MHPI group, Wenyu Ouyang. All rights reserved.</p>



  <div class="doc doc-children">









  <div class="doc doc-object doc-function">



<h3 id="hydroutils.hydro_stat.KGE" class="doc doc-heading">
<code class="highlight language-python"><span class="n">KGE</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">xo</span><span class="p">)</span></code>


<a href="#hydroutils.hydro_stat.KGE" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Calculates Kling-Gupta Efficiency between simulated and observed values.</p>
<p>KGE combines correlation, bias, and variability to evaluate model performance.
KGE = 1 - sqrt((r-1) + (-1) + (-1))
where:
- r is Pearson correlation
-  is ratio of simulated to observed standard deviation
-  is ratio of simulated to observed mean</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>xs</code></td>
        <td><code>ndarray</code></td>
        <td><p>Simulated values.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>xo</code></td>
        <td><code>ndarray</code></td>
        <td><p>Observed values.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>float</code></td>
      <td><p>KGE score (- to 1, where 1 is perfect).</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">obs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="n">sim</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">2.1</span><span class="p">,</span> <span class="mf">2.9</span><span class="p">,</span> <span class="mf">4.2</span><span class="p">,</span> <span class="mf">5.1</span><span class="p">])</span>
<span class="n">kge</span> <span class="o">=</span> <span class="n">KGE</span><span class="p">(</span><span class="n">sim</span><span class="p">,</span> <span class="n">obs</span><span class="p">)</span>  <span class="c1"># Returns value close to 1</span>
</code></pre></div></td></tr></table></div>
      <p>!!! note
    Based on Gupta et al. (2009), doi:10.1016/j.jhydrol.2009.08.003</p>

        <details class="quote">
          <summary>Source code in <code>hydroutils/hydro_stat.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">KGE</span><span class="p">(</span><span class="n">xs</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">xo</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculates Kling-Gupta Efficiency between simulated and observed values.</span>

<span class="sd">    KGE combines correlation, bias, and variability to evaluate model performance.</span>
<span class="sd">    KGE = 1 - sqrt((r-1) + (-1) + (-1))</span>
<span class="sd">    where:</span>
<span class="sd">    - r is Pearson correlation</span>
<span class="sd">    -  is ratio of simulated to observed standard deviation</span>
<span class="sd">    -  is ratio of simulated to observed mean</span>

<span class="sd">    Args:</span>
<span class="sd">        xs: Simulated values.</span>
<span class="sd">        xo: Observed values.</span>

<span class="sd">    Returns:</span>
<span class="sd">        KGE score (- to 1, where 1 is perfect).</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        obs = np.array([1, 2, 3, 4, 5])</span>
<span class="sd">        sim = np.array([1.1, 2.1, 2.9, 4.2, 5.1])</span>
<span class="sd">        kge = KGE(sim, obs)  # Returns value close to 1</span>
<span class="sd">        ```</span>

<span class="sd">    Note:</span>
<span class="sd">        Based on Gupta et al. (2009), doi:10.1016/j.jhydrol.2009.08.003</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">corrcoef</span><span class="p">(</span><span class="n">xo</span><span class="p">,</span> <span class="n">xs</span><span class="p">)[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
    <span class="n">alpha</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">xs</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">xo</span><span class="p">)</span>
    <span class="n">beta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">xs</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">xo</span><span class="p">)</span>
    <span class="k">return</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">r</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">alpha</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">beta</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="hydroutils.hydro_stat.cal_4_stat_inds" class="doc doc-heading">
<code class="highlight language-python"><span class="n">cal_4_stat_inds</span><span class="p">(</span><span class="n">b</span><span class="p">)</span></code>


<a href="#hydroutils.hydro_stat.cal_4_stat_inds" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Calculates four basic statistical indices for an array.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>b</code></td>
        <td><code>ndarray</code></td>
        <td><p>Input array of numerical values.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>List[float]</code></td>
      <td><p>List containing [10th percentile, 90th percentile, mean, standard deviation].
If std &lt; 0.001, returns 1 for std to avoid numerical issues.</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>
<span class="n">p10</span><span class="p">,</span> <span class="n">p90</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">std</span> <span class="o">=</span> <span class="n">cal_4_stat_inds</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mean: </span><span class="si">{</span><span class="n">mean</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">, Std: </span><span class="si">{</span><span class="n">std</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;10th-90th percentile range: [</span><span class="si">{</span><span class="n">p10</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">p90</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">]&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>

        <details class="quote">
          <summary>Source code in <code>hydroutils/hydro_stat.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">cal_4_stat_inds</span><span class="p">(</span><span class="n">b</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculates four basic statistical indices for an array.</span>

<span class="sd">    Args:</span>
<span class="sd">        b: Input array of numerical values.</span>

<span class="sd">    Returns:</span>
<span class="sd">        List containing [10th percentile, 90th percentile, mean, standard deviation].</span>
<span class="sd">        If std &lt; 0.001, returns 1 for std to avoid numerical issues.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        data = np.array([1, 2, 3, 4, 5, 6, 7, 8, 9, 10])</span>
<span class="sd">        p10, p90, mean, std = cal_4_stat_inds(data)</span>
<span class="sd">        print(f&quot;Mean: {mean:.1f}, Std: {std:.1f}&quot;)</span>
<span class="sd">        print(f&quot;10th-90th percentile range: [{p10:.1f}, {p90:.1f}]&quot;)</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">p10</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
    <span class="n">p90</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="mi">90</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
    <span class="n">mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
    <span class="n">std</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">std</span> <span class="o">&lt;</span> <span class="mf">0.001</span><span class="p">:</span>
        <span class="n">std</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">p10</span><span class="p">,</span> <span class="n">p90</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">std</span><span class="p">]</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="hydroutils.hydro_stat.cal_fdc" class="doc doc-heading">
<code class="highlight language-python"><span class="n">cal_fdc</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">quantile_num</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span></code>


<a href="#hydroutils.hydro_stat.cal_fdc" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Calculates flow duration curves for multiple time series.</p>
<p>For each location/grid point, computes a flow duration curve by sorting flows
from highest to lowest and selecting evenly spaced quantiles.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>data</code></td>
        <td><code>ndarray</code></td>
        <td><p>Flow data array of shape [n_locations, n_timesteps].</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>quantile_num</code></td>
        <td><code>int</code></td>
        <td><p>Number of quantile points to compute. Defaults to 100.</p></td>
        <td><code>100</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>ndarray</code></td>
      <td><p>Array of shape [n_locations, quantile_num] containing flow duration curves.
Each row represents the FDC for one location.</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>Exception</code></td>
        <td><p>If output flow array length doesn't match quantile_num.</p></td>
      </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1"># Flow data for 2 locations, 365 days</span>
<span class="n">flows</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">lognormal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">365</span><span class="p">))</span>

<span class="c1"># Calculate FDCs with 100 points</span>
<span class="n">fdcs</span> <span class="o">=</span> <span class="n">cal_fdc</span><span class="p">(</span><span class="n">flows</span><span class="p">,</span> <span class="n">quantile_num</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>

<span class="c1"># Plot first FDC</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="n">fdcs</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Exceedance Probability (%)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Flow&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      <p>!!! note
    - Handles NaN values by removing them
    - For locations with no valid data, returns zeros
    - Flow values are sorted from highest to lowest</p>

        <details class="quote">
          <summary>Source code in <code>hydroutils/hydro_stat.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">cal_fdc</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">quantile_num</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculates flow duration curves for multiple time series.</span>

<span class="sd">    For each location/grid point, computes a flow duration curve by sorting flows</span>
<span class="sd">    from highest to lowest and selecting evenly spaced quantiles.</span>

<span class="sd">    Args:</span>
<span class="sd">        data: Flow data array of shape [n_locations, n_timesteps].</span>
<span class="sd">        quantile_num: Number of quantile points to compute. Defaults to 100.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Array of shape [n_locations, quantile_num] containing flow duration curves.</span>
<span class="sd">        Each row represents the FDC for one location.</span>

<span class="sd">    Raises:</span>
<span class="sd">        Exception: If output flow array length doesn&#39;t match quantile_num.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        # Flow data for 2 locations, 365 days</span>
<span class="sd">        flows = np.random.lognormal(0, 1, (2, 365))</span>

<span class="sd">        # Calculate FDCs with 100 points</span>
<span class="sd">        fdcs = cal_fdc(flows, quantile_num=100)</span>

<span class="sd">        # Plot first FDC</span>
<span class="sd">        plt.plot(np.linspace(0, 100, 100), fdcs[0])</span>
<span class="sd">        plt.xlabel(&#39;Exceedance Probability (%)&#39;)</span>
<span class="sd">        plt.ylabel(&#39;Flow&#39;)</span>
<span class="sd">        ```</span>

<span class="sd">    Note:</span>
<span class="sd">        - Handles NaN values by removing them</span>
<span class="sd">        - For locations with no valid data, returns zeros</span>
<span class="sd">        - Flow values are sorted from highest to lowest</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># data = n_grid * n_day</span>
    <span class="n">n_grid</span><span class="p">,</span> <span class="n">n_day</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span>
    <span class="n">fdc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">([</span><span class="n">n_grid</span><span class="p">,</span> <span class="n">quantile_num</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_grid</span><span class="p">):</span>
        <span class="n">temp_data0</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">ii</span><span class="p">,</span> <span class="p">:]</span>
        <span class="n">temp_data</span> <span class="o">=</span> <span class="n">temp_data0</span><span class="p">[</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">temp_data0</span><span class="p">)]</span>
        <span class="c1"># deal with no data case for some gages</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">temp_data</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">temp_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">n_day</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="c1"># sort from large to small</span>
        <span class="n">temp_sort</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">temp_data</span><span class="p">)[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="c1"># select quantile_num quantile points</span>
        <span class="n">n_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">temp_data</span><span class="p">)</span>
        <span class="n">ind</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">quantile_num</span><span class="p">)</span> <span class="o">/</span> <span class="n">quantile_num</span> <span class="o">*</span> <span class="n">n_len</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
        <span class="n">fdc_flow</span> <span class="o">=</span> <span class="n">temp_sort</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">fdc_flow</span><span class="p">)</span> <span class="o">!=</span> <span class="n">quantile_num</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;unknown assimilation variable&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">fdc</span><span class="p">[</span><span class="n">ii</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">fdc_flow</span>

    <span class="k">return</span> <span class="n">fdc</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="hydroutils.hydro_stat.cal_stat" class="doc doc-heading">
<code class="highlight language-python"><span class="n">cal_stat</span><span class="p">(</span><span class="n">x</span><span class="p">)</span></code>


<a href="#hydroutils.hydro_stat.cal_stat" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Calculates basic statistics for an array, ignoring NaN values.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>x</code></td>
        <td><code>ndarray</code></td>
        <td><p>Input array. Can contain NaN values.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>List[float]</code></td>
      <td><p>List containing [10th percentile, 90th percentile, mean, standard deviation].
If array is empty or all NaN, returns statistics for [0].</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="n">stats</span> <span class="o">=</span> <span class="n">cal_stat</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>  <span class="c1"># Calculates stats ignoring NaN</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mean (excluding NaN): </span><span class="si">{</span><span class="n">stats</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>

        <details class="quote">
          <summary>Source code in <code>hydroutils/hydro_stat.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">cal_stat</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculates basic statistics for an array, ignoring NaN values.</span>

<span class="sd">    Args:</span>
<span class="sd">        x: Input array. Can contain NaN values.</span>

<span class="sd">    Returns:</span>
<span class="sd">        List containing [10th percentile, 90th percentile, mean, standard deviation].</span>
<span class="sd">        If array is empty or all NaN, returns statistics for [0].</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        data = np.array([1, 2, np.nan, 4, 5])</span>
<span class="sd">        stats = cal_stat(data)  # Calculates stats ignoring NaN</span>
<span class="sd">        print(f&quot;Mean (excluding NaN): {stats[2]:.1f}&quot;)</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">a</span><span class="p">)]</span>
    <span class="k">if</span> <span class="n">b</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="c1"># if b is [], then give it a 0 value</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">cal_4_stat_inds</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="hydroutils.hydro_stat.cal_stat_gamma" class="doc doc-heading">
<code class="highlight language-python"><span class="n">cal_stat_gamma</span><span class="p">(</span><span class="n">x</span><span class="p">)</span></code>


<a href="#hydroutils.hydro_stat.cal_stat_gamma" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Transforms data to approximate normal distribution and calculates statistics.</p>
<p>Applies a transformation (log10(sqrt(x) + 0.1)) to handle gamma-distributed data
like streamflow, precipitation, and evapotranspiration.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>x</code></td>
        <td><code>ndarray</code></td>
        <td><p>Input array, typically daily hydrology data.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>List[float]</code></td>
      <td><p>List containing [10th percentile, 90th percentile, mean, standard deviation]
of the transformed data.</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">flow</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">])</span>  <span class="c1"># Gamma-like distribution</span>
<span class="n">stats</span> <span class="o">=</span> <span class="n">cal_stat_gamma</span><span class="p">(</span><span class="n">flow</span><span class="p">)</span>  <span class="c1"># Stats of transformed data</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mean of transformed data: </span><span class="si">{</span><span class="n">stats</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      <p>!!! note
    - Ignores NaN values
    - Transformation: log10(sqrt(x) + 0.1)
    - Suitable for positively skewed data</p>

        <details class="quote">
          <summary>Source code in <code>hydroutils/hydro_stat.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">cal_stat_gamma</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Transforms data to approximate normal distribution and calculates statistics.</span>

<span class="sd">    Applies a transformation (log10(sqrt(x) + 0.1)) to handle gamma-distributed data</span>
<span class="sd">    like streamflow, precipitation, and evapotranspiration.</span>

<span class="sd">    Args:</span>
<span class="sd">        x: Input array, typically daily hydrology data.</span>

<span class="sd">    Returns:</span>
<span class="sd">        List containing [10th percentile, 90th percentile, mean, standard deviation]</span>
<span class="sd">        of the transformed data.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        flow = np.array([0.1, 0.5, 1.0, 2.0, 5.0])  # Gamma-like distribution</span>
<span class="sd">        stats = cal_stat_gamma(flow)  # Stats of transformed data</span>
<span class="sd">        print(f&quot;Mean of transformed data: {stats[2]:.2f}&quot;)</span>
<span class="sd">        ```</span>

<span class="sd">    Note:</span>
<span class="sd">        - Ignores NaN values</span>
<span class="sd">        - Transformation: log10(sqrt(x) + 0.1)</span>
<span class="sd">        - Suitable for positively skewed data</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">a</span><span class="p">)]</span>  <span class="c1"># kick out Nan</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span>
        <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.1</span>
    <span class="p">)</span>  <span class="c1"># do some tranformation to change gamma characteristics</span>
    <span class="k">return</span> <span class="n">cal_4_stat_inds</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="hydroutils.hydro_stat.cal_stat_prcp_norm" class="doc doc-heading">
<code class="highlight language-python"><span class="n">cal_stat_prcp_norm</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">meanprep</span><span class="p">)</span></code>


<a href="#hydroutils.hydro_stat.cal_stat_prcp_norm" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Normalizes data by mean precipitation and calculates statistics.</p>
<p>Divides data by mean precipitation to remove rainfall magnitude influence,
reducing bias between dry and wet basins. Then applies gamma transformation
and calculates statistics.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>x</code></td>
        <td><code>ndarray</code></td>
        <td><p>Data to normalize, typically hydrological variables.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>meanprep</code></td>
        <td><code>ndarray</code></td>
        <td><p>Mean precipitation for each location/basin.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>List[float]</code></td>
      <td><p>List containing [10th percentile, 90th percentile, mean, standard deviation]
of the normalized and transformed data.</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">flow</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">3.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">]])</span>  <span class="c1"># 2 basins, 2 timesteps</span>
<span class="n">mean_precip</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">])</span>  <span class="c1"># Mean annual precip for each basin</span>
<span class="n">stats</span> <span class="o">=</span> <span class="n">cal_stat_prcp_norm</span><span class="p">(</span><span class="n">flow</span><span class="p">,</span> <span class="n">mean_precip</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mean of normalized data: </span><span class="si">{</span><span class="n">stats</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      <p>!!! note
    - Normalizes by precipitation: x / meanprep
    - Then applies gamma transformation
    - Useful for comparing basins with different rainfall regimes</p>

        <details class="quote">
          <summary>Source code in <code>hydroutils/hydro_stat.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">cal_stat_prcp_norm</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">meanprep</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Normalizes data by mean precipitation and calculates statistics.</span>

<span class="sd">    Divides data by mean precipitation to remove rainfall magnitude influence,</span>
<span class="sd">    reducing bias between dry and wet basins. Then applies gamma transformation</span>
<span class="sd">    and calculates statistics.</span>

<span class="sd">    Args:</span>
<span class="sd">        x: Data to normalize, typically hydrological variables.</span>
<span class="sd">        meanprep: Mean precipitation for each location/basin.</span>

<span class="sd">    Returns:</span>
<span class="sd">        List containing [10th percentile, 90th percentile, mean, standard deviation]</span>
<span class="sd">        of the normalized and transformed data.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        flow = np.array([[1.0, 2.0], [3.0, 4.0]])  # 2 basins, 2 timesteps</span>
<span class="sd">        mean_precip = np.array([100, 200])  # Mean annual precip for each basin</span>
<span class="sd">        stats = cal_stat_prcp_norm(flow, mean_precip)</span>
<span class="sd">        print(f&quot;Mean of normalized data: {stats[2]:.3f}&quot;)</span>
<span class="sd">        ```</span>

<span class="sd">    Note:</span>
<span class="sd">        - Normalizes by precipitation: x / meanprep</span>
<span class="sd">        - Then applies gamma transformation</span>
<span class="sd">        - Useful for comparing basins with different rainfall regimes</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># meanprep = readAttr(gageDict[&#39;id&#39;], [&#39;q_mean&#39;])</span>
    <span class="n">tempprep</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">meanprep</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
    <span class="c1"># unit (mm/day)/(mm/day)</span>
    <span class="n">flowua</span> <span class="o">=</span> <span class="n">x</span> <span class="o">/</span> <span class="n">tempprep</span>
    <span class="k">return</span> <span class="n">cal_stat_gamma</span><span class="p">(</span><span class="n">flowua</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="hydroutils.hydro_stat.ecdf" class="doc doc-heading">
<code class="highlight language-python"><span class="n">ecdf</span><span class="p">(</span><span class="n">data</span><span class="p">)</span></code>


<a href="#hydroutils.hydro_stat.ecdf" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Computes empirical cumulative distribution function (ECDF).</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>data</code></td>
        <td><code>ndarray</code></td>
        <td><p>Input array of values.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Tuple[numpy.ndarray, numpy.ndarray]</code></td>
      <td><p>Tuple of (sorted_values, cumulative_probabilities).</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">ecdf</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="c1"># x = [1, 2, 2, 3, 4, 4, 5]  # Sorted values</span>
<span class="c1"># y  [0.14, 0.29, 0.43, 0.57, 0.71, 0.86, 1.0]  # Probabilities</span>
</code></pre></div></td></tr></table></div>

        <details class="quote">
          <summary>Source code in <code>hydroutils/hydro_stat.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">ecdf</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Computes empirical cumulative distribution function (ECDF).</span>

<span class="sd">    Args:</span>
<span class="sd">        data: Input array of values.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Tuple of (sorted_values, cumulative_probabilities).</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        data = np.array([1, 2, 2, 3, 4, 4, 5])</span>
<span class="sd">        x, y = ecdf(data)</span>
<span class="sd">        # x = [1, 2, 2, 3, 4, 4, 5]  # Sorted values</span>
<span class="sd">        # y  [0.14, 0.29, 0.43, 0.57, 0.71, 0.86, 1.0]  # Probabilities</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">size</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">n</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="hydroutils.hydro_stat.fms" class="doc doc-heading">
<code class="highlight language-python"><span class="n">fms</span><span class="p">(</span><span class="n">obs</span><span class="p">,</span> <span class="n">sim</span><span class="p">,</span> <span class="n">lower</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">upper</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span></code>


<a href="#hydroutils.hydro_stat.fms" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Calculates the slope of the middle section of the flow duration curve.</p>
<p>Computes the bias in the slope of the middle section of the flow duration curve (FDC)
between simulated and observed flows. The middle section is defined by the lower
and upper percentiles.</p>
<p>The formula used is:
BiasFMS = (|log(Qs_lower) - log(Qs_upper)| - |log(Qo_lower) - log(Qo_upper)|) /
          |log(Qs_lower) - log(Qs_upper)|  100</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>obs</code></td>
        <td><code>ndarray</code></td>
        <td><p>Observed flow time series.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>sim</code></td>
        <td><code>ndarray</code></td>
        <td><p>Simulated flow time series.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>lower</code></td>
        <td><code>float</code></td>
        <td><p>Lower percentile bound (0-1). Defaults to 0.2 (20th percentile).</p></td>
        <td><code>0.2</code></td>
      </tr>
      <tr>
        <td><code>upper</code></td>
        <td><code>float</code></td>
        <td><p>Upper percentile bound (0-1). Defaults to 0.7 (70th percentile).</p></td>
        <td><code>0.7</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>float</code></td>
      <td><p>Percentage bias in the FDC slope.</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>ValueError</code></td>
        <td><p>If lower/upper bounds are not in range (0,1) or if lower &gt;= upper.</p></td>
      </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">obs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">])</span>
<span class="n">sim</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.2</span><span class="p">,</span> <span class="mf">2.1</span><span class="p">,</span> <span class="mf">2.9</span><span class="p">,</span> <span class="mf">4.2</span><span class="p">,</span> <span class="mf">5.1</span><span class="p">])</span>
<span class="n">bias</span> <span class="o">=</span> <span class="n">fms</span><span class="p">(</span><span class="n">obs</span><span class="p">,</span> <span class="n">sim</span><span class="p">,</span> <span class="n">lower</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">upper</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      <p>!!! note
    Based on Yilmaz et al. (2008), doi:10.1029/2007WR006716</p>

        <details class="quote">
          <summary>Source code in <code>hydroutils/hydro_stat.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">fms</span><span class="p">(</span><span class="n">obs</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">sim</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">lower</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">,</span> <span class="n">upper</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.7</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculates the slope of the middle section of the flow duration curve.</span>

<span class="sd">    Computes the bias in the slope of the middle section of the flow duration curve (FDC)</span>
<span class="sd">    between simulated and observed flows. The middle section is defined by the lower</span>
<span class="sd">    and upper percentiles.</span>

<span class="sd">    The formula used is:</span>
<span class="sd">    BiasFMS = (|log(Qs_lower) - log(Qs_upper)| - |log(Qo_lower) - log(Qo_upper)|) /</span>
<span class="sd">              |log(Qs_lower) - log(Qs_upper)|  100</span>

<span class="sd">    Args:</span>
<span class="sd">        obs: Observed flow time series.</span>
<span class="sd">        sim: Simulated flow time series.</span>
<span class="sd">        lower: Lower percentile bound (0-1). Defaults to 0.2 (20th percentile).</span>
<span class="sd">        upper: Upper percentile bound (0-1). Defaults to 0.7 (70th percentile).</span>

<span class="sd">    Returns:</span>
<span class="sd">        Percentage bias in the FDC slope.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If lower/upper bounds are not in range (0,1) or if lower &gt;= upper.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        obs = np.array([1.0, 2.0, 3.0, 4.0, 5.0])</span>
<span class="sd">        sim = np.array([1.2, 2.1, 2.9, 4.2, 5.1])</span>
<span class="sd">        bias = fms(obs, sim, lower=0.2, upper=0.7)</span>
<span class="sd">        ```</span>

<span class="sd">    Note:</span>
<span class="sd">        Based on Yilmaz et al. (2008), doi:10.1029/2007WR006716</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">obs</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

    <span class="k">if</span> <span class="nb">any</span><span class="p">((</span><span class="n">x</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">x</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">[</span><span class="n">upper</span><span class="p">,</span> <span class="n">lower</span><span class="p">]):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;upper and lower have to be in range ]0,1[&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">lower</span> <span class="o">&gt;=</span> <span class="n">upper</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The lower threshold has to be smaller than the upper.&quot;</span><span class="p">)</span>

    <span class="c1"># get arrays of sorted (descending) discharges</span>
    <span class="n">obs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">obs</span><span class="p">)</span>
    <span class="n">sim</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">sim</span><span class="p">)</span>

    <span class="c1"># for numerical reasons change 0s to 1e-6. Simulations can still contain negatives, so also reset those.</span>
    <span class="n">sim</span><span class="p">[</span><span class="n">sim</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1e-6</span>
    <span class="n">obs</span><span class="p">[</span><span class="n">obs</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1e-6</span>

    <span class="c1"># calculate fms part by part</span>
    <span class="n">qsm_lower</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">sim</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">lower</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">sim</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)])</span>
    <span class="n">qsm_upper</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">sim</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">upper</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">sim</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)])</span>
    <span class="n">qom_lower</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">obs</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">lower</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">obs</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)])</span>
    <span class="n">qom_upper</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">obs</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">upper</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">obs</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)])</span>

    <span class="n">fms</span> <span class="o">=</span> <span class="p">((</span><span class="n">qsm_lower</span> <span class="o">-</span> <span class="n">qsm_upper</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">qom_lower</span> <span class="o">-</span> <span class="n">qom_upper</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span>
        <span class="n">qom_lower</span> <span class="o">-</span> <span class="n">qom_upper</span> <span class="o">+</span> <span class="mf">1e-6</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">fms</span> <span class="o">*</span> <span class="mi">100</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="hydroutils.hydro_stat.mean_peak_timing" class="doc doc-heading">
<code class="highlight language-python"><span class="n">mean_peak_timing</span><span class="p">(</span><span class="n">obs</span><span class="p">,</span> <span class="n">sim</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">resolution</span><span class="o">=</span><span class="s1">&#39;1D&#39;</span><span class="p">,</span> <span class="n">datetime_coord</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#hydroutils.hydro_stat.mean_peak_timing" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Calculates mean difference in peak flow timing between observed and simulated flows.</p>
<p>Uses peak detection to find significant peaks in the observed time series and
compares their timing with corresponding peaks in the simulated series.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>obs</code></td>
        <td><code>ndarray</code></td>
        <td><p>Observed flow time series.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>sim</code></td>
        <td><code>ndarray</code></td>
        <td><p>Simulated flow time series.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>window</code></td>
        <td><code>int</code></td>
        <td><p>Search window size for matching peaks. If None, uses resolution-dependent
defaults (e.g., 3 for daily, 12 for hourly data).</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>resolution</code></td>
        <td><code>str</code></td>
        <td><p>Time step size ('1D' for daily, '1H' for hourly, etc.).</p></td>
        <td><code>&#39;1D&#39;</code></td>
      </tr>
      <tr>
        <td><code>datetime_coord</code></td>
        <td><code>str</code></td>
        <td><p>Name of datetime coordinate. Inferred if not specified.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>float</code></td>
      <td><p>Mean absolute time difference between observed and simulated peaks.</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">obs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>  <span class="c1"># Peak at index 2</span>
<span class="n">sim</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>  <span class="c1"># Peak at index 1</span>
<span class="n">diff</span> <span class="o">=</span> <span class="n">mean_peak_timing</span><span class="p">(</span><span class="n">obs</span><span class="p">,</span> <span class="n">sim</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># Returns 1 (time step difference)</span>
</code></pre></div></td></tr></table></div>
      <p>!!! note
    Based on Kratzert et al. (2020), https://doi.org/10.5194/hess-2020-221
    Peaks are filtered by prominence and minimum distance requirements.</p>

        <details class="quote">
          <summary>Source code in <code>hydroutils/hydro_stat.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">mean_peak_timing</span><span class="p">(</span>
    <span class="n">obs</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">sim</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">window</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">resolution</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;1D&quot;</span><span class="p">,</span>
    <span class="n">datetime_coord</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculates mean difference in peak flow timing between observed and simulated flows.</span>

<span class="sd">    Uses peak detection to find significant peaks in the observed time series and</span>
<span class="sd">    compares their timing with corresponding peaks in the simulated series.</span>

<span class="sd">    Args:</span>
<span class="sd">        obs: Observed flow time series.</span>
<span class="sd">        sim: Simulated flow time series.</span>
<span class="sd">        window: Search window size for matching peaks. If None, uses resolution-dependent</span>
<span class="sd">            defaults (e.g., 3 for daily, 12 for hourly data).</span>
<span class="sd">        resolution: Time step size (&#39;1D&#39; for daily, &#39;1H&#39; for hourly, etc.).</span>
<span class="sd">        datetime_coord: Name of datetime coordinate. Inferred if not specified.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Mean absolute time difference between observed and simulated peaks.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        obs = np.array([1, 2, 5, 2, 1])  # Peak at index 2</span>
<span class="sd">        sim = np.array([1, 4, 2, 1, 1])  # Peak at index 1</span>
<span class="sd">        diff = mean_peak_timing(obs, sim, window=1)  # Returns 1 (time step difference)</span>
<span class="sd">        ```</span>

<span class="sd">    Note:</span>
<span class="sd">        Based on Kratzert et al. (2020), https://doi.org/10.5194/hess-2020-221</span>
<span class="sd">        Peaks are filtered by prominence and minimum distance requirements.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># verify inputs</span>
    <span class="n">_validate_inputs</span><span class="p">(</span><span class="n">obs</span><span class="p">,</span> <span class="n">sim</span><span class="p">)</span>

    <span class="c1"># get time series with only valid observations (scipy&#39;s find_peaks doesn&#39;t guarantee correctness with NaNs)</span>
    <span class="n">obs</span><span class="p">,</span> <span class="n">sim</span> <span class="o">=</span> <span class="n">_mask_valid</span><span class="p">(</span><span class="n">obs</span><span class="p">,</span> <span class="n">sim</span><span class="p">)</span>

    <span class="c1"># heuristic to get indices of peaks and their corresponding height.</span>
    <span class="n">peaks</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">find_peaks</span><span class="p">(</span>
        <span class="n">obs</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">distance</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">prominence</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">obs</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
    <span class="p">)</span>

    <span class="c1"># infer name of datetime index</span>
    <span class="k">if</span> <span class="n">datetime_coord</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">datetime_coord</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">infer_datetime_coord</span><span class="p">(</span><span class="n">obs</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">window</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># infer a reasonable window size</span>
        <span class="n">window</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">utils</span><span class="o">.</span><span class="n">get_frequency_factor</span><span class="p">(</span><span class="s2">&quot;12H&quot;</span><span class="p">,</span> <span class="n">resolution</span><span class="p">)),</span> <span class="mi">3</span><span class="p">)</span>

    <span class="c1"># evaluate timing</span>
    <span class="n">timing_errors</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">peaks</span><span class="p">:</span>
        <span class="c1"># skip peaks at the start and end of the sequence and peaks around missing observations</span>
        <span class="c1"># (NaNs that were removed in obs &amp; sim would result in windows that span too much time).</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="p">(</span><span class="n">idx</span> <span class="o">-</span> <span class="n">window</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
            <span class="ow">or</span> <span class="p">(</span><span class="n">idx</span> <span class="o">+</span> <span class="n">window</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">obs</span><span class="p">))</span>
            <span class="ow">or</span> <span class="p">(</span>
                <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span>
                    <span class="n">obs</span><span class="p">[</span><span class="n">idx</span> <span class="o">-</span> <span class="n">window</span><span class="p">][</span><span class="n">datetime_coord</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
                    <span class="n">obs</span><span class="p">[</span><span class="n">idx</span> <span class="o">+</span> <span class="n">window</span><span class="p">][</span><span class="n">datetime_coord</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
                    <span class="n">freq</span><span class="o">=</span><span class="n">resolution</span><span class="p">,</span>
                <span class="p">)</span><span class="o">.</span><span class="n">size</span>
                <span class="o">!=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">window</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="p">)</span>
        <span class="p">):</span>
            <span class="k">continue</span>

        <span class="c1"># check if the value at idx is a peak (both neighbors must be smaller)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">sim</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">sim</span><span class="p">[</span><span class="n">idx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">sim</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">sim</span><span class="p">[</span><span class="n">idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]):</span>
            <span class="n">peak_sim</span> <span class="o">=</span> <span class="n">sim</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># define peak around idx as the max value inside of the window</span>
            <span class="n">values</span> <span class="o">=</span> <span class="n">sim</span><span class="p">[</span><span class="n">idx</span> <span class="o">-</span> <span class="n">window</span> <span class="p">:</span> <span class="n">idx</span> <span class="o">+</span> <span class="n">window</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
            <span class="n">peak_sim</span> <span class="o">=</span> <span class="n">values</span><span class="p">[</span><span class="n">values</span><span class="o">.</span><span class="n">argmax</span><span class="p">()]</span>

        <span class="c1"># get xarray object of qobs peak, for getting the date and calculating the datetime offset</span>
        <span class="n">peak_obs</span> <span class="o">=</span> <span class="n">obs</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>

        <span class="c1"># calculate the time difference between the peaks</span>
        <span class="n">delta</span> <span class="o">=</span> <span class="n">peak_obs</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="n">datetime_coord</span><span class="p">]</span> <span class="o">-</span> <span class="n">peak_sim</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="n">datetime_coord</span><span class="p">]</span>

        <span class="n">timing_error</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">delta</span><span class="o">.</span><span class="n">values</span> <span class="o">/</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_timedelta</span><span class="p">(</span><span class="n">resolution</span><span class="p">))</span>

        <span class="n">timing_errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">timing_error</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">timing_errors</span><span class="p">)</span> <span class="k">if</span> <span class="n">timing_errors</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="hydroutils.hydro_stat.month_stat_for_daily_df" class="doc doc-heading">
<code class="highlight language-python"><span class="n">month_stat_for_daily_df</span><span class="p">(</span><span class="n">df</span><span class="p">)</span></code>


<a href="#hydroutils.hydro_stat.month_stat_for_daily_df" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Calculates monthly statistics from daily data.</p>
<p>Resamples daily data to monthly frequency using mean values.
Automatically converts index to datetime if needed.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>df</code></td>
        <td><code>DataFrame</code></td>
        <td><p>DataFrame with daily data and datetime index.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>DataFrame</code></td>
      <td><p>DataFrame with monthly statistics (means).</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span>
<span class="normal">9</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1"># Daily flow data</span>
<span class="n">daily</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;flow&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span>  <span class="c1"># 365 values</span>
    <span class="s1">&#39;temp&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span>
<span class="p">},</span> <span class="n">index</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s1">&#39;2023-01-01&#39;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">365</span><span class="p">))</span>

<span class="c1"># Convert to monthly means</span>
<span class="n">monthly</span> <span class="o">=</span> <span class="n">month_stat_for_daily_df</span><span class="p">(</span><span class="n">daily</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of months: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">monthly</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># 12</span>
</code></pre></div></td></tr></table></div>
      <p>!!! note
    Uses pandas resample with 'MS' (month start) frequency
    and mean aggregation.</p>

        <details class="quote">
          <summary>Source code in <code>hydroutils/hydro_stat.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">month_stat_for_daily_df</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculates monthly statistics from daily data.</span>

<span class="sd">    Resamples daily data to monthly frequency using mean values.</span>
<span class="sd">    Automatically converts index to datetime if needed.</span>

<span class="sd">    Args:</span>
<span class="sd">        df: DataFrame with daily data and datetime index.</span>

<span class="sd">    Returns:</span>
<span class="sd">        DataFrame with monthly statistics (means).</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        # Daily flow data</span>
<span class="sd">        daily = pd.DataFrame({</span>
<span class="sd">            &#39;flow&#39;: [1, 2, 3, 4, ...],  # 365 values</span>
<span class="sd">            &#39;temp&#39;: [20, 21, 19, 22, ...]</span>
<span class="sd">        }, index=pd.date_range(&#39;2023-01-01&#39;, periods=365))</span>

<span class="sd">        # Convert to monthly means</span>
<span class="sd">        monthly = month_stat_for_daily_df(daily)</span>
<span class="sd">        print(f&quot;Number of months: {len(monthly)}&quot;)  # 12</span>
<span class="sd">        ```</span>

<span class="sd">    Note:</span>
<span class="sd">        Uses pandas resample with &#39;MS&#39; (month start) frequency</span>
<span class="sd">        and mean aggregation.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># guarantee the index is datetime</span>
    <span class="n">df</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s2">&quot;MS&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="hydroutils.hydro_stat.remove_abnormal_data" class="doc doc-heading">
<code class="highlight language-python"><span class="n">remove_abnormal_data</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">q1</span><span class="o">=</span><span class="mf">1e-05</span><span class="p">,</span> <span class="n">q2</span><span class="o">=</span><span class="mf">0.99999</span><span class="p">)</span></code>


<a href="#hydroutils.hydro_stat.remove_abnormal_data" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Removes extreme values from data using quantile thresholds.</p>
<p>Replaces values below q1 quantile and above q2 quantile with NaN.
Useful for removing outliers and extreme values.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>data</code></td>
        <td><code>ndarray</code></td>
        <td><p>Input data array.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>q1</code></td>
        <td><code>float</code></td>
        <td><p>Lower quantile threshold (0-1). Defaults to 0.00001.</p></td>
        <td><code>1e-05</code></td>
      </tr>
      <tr>
        <td><code>q2</code></td>
        <td><code>float</code></td>
        <td><p>Upper quantile threshold (0-1). Defaults to 0.99999.</p></td>
        <td><code>0.99999</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>ndarray</code></td>
      <td><p>Array with extreme values replaced by NaN.</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1"># Remove extreme values from flow data</span>
<span class="n">flows</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">100.0</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">])</span>
<span class="n">cleaned</span> <span class="o">=</span> <span class="n">remove_abnormal_data</span><span class="p">(</span><span class="n">flows</span><span class="p">,</span> <span class="n">q1</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">q2</span><span class="o">=</span><span class="mf">0.99</span><span class="p">)</span>
<span class="c1"># Very low and very high values become NaN</span>
</code></pre></div></td></tr></table></div>
      <p>!!! note
    - Values &lt;= q1 quantile become NaN
    - Values &gt;= q2 quantile become NaN
    - Useful for pre-processing hydrological data</p>

        <details class="quote">
          <summary>Source code in <code>hydroutils/hydro_stat.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">remove_abnormal_data</span><span class="p">(</span>
    <span class="n">data</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">q1</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.00001</span><span class="p">,</span>
    <span class="n">q2</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.99999</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Removes extreme values from data using quantile thresholds.</span>

<span class="sd">    Replaces values below q1 quantile and above q2 quantile with NaN.</span>
<span class="sd">    Useful for removing outliers and extreme values.</span>

<span class="sd">    Args:</span>
<span class="sd">        data: Input data array.</span>
<span class="sd">        q1: Lower quantile threshold (0-1). Defaults to 0.00001.</span>
<span class="sd">        q2: Upper quantile threshold (0-1). Defaults to 0.99999.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Array with extreme values replaced by NaN.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        # Remove extreme values from flow data</span>
<span class="sd">        flows = np.array([0.1, 1.0, 2.0, 100.0, 1000.0])</span>
<span class="sd">        cleaned = remove_abnormal_data(flows, q1=0.01, q2=0.99)</span>
<span class="sd">        # Very low and very high values become NaN</span>
<span class="sd">        ```</span>

<span class="sd">    Note:</span>
<span class="sd">        - Values &lt;= q1 quantile become NaN</span>
<span class="sd">        - Values &gt;= q2 quantile become NaN</span>
<span class="sd">        - Useful for pre-processing hydrological data</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># remove abnormal data</span>
    <span class="n">data</span><span class="p">[</span><span class="n">data</span> <span class="o">&lt;</span> <span class="n">np</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">q1</span><span class="p">)]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
    <span class="n">data</span><span class="p">[</span><span class="n">data</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">q2</span><span class="p">)]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
    <span class="k">return</span> <span class="n">data</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="hydroutils.hydro_stat.stat_error" class="doc doc-heading">
<code class="highlight language-python"><span class="n">stat_error</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">pred</span><span class="p">,</span> <span class="n">fill_nan</span><span class="o">=</span><span class="s1">&#39;no&#39;</span><span class="p">)</span></code>


<a href="#hydroutils.hydro_stat.stat_error" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Calculates statistical metrics for multiple time series.</p>
<p>Computes error metrics between predicted and target values across multiple basins
or time series, with options for handling NaN values.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>target</code></td>
        <td><code>ndarray</code></td>
        <td><p>Observed values. Shape: [n_basins, n_timesteps].</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>pred</code></td>
        <td><code>ndarray</code></td>
        <td><p>Predicted values. Same shape as target.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>fill_nan</code></td>
        <td><code>str</code></td>
        <td><p>How to handle NaN values:
- "no": Ignore NaN values (default)
- "sum": Sum values in NaN locations
- "mean": Average values in NaN locations
Example: For obs=[1,nan,nan,2] and pred=[0.3,0.3,0.3,1.5]:
- "no" compares [1,2] vs [0.3,1.5]
- "sum" compares [1,2] vs [0.9,1.5]
- "mean" compares [1,2] vs [0.3,1.5]</p></td>
        <td><code>&#39;no&#39;</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Dictionary of metrics</code></td>
      <td><ul>
<li>Bias: Mean error<ul>
<li>RMSE: Root mean square error</li>
<li>ubRMSE: Unbiased RMSE</li>
<li>Corr: Pearson correlation</li>
<li>R2: Coefficient of determination</li>
<li>NSE: Nash-Sutcliffe efficiency</li>
<li>KGE: Kling-Gupta efficiency</li>
<li>FHV: High flow bias (top 2%)</li>
<li>FLV: Low flow bias (bottom 30%)</li>
</ul>
</li>
</ul></td>
    </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>ValueError</code></td>
        <td><p>If inputs have wrong dimensions or invalid fill_nan value.</p></td>
      </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">obs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]])</span>  <span class="c1"># 2 basins, 3 timesteps</span>
<span class="n">pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">2.1</span><span class="p">,</span> <span class="mf">3.1</span><span class="p">],</span> <span class="p">[</span><span class="mf">4.2</span><span class="p">,</span> <span class="mf">5.1</span><span class="p">,</span> <span class="mf">5.9</span><span class="p">]])</span>
<span class="n">metrics</span> <span class="o">=</span> <span class="n">stat_error</span><span class="p">(</span><span class="n">obs</span><span class="p">,</span> <span class="n">pred</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mean RMSE: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">metrics</span><span class="p">[</span><span class="s1">&#39;RMSE&#39;</span><span class="p">])</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>

        <details class="quote">
          <summary>Source code in <code>hydroutils/hydro_stat.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">stat_error</span><span class="p">(</span><span class="n">target</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">pred</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">fill_nan</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;no&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculates statistical metrics for multiple time series.</span>

<span class="sd">    Computes error metrics between predicted and target values across multiple basins</span>
<span class="sd">    or time series, with options for handling NaN values.</span>

<span class="sd">    Args:</span>
<span class="sd">        target: Observed values. Shape: [n_basins, n_timesteps].</span>
<span class="sd">        pred: Predicted values. Same shape as target.</span>
<span class="sd">        fill_nan: How to handle NaN values:</span>
<span class="sd">            - &quot;no&quot;: Ignore NaN values (default)</span>
<span class="sd">            - &quot;sum&quot;: Sum values in NaN locations</span>
<span class="sd">            - &quot;mean&quot;: Average values in NaN locations</span>
<span class="sd">            Example: For obs=[1,nan,nan,2] and pred=[0.3,0.3,0.3,1.5]:</span>
<span class="sd">            - &quot;no&quot; compares [1,2] vs [0.3,1.5]</span>
<span class="sd">            - &quot;sum&quot; compares [1,2] vs [0.9,1.5]</span>
<span class="sd">            - &quot;mean&quot; compares [1,2] vs [0.3,1.5]</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dictionary of metrics:</span>
<span class="sd">            - Bias: Mean error</span>
<span class="sd">            - RMSE: Root mean square error</span>
<span class="sd">            - ubRMSE: Unbiased RMSE</span>
<span class="sd">            - Corr: Pearson correlation</span>
<span class="sd">            - R2: Coefficient of determination</span>
<span class="sd">            - NSE: Nash-Sutcliffe efficiency</span>
<span class="sd">            - KGE: Kling-Gupta efficiency</span>
<span class="sd">            - FHV: High flow bias (top 2%)</span>
<span class="sd">            - FLV: Low flow bias (bottom 30%)</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If inputs have wrong dimensions or invalid fill_nan value.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        obs = np.array([[1, 2, 3], [4, 5, 6]])  # 2 basins, 3 timesteps</span>
<span class="sd">        pred = np.array([[1.1, 2.1, 3.1], [4.2, 5.1, 5.9]])</span>
<span class="sd">        metrics = stat_error(obs, pred)</span>
<span class="sd">        print(f&quot;Mean RMSE: {np.mean(metrics[&#39;RMSE&#39;]):.2f}&quot;)</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">target</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;The input data should be 2-dim, not 3-dim. If you want to calculate metrics for 3-d arrays, please use stat_errors function.&quot;</span>
        <span class="p">)</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">fill_nan</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;fill_nan should be a string.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">target</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="n">pred</span><span class="o">.</span><span class="n">shape</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The shape of target and pred should be the same.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">fill_nan</span> <span class="o">!=</span> <span class="s2">&quot;no&quot;</span><span class="p">:</span>
        <span class="n">each_non_nan_idx</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">all_non_nan_idx</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">target</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
            <span class="n">tmp</span> <span class="o">=</span> <span class="n">target</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">non_nan_idx_tmp</span> <span class="o">=</span> <span class="p">[</span><span class="n">j</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">tmp</span><span class="o">.</span><span class="n">size</span><span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">tmp</span><span class="p">[</span><span class="n">j</span><span class="p">])]</span>
            <span class="n">each_non_nan_idx</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">non_nan_idx_tmp</span><span class="p">)</span>
            <span class="c1"># TODO: now all_non_nan_idx is only set for ET, because of its irregular nan values</span>
            <span class="n">all_non_nan_idx</span> <span class="o">=</span> <span class="n">all_non_nan_idx</span> <span class="o">+</span> <span class="n">non_nan_idx_tmp</span>
            <span class="n">non_nan_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">all_non_nan_idx</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="c1"># some NaN data appear in different dates in different basins, so we have to calculate the metric for each basin</span>
        <span class="c1"># but for ET, it is not very resonable to calculate the metric for each basin in this way, for example,</span>
        <span class="c1"># the non_nan_idx: [1, 9, 17, 33, 41], then there are 16 elements in 17 -&gt; 33, so use all_non_nan_idx is better</span>
        <span class="c1"># hence we don&#39;t use each_non_nan_idx finally</span>
        <span class="n">out_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
            <span class="n">Bias</span><span class="o">=</span><span class="p">[],</span>
            <span class="n">RMSE</span><span class="o">=</span><span class="p">[],</span>
            <span class="n">ubRMSE</span><span class="o">=</span><span class="p">[],</span>
            <span class="n">Corr</span><span class="o">=</span><span class="p">[],</span>
            <span class="n">R2</span><span class="o">=</span><span class="p">[],</span>
            <span class="n">NSE</span><span class="o">=</span><span class="p">[],</span>
            <span class="n">KGE</span><span class="o">=</span><span class="p">[],</span>
            <span class="n">FHV</span><span class="o">=</span><span class="p">[],</span>
            <span class="n">FLV</span><span class="o">=</span><span class="p">[],</span>
        <span class="p">)</span>
    <span class="k">if</span> <span class="n">fill_nan</span> <span class="o">==</span> <span class="s2">&quot;sum&quot;</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">target</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
            <span class="n">tmp</span> <span class="o">=</span> <span class="n">target</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="c1"># non_nan_idx = each_non_nan_idx[i]</span>
            <span class="n">targ_i</span> <span class="o">=</span> <span class="n">tmp</span><span class="p">[</span><span class="n">non_nan_idx</span><span class="p">]</span>
            <span class="n">pred_i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">add</span><span class="o">.</span><span class="n">reduceat</span><span class="p">(</span><span class="n">pred</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">non_nan_idx</span><span class="p">)</span>
            <span class="n">dict_i</span> <span class="o">=</span> <span class="n">stat_error_i</span><span class="p">(</span><span class="n">targ_i</span><span class="p">,</span> <span class="n">pred_i</span><span class="p">)</span>
            <span class="n">out_dict</span><span class="p">[</span><span class="s2">&quot;Bias&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dict_i</span><span class="p">[</span><span class="s2">&quot;Bias&quot;</span><span class="p">])</span>
            <span class="n">out_dict</span><span class="p">[</span><span class="s2">&quot;RMSE&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dict_i</span><span class="p">[</span><span class="s2">&quot;RMSE&quot;</span><span class="p">])</span>
            <span class="n">out_dict</span><span class="p">[</span><span class="s2">&quot;ubRMSE&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dict_i</span><span class="p">[</span><span class="s2">&quot;ubRMSE&quot;</span><span class="p">])</span>
            <span class="n">out_dict</span><span class="p">[</span><span class="s2">&quot;Corr&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dict_i</span><span class="p">[</span><span class="s2">&quot;Corr&quot;</span><span class="p">])</span>
            <span class="n">out_dict</span><span class="p">[</span><span class="s2">&quot;R2&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dict_i</span><span class="p">[</span><span class="s2">&quot;R2&quot;</span><span class="p">])</span>
            <span class="n">out_dict</span><span class="p">[</span><span class="s2">&quot;NSE&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dict_i</span><span class="p">[</span><span class="s2">&quot;NSE&quot;</span><span class="p">])</span>
            <span class="n">out_dict</span><span class="p">[</span><span class="s2">&quot;KGE&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dict_i</span><span class="p">[</span><span class="s2">&quot;KGE&quot;</span><span class="p">])</span>
            <span class="n">out_dict</span><span class="p">[</span><span class="s2">&quot;FHV&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dict_i</span><span class="p">[</span><span class="s2">&quot;FHV&quot;</span><span class="p">])</span>
            <span class="n">out_dict</span><span class="p">[</span><span class="s2">&quot;FLV&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dict_i</span><span class="p">[</span><span class="s2">&quot;FLV&quot;</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">out_dict</span>
    <span class="k">elif</span> <span class="n">fill_nan</span> <span class="o">==</span> <span class="s2">&quot;mean&quot;</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">target</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
            <span class="n">tmp</span> <span class="o">=</span> <span class="n">target</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="c1"># non_nan_idx = each_non_nan_idx[i]</span>
            <span class="n">targ_i</span> <span class="o">=</span> <span class="n">tmp</span><span class="p">[</span><span class="n">non_nan_idx</span><span class="p">]</span>
            <span class="n">pred_i_sum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">add</span><span class="o">.</span><span class="n">reduceat</span><span class="p">(</span><span class="n">pred</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">non_nan_idx</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">non_nan_idx</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">pred</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span>
                <span class="n">idx4mean</span> <span class="o">=</span> <span class="n">non_nan_idx</span> <span class="o">+</span> <span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">pred</span><span class="p">[</span><span class="n">i</span><span class="p">])]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">idx4mean</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">non_nan_idx</span><span class="p">)</span>
            <span class="n">idx_interval</span> <span class="o">=</span> <span class="p">[</span><span class="n">y</span> <span class="o">-</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">idx4mean</span><span class="p">,</span> <span class="n">idx4mean</span><span class="p">[</span><span class="mi">1</span><span class="p">:])]</span>
            <span class="n">pred_i</span> <span class="o">=</span> <span class="n">pred_i_sum</span> <span class="o">/</span> <span class="n">idx_interval</span>
            <span class="n">dict_i</span> <span class="o">=</span> <span class="n">stat_error_i</span><span class="p">(</span><span class="n">targ_i</span><span class="p">,</span> <span class="n">pred_i</span><span class="p">)</span>
            <span class="n">out_dict</span><span class="p">[</span><span class="s2">&quot;Bias&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dict_i</span><span class="p">[</span><span class="s2">&quot;Bias&quot;</span><span class="p">])</span>
            <span class="n">out_dict</span><span class="p">[</span><span class="s2">&quot;RMSE&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dict_i</span><span class="p">[</span><span class="s2">&quot;RMSE&quot;</span><span class="p">])</span>
            <span class="n">out_dict</span><span class="p">[</span><span class="s2">&quot;ubRMSE&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dict_i</span><span class="p">[</span><span class="s2">&quot;ubRMSE&quot;</span><span class="p">])</span>
            <span class="n">out_dict</span><span class="p">[</span><span class="s2">&quot;Corr&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dict_i</span><span class="p">[</span><span class="s2">&quot;Corr&quot;</span><span class="p">])</span>
            <span class="n">out_dict</span><span class="p">[</span><span class="s2">&quot;R2&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dict_i</span><span class="p">[</span><span class="s2">&quot;R2&quot;</span><span class="p">])</span>
            <span class="n">out_dict</span><span class="p">[</span><span class="s2">&quot;NSE&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dict_i</span><span class="p">[</span><span class="s2">&quot;NSE&quot;</span><span class="p">])</span>
            <span class="n">out_dict</span><span class="p">[</span><span class="s2">&quot;KGE&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dict_i</span><span class="p">[</span><span class="s2">&quot;KGE&quot;</span><span class="p">])</span>
            <span class="n">out_dict</span><span class="p">[</span><span class="s2">&quot;FHV&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dict_i</span><span class="p">[</span><span class="s2">&quot;FHV&quot;</span><span class="p">])</span>
            <span class="n">out_dict</span><span class="p">[</span><span class="s2">&quot;FLV&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dict_i</span><span class="p">[</span><span class="s2">&quot;FLV&quot;</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">out_dict</span>
    <span class="n">ngrid</span><span class="p">,</span> <span class="n">nt</span> <span class="o">=</span> <span class="n">pred</span><span class="o">.</span><span class="n">shape</span>
    <span class="c1"># Bias</span>
    <span class="n">Bias</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="n">pred</span> <span class="o">-</span> <span class="n">target</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="c1"># RMSE</span>
    <span class="n">RMSE</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">((</span><span class="n">pred</span> <span class="o">-</span> <span class="n">target</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
    <span class="c1"># ubRMSE</span>
    <span class="n">predMean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="n">pred</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="n">nt</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
    <span class="n">targetMean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="n">nt</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
    <span class="n">predAnom</span> <span class="o">=</span> <span class="n">pred</span> <span class="o">-</span> <span class="n">predMean</span>
    <span class="n">targetAnom</span> <span class="o">=</span> <span class="n">target</span> <span class="o">-</span> <span class="n">targetMean</span>
    <span class="n">ubRMSE</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">((</span><span class="n">predAnom</span> <span class="o">-</span> <span class="n">targetAnom</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
    <span class="c1"># rho R2 NSE</span>
    <span class="n">Corr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">ngrid</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
    <span class="n">R2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">ngrid</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
    <span class="n">NSE</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">ngrid</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
    <span class="n">KGe</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">ngrid</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
    <span class="n">PBiaslow</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">ngrid</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
    <span class="n">PBiashigh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">ngrid</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
    <span class="n">PBias</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">ngrid</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
    <span class="n">num_lowtarget_zero</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ngrid</span><span class="p">):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">pred</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="p">:]</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">target</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="p">:]</span>
        <span class="n">ind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">y</span><span class="p">)))[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">ind</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">xx</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span>
            <span class="n">yy</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span>
            <span class="c1"># percent bias</span>
            <span class="n">PBias</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">xx</span> <span class="o">-</span> <span class="n">yy</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">yy</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>
            <span class="k">if</span> <span class="n">ind</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="c1"># Theoretically at least two points for correlation</span>
                <span class="n">Corr</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">pearsonr</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">yymean</span> <span class="o">=</span> <span class="n">yy</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
                <span class="n">SST</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">yy</span> <span class="o">-</span> <span class="n">yymean</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
                <span class="n">SSReg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">xx</span> <span class="o">-</span> <span class="n">yymean</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
                <span class="n">SSRes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">yy</span> <span class="o">-</span> <span class="n">xx</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
                <span class="n">R2</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">SSRes</span> <span class="o">/</span> <span class="n">SST</span>
                <span class="n">NSE</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">SSRes</span> <span class="o">/</span> <span class="n">SST</span>
                <span class="n">KGe</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">KGE</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">)</span>
            <span class="c1"># FHV the peak flows bias 2%</span>
            <span class="c1"># FLV the low flows bias bottom 30%, log space</span>
            <span class="n">pred_sort</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">xx</span><span class="p">)</span>
            <span class="n">target_sort</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">yy</span><span class="p">)</span>
            <span class="n">indexlow</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="mf">0.3</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">pred_sort</span><span class="p">))</span>
            <span class="n">indexhigh</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="mf">0.98</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">pred_sort</span><span class="p">))</span>
            <span class="n">lowpred</span> <span class="o">=</span> <span class="n">pred_sort</span><span class="p">[:</span><span class="n">indexlow</span><span class="p">]</span>
            <span class="n">highpred</span> <span class="o">=</span> <span class="n">pred_sort</span><span class="p">[</span><span class="n">indexhigh</span><span class="p">:]</span>
            <span class="n">lowtarget</span> <span class="o">=</span> <span class="n">target_sort</span><span class="p">[:</span><span class="n">indexlow</span><span class="p">]</span>
            <span class="n">hightarget</span> <span class="o">=</span> <span class="n">target_sort</span><span class="p">[</span><span class="n">indexhigh</span><span class="p">:]</span>
            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">lowtarget</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">num_lowtarget_zero</span> <span class="o">=</span> <span class="n">num_lowtarget_zero</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="k">with</span> <span class="n">warnings</span><span class="o">.</span><span class="n">catch_warnings</span><span class="p">():</span>
                <span class="c1"># Sometimes the lowtarget is all 0, which will cause a warning</span>
                <span class="c1"># but I know it is not an error, so I ignore it</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="ne">RuntimeWarning</span><span class="p">)</span>
                <span class="n">PBiaslow</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">lowpred</span> <span class="o">-</span> <span class="n">lowtarget</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">lowtarget</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>
            <span class="n">PBiashigh</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">highpred</span> <span class="o">-</span> <span class="n">hightarget</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">hightarget</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>
    <span class="n">outDict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
        <span class="n">Bias</span><span class="o">=</span><span class="n">Bias</span><span class="p">,</span>
        <span class="n">RMSE</span><span class="o">=</span><span class="n">RMSE</span><span class="p">,</span>
        <span class="n">ubRMSE</span><span class="o">=</span><span class="n">ubRMSE</span><span class="p">,</span>
        <span class="n">Corr</span><span class="o">=</span><span class="n">Corr</span><span class="p">,</span>
        <span class="n">R2</span><span class="o">=</span><span class="n">R2</span><span class="p">,</span>
        <span class="n">NSE</span><span class="o">=</span><span class="n">NSE</span><span class="p">,</span>
        <span class="n">KGE</span><span class="o">=</span><span class="n">KGe</span><span class="p">,</span>
        <span class="n">FHV</span><span class="o">=</span><span class="n">PBiashigh</span><span class="p">,</span>
        <span class="n">FLV</span><span class="o">=</span><span class="n">PBiaslow</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="c1"># &quot;The CDF of BFLV will not reach 1.0 because some basins have all zero flow observations for the &quot;</span>
    <span class="c1"># &quot;30% low flow interval, the percent bias can be infinite\n&quot;</span>
    <span class="c1"># &quot;The number of these cases is &quot; + str(num_lowtarget_zero)</span>
    <span class="k">return</span> <span class="n">outDict</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="hydroutils.hydro_stat.stat_error_i" class="doc doc-heading">
<code class="highlight language-python"><span class="n">stat_error_i</span><span class="p">(</span><span class="n">targ_i</span><span class="p">,</span> <span class="n">pred_i</span><span class="p">)</span></code>


<a href="#hydroutils.hydro_stat.stat_error_i" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Calculates multiple error metrics between predicted and target values.</p>
<p>Computes a comprehensive set of error metrics including bias, RMSE, correlation,
and flow-specific metrics.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>targ_i</code></td>
        <td><code>ndarray</code></td>
        <td><p>Target (observed) values.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>pred_i</code></td>
        <td><code>ndarray</code></td>
        <td><p>Predicted (simulated) values.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Dictionary containing</code></td>
      <td><ul>
<li>Bias: Mean error<ul>
<li>RMSE: Root mean square error</li>
<li>ubRMSE: Unbiased RMSE</li>
<li>Corr: Pearson correlation</li>
<li>R2: Coefficient of determination</li>
<li>NSE: Nash-Sutcliffe efficiency</li>
<li>KGE: Kling-Gupta efficiency</li>
<li>FHV: High flow bias (top 2%)</li>
<li>FLV: Low flow bias (bottom 30%)</li>
</ul>
</li>
</ul></td>
    </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>ValueError</code></td>
        <td><p>If input arrays have less than 2 valid points.</p></td>
      </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">target</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="n">pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">2.1</span><span class="p">,</span> <span class="mf">2.9</span><span class="p">,</span> <span class="mf">4.2</span><span class="p">,</span> <span class="mf">5.1</span><span class="p">])</span>
<span class="n">metrics</span> <span class="o">=</span> <span class="n">stat_error_i</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">pred</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;RMSE: </span><span class="si">{</span><span class="n">metrics</span><span class="p">[</span><span class="s1">&#39;RMSE&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>

        <details class="quote">
          <summary>Source code in <code>hydroutils/hydro_stat.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">stat_error_i</span><span class="p">(</span><span class="n">targ_i</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">pred_i</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculates multiple error metrics between predicted and target values.</span>

<span class="sd">    Computes a comprehensive set of error metrics including bias, RMSE, correlation,</span>
<span class="sd">    and flow-specific metrics.</span>

<span class="sd">    Args:</span>
<span class="sd">        targ_i: Target (observed) values.</span>
<span class="sd">        pred_i: Predicted (simulated) values.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dictionary containing:</span>
<span class="sd">            - Bias: Mean error</span>
<span class="sd">            - RMSE: Root mean square error</span>
<span class="sd">            - ubRMSE: Unbiased RMSE</span>
<span class="sd">            - Corr: Pearson correlation</span>
<span class="sd">            - R2: Coefficient of determination</span>
<span class="sd">            - NSE: Nash-Sutcliffe efficiency</span>
<span class="sd">            - KGE: Kling-Gupta efficiency</span>
<span class="sd">            - FHV: High flow bias (top 2%)</span>
<span class="sd">            - FLV: Low flow bias (bottom 30%)</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If input arrays have less than 2 valid points.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        target = np.array([1, 2, 3, 4, 5])</span>
<span class="sd">        pred = np.array([1.1, 2.1, 2.9, 4.2, 5.1])</span>
<span class="sd">        metrics = stat_error_i(target, pred)</span>
<span class="sd">        print(f&quot;RMSE: {metrics[&#39;RMSE&#39;]:.2f}&quot;)</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">pred_i</span><span class="p">),</span> <span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">targ_i</span><span class="p">)))[</span><span class="mi">0</span><span class="p">]</span>
    <span class="c1"># Theoretically at least two points for correlation</span>
    <span class="k">if</span> <span class="n">ind</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">xx</span> <span class="o">=</span> <span class="n">pred_i</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span>
        <span class="n">yy</span> <span class="o">=</span> <span class="n">targ_i</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span>
        <span class="n">bias</span> <span class="o">=</span> <span class="n">he</span><span class="o">.</span><span class="n">me</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">)</span>
        <span class="c1"># RMSE</span>
        <span class="n">rmse</span> <span class="o">=</span> <span class="n">he</span><span class="o">.</span><span class="n">rmse</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">)</span>
        <span class="c1"># ubRMSE</span>
        <span class="n">pred_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="n">xx</span><span class="p">)</span>
        <span class="n">target_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="n">yy</span><span class="p">)</span>
        <span class="n">pred_anom</span> <span class="o">=</span> <span class="n">xx</span> <span class="o">-</span> <span class="n">pred_mean</span>
        <span class="n">target_anom</span> <span class="o">=</span> <span class="n">yy</span> <span class="o">-</span> <span class="n">target_mean</span>
        <span class="n">ubrmse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">((</span><span class="n">pred_anom</span> <span class="o">-</span> <span class="n">target_anom</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span>
        <span class="c1"># rho R2 NSE</span>
        <span class="n">corr</span> <span class="o">=</span> <span class="n">he</span><span class="o">.</span><span class="n">pearson_r</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">)</span>
        <span class="n">r2</span> <span class="o">=</span> <span class="n">he</span><span class="o">.</span><span class="n">r_squared</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">)</span>
        <span class="n">nse</span> <span class="o">=</span> <span class="n">he</span><span class="o">.</span><span class="n">nse</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">)</span>
        <span class="n">kge</span> <span class="o">=</span> <span class="n">he</span><span class="o">.</span><span class="n">kge_2009</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">)</span>
        <span class="c1"># percent bias</span>
        <span class="n">pbias</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">xx</span> <span class="o">-</span> <span class="n">yy</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">yy</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>
        <span class="c1"># FHV the peak flows bias 2%</span>
        <span class="c1"># FLV the low flows bias bottom 30%, log space</span>
        <span class="n">pred_sort</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">xx</span><span class="p">)</span>
        <span class="n">target_sort</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">yy</span><span class="p">)</span>
        <span class="n">indexlow</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="mf">0.3</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">pred_sort</span><span class="p">))</span>
        <span class="n">indexhigh</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="mf">0.98</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">pred_sort</span><span class="p">))</span>
        <span class="n">lowpred</span> <span class="o">=</span> <span class="n">pred_sort</span><span class="p">[:</span><span class="n">indexlow</span><span class="p">]</span>
        <span class="n">highpred</span> <span class="o">=</span> <span class="n">pred_sort</span><span class="p">[</span><span class="n">indexhigh</span><span class="p">:]</span>
        <span class="n">lowtarget</span> <span class="o">=</span> <span class="n">target_sort</span><span class="p">[:</span><span class="n">indexlow</span><span class="p">]</span>
        <span class="n">hightarget</span> <span class="o">=</span> <span class="n">target_sort</span><span class="p">[</span><span class="n">indexhigh</span><span class="p">:]</span>
        <span class="n">pbiaslow</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">lowpred</span> <span class="o">-</span> <span class="n">lowtarget</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">lowtarget</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>
        <span class="n">pbiashigh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">highpred</span> <span class="o">-</span> <span class="n">hightarget</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">hightarget</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>
        <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span>
            <span class="n">Bias</span><span class="o">=</span><span class="n">bias</span><span class="p">,</span>
            <span class="n">RMSE</span><span class="o">=</span><span class="n">rmse</span><span class="p">,</span>
            <span class="n">ubRMSE</span><span class="o">=</span><span class="n">ubrmse</span><span class="p">,</span>
            <span class="n">Corr</span><span class="o">=</span><span class="n">corr</span><span class="p">,</span>
            <span class="n">R2</span><span class="o">=</span><span class="n">r2</span><span class="p">,</span>
            <span class="n">NSE</span><span class="o">=</span><span class="n">nse</span><span class="p">,</span>
            <span class="n">KGE</span><span class="o">=</span><span class="n">kge</span><span class="p">,</span>
            <span class="n">FHV</span><span class="o">=</span><span class="n">pbiashigh</span><span class="p">,</span>
            <span class="n">FLV</span><span class="o">=</span><span class="n">pbiaslow</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;The number of data is less than 2, we don&#39;t calculate the statistics.&quot;</span>
        <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="hydroutils.hydro_stat.stat_errors" class="doc doc-heading">
<code class="highlight language-python"><span class="n">stat_errors</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">pred</span><span class="p">,</span> <span class="n">fill_nan</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#hydroutils.hydro_stat.stat_errors" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Calculates statistical metrics for multiple variables.</p>
<p>Similar to stat_error but handles 3D arrays where the third dimension represents
different variables.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>target</code></td>
        <td><code>ndarray</code></td>
        <td><p>Observed values. Shape: [n_basins, n_timesteps, n_variables].</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>pred</code></td>
        <td><code>ndarray</code></td>
        <td><p>Predicted values. Same shape as target.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>fill_nan</code></td>
        <td><code>List[str]</code></td>
        <td><p>List of NaN handling methods for each variable:
- "no": Ignore NaN values
- "sum": Sum values in NaN locations
- "mean": Average values in NaN locations
If None, defaults to ["no"] for all variables.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>List of dictionaries, one per variable, each containing</code></td>
      <td><ul>
<li>Bias: Mean error<ul>
<li>RMSE: Root mean square error</li>
<li>ubRMSE: Unbiased RMSE</li>
<li>Corr: Pearson correlation</li>
<li>R2: Coefficient of determination</li>
<li>NSE: Nash-Sutcliffe efficiency</li>
<li>KGE: Kling-Gupta efficiency</li>
<li>FHV: High flow bias (top 2%)</li>
<li>FLV: Low flow bias (bottom 30%)</li>
</ul>
</li>
</ul></td>
    </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>ValueError</code></td>
        <td><p>If inputs have wrong dimensions or invalid fill_nan values.</p></td>
      </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1"># 2 basins, 3 timesteps, 2 variables</span>
<span class="n">obs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">6</span><span class="p">]],</span> <span class="p">[[</span><span class="mi">4</span><span class="p">,</span><span class="mi">7</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">8</span><span class="p">],</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span><span class="mi">9</span><span class="p">]]])</span>
<span class="n">pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[[</span><span class="mf">1.1</span><span class="p">,</span><span class="mf">4.1</span><span class="p">],</span> <span class="p">[</span><span class="mf">2.1</span><span class="p">,</span><span class="mf">5.1</span><span class="p">],</span> <span class="p">[</span><span class="mf">3.1</span><span class="p">,</span><span class="mf">6.1</span><span class="p">]],</span>
                <span class="p">[[</span><span class="mf">4.2</span><span class="p">,</span><span class="mf">7.2</span><span class="p">],</span> <span class="p">[</span><span class="mf">5.1</span><span class="p">,</span><span class="mf">8.1</span><span class="p">],</span> <span class="p">[</span><span class="mf">5.9</span><span class="p">,</span><span class="mf">9.1</span><span class="p">]]])</span>
<span class="n">metrics</span> <span class="o">=</span> <span class="n">stat_errors</span><span class="p">(</span><span class="n">obs</span><span class="p">,</span> <span class="n">pred</span><span class="p">,</span> <span class="n">fill_nan</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;no&#39;</span><span class="p">,</span> <span class="s1">&#39;no&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;RMSE for var1: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">metrics</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;RMSE&#39;</span><span class="p">])</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>

        <details class="quote">
          <summary>Source code in <code>hydroutils/hydro_stat.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">stat_errors</span><span class="p">(</span><span class="n">target</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">pred</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">fill_nan</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">dict</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculates statistical metrics for multiple variables.</span>

<span class="sd">    Similar to stat_error but handles 3D arrays where the third dimension represents</span>
<span class="sd">    different variables.</span>

<span class="sd">    Args:</span>
<span class="sd">        target: Observed values. Shape: [n_basins, n_timesteps, n_variables].</span>
<span class="sd">        pred: Predicted values. Same shape as target.</span>
<span class="sd">        fill_nan: List of NaN handling methods for each variable:</span>
<span class="sd">            - &quot;no&quot;: Ignore NaN values</span>
<span class="sd">            - &quot;sum&quot;: Sum values in NaN locations</span>
<span class="sd">            - &quot;mean&quot;: Average values in NaN locations</span>
<span class="sd">            If None, defaults to [&quot;no&quot;] for all variables.</span>

<span class="sd">    Returns:</span>
<span class="sd">        List of dictionaries, one per variable, each containing:</span>
<span class="sd">            - Bias: Mean error</span>
<span class="sd">            - RMSE: Root mean square error</span>
<span class="sd">            - ubRMSE: Unbiased RMSE</span>
<span class="sd">            - Corr: Pearson correlation</span>
<span class="sd">            - R2: Coefficient of determination</span>
<span class="sd">            - NSE: Nash-Sutcliffe efficiency</span>
<span class="sd">            - KGE: Kling-Gupta efficiency</span>
<span class="sd">            - FHV: High flow bias (top 2%)</span>
<span class="sd">            - FLV: Low flow bias (bottom 30%)</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If inputs have wrong dimensions or invalid fill_nan values.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        # 2 basins, 3 timesteps, 2 variables</span>
<span class="sd">        obs = np.array([[[1,4], [2,5], [3,6]], [[4,7], [5,8], [6,9]]])</span>
<span class="sd">        pred = np.array([[[1.1,4.1], [2.1,5.1], [3.1,6.1]],</span>
<span class="sd">                        [[4.2,7.2], [5.1,8.1], [5.9,9.1]]])</span>
<span class="sd">        metrics = stat_errors(obs, pred, fill_nan=[&#39;no&#39;, &#39;no&#39;])</span>
<span class="sd">        print(f&quot;RMSE for var1: {np.mean(metrics[0][&#39;RMSE&#39;]):.2f}&quot;)</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">fill_nan</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">fill_nan</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;no&quot;</span><span class="p">]</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">target</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">3</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;The input data should be 3-dim, not 2-dim. If you want to calculate &quot;</span>
            <span class="s2">&quot;metrics for 2-d arrays, please use stat_error function.&quot;</span>
        <span class="p">)</span>
    <span class="k">if</span> <span class="n">target</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="n">pred</span><span class="o">.</span><span class="n">shape</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The shape of target and pred should be the same.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">fill_nan</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">list</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">fill_nan</span><span class="p">)</span> <span class="o">!=</span> <span class="n">target</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;Please give same length of fill_nan as the number of variables.&quot;</span>
        <span class="p">)</span>
    <span class="n">dict_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">target</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]):</span>
        <span class="n">k_dict</span> <span class="o">=</span> <span class="n">stat_error</span><span class="p">(</span><span class="n">target</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">k</span><span class="p">],</span> <span class="n">pred</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">k</span><span class="p">],</span> <span class="n">fill_nan</span><span class="o">=</span><span class="n">fill_nan</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
        <span class="n">dict_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">k_dict</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">dict_list</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="hydroutils.hydro_stat.trans_norm" class="doc doc-heading">
<code class="highlight language-python"><span class="n">trans_norm</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">var_lst</span><span class="p">,</span> <span class="n">stat_dict</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">to_norm</span><span class="p">)</span></code>


<a href="#hydroutils.hydro_stat.trans_norm" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Normalizes or denormalizes data using pre-computed statistics.</p>
<p>Performs z-score normalization (x-mean)/std or its inverse on multiple variables.
Handles both 2D and 3D arrays.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>x</code></td>
        <td><code>ndarray</code></td>
        <td><p>Input data array:
- 2D: [n_sites, n_variables]
- 3D: [n_sites, n_timesteps, n_variables]</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>var_lst</code></td>
        <td><code>Union[str, list]</code></td>
        <td><p>Variable name(s) corresponding to the last dimension of x.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>stat_dict</code></td>
        <td><code>dict</code></td>
        <td><p>Dictionary containing [p10, p90, mean, std] for each variable.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>to_norm</code></td>
        <td><code>bool</code></td>
        <td><p>If True, normalizes data; if False, denormalizes data.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>ndarray</code></td>
      <td><p>Normalized or denormalized data with same shape as input.</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1"># Normalization</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">200</span><span class="p">]])</span>  <span class="c1"># 2 sites, 2 variables</span>
<span class="n">stats</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;flow&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>    <span class="c1"># [p10, p90, mean, std]</span>
    <span class="s1">&#39;precip&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">50</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">50</span><span class="p">]</span>
<span class="p">}</span>
<span class="n">norm_data</span> <span class="o">=</span> <span class="n">trans_norm</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;flow&#39;</span><span class="p">,</span> <span class="s1">&#39;precip&#39;</span><span class="p">],</span> <span class="n">stats</span><span class="p">,</span> <span class="n">to_norm</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Denormalization</span>
<span class="n">orig_data</span> <span class="o">=</span> <span class="n">trans_norm</span><span class="p">(</span><span class="n">norm_data</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;flow&#39;</span><span class="p">,</span> <span class="s1">&#39;precip&#39;</span><span class="p">],</span> <span class="n">stats</span><span class="p">,</span> <span class="n">to_norm</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      <p>!!! note
    - For normalization: (x - mean) / std
    - For denormalization: x * std + mean
    - Handles multiple variables simultaneously</p>

        <details class="quote">
          <summary>Source code in <code>hydroutils/hydro_stat.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">trans_norm</span><span class="p">(</span>
    <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">var_lst</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">],</span>
    <span class="n">stat_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">to_norm</span><span class="p">:</span> <span class="nb">bool</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Normalizes or denormalizes data using pre-computed statistics.</span>

<span class="sd">    Performs z-score normalization (x-mean)/std or its inverse on multiple variables.</span>
<span class="sd">    Handles both 2D and 3D arrays.</span>

<span class="sd">    Args:</span>
<span class="sd">        x: Input data array:</span>
<span class="sd">            - 2D: [n_sites, n_variables]</span>
<span class="sd">            - 3D: [n_sites, n_timesteps, n_variables]</span>
<span class="sd">        var_lst: Variable name(s) corresponding to the last dimension of x.</span>
<span class="sd">        stat_dict: Dictionary containing [p10, p90, mean, std] for each variable.</span>
<span class="sd">        to_norm: If True, normalizes data; if False, denormalizes data.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Normalized or denormalized data with same shape as input.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        # Normalization</span>
<span class="sd">        data = np.array([[1, 100], [2, 200]])  # 2 sites, 2 variables</span>
<span class="sd">        stats = {</span>
<span class="sd">            &#39;flow&#39;: [0, 5, 1.5, 0.5],    # [p10, p90, mean, std]</span>
<span class="sd">            &#39;precip&#39;: [50, 250, 150, 50]</span>
<span class="sd">        }</span>
<span class="sd">        norm_data = trans_norm(data, [&#39;flow&#39;, &#39;precip&#39;], stats, to_norm=True)</span>

<span class="sd">        # Denormalization</span>
<span class="sd">        orig_data = trans_norm(norm_data, [&#39;flow&#39;, &#39;precip&#39;], stats, to_norm=False)</span>
<span class="sd">        ```</span>

<span class="sd">    Note:</span>
<span class="sd">        - For normalization: (x - mean) / std</span>
<span class="sd">        - For denormalization: x * std + mean</span>
<span class="sd">        - Handles multiple variables simultaneously</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">var_lst</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">var_lst</span> <span class="o">=</span> <span class="p">[</span><span class="n">var_lst</span><span class="p">]</span>
    <span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">var_lst</span><span class="p">)):</span>
        <span class="n">var</span> <span class="o">=</span> <span class="n">var_lst</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
        <span class="n">stat</span> <span class="o">=</span> <span class="n">stat_dict</span><span class="p">[</span><span class="n">var</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">to_norm</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                <span class="n">out</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="n">stat</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">/</span> <span class="n">stat</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">out</span><span class="p">[:,</span> <span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="p">[:,</span> <span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="n">stat</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">/</span> <span class="n">stat</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="n">out</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">k</span><span class="p">]</span> <span class="o">*</span> <span class="n">stat</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">+</span> <span class="n">stat</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">out</span><span class="p">[:,</span> <span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[:,</span> <span class="n">k</span><span class="p">]</span> <span class="o">*</span> <span class="n">stat</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">+</span> <span class="n">stat</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">out</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="hydroutils.hydro_stat.wilcoxon_t_test" class="doc doc-heading">
<code class="highlight language-python"><span class="n">wilcoxon_t_test</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">xo</span><span class="p">)</span></code>


<a href="#hydroutils.hydro_stat.wilcoxon_t_test" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Performs Wilcoxon signed-rank test on paired samples.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>xs</code></td>
        <td><code>ndarray</code></td>
        <td><p>First sample array.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>xo</code></td>
        <td><code>ndarray</code></td>
        <td><p>Second sample array (same length as xs).</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Tuple[float, float]</code></td>
      <td><p>Tuple of (test_statistic, p_value).</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">x1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="n">x2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">2.2</span><span class="p">,</span> <span class="mf">2.9</span><span class="p">,</span> <span class="mf">4.2</span><span class="p">,</span> <span class="mf">5.1</span><span class="p">])</span>
<span class="n">w</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">wilcoxon_t_test</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;p-value: </span><span class="si">{</span><span class="n">p</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># Test significance</span>
</code></pre></div></td></tr></table></div>
      <p>!!! note
    Tests the null hypothesis that two related paired samples
    come from the same distribution.</p>

        <details class="quote">
          <summary>Source code in <code>hydroutils/hydro_stat.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">wilcoxon_t_test</span><span class="p">(</span><span class="n">xs</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">xo</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Performs Wilcoxon signed-rank test on paired samples.</span>

<span class="sd">    Args:</span>
<span class="sd">        xs: First sample array.</span>
<span class="sd">        xo: Second sample array (same length as xs).</span>

<span class="sd">    Returns:</span>
<span class="sd">        Tuple of (test_statistic, p_value).</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        x1 = np.array([1, 2, 3, 4, 5])</span>
<span class="sd">        x2 = np.array([1.1, 2.2, 2.9, 4.2, 5.1])</span>
<span class="sd">        w, p = wilcoxon_t_test(x1, x2)</span>
<span class="sd">        print(f&quot;p-value: {p:.3f}&quot;)  # Test significance</span>
<span class="sd">        ```</span>

<span class="sd">    Note:</span>
<span class="sd">        Tests the null hypothesis that two related paired samples</span>
<span class="sd">        come from the same distribution.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">diff</span> <span class="o">=</span> <span class="n">xs</span> <span class="o">-</span> <span class="n">xo</span>  <span class="c1"># same result when using xo-xs</span>
    <span class="n">w</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">wilcoxon</span><span class="p">(</span><span class="n">diff</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">w</span><span class="p">,</span> <span class="n">p</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="hydroutils.hydro_stat.wilcoxon_t_test_for_lst" class="doc doc-heading">
<code class="highlight language-python"><span class="n">wilcoxon_t_test_for_lst</span><span class="p">(</span><span class="n">x_lst</span><span class="p">,</span> <span class="n">rnd_num</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span></code>


<a href="#hydroutils.hydro_stat.wilcoxon_t_test_for_lst" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Performs pairwise Wilcoxon tests between all arrays in a list.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>x_lst</code></td>
        <td><code>List[numpy.ndarray]</code></td>
        <td><p>List of arrays to compare.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>rnd_num</code></td>
        <td><code>int</code></td>
        <td><p>Number of decimal places to round results. Defaults to 2.</p></td>
        <td><code>2</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Tuple[List[float], List[float]]</code></td>
      <td><p>Tuple of (test_statistics, p_values), where each element is a list of
rounded values for each pairwise comparison.</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">arrays</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]),</span>
    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">2.2</span><span class="p">,</span> <span class="mf">2.9</span><span class="p">,</span> <span class="mf">4.2</span><span class="p">,</span> <span class="mf">5.1</span><span class="p">]),</span>
    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.2</span><span class="p">,</span> <span class="mf">2.1</span><span class="p">,</span> <span class="mf">3.1</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">,</span> <span class="mf">5.2</span><span class="p">])</span>
<span class="p">]</span>
<span class="n">w</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">wilcoxon_t_test_for_lst</span><span class="p">(</span><span class="n">arrays</span><span class="p">)</span>
<span class="c1"># Returns test statistics and p-values for:</span>
<span class="c1"># - arrays[0] vs arrays[1]</span>
<span class="c1"># - arrays[0] vs arrays[2]</span>
<span class="c1"># - arrays[1] vs arrays[2]</span>
</code></pre></div></td></tr></table></div>

        <details class="quote">
          <summary>Source code in <code>hydroutils/hydro_stat.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">wilcoxon_t_test_for_lst</span><span class="p">(</span><span class="n">x_lst</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span> <span class="n">rnd_num</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Performs pairwise Wilcoxon tests between all arrays in a list.</span>

<span class="sd">    Args:</span>
<span class="sd">        x_lst: List of arrays to compare.</span>
<span class="sd">        rnd_num: Number of decimal places to round results. Defaults to 2.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Tuple of (test_statistics, p_values), where each element is a list of</span>
<span class="sd">        rounded values for each pairwise comparison.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        arrays = [</span>
<span class="sd">            np.array([1, 2, 3, 4, 5]),</span>
<span class="sd">            np.array([1.1, 2.2, 2.9, 4.2, 5.1]),</span>
<span class="sd">            np.array([1.2, 2.1, 3.1, 4.0, 5.2])</span>
<span class="sd">        ]</span>
<span class="sd">        w, p = wilcoxon_t_test_for_lst(arrays)</span>
<span class="sd">        # Returns test statistics and p-values for:</span>
<span class="sd">        # - arrays[0] vs arrays[1]</span>
<span class="sd">        # - arrays[0] vs arrays[2]</span>
<span class="sd">        # - arrays[1] vs arrays[2]</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">arr_lst</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">x_lst</span><span class="p">)</span>
    <span class="n">w</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="n">arr_lst_pair</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">combinations</span><span class="p">(</span><span class="n">arr_lst</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">arr_pair</span> <span class="ow">in</span> <span class="n">arr_lst_pair</span><span class="p">:</span>
        <span class="n">wi</span><span class="p">,</span> <span class="n">pi</span> <span class="o">=</span> <span class="n">wilcoxon_t_test</span><span class="p">(</span><span class="n">arr_pair</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">arr_pair</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">w</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">wi</span><span class="p">,</span> <span class="n">rnd_num</span><span class="p">))</span>
        <span class="n">p</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">pi</span><span class="p">,</span> <span class="n">rnd_num</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">w</span><span class="p">,</span> <span class="n">p</span>
</code></pre></div>
        </details>
    </div>

  </div>






  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h2 id="hydroutils.hydro_time" class="doc doc-heading">
        <code>hydro_time</code>



<a href="#hydroutils.hydro_time" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Author: Wenyu Ouyang
Date: 2022-12-02 11:03:04
LastEditTime: 2024-09-14 13:57:36
LastEditors: Wenyu Ouyang
Description: some functions to deal with time
FilePath: /hydroutils/hydroutils/hydro_time.py
Copyright (c) 2023-2024 Wenyu Ouyang. All rights reserved.</p>



  <div class="doc doc-children">








  <div class="doc doc-object doc-function">



<h3 id="hydroutils.hydro_time.assign_time_start_end" class="doc doc-heading">
<code class="highlight language-python"><span class="n">assign_time_start_end</span><span class="p">(</span><span class="n">time_ranges</span><span class="p">,</span> <span class="n">assign_way</span><span class="o">=</span><span class="s1">&#39;intersection&#39;</span><span class="p">)</span></code>


<a href="#hydroutils.hydro_time.assign_time_start_end" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Determines overall start and end times from multiple time ranges.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>time_ranges</code></td>
        <td><code>list</code></td>
        <td><p>List of [start, end] time ranges.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>assign_way</code></td>
        <td><code>str</code></td>
        <td><p>Method to combine ranges:
- "intersection": Use latest start and earliest end
- "union": Use earliest start and latest end</p></td>
        <td><code>&#39;intersection&#39;</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>tuple</code></td>
      <td><p>Tuple of (start_time, end_time).</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>NotImplementedError</code></td>
        <td><p>If assign_way is not "intersection" or "union".</p></td>
      </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">ranges</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="s1">&#39;2023-01-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2023-12-31&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="s1">&#39;2023-03-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2024-02-28&#39;</span><span class="p">]</span>
<span class="p">]</span>

<span class="c1"># Get intersection (common period)</span>
<span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="o">=</span> <span class="n">assign_time_start_end</span><span class="p">(</span><span class="n">ranges</span><span class="p">,</span> <span class="s1">&#39;intersection&#39;</span><span class="p">)</span>
<span class="c1"># Returns (&#39;2023-03-01&#39;, &#39;2023-12-31&#39;)</span>

<span class="c1"># Get union (total span)</span>
<span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="o">=</span> <span class="n">assign_time_start_end</span><span class="p">(</span><span class="n">ranges</span><span class="p">,</span> <span class="s1">&#39;union&#39;</span><span class="p">)</span>
<span class="c1"># Returns (&#39;2023-01-01&#39;, &#39;2024-02-28&#39;)</span>
</code></pre></div></td></tr></table></div>

        <details class="quote">
          <summary>Source code in <code>hydroutils/hydro_time.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">assign_time_start_end</span><span class="p">(</span><span class="n">time_ranges</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">assign_way</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;intersection&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Determines overall start and end times from multiple time ranges.</span>

<span class="sd">    Args:</span>
<span class="sd">        time_ranges: List of [start, end] time ranges.</span>
<span class="sd">        assign_way: Method to combine ranges:</span>
<span class="sd">            - &quot;intersection&quot;: Use latest start and earliest end</span>
<span class="sd">            - &quot;union&quot;: Use earliest start and latest end</span>

<span class="sd">    Returns:</span>
<span class="sd">        Tuple of (start_time, end_time).</span>

<span class="sd">    Raises:</span>
<span class="sd">        NotImplementedError: If assign_way is not &quot;intersection&quot; or &quot;union&quot;.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        ranges = [</span>
<span class="sd">            [&#39;2023-01-01&#39;, &#39;2023-12-31&#39;],</span>
<span class="sd">            [&#39;2023-03-01&#39;, &#39;2024-02-28&#39;]</span>
<span class="sd">        ]</span>

<span class="sd">        # Get intersection (common period)</span>
<span class="sd">        start, end = assign_time_start_end(ranges, &#39;intersection&#39;)</span>
<span class="sd">        # Returns (&#39;2023-03-01&#39;, &#39;2023-12-31&#39;)</span>

<span class="sd">        # Get union (total span)</span>
<span class="sd">        start, end = assign_time_start_end(ranges, &#39;union&#39;)</span>
<span class="sd">        # Returns (&#39;2023-01-01&#39;, &#39;2024-02-28&#39;)</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">assign_way</span> <span class="o">==</span> <span class="s2">&quot;intersection&quot;</span><span class="p">:</span>
        <span class="n">time_start</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">time_ranges</span><span class="p">)</span>
        <span class="n">time_end</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">time_ranges</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">assign_way</span> <span class="o">==</span> <span class="s2">&quot;union&quot;</span><span class="p">:</span>
        <span class="n">time_start</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">time_ranges</span><span class="p">)</span>
        <span class="n">time_end</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">time_ranges</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;We don&#39;t support this assign_way yet&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">time_start</span><span class="p">,</span> <span class="n">time_end</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="hydroutils.hydro_time.calculate_utc_offset" class="doc doc-heading">
<code class="highlight language-python"><span class="n">calculate_utc_offset</span><span class="p">(</span><span class="n">lat</span><span class="p">,</span> <span class="n">lng</span><span class="p">,</span> <span class="n">date</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#hydroutils.hydro_time.calculate_utc_offset" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Calculates UTC offset for a location using tzfpy.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>lat</code></td>
        <td><code>float</code></td>
        <td><p>Latitude in decimal degrees.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>lng</code></td>
        <td><code>float</code></td>
        <td><p>Longitude in decimal degrees.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>date</code></td>
        <td><code>datetime</code></td>
        <td><p>Optional date for timezone calculation. Uses current date if not provided.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>int</code></td>
      <td><p>UTC offset in hours, or None if timezone cannot be determined.</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1"># Get current UTC offset for New York</span>
<span class="n">offset</span> <span class="o">=</span> <span class="n">calculate_utc_offset</span><span class="p">(</span><span class="mf">40.7128</span><span class="p">,</span> <span class="o">-</span><span class="mf">74.0060</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;New York is UTC</span><span class="si">{</span><span class="n">offset</span><span class="si">:</span><span class="s2">+d</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># e.g., &quot;UTC-4&quot;</span>

<span class="c1"># Get offset for specific date</span>
<span class="n">date</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2023</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">offset</span> <span class="o">=</span> <span class="n">calculate_utc_offset</span><span class="p">(</span><span class="mf">40.7128</span><span class="p">,</span> <span class="o">-</span><span class="mf">74.0060</span><span class="p">,</span> <span class="n">date</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>

        <details class="quote">
          <summary>Source code in <code>hydroutils/hydro_time.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">calculate_utc_offset</span><span class="p">(</span><span class="n">lat</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">lng</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">date</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculates UTC offset for a location using tzfpy.</span>

<span class="sd">    Args:</span>
<span class="sd">        lat: Latitude in decimal degrees.</span>
<span class="sd">        lng: Longitude in decimal degrees.</span>
<span class="sd">        date: Optional date for timezone calculation. Uses current date if not provided.</span>

<span class="sd">    Returns:</span>
<span class="sd">        UTC offset in hours, or None if timezone cannot be determined.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        # Get current UTC offset for New York</span>
<span class="sd">        offset = calculate_utc_offset(40.7128, -74.0060)</span>
<span class="sd">        print(f&quot;New York is UTC{offset:+d}&quot;)  # e.g., &quot;UTC-4&quot;</span>

<span class="sd">        # Get offset for specific date</span>
<span class="sd">        date = datetime(2023, 1, 1)</span>
<span class="sd">        offset = calculate_utc_offset(40.7128, -74.0060, date)</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">date</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">date</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">utcnow</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">timezone_str</span> <span class="o">:=</span> <span class="n">tzfpy</span><span class="o">.</span><span class="n">get_tz</span><span class="p">(</span><span class="n">lng</span><span class="p">,</span> <span class="n">lat</span><span class="p">):</span>
        <span class="c1"># Get the timezone object using pytz</span>
        <span class="n">tz</span> <span class="o">=</span> <span class="n">pytz</span><span class="o">.</span><span class="n">timezone</span><span class="p">(</span><span class="n">timezone_str</span><span class="p">)</span>
        <span class="c1"># Get the UTC offset for the specified date</span>
        <span class="n">offset</span> <span class="o">=</span> <span class="n">tz</span><span class="o">.</span><span class="n">utcoffset</span><span class="p">(</span><span class="n">date</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">offset</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">offset</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">()</span> <span class="o">/</span> <span class="mi">3600</span><span class="p">)</span>
    <span class="k">return</span> <span class="kc">None</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="hydroutils.hydro_time.date_to_julian" class="doc doc-heading">
<code class="highlight language-python"><span class="n">date_to_julian</span><span class="p">(</span><span class="n">a_time</span><span class="p">)</span></code>


<a href="#hydroutils.hydro_time.date_to_julian" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Converts a date to its Julian day (day of year).</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>a_time</code></td>
        <td><code>Union[str, datetime.datetime]</code></td>
        <td><p>Date as either:
- string in 'YYYY-MM-DD' format
- datetime object</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>int</code></td>
      <td><p>Day of year (1-366).</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1"># From string</span>
<span class="n">day</span> <span class="o">=</span> <span class="n">date_to_julian</span><span class="p">(</span><span class="s1">&#39;2023-02-01&#39;</span><span class="p">)</span>  <span class="c1"># Returns 32</span>

<span class="c1"># From datetime</span>
<span class="n">day</span> <span class="o">=</span> <span class="n">date_to_julian</span><span class="p">(</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2023</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>  <span class="c1"># Returns 32</span>
</code></pre></div></td></tr></table></div>

        <details class="quote">
          <summary>Source code in <code>hydroutils/hydro_time.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">date_to_julian</span><span class="p">(</span><span class="n">a_time</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Converts a date to its Julian day (day of year).</span>

<span class="sd">    Args:</span>
<span class="sd">        a_time: Date as either:</span>
<span class="sd">            - string in &#39;YYYY-MM-DD&#39; format</span>
<span class="sd">            - datetime object</span>

<span class="sd">    Returns:</span>
<span class="sd">        Day of year (1-366).</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        # From string</span>
<span class="sd">        day = date_to_julian(&#39;2023-02-01&#39;)  # Returns 32</span>

<span class="sd">        # From datetime</span>
<span class="sd">        day = date_to_julian(datetime(2023, 2, 1))  # Returns 32</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">a_time</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">fmt</span> <span class="o">=</span> <span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">&quot;</span>
        <span class="n">dt</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">a_time</span><span class="p">,</span> <span class="n">fmt</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">dt</span> <span class="o">=</span> <span class="n">a_time</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">timetuple</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">tt</span><span class="o">.</span><span class="n">tm_yday</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="hydroutils.hydro_time.generate_start0101_time_range" class="doc doc-heading">
<code class="highlight language-python"><span class="n">generate_start0101_time_range</span><span class="p">(</span><span class="n">start_time</span><span class="p">,</span> <span class="n">end_time</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;8D&#39;</span><span class="p">)</span></code>


<a href="#hydroutils.hydro_time.generate_start0101_time_range" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Generates a time range that resets to January 1st each year.</p>
<p>Creates a sequence of dates with specified frequency, but ensures that each year
starts from January 1st regardless of the frequency interval.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>start_time</code></td>
        <td><code>Union[str, pandas._libs.tslibs.timestamps.Timestamp]</code></td>
        <td><p>Start date as string ('YYYY-MM-DD') or pandas Timestamp.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>end_time</code></td>
        <td><code>Union[str, pandas._libs.tslibs.timestamps.Timestamp]</code></td>
        <td><p>End date as string ('YYYY-MM-DD') or pandas Timestamp.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>freq</code></td>
        <td><code>str</code></td>
        <td><p>Time frequency (e.g., '8D' for 8 days, '7D' for weekly).</p></td>
        <td><code>&#39;8D&#39;</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>DatetimeIndex</code></td>
      <td><p>DatetimeIndex with specified frequency and annual reset to January 1st.</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1"># Generate 8-day intervals, resetting to Jan 1st each year</span>
<span class="n">dates</span> <span class="o">=</span> <span class="n">generate_start0101_time_range</span><span class="p">(</span><span class="s1">&#39;2023-01-15&#39;</span><span class="p">,</span> <span class="s1">&#39;2024-02-01&#39;</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;8D&#39;</span><span class="p">)</span>

<span class="c1"># Generate weekly intervals</span>
<span class="n">dates</span> <span class="o">=</span> <span class="n">generate_start0101_time_range</span><span class="p">(</span><span class="s1">&#39;2023-01-15&#39;</span><span class="p">,</span> <span class="s1">&#39;2024-02-01&#39;</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;7D&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      <p>!!! note
    If an interval would cross into a new year, it's truncated and the next
    interval starts from January 1st of the new year.</p>

        <details class="quote">
          <summary>Source code in <code>hydroutils/hydro_time.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">generate_start0101_time_range</span><span class="p">(</span>
    <span class="n">start_time</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">],</span>
    <span class="n">end_time</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">],</span>
    <span class="n">freq</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;8D&quot;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DatetimeIndex</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generates a time range that resets to January 1st each year.</span>

<span class="sd">    Creates a sequence of dates with specified frequency, but ensures that each year</span>
<span class="sd">    starts from January 1st regardless of the frequency interval.</span>

<span class="sd">    Args:</span>
<span class="sd">        start_time: Start date as string (&#39;YYYY-MM-DD&#39;) or pandas Timestamp.</span>
<span class="sd">        end_time: End date as string (&#39;YYYY-MM-DD&#39;) or pandas Timestamp.</span>
<span class="sd">        freq: Time frequency (e.g., &#39;8D&#39; for 8 days, &#39;7D&#39; for weekly).</span>

<span class="sd">    Returns:</span>
<span class="sd">        DatetimeIndex with specified frequency and annual reset to January 1st.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        # Generate 8-day intervals, resetting to Jan 1st each year</span>
<span class="sd">        dates = generate_start0101_time_range(&#39;2023-01-15&#39;, &#39;2024-02-01&#39;, freq=&#39;8D&#39;)</span>

<span class="sd">        # Generate weekly intervals</span>
<span class="sd">        dates = generate_start0101_time_range(&#39;2023-01-15&#39;, &#39;2024-02-01&#39;, freq=&#39;7D&#39;)</span>
<span class="sd">        ```</span>

<span class="sd">    Note:</span>
<span class="sd">        If an interval would cross into a new year, it&#39;s truncated and the next</span>
<span class="sd">        interval starts from January 1st of the new year.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">all_dates</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># Ensure the start and end times are of type pd.Timestamp</span>
    <span class="n">current_time</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="n">start_time</span><span class="p">)</span>
    <span class="n">end_time</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="n">end_time</span><span class="p">)</span>

    <span class="c1"># Parse the frequency interval correctly</span>
    <span class="n">interval_days</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timedelta</span><span class="p">(</span><span class="n">freq</span><span class="p">)</span>  <span class="c1"># Ensure it&#39;s a Timedelta</span>

    <span class="k">while</span> <span class="n">current_time</span> <span class="o">&lt;=</span> <span class="n">end_time</span><span class="p">:</span>
        <span class="n">all_dates</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">current_time</span><span class="p">)</span>

        <span class="c1"># Calculate next date with the specified interval</span>
        <span class="n">next_time</span> <span class="o">=</span> <span class="n">current_time</span> <span class="o">+</span> <span class="n">interval_days</span>

        <span class="c1"># If next_time crosses into a new year, reset to 01-01 of the new year</span>
        <span class="k">if</span> <span class="n">next_time</span><span class="o">.</span><span class="n">year</span> <span class="o">&gt;</span> <span class="n">current_time</span><span class="o">.</span><span class="n">year</span><span class="p">:</span>
            <span class="n">next_time</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">next_time</span><span class="o">.</span><span class="n">year</span><span class="si">}</span><span class="s2">-01-01&quot;</span><span class="p">)</span>

        <span class="n">current_time</span> <span class="o">=</span> <span class="n">next_time</span>

    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">all_dates</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="hydroutils.hydro_time.get_year" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_year</span><span class="p">(</span><span class="n">a_time</span><span class="p">)</span></code>


<a href="#hydroutils.hydro_time.get_year" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Extracts the year from various date formats.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>a_time</code></td>
        <td><code>Union[datetime.date, numpy.datetime64, str]</code></td>
        <td><p>Date in one of these formats:
- datetime.date object
- numpy.datetime64 object
- string in 'YYYY-MM-DD' format</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>int</code></td>
      <td><p>Year as integer.</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1"># From datetime.date</span>
<span class="n">year</span> <span class="o">=</span> <span class="n">get_year</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="p">(</span><span class="mi">2023</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>  <span class="c1"># Returns 2023</span>

<span class="c1"># From numpy.datetime64</span>
<span class="n">year</span> <span class="o">=</span> <span class="n">get_year</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">datetime64</span><span class="p">(</span><span class="s1">&#39;2023-01-01&#39;</span><span class="p">))</span>  <span class="c1"># Returns 2023</span>

<span class="c1"># From string</span>
<span class="n">year</span> <span class="o">=</span> <span class="n">get_year</span><span class="p">(</span><span class="s1">&#39;2023-01-01&#39;</span><span class="p">)</span>  <span class="c1"># Returns 2023</span>
</code></pre></div></td></tr></table></div>

        <details class="quote">
          <summary>Source code in <code>hydroutils/hydro_time.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_year</span><span class="p">(</span><span class="n">a_time</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">datetime64</span><span class="p">,</span> <span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Extracts the year from various date formats.</span>

<span class="sd">    Args:</span>
<span class="sd">        a_time: Date in one of these formats:</span>
<span class="sd">            - datetime.date object</span>
<span class="sd">            - numpy.datetime64 object</span>
<span class="sd">            - string in &#39;YYYY-MM-DD&#39; format</span>

<span class="sd">    Returns:</span>
<span class="sd">        Year as integer.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        # From datetime.date</span>
<span class="sd">        year = get_year(datetime.date(2023, 1, 1))  # Returns 2023</span>

<span class="sd">        # From numpy.datetime64</span>
<span class="sd">        year = get_year(np.datetime64(&#39;2023-01-01&#39;))  # Returns 2023</span>

<span class="sd">        # From string</span>
<span class="sd">        year = get_year(&#39;2023-01-01&#39;)  # Returns 2023</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">a_time</span><span class="p">,</span> <span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">a_time</span><span class="o">.</span><span class="n">year</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">a_time</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">datetime64</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">a_time</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;datetime64[Y]&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1970</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">a_time</span><span class="p">[:</span><span class="mi">4</span><span class="p">])</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="hydroutils.hydro_time.intersect" class="doc doc-heading">
<code class="highlight language-python"><span class="n">intersect</span><span class="p">(</span><span class="n">t_lst1</span><span class="p">,</span> <span class="n">t_lst2</span><span class="p">)</span></code>


<a href="#hydroutils.hydro_time.intersect" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Finds indices where two time arrays intersect.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>t_lst1</code></td>
        <td><code>&lt;built-in function array&gt;</code></td>
        <td><p>First time array.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>t_lst2</code></td>
        <td><code>&lt;built-in function array&gt;</code></td>
        <td><p>Second time array.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>tuple</code></td>
      <td><p>Tuple of (indices_in_t_lst1, indices_in_t_lst2) where values match.</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">t1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;2000-01-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2000-01-02&#39;</span><span class="p">,</span> <span class="s1">&#39;2000-01-03&#39;</span><span class="p">])</span>
<span class="n">t2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;2000-01-02&#39;</span><span class="p">,</span> <span class="s1">&#39;2000-01-03&#39;</span><span class="p">,</span> <span class="s1">&#39;2000-01-04&#39;</span><span class="p">])</span>
<span class="n">idx1</span><span class="p">,</span> <span class="n">idx2</span> <span class="o">=</span> <span class="n">intersect</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">)</span>
<span class="c1"># idx1 = [1, 2] (indices in t1)</span>
<span class="c1"># idx2 = [0, 1] (indices in t2)</span>
</code></pre></div></td></tr></table></div>

        <details class="quote">
          <summary>Source code in <code>hydroutils/hydro_time.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">intersect</span><span class="p">(</span><span class="n">t_lst1</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">,</span> <span class="n">t_lst2</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Finds indices where two time arrays intersect.</span>

<span class="sd">    Args:</span>
<span class="sd">        t_lst1: First time array.</span>
<span class="sd">        t_lst2: Second time array.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Tuple of (indices_in_t_lst1, indices_in_t_lst2) where values match.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        t1 = np.array([&#39;2000-01-01&#39;, &#39;2000-01-02&#39;, &#39;2000-01-03&#39;])</span>
<span class="sd">        t2 = np.array([&#39;2000-01-02&#39;, &#39;2000-01-03&#39;, &#39;2000-01-04&#39;])</span>
<span class="sd">        idx1, idx2 = intersect(t1, t2)</span>
<span class="sd">        # idx1 = [1, 2] (indices in t1)</span>
<span class="sd">        # idx2 = [0, 1] (indices in t2)</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">C</span><span class="p">,</span> <span class="n">ind1</span><span class="p">,</span> <span class="n">ind2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">intersect1d</span><span class="p">(</span><span class="n">t_lst1</span><span class="p">,</span> <span class="n">t_lst2</span><span class="p">,</span> <span class="n">return_indices</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ind1</span><span class="p">,</span> <span class="n">ind2</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="hydroutils.hydro_time.t2str" class="doc doc-heading">
<code class="highlight language-python"><span class="n">t2str</span><span class="p">(</span><span class="n">t_</span><span class="p">)</span></code>


<a href="#hydroutils.hydro_time.t2str" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Converts between datetime string and datetime object.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>t_</code></td>
        <td><code>Union[str, datetime.datetime]</code></td>
        <td><p>Either a date string in 'YYYY-MM-DD' format or a datetime object.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>If input is string</code></td>
      <td><p>returns datetime object.
If input is datetime: returns date string in 'YYYY-MM-DD' format.</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>NotImplementedError</code></td>
        <td><p>If input type is not supported.</p></td>
      </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1"># String to datetime</span>
<span class="n">dt</span> <span class="o">=</span> <span class="n">t2str</span><span class="p">(</span><span class="s1">&#39;2023-01-01&#39;</span><span class="p">)</span>  <span class="c1"># Returns datetime(2023, 1, 1)</span>

<span class="c1"># Datetime to string</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">t2str</span><span class="p">(</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2023</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>  <span class="c1"># Returns &#39;2023-01-01&#39;</span>
</code></pre></div></td></tr></table></div>

        <details class="quote">
          <summary>Source code in <code>hydroutils/hydro_time.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">t2str</span><span class="p">(</span><span class="n">t_</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Converts between datetime string and datetime object.</span>

<span class="sd">    Args:</span>
<span class="sd">        t_: Either a date string in &#39;YYYY-MM-DD&#39; format or a datetime object.</span>

<span class="sd">    Returns:</span>
<span class="sd">        If input is string: returns datetime object.</span>
<span class="sd">        If input is datetime: returns date string in &#39;YYYY-MM-DD&#39; format.</span>

<span class="sd">    Raises:</span>
<span class="sd">        NotImplementedError: If input type is not supported.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        # String to datetime</span>
<span class="sd">        dt = t2str(&#39;2023-01-01&#39;)  # Returns datetime(2023, 1, 1)</span>

<span class="sd">        # Datetime to string</span>
<span class="sd">        s = t2str(datetime(2023, 1, 1))  # Returns &#39;2023-01-01&#39;</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">t_</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">t_</span><span class="p">,</span> <span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">t_</span><span class="p">)</span> <span class="ow">is</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">t_</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;We don&#39;t support this data type yet&quot;</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="hydroutils.hydro_time.t_days_lst2range" class="doc doc-heading">
<code class="highlight language-python"><span class="n">t_days_lst2range</span><span class="p">(</span><span class="n">t_array</span><span class="p">)</span></code>


<a href="#hydroutils.hydro_time.t_days_lst2range" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Converts a list of dates to a date range [start, end].</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>t_array</code></td>
        <td><code>list</code></td>
        <td><p>List of dates, either as np.datetime64 objects or strings in 'YYYY-MM-DD' format.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>list</code></td>
      <td><p>Two-element list containing start and end dates as strings in 'YYYY-MM-DD' format.</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1"># With string dates</span>
<span class="n">dates</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;2000-01-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2000-01-02&#39;</span><span class="p">,</span> <span class="s1">&#39;2000-01-03&#39;</span><span class="p">,</span> <span class="s1">&#39;2000-01-04&#39;</span><span class="p">]</span>
<span class="nb">range</span> <span class="o">=</span> <span class="n">t_days_lst2range</span><span class="p">(</span><span class="n">dates</span><span class="p">)</span>  <span class="c1"># Returns [&#39;2000-01-01&#39;, &#39;2000-01-04&#39;]</span>

<span class="c1"># With datetime64 objects</span>
<span class="n">dates</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;2000-01-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2000-01-04&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;datetime64&#39;</span><span class="p">)</span>
<span class="nb">range</span> <span class="o">=</span> <span class="n">t_days_lst2range</span><span class="p">(</span><span class="n">dates</span><span class="p">)</span>  <span class="c1"># Returns [&#39;2000-01-01&#39;, &#39;2000-01-04&#39;]</span>
</code></pre></div></td></tr></table></div>

        <details class="quote">
          <summary>Source code in <code>hydroutils/hydro_time.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">t_days_lst2range</span><span class="p">(</span><span class="n">t_array</span><span class="p">:</span> <span class="nb">list</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Converts a list of dates to a date range [start, end].</span>

<span class="sd">    Args:</span>
<span class="sd">        t_array: List of dates, either as np.datetime64 objects or strings in &#39;YYYY-MM-DD&#39; format.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Two-element list containing start and end dates as strings in &#39;YYYY-MM-DD&#39; format.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        # With string dates</span>
<span class="sd">        dates = [&#39;2000-01-01&#39;, &#39;2000-01-02&#39;, &#39;2000-01-03&#39;, &#39;2000-01-04&#39;]</span>
<span class="sd">        range = t_days_lst2range(dates)  # Returns [&#39;2000-01-01&#39;, &#39;2000-01-04&#39;]</span>

<span class="sd">        # With datetime64 objects</span>
<span class="sd">        dates = np.array([&#39;2000-01-01&#39;, &#39;2000-01-04&#39;], dtype=&#39;datetime64&#39;)</span>
<span class="sd">        range = t_days_lst2range(dates)  # Returns [&#39;2000-01-01&#39;, &#39;2000-01-04&#39;]</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">t_array</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">datetime64</span><span class="p">:</span>
        <span class="n">t0</span> <span class="o">=</span> <span class="n">t_array</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">)</span>
        <span class="n">t1</span> <span class="o">=</span> <span class="n">t_array</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">t0</span> <span class="o">=</span> <span class="n">t_array</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">t1</span> <span class="o">=</span> <span class="n">t_array</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">sd</span> <span class="o">=</span> <span class="n">t0</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">ed</span> <span class="o">=</span> <span class="n">t1</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">sd</span><span class="p">,</span> <span class="n">ed</span><span class="p">]</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="hydroutils.hydro_time.t_range_days" class="doc doc-heading">
<code class="highlight language-python"><span class="n">t_range_days</span><span class="p">(</span><span class="n">t_range</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">timedelta64</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;D&#39;</span><span class="p">))</span></code>


<a href="#hydroutils.hydro_time.t_range_days" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Creates a uniformly-spaced array of dates from a date range.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>t_range</code></td>
        <td><code>list</code></td>
        <td><p>Two-element list containing start and end dates as strings in 'YYYY-MM-DD' format.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>step</code></td>
        <td><code>timedelta64</code></td>
        <td><p>Time interval between dates. Defaults to 1 day.</p></td>
        <td><code>np.timedelta64(1,&#39;D&#39;)</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>&lt;built-in function array&gt;</code></td>
      <td><p>Array of datetime64 objects representing the date range.</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">dates</span> <span class="o">=</span> <span class="n">t_range_days</span><span class="p">([</span><span class="s1">&#39;2000-01-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2000-01-05&#39;</span><span class="p">])</span>
<span class="c1"># Returns array([&#39;2000-01-01&#39;, &#39;2000-01-02&#39;, &#39;2000-01-03&#39;, &#39;2000-01-04&#39;],</span>
<span class="c1">#              dtype=&#39;datetime64[D]&#39;)</span>

<span class="c1"># With custom step</span>
<span class="n">dates</span> <span class="o">=</span> <span class="n">t_range_days</span><span class="p">([</span><span class="s1">&#39;2000-01-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2000-01-10&#39;</span><span class="p">],</span> 
                   <span class="n">step</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">timedelta64</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">))</span>
<span class="c1"># Returns dates with 2-day intervals</span>
</code></pre></div></td></tr></table></div>

        <details class="quote">
          <summary>Source code in <code>hydroutils/hydro_time.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">t_range_days</span><span class="p">(</span><span class="n">t_range</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">step</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">timedelta64</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">timedelta64</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;D&quot;</span><span class="p">))</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates a uniformly-spaced array of dates from a date range.</span>

<span class="sd">    Args:</span>
<span class="sd">        t_range: Two-element list containing start and end dates as strings in &#39;YYYY-MM-DD&#39; format.</span>
<span class="sd">        step: Time interval between dates. Defaults to 1 day.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Array of datetime64 objects representing the date range.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        dates = t_range_days([&#39;2000-01-01&#39;, &#39;2000-01-05&#39;])</span>
<span class="sd">        # Returns array([&#39;2000-01-01&#39;, &#39;2000-01-02&#39;, &#39;2000-01-03&#39;, &#39;2000-01-04&#39;],</span>
<span class="sd">        #              dtype=&#39;datetime64[D]&#39;)</span>

<span class="sd">        # With custom step</span>
<span class="sd">        dates = t_range_days([&#39;2000-01-01&#39;, &#39;2000-01-10&#39;], </span>
<span class="sd">                           step=np.timedelta64(2, &#39;D&#39;))</span>
<span class="sd">        # Returns dates with 2-day intervals</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">sd</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">t_range</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">ed</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">t_range</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">sd</span><span class="p">,</span> <span class="n">ed</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="hydroutils.hydro_time.t_range_days_timedelta" class="doc doc-heading">
<code class="highlight language-python"><span class="n">t_range_days_timedelta</span><span class="p">(</span><span class="n">t_array</span><span class="p">,</span> <span class="n">td</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">td_type</span><span class="o">=</span><span class="s1">&#39;h&#39;</span><span class="p">)</span></code>


<a href="#hydroutils.hydro_time.t_range_days_timedelta" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Adds a time delta to each date in an array.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>t_array</code></td>
        <td><code>&lt;built-in function array&gt;</code></td>
        <td><p>Array of datetime64 objects (typically from t_range_days).</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>td</code></td>
        <td><code>int</code></td>
        <td><p>Number of time units to add.</p></td>
        <td><code>12</code></td>
      </tr>
      <tr>
        <td><code>td_type</code></td>
        <td><code>str</code></td>
        <td><p>Time unit type. One of 'Y'(years), 'M'(months), 'D'(days),
    'h'(hours), 'm'(minutes), 's'(seconds).</p></td>
        <td><code>&#39;h&#39;</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>&lt;built-in function array&gt;</code></td>
      <td><p>Array of datetime64 objects with added time delta.</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>AssertionError</code></td>
        <td><p>If td_type is not one of the supported types.</p></td>
      </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">dates</span> <span class="o">=</span> <span class="n">t_range_days</span><span class="p">([</span><span class="s1">&#39;2000-01-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2000-01-03&#39;</span><span class="p">])</span>
<span class="c1"># Add 12 hours to each date</span>
<span class="n">shifted</span> <span class="o">=</span> <span class="n">t_range_days_timedelta</span><span class="p">(</span><span class="n">dates</span><span class="p">,</span> <span class="n">td</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">td_type</span><span class="o">=</span><span class="s1">&#39;h&#39;</span><span class="p">)</span>

<span class="c1"># Add 30 minutes to each date</span>
<span class="n">shifted</span> <span class="o">=</span> <span class="n">t_range_days_timedelta</span><span class="p">(</span><span class="n">dates</span><span class="p">,</span> <span class="n">td</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">td_type</span><span class="o">=</span><span class="s1">&#39;m&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>

        <details class="quote">
          <summary>Source code in <code>hydroutils/hydro_time.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">t_range_days_timedelta</span><span class="p">(</span><span class="n">t_array</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">,</span> <span class="n">td</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">12</span><span class="p">,</span> <span class="n">td_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;h&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Adds a time delta to each date in an array.</span>

<span class="sd">    Args:</span>
<span class="sd">        t_array: Array of datetime64 objects (typically from t_range_days).</span>
<span class="sd">        td: Number of time units to add.</span>
<span class="sd">        td_type: Time unit type. One of &#39;Y&#39;(years), &#39;M&#39;(months), &#39;D&#39;(days),</span>
<span class="sd">                &#39;h&#39;(hours), &#39;m&#39;(minutes), &#39;s&#39;(seconds).</span>

<span class="sd">    Returns:</span>
<span class="sd">        Array of datetime64 objects with added time delta.</span>

<span class="sd">    Raises:</span>
<span class="sd">        AssertionError: If td_type is not one of the supported types.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        dates = t_range_days([&#39;2000-01-01&#39;, &#39;2000-01-03&#39;])</span>
<span class="sd">        # Add 12 hours to each date</span>
<span class="sd">        shifted = t_range_days_timedelta(dates, td=12, td_type=&#39;h&#39;)</span>

<span class="sd">        # Add 30 minutes to each date</span>
<span class="sd">        shifted = t_range_days_timedelta(dates, td=30, td_type=&#39;m&#39;)</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="n">td_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Y&quot;</span><span class="p">,</span> <span class="s2">&quot;M&quot;</span><span class="p">,</span> <span class="s2">&quot;D&quot;</span><span class="p">,</span> <span class="s2">&quot;h&quot;</span><span class="p">,</span> <span class="s2">&quot;m&quot;</span><span class="p">,</span> <span class="s2">&quot;s&quot;</span><span class="p">]</span>
    <span class="n">t_array_final</span> <span class="o">=</span> <span class="p">[</span><span class="n">t</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">timedelta64</span><span class="p">(</span><span class="n">td</span><span class="p">,</span> <span class="n">td_type</span><span class="p">)</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">t_array</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">t_array_final</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="hydroutils.hydro_time.t_range_to_julian" class="doc doc-heading">
<code class="highlight language-python"><span class="n">t_range_to_julian</span><span class="p">(</span><span class="n">t_range</span><span class="p">)</span></code>


<a href="#hydroutils.hydro_time.t_range_to_julian" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Converts a date range to a list of Julian days.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>t_range</code></td>
        <td><code>list</code></td>
        <td><p>Two-element list containing start and end dates as strings in 'YYYY-MM-DD' format.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>list</code></td>
      <td><p>List of Julian days (days of year) for each date in the range.</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">days</span> <span class="o">=</span> <span class="n">t_range_to_julian</span><span class="p">([</span><span class="s1">&#39;2023-01-31&#39;</span><span class="p">,</span> <span class="s1">&#39;2023-02-03&#39;</span><span class="p">])</span>
<span class="c1"># Returns [31, 32, 33, 34]  # Julian days for Jan 31 - Feb 3</span>
</code></pre></div></td></tr></table></div>

        <details class="quote">
          <summary>Source code in <code>hydroutils/hydro_time.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">t_range_to_julian</span><span class="p">(</span><span class="n">t_range</span><span class="p">:</span> <span class="nb">list</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Converts a date range to a list of Julian days.</span>

<span class="sd">    Args:</span>
<span class="sd">        t_range: Two-element list containing start and end dates as strings in &#39;YYYY-MM-DD&#39; format.</span>

<span class="sd">    Returns:</span>
<span class="sd">        List of Julian days (days of year) for each date in the range.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        days = t_range_to_julian([&#39;2023-01-31&#39;, &#39;2023-02-03&#39;])</span>
<span class="sd">        # Returns [31, 32, 33, 34]  # Julian days for Jan 31 - Feb 3</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">t_array</span> <span class="o">=</span> <span class="n">t_range_days</span><span class="p">(</span><span class="n">t_range</span><span class="p">)</span>
    <span class="n">t_array_str</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">datetime_as_string</span><span class="p">(</span><span class="n">t_array</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">date_to_julian</span><span class="p">(</span><span class="n">a_time</span><span class="p">[:</span><span class="mi">10</span><span class="p">])</span> <span class="k">for</span> <span class="n">a_time</span> <span class="ow">in</span> <span class="n">t_array_str</span><span class="p">]</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="hydroutils.hydro_time.t_range_years" class="doc doc-heading">
<code class="highlight language-python"><span class="n">t_range_years</span><span class="p">(</span><span class="n">t_range</span><span class="p">)</span></code>


<a href="#hydroutils.hydro_time.t_range_years" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Extracts years from a date range, handling year boundaries.</p>
<p>The function treats the range as left-closed and right-open. If the end date
is not January 1st, the end year is included in the range.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>t_range</code></td>
        <td><code>list</code></td>
        <td><p>Two-element list containing start and end dates as strings in 'YYYY-MM-DD' format.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>&lt;built-in function array&gt;</code></td>
      <td><p>Array of years included in the range.</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1"># End date is Jan 1st - end year not included</span>
<span class="n">years</span> <span class="o">=</span> <span class="n">t_range_years</span><span class="p">([</span><span class="s1">&#39;2000-01-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2003-01-01&#39;</span><span class="p">])</span>
<span class="c1"># Returns array([2000, 2001, 2002])</span>

<span class="c1"># End date is not Jan 1st - end year included</span>
<span class="n">years</span> <span class="o">=</span> <span class="n">t_range_years</span><span class="p">([</span><span class="s1">&#39;2000-01-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2003-06-01&#39;</span><span class="p">])</span>
<span class="c1"># Returns array([2000, 2001, 2002, 2003])</span>
</code></pre></div></td></tr></table></div>

        <details class="quote">
          <summary>Source code in <code>hydroutils/hydro_time.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">t_range_years</span><span class="p">(</span><span class="n">t_range</span><span class="p">:</span> <span class="nb">list</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Extracts years from a date range, handling year boundaries.</span>

<span class="sd">    The function treats the range as left-closed and right-open. If the end date</span>
<span class="sd">    is not January 1st, the end year is included in the range.</span>

<span class="sd">    Args:</span>
<span class="sd">        t_range: Two-element list containing start and end dates as strings in &#39;YYYY-MM-DD&#39; format.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Array of years included in the range.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        # End date is Jan 1st - end year not included</span>
<span class="sd">        years = t_range_years([&#39;2000-01-01&#39;, &#39;2003-01-01&#39;])</span>
<span class="sd">        # Returns array([2000, 2001, 2002])</span>

<span class="sd">        # End date is not Jan 1st - end year included</span>
<span class="sd">        years = t_range_years([&#39;2000-01-01&#39;, &#39;2003-06-01&#39;])</span>
<span class="sd">        # Returns array([2000, 2001, 2002, 2003])</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">start_year</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">t_range</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">end_year</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">t_range</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">end_month</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">t_range</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">end_day</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">t_range</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">)[</span><span class="mi">2</span><span class="p">])</span>
    <span class="k">return</span> <span class="p">(</span>
        <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">start_year</span><span class="p">,</span> <span class="n">end_year</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">end_month</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">end_day</span> <span class="o">==</span> <span class="mi">1</span>
        <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">start_year</span><span class="p">,</span> <span class="n">end_year</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>






  </div>

    </div>

  </div>




  </div>

    </div>

  </div>

<h2 id="submodules">Submodules<a class="headerlink" href="#submodules" title="Permanent link">&para;</a></h2>
<p>The <code>hydroutils</code> package consists of several specialized modules:</p>
<ul>
<li><strong><a href="../hydro_stat/">hydro_stat</a></strong> - Statistical analysis and performance metrics</li>
<li><strong><a href="../hydro_plot/">hydro_plot</a></strong> - Visualization tools for hydrological data  </li>
<li><strong><a href="../hydro_time/">hydro_time</a></strong> - Time series processing utilities</li>
<li><strong><a href="../hydro_file/">hydro_file</a></strong> - File I/O operations</li>
<li><strong><a href="../hydro_arithmetric/">hydro_arithmetric</a></strong> - Mathematical operations</li>
<li><strong><a href="../hydro_s3/">hydro_s3</a></strong> - AWS S3 integration</li>
<li><strong><a href="../hydro_log/">hydro_log</a></strong> - Logging utilities</li>
</ul>
<p>Click on any module above for detailed function documentation.</p>







  
    
  
  


  <aside class="md-source-file">
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Last update">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg>
    </span>
    2025-08-19
  </span>

    
    
    
    
  </aside>





                

              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.instant", "search.highlight"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.92b07e13.min.js"></script>
      
    
  </body>
</html>