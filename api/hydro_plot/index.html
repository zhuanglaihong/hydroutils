
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://zhuanglaihong.github.io/hydroutils/api/hydro_plot/">
      
      
        <link rel="prev" href="../hydro_stat/">
      
      
        <link rel="next" href="../hydro_time/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.17">
    
    
      
        <title>Visualization - hydroutils</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.7e37652d.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="preference" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#hydro_plot-visualization-tools" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="hydroutils" class="md-header__button md-logo" aria-label="hydroutils" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            hydroutils
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Visualization
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/zhuanglaihong/hydroutils" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="hydroutils" class="md-nav__button md-logo" aria-label="hydroutils" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    hydroutils
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/zhuanglaihong/hydroutils" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Getting Started
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Getting Started
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../installation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Installation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../usage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Quick Start
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    FAQ
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    API Reference
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            API Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../hydroutils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" checked>
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Core Modules
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            Core Modules
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../hydro_stat/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Statistical Analysis
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Visualization
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Visualization
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      Overview
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quick-example" class="md-nav__link">
    <span class="md-ellipsis">
      Quick Example
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#api-reference" class="md-nav__link">
    <span class="md-ellipsis">
      API Reference
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.hydro_plot" class="md-nav__link">
    <span class="md-ellipsis">
      hydroutils.hydro_plot
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.hydro_plot.create_median_labels" class="md-nav__link">
    <span class="md-ellipsis">
      create_median_labels()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.hydro_plot.plot_boxes_matplotlib" class="md-nav__link">
    <span class="md-ellipsis">
      plot_boxes_matplotlib()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.hydro_plot.plot_boxs" class="md-nav__link">
    <span class="md-ellipsis">
      plot_boxs()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.hydro_plot.plot_diff_boxes" class="md-nav__link">
    <span class="md-ellipsis">
      plot_diff_boxes()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.hydro_plot.plot_ecdf" class="md-nav__link">
    <span class="md-ellipsis">
      plot_ecdf()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.hydro_plot.plot_ecdfs" class="md-nav__link">
    <span class="md-ellipsis">
      plot_ecdfs()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.hydro_plot.plot_ecdfs_matplot" class="md-nav__link">
    <span class="md-ellipsis">
      plot_ecdfs_matplot()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.hydro_plot.plot_heat_map" class="md-nav__link">
    <span class="md-ellipsis">
      plot_heat_map()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.hydro_plot.plot_map_carto" class="md-nav__link">
    <span class="md-ellipsis">
      plot_map_carto()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.hydro_plot.plot_pdf_cdf" class="md-nav__link">
    <span class="md-ellipsis">
      plot_pdf_cdf()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.hydro_plot.plot_quiver" class="md-nav__link">
    <span class="md-ellipsis">
      plot_quiver()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.hydro_plot.plot_rainfall_runoff" class="md-nav__link">
    <span class="md-ellipsis">
      plot_rainfall_runoff()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.hydro_plot.plot_rainfall_runoff_chai" class="md-nav__link">
    <span class="md-ellipsis">
      plot_rainfall_runoff_chai()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.hydro_plot.plot_rainfall_runoff_xu" class="md-nav__link">
    <span class="md-ellipsis">
      plot_rainfall_runoff_xu()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.hydro_plot.plot_scatter_with_11line" class="md-nav__link">
    <span class="md-ellipsis">
      plot_scatter_with_11line()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.hydro_plot.plot_scatter_xyc" class="md-nav__link">
    <span class="md-ellipsis">
      plot_scatter_xyc()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.hydro_plot.plot_ts" class="md-nav__link">
    <span class="md-ellipsis">
      plot_ts()
    </span>
  </a>
  
    <nav class="md-nav" aria-label="plot_ts()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_plot.plot_ts--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_plot.plot_ts--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.hydro_plot.plot_ts_map" class="md-nav__link">
    <span class="md-ellipsis">
      plot_ts_map()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.hydro_plot.plot_ts_matplot" class="md-nav__link">
    <span class="md-ellipsis">
      plot_ts_matplot()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.hydro_plot.swarmplot_without_legend" class="md-nav__link">
    <span class="md-ellipsis">
      swarmplot_without_legend()
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../hydro_time/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Time Processing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../hydro_file/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    File Operations
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" >
        
          
          <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Advanced Modules
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            Advanced Modules
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../hydro_arithmetric/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Mathematical Operations
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../hydro_s3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    AWS S3 Integration
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../hydro_log/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Logging Utilities
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Development
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Development
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../contributing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Contributing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../changelog/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Changelog
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="https://github.com/zhuanglaihong/hydroutils/issues" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Report Issues
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      Overview
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quick-example" class="md-nav__link">
    <span class="md-ellipsis">
      Quick Example
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#api-reference" class="md-nav__link">
    <span class="md-ellipsis">
      API Reference
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.hydro_plot" class="md-nav__link">
    <span class="md-ellipsis">
      hydroutils.hydro_plot
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.hydro_plot.create_median_labels" class="md-nav__link">
    <span class="md-ellipsis">
      create_median_labels()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.hydro_plot.plot_boxes_matplotlib" class="md-nav__link">
    <span class="md-ellipsis">
      plot_boxes_matplotlib()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.hydro_plot.plot_boxs" class="md-nav__link">
    <span class="md-ellipsis">
      plot_boxs()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.hydro_plot.plot_diff_boxes" class="md-nav__link">
    <span class="md-ellipsis">
      plot_diff_boxes()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.hydro_plot.plot_ecdf" class="md-nav__link">
    <span class="md-ellipsis">
      plot_ecdf()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.hydro_plot.plot_ecdfs" class="md-nav__link">
    <span class="md-ellipsis">
      plot_ecdfs()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.hydro_plot.plot_ecdfs_matplot" class="md-nav__link">
    <span class="md-ellipsis">
      plot_ecdfs_matplot()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.hydro_plot.plot_heat_map" class="md-nav__link">
    <span class="md-ellipsis">
      plot_heat_map()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.hydro_plot.plot_map_carto" class="md-nav__link">
    <span class="md-ellipsis">
      plot_map_carto()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.hydro_plot.plot_pdf_cdf" class="md-nav__link">
    <span class="md-ellipsis">
      plot_pdf_cdf()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.hydro_plot.plot_quiver" class="md-nav__link">
    <span class="md-ellipsis">
      plot_quiver()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.hydro_plot.plot_rainfall_runoff" class="md-nav__link">
    <span class="md-ellipsis">
      plot_rainfall_runoff()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.hydro_plot.plot_rainfall_runoff_chai" class="md-nav__link">
    <span class="md-ellipsis">
      plot_rainfall_runoff_chai()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.hydro_plot.plot_rainfall_runoff_xu" class="md-nav__link">
    <span class="md-ellipsis">
      plot_rainfall_runoff_xu()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.hydro_plot.plot_scatter_with_11line" class="md-nav__link">
    <span class="md-ellipsis">
      plot_scatter_with_11line()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.hydro_plot.plot_scatter_xyc" class="md-nav__link">
    <span class="md-ellipsis">
      plot_scatter_xyc()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.hydro_plot.plot_ts" class="md-nav__link">
    <span class="md-ellipsis">
      plot_ts()
    </span>
  </a>
  
    <nav class="md-nav" aria-label="plot_ts()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_plot.plot_ts--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydroutils.hydro_plot.plot_ts--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.hydro_plot.plot_ts_map" class="md-nav__link">
    <span class="md-ellipsis">
      plot_ts_map()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.hydro_plot.plot_ts_matplot" class="md-nav__link">
    <span class="md-ellipsis">
      plot_ts_matplot()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydroutils.hydro_plot.swarmplot_without_legend" class="md-nav__link">
    <span class="md-ellipsis">
      swarmplot_without_legend()
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                



                  


  
  


<h1 id="hydro_plot-visualization-tools">hydro_plot - Visualization Tools<a class="headerlink" href="#hydro_plot-visualization-tools" title="Permanent link">&para;</a></h1>
<p>The <code>hydro_plot</code> module provides specialized plotting functions for visualizing hydrological data and analysis results.</p>
<h2 id="overview">Overview<a class="headerlink" href="#overview" title="Permanent link">&para;</a></h2>
<p>This module contains functions for:</p>
<ul>
<li><strong>Time Series Plots</strong>: Visualize streamflow, precipitation, and other time series data</li>
<li><strong>Statistical Plots</strong>: Create plots for model performance assessment</li>
<li><strong>Flow Analysis Plots</strong>: Flow duration curves, hydrographs, and flow statistics</li>
<li><strong>Comparison Plots</strong>: Side-by-side comparisons of observed vs simulated data</li>
</ul>
<h2 id="quick-example">Quick Example<a class="headerlink" href="#quick-example" title="Permanent link">&para;</a></h2>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">hydroutils</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">hu</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="c1"># Sample data</span>
<span class="n">dates</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s1">&#39;2020-01-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2020-12-31&#39;</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;D&#39;</span><span class="p">)</span>
<span class="n">observed</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">+</span> <span class="mi">5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">dates</span><span class="p">))</span> <span class="o">/</span> <span class="mf">365.25</span><span class="p">)</span>
<span class="n">simulated</span> <span class="o">=</span> <span class="n">observed</span> <span class="o">*</span> <span class="mf">0.95</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">dates</span><span class="p">))</span>

<span class="c1"># Create time series plot</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">hu</span><span class="o">.</span><span class="n">plot_timeseries</span><span class="p">(</span>
    <span class="n">dates</span><span class="p">,</span> <span class="n">observed</span><span class="p">,</span> <span class="n">simulated</span><span class="p">,</span>
    <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Observed&#39;</span><span class="p">,</span> <span class="s1">&#39;Simulated&#39;</span><span class="p">],</span>
    <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Streamflow Comparison&#39;</span>
<span class="p">)</span>

<span class="c1"># Create performance scatter plot</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">hu</span><span class="o">.</span><span class="n">plot_scatter_performance</span><span class="p">(</span>
    <span class="n">observed</span><span class="p">,</span> <span class="n">simulated</span><span class="p">,</span>
    <span class="n">add_stats</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>  <span class="c1"># Add NSE, RÂ², etc.</span>
    <span class="n">add_1to1_line</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
</code></pre></div></td></tr></table></div>
<h2 id="api-reference">API Reference<a class="headerlink" href="#api-reference" title="Permanent link">&para;</a></h2>


  <div class="doc doc-object doc-module">

<a id="hydroutils.hydro_plot"></a>
    <div class="doc doc-contents first">

      <p>Author: Wenyu Ouyang
Date: 2022-12-02 10:59:30
LastEditTime: 2025-01-17 17:30:55
LastEditors: Wenyu Ouyang
Description: Some common plots for hydrology
FilePath: /hydroutils/hydroutils/hydro_plot.py
Copyright (c) 2021-2022 Wenyu Ouyang. All rights reserved.</p>



  <div class="doc doc-children">








  <div class="doc doc-object doc-function">



<h2 id="hydroutils.hydro_plot.create_median_labels" class="doc doc-heading">
<code class="highlight language-python"><span class="n">create_median_labels</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">medians_value</span><span class="p">,</span> <span class="n">percent25value</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">percent75value</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="s1">&#39;small&#39;</span><span class="p">)</span></code>


<a href="#hydroutils.hydro_plot.create_median_labels" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>"create median labels for boxes in a boxplot
Parameters</p>
<hr />
<p>ax : plt.AxesSubplot
    an ax in a fig
medians_value : np.array
    <em>description</em>
percent25value : <em>type</em>, optional
    <em>description</em>, by default None
percent75value : <em>type</em>, optional
    <em>description</em>, by default None
size : str, optional
    the size of median-value labels, by default small</p>

        <details class="quote">
          <summary>Source code in <code>hydroutils/hydro_plot.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">create_median_labels</span><span class="p">(</span>
    <span class="n">ax</span><span class="p">,</span> <span class="n">medians_value</span><span class="p">,</span> <span class="n">percent25value</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">percent75value</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="s2">&quot;small&quot;</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; &quot;create median labels for boxes in a boxplot</span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    ax : plt.AxesSubplot</span>
<span class="sd">        an ax in a fig</span>
<span class="sd">    medians_value : np.array</span>
<span class="sd">        _description_</span>
<span class="sd">    percent25value : _type_, optional</span>
<span class="sd">        _description_, by default None</span>
<span class="sd">    percent75value : _type_, optional</span>
<span class="sd">        _description_, by default None</span>
<span class="sd">    size : str, optional</span>
<span class="sd">        the size of median-value labels, by default small</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">decimal_places</span> <span class="o">=</span> <span class="s2">&quot;2&quot;</span>
    <span class="k">if</span> <span class="n">percent25value</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">percent75value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">vertical_offset</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">medians_value</span> <span class="o">*</span> <span class="mf">0.01</span><span class="p">)</span>  <span class="c1"># offset from median for display</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">per25min</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">percent25value</span><span class="p">)</span>
        <span class="n">per75max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">percent75value</span><span class="p">)</span>
        <span class="n">vertical_offset</span> <span class="o">=</span> <span class="p">(</span><span class="n">per75max</span> <span class="o">-</span> <span class="n">per25min</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.01</span>
    <span class="n">median_labels</span> <span class="o">=</span> <span class="p">[</span><span class="nb">format</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;.</span><span class="si">{</span><span class="n">decimal_places</span><span class="si">}</span><span class="s2">f&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">medians_value</span><span class="p">]</span>
    <span class="n">pos</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">medians_value</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">xtick</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_xticks</span><span class="p">():</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
            <span class="n">pos</span><span class="p">[</span><span class="n">xtick</span><span class="p">],</span>
            <span class="n">medians_value</span><span class="p">[</span><span class="n">xtick</span><span class="p">]</span> <span class="o">+</span> <span class="n">vertical_offset</span><span class="p">,</span>
            <span class="n">median_labels</span><span class="p">[</span><span class="n">xtick</span><span class="p">],</span>
            <span class="n">horizontalalignment</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="s2">&quot;w&quot;</span><span class="p">,</span>
            <span class="c1"># https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.text.html</span>
            <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">,</span>
            <span class="n">weight</span><span class="o">=</span><span class="s2">&quot;semibold&quot;</span><span class="p">,</span>
        <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="hydroutils.hydro_plot.plot_boxes_matplotlib" class="doc doc-heading">
<code class="highlight language-python"><span class="n">plot_boxes_matplotlib</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">label1</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">label2</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">leg_col</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">colorlst</span><span class="o">=</span><span class="s1">&#39;rbgcmywrbgcmyw&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">xticklabel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">axin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ylim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">notch</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">widths</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">subplots_adjust_wspace</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">show_median</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">median_line_color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">median_font_size</span><span class="o">=</span><span class="s1">&#39;small&#39;</span><span class="p">)</span></code>


<a href="#hydroutils.hydro_plot.plot_boxes_matplotlib" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Creates multiple boxplots for comparing multiple indicators or groups.</p>
<p>This function generates a sophisticated boxplot visualization with multiple customization
options, including median display, notched boxes, and flexible layout options. It's
particularly useful for comparing distributions across different groups or indicators.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>data</code></td>
        <td><code>list</code></td>
        <td><p>List of arrays, where each array contains the data for one indicator
or group to be displayed as a boxplot.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>label1</code></td>
        <td><code>list</code></td>
        <td><p>Labels for each subplot. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>label2</code></td>
        <td><code>list</code></td>
        <td><p>Legend labels for boxes within each subplot. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>leg_col</code></td>
        <td><code>int</code></td>
        <td><p>Number of columns in the legend. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>colorlst</code></td>
        <td><code>str</code></td>
        <td><p>String of color characters for box colors. Defaults to
"rbgcmywrbgcmyw".</p></td>
        <td><code>&#39;rbgcmywrbgcmyw&#39;</code></td>
      </tr>
      <tr>
        <td><code>title</code></td>
        <td><code>str</code></td>
        <td><p>Title of the plot. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>figsize</code></td>
        <td><code>tuple</code></td>
        <td><p>Figure size as (width, height). Defaults to (8, 6).</p></td>
        <td><code>(8, 6)</code></td>
      </tr>
      <tr>
        <td><code>sharey</code></td>
        <td><code>bool</code></td>
        <td><p>If True, all subplots share the same y-axis scale.
Defaults to False.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>xticklabel</code></td>
        <td><code>list</code></td>
        <td><p>Custom x-axis tick labels. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>axin</code></td>
        <td><code>matplotlib.axes.Axes</code></td>
        <td><p>Existing axes to plot on. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>ylim</code></td>
        <td><code>list</code></td>
        <td><p>Y-axis limits as [min, max]. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>ylabel</code></td>
        <td><code>list</code></td>
        <td><p>Y-axis labels for each subplot. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>notch</code></td>
        <td><code>bool</code></td>
        <td><p>If True, creates notched boxes. Defaults to False.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>widths</code></td>
        <td><code>float</code></td>
        <td><p>Width of the boxes. Defaults to 0.5.</p></td>
        <td><code>0.5</code></td>
      </tr>
      <tr>
        <td><code>subplots_adjust_wspace</code></td>
        <td><code>float</code></td>
        <td><p>Width space between subplots.
Defaults to 0.2.</p></td>
        <td><code>0.2</code></td>
      </tr>
      <tr>
        <td><code>show_median</code></td>
        <td><code>bool</code></td>
        <td><p>If True, displays median values. Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>median_line_color</code></td>
        <td><code>str</code></td>
        <td><p>Color of median lines. Defaults to "black".</p></td>
        <td><code>&#39;black&#39;</code></td>
      </tr>
      <tr>
        <td><code>median_font_size</code></td>
        <td><code>str</code></td>
        <td><p>Font size for median values. Defaults to "small".</p></td>
        <td><code>&#39;small&#39;</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Union[matplotlib.figure.Figure, Tuple[matplotlib.axes.Axes, dict]]</code></td>
      <td><p>If axin is None, returns the Figure object.
    If axin is provided, returns a tuple of (Axes, boxplot_dict).</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">fig</span> <span class="o">=</span> <span class="n">plot_boxes_matplotlib</span><span class="p">(</span>
<span class="o">...</span>     <span class="n">data</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">label1</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Group A&#39;</span><span class="p">,</span> <span class="s1">&#39;Group B&#39;</span><span class="p">,</span> <span class="s1">&#39;Group C&#39;</span><span class="p">],</span>
<span class="o">...</span>     <span class="n">show_median</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">notch</span><span class="o">=</span><span class="kc">True</span>
<span class="o">...</span> <span class="p">)</span>
</code></pre></div>
      <p>!!! notes
    - The function automatically handles NaN values in the data.
    - Median values can be displayed with customizable formatting.
    - Supports both single and multiple subplot layouts.</p>

        <details class="quote">
          <summary>Source code in <code>hydroutils/hydro_plot.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_boxes_matplotlib</span><span class="p">(</span>
    <span class="n">data</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span>
    <span class="n">label1</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">label2</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">leg_col</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">colorlst</span><span class="o">=</span><span class="s2">&quot;rbgcmywrbgcmyw&quot;</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span>
    <span class="n">sharey</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">xticklabel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">axin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">ylim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">ylabel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">notch</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">widths</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
    <span class="n">subplots_adjust_wspace</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
    <span class="n">show_median</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">median_line_color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span>
    <span class="n">median_font_size</span><span class="o">=</span><span class="s2">&quot;small&quot;</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates multiple boxplots for comparing multiple indicators or groups.</span>

<span class="sd">    This function generates a sophisticated boxplot visualization with multiple customization</span>
<span class="sd">    options, including median display, notched boxes, and flexible layout options. It&#39;s</span>
<span class="sd">    particularly useful for comparing distributions across different groups or indicators.</span>

<span class="sd">    Args:</span>
<span class="sd">        data (list): List of arrays, where each array contains the data for one indicator</span>
<span class="sd">            or group to be displayed as a boxplot.</span>
<span class="sd">        label1 (list, optional): Labels for each subplot. Defaults to None.</span>
<span class="sd">        label2 (list, optional): Legend labels for boxes within each subplot. Defaults to None.</span>
<span class="sd">        leg_col (int, optional): Number of columns in the legend. Defaults to None.</span>
<span class="sd">        colorlst (str, optional): String of color characters for box colors. Defaults to</span>
<span class="sd">            &quot;rbgcmywrbgcmyw&quot;.</span>
<span class="sd">        title (str, optional): Title of the plot. Defaults to None.</span>
<span class="sd">        figsize (tuple, optional): Figure size as (width, height). Defaults to (8, 6).</span>
<span class="sd">        sharey (bool, optional): If True, all subplots share the same y-axis scale.</span>
<span class="sd">            Defaults to False.</span>
<span class="sd">        xticklabel (list, optional): Custom x-axis tick labels. Defaults to None.</span>
<span class="sd">        axin (matplotlib.axes.Axes, optional): Existing axes to plot on. Defaults to None.</span>
<span class="sd">        ylim (list, optional): Y-axis limits as [min, max]. Defaults to None.</span>
<span class="sd">        ylabel (list, optional): Y-axis labels for each subplot. Defaults to None.</span>
<span class="sd">        notch (bool, optional): If True, creates notched boxes. Defaults to False.</span>
<span class="sd">        widths (float, optional): Width of the boxes. Defaults to 0.5.</span>
<span class="sd">        subplots_adjust_wspace (float, optional): Width space between subplots.</span>
<span class="sd">            Defaults to 0.2.</span>
<span class="sd">        show_median (bool, optional): If True, displays median values. Defaults to True.</span>
<span class="sd">        median_line_color (str, optional): Color of median lines. Defaults to &quot;black&quot;.</span>
<span class="sd">        median_font_size (str, optional): Font size for median values. Defaults to &quot;small&quot;.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Union[matplotlib.figure.Figure, Tuple[matplotlib.axes.Axes, dict]]:</span>
<span class="sd">            If axin is None, returns the Figure object.</span>
<span class="sd">            If axin is provided, returns a tuple of (Axes, boxplot_dict).</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; data = [np.random.normal(0, 1, 100) for _ in range(3)]</span>
<span class="sd">        &gt;&gt;&gt; fig = plot_boxes_matplotlib(</span>
<span class="sd">        ...     data,</span>
<span class="sd">        ...     label1=[&#39;Group A&#39;, &#39;Group B&#39;, &#39;Group C&#39;],</span>
<span class="sd">        ...     show_median=True,</span>
<span class="sd">        ...     notch=True</span>
<span class="sd">        ... )</span>

<span class="sd">    Notes:</span>
<span class="sd">        - The function automatically handles NaN values in the data.</span>
<span class="sd">        - Median values can be displayed with customizable formatting.</span>
<span class="sd">        - Supports both single and multiple subplot layouts.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">nc</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">axin</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span>
            <span class="n">ncols</span><span class="o">=</span><span class="n">nc</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="n">sharey</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">,</span> <span class="n">constrained_layout</span><span class="o">=</span><span class="kc">False</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">axes</span> <span class="o">=</span> <span class="n">axin</span>

    <span class="c1"># the next few lines are for showing median values</span>
    <span class="n">decimal_places</span> <span class="o">=</span> <span class="s2">&quot;2&quot;</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nc</span><span class="p">):</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="k">if</span> <span class="n">nc</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">axes</span>
        <span class="n">temp</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">kk</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">temp</span><span class="p">)):</span>
                <span class="n">tt</span> <span class="o">=</span> <span class="n">temp</span><span class="p">[</span><span class="n">kk</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">tt</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">tt</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">tt</span> <span class="o">=</span> <span class="n">tt</span><span class="p">[</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">tt</span><span class="p">)]</span>
                    <span class="n">temp</span><span class="p">[</span><span class="n">kk</span><span class="p">]</span> <span class="o">=</span> <span class="n">tt</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">temp</span><span class="p">[</span><span class="n">kk</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">temp</span> <span class="o">=</span> <span class="n">temp</span><span class="p">[</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">temp</span><span class="p">)]</span>
        <span class="n">bp</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span>
            <span class="n">temp</span><span class="p">,</span> <span class="n">patch_artist</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">notch</span><span class="o">=</span><span class="n">notch</span><span class="p">,</span> <span class="n">showfliers</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">widths</span><span class="o">=</span><span class="n">widths</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">median</span> <span class="ow">in</span> <span class="n">bp</span><span class="p">[</span><span class="s2">&quot;medians&quot;</span><span class="p">]:</span>
            <span class="n">median</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="n">median_line_color</span><span class="p">)</span>
        <span class="n">medians_value</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span> <span class="k">for</span> <span class="n">tmp</span> <span class="ow">in</span> <span class="n">temp</span><span class="p">]</span>
        <span class="n">percent25value</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">tmp</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span> <span class="k">for</span> <span class="n">tmp</span> <span class="ow">in</span> <span class="n">temp</span><span class="p">]</span>
        <span class="n">percent75value</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">tmp</span><span class="p">,</span> <span class="mi">75</span><span class="p">)</span> <span class="k">for</span> <span class="n">tmp</span> <span class="ow">in</span> <span class="n">temp</span><span class="p">]</span>
        <span class="n">per25min</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">percent25value</span><span class="p">)</span>
        <span class="n">per75max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">percent75value</span><span class="p">)</span>
        <span class="n">median_labels</span> <span class="o">=</span> <span class="p">[</span><span class="nb">format</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;.</span><span class="si">{</span><span class="n">decimal_places</span><span class="si">}</span><span class="s2">f&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">medians_value</span><span class="p">]</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">medians_value</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">show_median</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">tick</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">()):</span>
                <span class="c1"># params of ax.text could be seen here: https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.text.html</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
                    <span class="n">pos</span><span class="p">[</span><span class="n">tick</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
                    <span class="n">medians_value</span><span class="p">[</span><span class="n">tick</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">per75max</span> <span class="o">-</span> <span class="n">per25min</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.01</span><span class="p">,</span>
                    <span class="n">median_labels</span><span class="p">[</span><span class="n">tick</span><span class="p">],</span>
                    <span class="n">horizontalalignment</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
                    <span class="c1"># https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.text.html</span>
                    <span class="n">size</span><span class="o">=</span><span class="n">median_font_size</span><span class="p">,</span>
                    <span class="n">weight</span><span class="o">=</span><span class="s2">&quot;semibold&quot;</span><span class="p">,</span>
                    <span class="n">color</span><span class="o">=</span><span class="n">median_line_color</span><span class="p">,</span>
                <span class="p">)</span>
        <span class="k">for</span> <span class="n">kk</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">bp</span><span class="p">[</span><span class="s2">&quot;boxes&quot;</span><span class="p">])):</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">bp</span><span class="p">[</span><span class="s2">&quot;boxes&quot;</span><span class="p">][</span><span class="n">kk</span><span class="p">],</span> <span class="n">facecolor</span><span class="o">=</span><span class="n">colorlst</span><span class="p">[</span><span class="n">kk</span><span class="p">])</span>

        <span class="k">if</span> <span class="n">label1</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">label1</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">xticklabel</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([</span><span class="n">y</span> <span class="o">+</span> <span class="mi">1</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">k</span><span class="p">]),</span> <span class="mi">2</span><span class="p">)])</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">xticklabel</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ylabel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">ylim</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ylim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">label2</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span>
            <span class="n">bp</span><span class="p">[</span><span class="s2">&quot;boxes&quot;</span><span class="p">],</span>
            <span class="n">label2</span><span class="p">,</span>
            <span class="c1"># explanation for bbox_to_anchor: https://zhuanlan.zhihu.com/p/101059179</span>
            <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.02</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">),</span>
            <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper right&quot;</span><span class="p">,</span>
            <span class="n">borderaxespad</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
            <span class="n">ncol</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">label2</span><span class="p">)</span> <span class="k">if</span> <span class="n">leg_col</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">leg_col</span><span class="p">,</span>
            <span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">if</span> <span class="n">title</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># fig.suptitle(title)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">wspace</span><span class="o">=</span><span class="n">subplots_adjust_wspace</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">fig</span> <span class="k">if</span> <span class="n">axin</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">bp</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="hydroutils.hydro_plot.plot_boxs" class="doc doc-heading">
<code class="highlight language-python"><span class="n">plot_boxs</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">x_name</span><span class="p">,</span> <span class="n">y_name</span><span class="p">,</span> <span class="n">uniform_color</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">swarm_plot</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">colormap</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ylim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="s1">&#39;serif&#39;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span> <span class="n">show_median</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


<a href="#hydroutils.hydro_plot.plot_boxs" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>plot multiple boxes in one ax with seaborn
Parameters</p>
<hr />
<p>data : pd.DataFrame
    a tidy pandas dataframe;
    if you don't know what is "tidy data", please read: https://github.com/jizhang/pandas-tidy-data
x_name : str
    the names of each box
y_name : str
    what is shown
uniform_color : str, optional
    unified color for all boxes, by default None
swarm_plot : bool, optional
    <em>description</em>, by default False
hue : <em>type</em>, optional
    <em>description</em>, by default None
colormap : bool, optional
    <em>description</em>, by default False
xlim : <em>type</em>, optional
    <em>description</em>, by default None
ylim : <em>type</em>, optional
    <em>description</em>, by default None
order : <em>type</em>, optional
    <em>description</em>, by default None
font : str, optional
    <em>description</em>, by default "serif"
rotation : int, optional
    rotation for labels in x-axis, by default 45
!!! show_median "bool, optional"
    if True, show median value for each box, by default False
Returns</p>
<hr />
<p><em>type</em>
    <em>description</em></p>

        <details class="quote">
          <summary>Source code in <code>hydroutils/hydro_plot.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_boxs</span><span class="p">(</span>
    <span class="n">data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">x_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">y_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">uniform_color</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">swarm_plot</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">hue</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">colormap</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">xlim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">ylim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">order</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">font</span><span class="o">=</span><span class="s2">&quot;serif&quot;</span><span class="p">,</span>
    <span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span>
    <span class="n">show_median</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;plot multiple boxes in one ax with seaborn</span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : pd.DataFrame</span>
<span class="sd">        a tidy pandas dataframe;</span>
<span class="sd">        if you don&#39;t know what is &quot;tidy data&quot;, please read: https://github.com/jizhang/pandas-tidy-data</span>
<span class="sd">    x_name : str</span>
<span class="sd">        the names of each box</span>
<span class="sd">    y_name : str</span>
<span class="sd">        what is shown</span>
<span class="sd">    uniform_color : str, optional</span>
<span class="sd">        unified color for all boxes, by default None</span>
<span class="sd">    swarm_plot : bool, optional</span>
<span class="sd">        _description_, by default False</span>
<span class="sd">    hue : _type_, optional</span>
<span class="sd">        _description_, by default None</span>
<span class="sd">    colormap : bool, optional</span>
<span class="sd">        _description_, by default False</span>
<span class="sd">    xlim : _type_, optional</span>
<span class="sd">        _description_, by default None</span>
<span class="sd">    ylim : _type_, optional</span>
<span class="sd">        _description_, by default None</span>
<span class="sd">    order : _type_, optional</span>
<span class="sd">        _description_, by default None</span>
<span class="sd">    font : str, optional</span>
<span class="sd">        _description_, by default &quot;serif&quot;</span>
<span class="sd">    rotation : int, optional</span>
<span class="sd">        rotation for labels in x-axis, by default 45</span>
<span class="sd">    show_median: bool, optional</span>
<span class="sd">        if True, show median value for each box, by default False</span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    _type_</span>
<span class="sd">        _description_</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s2">&quot;ticks&quot;</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s2">&quot;pastel&quot;</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="n">font</span><span class="p">,</span> <span class="n">font_scale</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
    <span class="c1"># Draw a nested boxplot to show bills by day and time</span>
    <span class="k">if</span> <span class="n">uniform_color</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">sns_box</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span>
            <span class="n">x</span><span class="o">=</span><span class="n">x_name</span><span class="p">,</span>
            <span class="n">y</span><span class="o">=</span><span class="n">y_name</span><span class="p">,</span>
            <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="n">uniform_color</span><span class="p">,</span>
            <span class="n">showfliers</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">order</span><span class="o">=</span><span class="n">order</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">sns_box</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span>
            <span class="n">x</span><span class="o">=</span><span class="n">x_name</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y_name</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">showfliers</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="n">order</span>
        <span class="p">)</span>
    <span class="k">if</span> <span class="n">swarm_plot</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">hue</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">sns_box</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">swarmplot</span><span class="p">(</span>
                <span class="n">x</span><span class="o">=</span><span class="n">x_name</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y_name</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;.2&quot;</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="n">order</span>
            <span class="p">)</span>
        <span class="k">elif</span> <span class="n">colormap</span><span class="p">:</span>
            <span class="c1"># Create a matplotlib colormap from the sns seagreen color palette</span>
            <span class="n">cmap</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">light_palette</span><span class="p">(</span><span class="s2">&quot;seagreen&quot;</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">as_cmap</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="c1"># Normalize to the range of possible values from df[&quot;c&quot;]</span>
            <span class="n">norm</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span>
                <span class="n">vmin</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="n">hue</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">vmax</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="n">hue</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
            <span class="p">)</span>
            <span class="n">colors</span> <span class="o">=</span> <span class="p">{</span><span class="n">cval</span><span class="p">:</span> <span class="n">cmap</span><span class="p">(</span><span class="n">norm</span><span class="p">(</span><span class="n">cval</span><span class="p">))</span> <span class="k">for</span> <span class="n">cval</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="n">hue</span><span class="p">]}</span>
            <span class="c1"># plot the swarmplot with the colors dictionary as palette, s=2 means size is 2</span>
            <span class="n">sns_box</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">swarmplot</span><span class="p">(</span>
                <span class="n">x</span><span class="o">=</span><span class="n">x_name</span><span class="p">,</span>
                <span class="n">y</span><span class="o">=</span><span class="n">y_name</span><span class="p">,</span>
                <span class="n">hue</span><span class="o">=</span><span class="n">hue</span><span class="p">,</span>
                <span class="n">s</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
                <span class="n">palette</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span>
                <span class="n">order</span><span class="o">=</span><span class="n">order</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="c1"># remove the legend, because we want to set a colorbar instead</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">legend_</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
            <span class="c1"># create colorbar</span>
            <span class="n">divider</span> <span class="o">=</span> <span class="n">make_axes_locatable</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">())</span>
            <span class="n">ax_cb</span> <span class="o">=</span> <span class="n">divider</span><span class="o">.</span><span class="n">new_horizontal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="s2">&quot;5%&quot;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
            <span class="n">fig</span> <span class="o">=</span> <span class="n">sns_box</span><span class="o">.</span><span class="n">get_figure</span><span class="p">()</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">(</span><span class="n">ax_cb</span><span class="p">)</span>
            <span class="n">cb1</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">colorbar</span><span class="o">.</span><span class="n">ColorbarBase</span><span class="p">(</span>
                <span class="n">ax_cb</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s2">&quot;vertical&quot;</span>
            <span class="p">)</span>
            <span class="n">cb1</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s2">&quot;Some Units&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">palette</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">light_palette</span><span class="p">(</span><span class="s2">&quot;seagreen&quot;</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">n_colors</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
            <span class="n">sns_box</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">swarmplot</span><span class="p">(</span>
                <span class="n">x</span><span class="o">=</span><span class="n">x_name</span><span class="p">,</span>
                <span class="n">y</span><span class="o">=</span><span class="n">y_name</span><span class="p">,</span>
                <span class="n">hue</span><span class="o">=</span><span class="n">hue</span><span class="p">,</span>
                <span class="n">s</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
                <span class="n">palette</span><span class="o">=</span><span class="n">palette</span><span class="p">,</span>
                <span class="n">order</span><span class="o">=</span><span class="n">order</span><span class="p">,</span>
            <span class="p">)</span>
    <span class="k">if</span> <span class="n">xlim</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">xlim</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">ylim</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="n">ylim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ylim</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">show_median</span><span class="p">:</span>
        <span class="n">medians</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="n">x_name</span><span class="p">],</span> <span class="n">sort</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="n">y_name</span><span class="p">]</span><span class="o">.</span><span class="n">median</span><span class="p">()</span><span class="o">.</span><span class="n">values</span>
        <span class="n">create_median_labels</span><span class="p">(</span><span class="n">sns_box</span><span class="p">,</span> <span class="n">medians_value</span><span class="o">=</span><span class="n">medians</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="s2">&quot;x-small&quot;</span><span class="p">)</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>
    <span class="n">locs</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="n">rotation</span><span class="p">)</span>
    <span class="c1"># plt.show()</span>
    <span class="k">return</span> <span class="n">sns_box</span><span class="o">.</span><span class="n">get_figure</span><span class="p">()</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="hydroutils.hydro_plot.plot_diff_boxes" class="doc doc-heading">
<code class="highlight language-python"><span class="n">plot_diff_boxes</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">row_and_col</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">y_col</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">x_col</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">title_str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">title_font_size</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span></code>


<a href="#hydroutils.hydro_plot.plot_diff_boxes" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>plot boxplots in rows and cols</p>

        <details class="quote">
          <summary>Source code in <code>hydroutils/hydro_plot.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_diff_boxes</span><span class="p">(</span>
    <span class="n">data</span><span class="p">,</span>
    <span class="n">row_and_col</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">y_col</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">x_col</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">hspace</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>
    <span class="n">wspace</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">title_str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">title_font_size</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;plot boxplots in rows and cols&quot;&quot;&quot;</span>
    <span class="c1"># matplotlib.use(&#39;TkAgg&#39;)</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="n">subplot_num</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="n">y_col</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_col</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">row_and_col</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">row_num</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">col_num</span> <span class="o">=</span> <span class="n">subplot_num</span>
        <span class="n">f</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">row_num</span><span class="p">,</span> <span class="n">col_num</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">hspace</span><span class="o">=</span><span class="n">hspace</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="n">wspace</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">assert</span> <span class="n">subplot_num</span> <span class="o">&lt;=</span> <span class="n">row_and_col</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">row_and_col</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">row_num</span> <span class="o">=</span> <span class="n">row_and_col</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">col_num</span> <span class="o">=</span> <span class="n">row_and_col</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">f</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">row_num</span><span class="p">,</span> <span class="n">col_num</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">subplot_num</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">y_col</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">row_num</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">col_num</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span>
                    <span class="n">y</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                    <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
                    <span class="n">width</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
                    <span class="n">orient</span><span class="o">=</span><span class="s2">&quot;v&quot;</span><span class="p">,</span>
                    <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                    <span class="n">showfliers</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="p">)</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">row_idx</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">i</span> <span class="o">/</span> <span class="n">col_num</span><span class="p">)</span>
                <span class="n">col_idx</span> <span class="o">=</span> <span class="n">i</span> <span class="o">%</span> <span class="n">col_num</span>
                <span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span>
                    <span class="n">y</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                    <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
                    <span class="n">orient</span><span class="o">=</span><span class="s2">&quot;v&quot;</span><span class="p">,</span>
                    <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="n">row_idx</span><span class="p">,</span> <span class="n">col_idx</span><span class="p">],</span>
                    <span class="n">showfliers</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">assert</span> <span class="n">x_col</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
            <span class="k">if</span> <span class="n">row_num</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">col_num</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span>
                    <span class="n">x</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">x_col</span><span class="p">],</span>
                    <span class="n">y</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">y_col</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span>
                    <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
                    <span class="n">orient</span><span class="o">=</span><span class="s2">&quot;v&quot;</span><span class="p">,</span>
                    <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                    <span class="n">showfliers</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">row_idx</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">i</span> <span class="o">/</span> <span class="n">col_num</span><span class="p">)</span>
                <span class="n">col_idx</span> <span class="o">=</span> <span class="n">i</span> <span class="o">%</span> <span class="n">col_num</span>
                <span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span>
                    <span class="n">x</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">x_col</span><span class="p">],</span>
                    <span class="n">y</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">y_col</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span>
                    <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
                    <span class="n">orient</span><span class="o">=</span><span class="s2">&quot;v&quot;</span><span class="p">,</span>
                    <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="n">row_idx</span><span class="p">,</span> <span class="n">col_idx</span><span class="p">],</span>
                    <span class="n">showfliers</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="p">)</span>
    <span class="k">if</span> <span class="n">title_str</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">f</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">title_str</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">title_font_size</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">f</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="hydroutils.hydro_plot.plot_ecdf" class="doc doc-heading">
<code class="highlight language-python"><span class="n">plot_ecdf</span><span class="p">(</span><span class="n">mydataframe</span><span class="p">,</span> <span class="n">mycolumn</span><span class="p">,</span> <span class="n">save_file</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#hydroutils.hydro_plot.plot_ecdf" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Creates an empirical cumulative distribution function (ECDF) plot for a single column.</p>
<p>This function generates an ECDF plot for a single column of data from a pandas
DataFrame. It provides a simple interface for quick visualization of data
distributions.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>mydataframe</code></td>
        <td><code>pd.DataFrame</code></td>
        <td><p>DataFrame containing the data to plot.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>mycolumn</code></td>
        <td><code>str</code></td>
        <td><p>Name of the column to create ECDF for.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>save_file</code></td>
        <td><code>str</code></td>
        <td><p>Path to save the plot. If None, plot is only
displayed. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;values&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)})</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">plot_ecdf</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s1">&#39;values&#39;</span><span class="p">,</span> <span class="s1">&#39;normal_dist_ecdf.png&#39;</span><span class="p">)</span>
</code></pre></div>
      <p>!!! notes
    - Uses seaborn's styling for better visualization
    - Automatically handles NaN values
    - Plot range is set to [0, 1] for both axes
    - Uses 0.05 intervals for axis ticks</p>

        <details class="quote">
          <summary>Source code in <code>hydroutils/hydro_plot.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_ecdf</span><span class="p">(</span><span class="n">mydataframe</span><span class="p">,</span> <span class="n">mycolumn</span><span class="p">,</span> <span class="n">save_file</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates an empirical cumulative distribution function (ECDF) plot for a single column.</span>

<span class="sd">    This function generates an ECDF plot for a single column of data from a pandas</span>
<span class="sd">    DataFrame. It provides a simple interface for quick visualization of data</span>
<span class="sd">    distributions.</span>

<span class="sd">    Args:</span>
<span class="sd">        mydataframe (pd.DataFrame): DataFrame containing the data to plot.</span>
<span class="sd">        mycolumn (str): Name of the column to create ECDF for.</span>
<span class="sd">        save_file (str, optional): Path to save the plot. If None, plot is only</span>
<span class="sd">            displayed. Defaults to None.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; df = pd.DataFrame({&#39;values&#39;: np.random.normal(0, 1, 1000)})</span>
<span class="sd">        &gt;&gt;&gt; plot_ecdf(df, &#39;values&#39;, &#39;normal_dist_ecdf.png&#39;)</span>

<span class="sd">    Notes:</span>
<span class="sd">        - Uses seaborn&#39;s styling for better visualization</span>
<span class="sd">        - Automatically handles NaN values</span>
<span class="sd">        - Plot range is set to [0, 1] for both axes</span>
<span class="sd">        - Uses 0.05 intervals for axis ticks</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">ecdf</span><span class="p">(</span><span class="n">mydataframe</span><span class="p">[</span><span class="n">mycolumn</span><span class="p">])</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="n">x</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="n">y</span><span class="p">})</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s2">&quot;ticks&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;axes.grid&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">estimator</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span><span class="o">.</span><span class="n">set</span><span class="p">(</span>
        <span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">xticks</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">),</span> <span class="n">yticks</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">save_file</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">save_file</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="hydroutils.hydro_plot.plot_ecdfs" class="doc doc-heading">
<code class="highlight language-python"><span class="n">plot_ecdfs</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">ys</span><span class="p">,</span> <span class="n">legends</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">case_str</span><span class="o">=</span><span class="s1">&#39;case&#39;</span><span class="p">,</span> <span class="n">event_str</span><span class="o">=</span><span class="s1">&#39;event&#39;</span><span class="p">,</span> <span class="n">x_str</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">y_str</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">ax_as_subplot</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span></code>


<a href="#hydroutils.hydro_plot.plot_ecdfs" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Creates empirical cumulative distribution function (ECDF) plots for multiple datasets.</p>
<p>This function generates ECDF plots for multiple datasets with customizable styling
and labeling options. It's particularly useful for comparing distributions of
different datasets or experimental conditions.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>xs</code></td>
        <td><code>list[np.array]</code></td>
        <td><p>List of x-values arrays for each ECDF.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>ys</code></td>
        <td><code>list[np.array]</code></td>
        <td><p>List of y-values arrays for each ECDF.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>legends</code></td>
        <td><code>list[str]</code></td>
        <td><p>Legend labels for each ECDF. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>style</code></td>
        <td><code>list[str]</code></td>
        <td><p>Line styles for each ECDF. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>case_str</code></td>
        <td><code>str</code></td>
        <td><p>Label for different cases in the plot.
Defaults to "case".</p></td>
        <td><code>&#39;case&#39;</code></td>
      </tr>
      <tr>
        <td><code>event_str</code></td>
        <td><code>str</code></td>
        <td><p>Label for different events in the plot.
Defaults to "event".</p></td>
        <td><code>&#39;event&#39;</code></td>
      </tr>
      <tr>
        <td><code>x_str</code></td>
        <td><code>str</code></td>
        <td><p>X-axis label. Defaults to "x".</p></td>
        <td><code>&#39;x&#39;</code></td>
      </tr>
      <tr>
        <td><code>y_str</code></td>
        <td><code>str</code></td>
        <td><p>Y-axis label. Defaults to "y".</p></td>
        <td><code>&#39;y&#39;</code></td>
      </tr>
      <tr>
        <td><code>ax_as_subplot</code></td>
        <td><code>matplotlib.axes.Axes</code></td>
        <td><p>Existing axes to plot on.
Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>interval</code></td>
        <td><code>float</code></td>
        <td><p>Interval for axis ticks. Defaults to 0.1.</p></td>
        <td><code>0.1</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>matplotlib.axes.Axes</code></td>
      <td><p>The axes object containing the ECDF plots.</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="c1"># Compare two distributions</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">x1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">x2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">,</span> <span class="mi">1000</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">x1</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">x2</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plot_ecdfs</span><span class="p">(</span>
<span class="o">...</span>     <span class="p">[</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">],</span> <span class="p">[</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">],</span>
<span class="o">...</span>     <span class="n">legends</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Distribution 1&#39;</span><span class="p">,</span> <span class="s1">&#39;Distribution 2&#39;</span><span class="p">],</span>
<span class="o">...</span>     <span class="n">x_str</span><span class="o">=</span><span class="s1">&#39;Value&#39;</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">y_str</span><span class="o">=</span><span class="s1">&#39;Cumulative Probability&#39;</span>
<span class="o">...</span> <span class="p">)</span>
</code></pre></div>
    <div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="c1"># Multiple distributions with different styles</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plot_ecdfs</span><span class="p">(</span>
<span class="o">...</span>     <span class="p">[</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">],</span> <span class="p">[</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">],</span>
<span class="o">...</span>     <span class="n">legends</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Group A&#39;</span><span class="p">,</span> <span class="s1">&#39;Group B&#39;</span><span class="p">],</span>
<span class="o">...</span>     <span class="n">style</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">],</span>
<span class="o">...</span>     <span class="n">interval</span><span class="o">=</span><span class="mf">0.2</span>
<span class="o">...</span> <span class="p">)</span>
</code></pre></div>
      <p>!!! notes
    - Input arrays must be sorted in ascending order
    - Function automatically validates data ordering
    - Supports both single and multiple subplot layouts
    - Uses seaborn for enhanced visual styling</p>

        <details class="quote">
          <summary>Source code in <code>hydroutils/hydro_plot.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_ecdfs</span><span class="p">(</span>
    <span class="n">xs</span><span class="p">,</span>
    <span class="n">ys</span><span class="p">,</span>
    <span class="n">legends</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">style</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">case_str</span><span class="o">=</span><span class="s2">&quot;case&quot;</span><span class="p">,</span>
    <span class="n">event_str</span><span class="o">=</span><span class="s2">&quot;event&quot;</span><span class="p">,</span>
    <span class="n">x_str</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span>
    <span class="n">y_str</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span>
    <span class="n">ax_as_subplot</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">interval</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates empirical cumulative distribution function (ECDF) plots for multiple datasets.</span>

<span class="sd">    This function generates ECDF plots for multiple datasets with customizable styling</span>
<span class="sd">    and labeling options. It&#39;s particularly useful for comparing distributions of</span>
<span class="sd">    different datasets or experimental conditions.</span>

<span class="sd">    Args:</span>
<span class="sd">        xs (list[np.array]): List of x-values arrays for each ECDF.</span>
<span class="sd">        ys (list[np.array]): List of y-values arrays for each ECDF.</span>
<span class="sd">        legends (list[str], optional): Legend labels for each ECDF. Defaults to None.</span>
<span class="sd">        style (list[str], optional): Line styles for each ECDF. Defaults to None.</span>
<span class="sd">        case_str (str, optional): Label for different cases in the plot.</span>
<span class="sd">            Defaults to &quot;case&quot;.</span>
<span class="sd">        event_str (str, optional): Label for different events in the plot.</span>
<span class="sd">            Defaults to &quot;event&quot;.</span>
<span class="sd">        x_str (str, optional): X-axis label. Defaults to &quot;x&quot;.</span>
<span class="sd">        y_str (str, optional): Y-axis label. Defaults to &quot;y&quot;.</span>
<span class="sd">        ax_as_subplot (matplotlib.axes.Axes, optional): Existing axes to plot on.</span>
<span class="sd">            Defaults to None.</span>
<span class="sd">        interval (float, optional): Interval for axis ticks. Defaults to 0.1.</span>

<span class="sd">    Returns:</span>
<span class="sd">        matplotlib.axes.Axes: The axes object containing the ECDF plots.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; # Compare two distributions</span>
<span class="sd">        &gt;&gt;&gt; x1 = np.sort(np.random.normal(0, 1, 1000))</span>
<span class="sd">        &gt;&gt;&gt; x2 = np.sort(np.random.normal(0.5, 1.2, 1000))</span>
<span class="sd">        &gt;&gt;&gt; y1 = np.linspace(0, 1, len(x1))</span>
<span class="sd">        &gt;&gt;&gt; y2 = np.linspace(0, 1, len(x2))</span>
<span class="sd">        &gt;&gt;&gt; ax = plot_ecdfs(</span>
<span class="sd">        ...     [x1, x2], [y1, y2],</span>
<span class="sd">        ...     legends=[&#39;Distribution 1&#39;, &#39;Distribution 2&#39;],</span>
<span class="sd">        ...     x_str=&#39;Value&#39;,</span>
<span class="sd">        ...     y_str=&#39;Cumulative Probability&#39;</span>
<span class="sd">        ... )</span>

<span class="sd">        &gt;&gt;&gt; # Multiple distributions with different styles</span>
<span class="sd">        &gt;&gt;&gt; ax = plot_ecdfs(</span>
<span class="sd">        ...     [x1, x2], [y1, y2],</span>
<span class="sd">        ...     legends=[&#39;Group A&#39;, &#39;Group B&#39;],</span>
<span class="sd">        ...     style=[&#39;-&#39;, &#39;--&#39;],</span>
<span class="sd">        ...     interval=0.2</span>
<span class="sd">        ... )</span>

<span class="sd">    Notes:</span>
<span class="sd">        - Input arrays must be sorted in ascending order</span>
<span class="sd">        - Function automatically validates data ordering</span>
<span class="sd">        - Supports both single and multiple subplot layouts</span>
<span class="sd">        - Uses seaborn for enhanced visual styling</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ys</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">xs</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">ys</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">legends</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">legends</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">ys</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">legends</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">style</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">style</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">ys</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">style</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">ys</span><span class="p">:</span>
        <span class="k">assert</span> <span class="nb">all</span><span class="p">(</span><span class="n">xi</span> <span class="o">&lt;</span> <span class="n">yi</span> <span class="k">for</span> <span class="n">xi</span><span class="p">,</span> <span class="n">yi</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">:]))</span>
    <span class="n">frames</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">xs</span><span class="p">)):</span>
        <span class="n">str_i</span> <span class="o">=</span> <span class="n">x_str</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">if</span> <span class="n">legends</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">legends</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">assert</span> <span class="nb">all</span><span class="p">(</span><span class="n">xi</span> <span class="o">&lt;</span> <span class="n">yi</span> <span class="k">for</span> <span class="n">xi</span><span class="p">,</span> <span class="n">yi</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">xs</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">xs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">:]))</span>
        <span class="n">df_dict_i</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">x_str</span><span class="p">:</span> <span class="n">xs</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
            <span class="n">y_str</span><span class="p">:</span> <span class="n">ys</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
            <span class="n">case_str</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">([</span><span class="n">xs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">size</span><span class="p">],</span> <span class="n">str_i</span><span class="p">),</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="n">style</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">df_dict_i</span><span class="p">[</span><span class="n">event_str</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">([</span><span class="n">xs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">size</span><span class="p">],</span> <span class="n">style</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="n">df_i</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">df_dict_i</span><span class="p">)</span>
        <span class="n">frames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df_i</span><span class="p">)</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">frames</span><span class="p">)</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s2">&quot;ticks&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;axes.grid&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
    <span class="k">if</span> <span class="n">style</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x_str</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y_str</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="n">case_str</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">estimator</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span><span class="o">.</span><span class="n">set</span><span class="p">(</span>
                <span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                <span class="n">xticks</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">interval</span><span class="p">),</span>
                <span class="n">yticks</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">interval</span><span class="p">),</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">ax_as_subplot</span> <span class="ow">is</span> <span class="kc">None</span>
            <span class="k">else</span> <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span>
                <span class="n">ax</span><span class="o">=</span><span class="n">ax_as_subplot</span><span class="p">,</span>
                <span class="n">x</span><span class="o">=</span><span class="n">x_str</span><span class="p">,</span>
                <span class="n">y</span><span class="o">=</span><span class="n">y_str</span><span class="p">,</span>
                <span class="n">hue</span><span class="o">=</span><span class="n">case_str</span><span class="p">,</span>
                <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span>
                <span class="n">estimator</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="p">)</span><span class="o">.</span><span class="n">set</span><span class="p">(</span>
                <span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                <span class="n">xticks</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">interval</span><span class="p">),</span>
                <span class="n">yticks</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">interval</span><span class="p">),</span>
            <span class="p">)</span>
        <span class="p">)</span>
    <span class="k">elif</span> <span class="n">ax_as_subplot</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span>
            <span class="n">x</span><span class="o">=</span><span class="n">x_str</span><span class="p">,</span>
            <span class="n">y</span><span class="o">=</span><span class="n">y_str</span><span class="p">,</span>
            <span class="n">hue</span><span class="o">=</span><span class="n">case_str</span><span class="p">,</span>
            <span class="n">style</span><span class="o">=</span><span class="n">event_str</span><span class="p">,</span>
            <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span>
            <span class="n">estimator</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="p">)</span><span class="o">.</span><span class="n">set</span><span class="p">(</span>
            <span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="n">xticks</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">interval</span><span class="p">),</span>
            <span class="n">yticks</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">interval</span><span class="p">),</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span>
            <span class="n">ax</span><span class="o">=</span><span class="n">ax_as_subplot</span><span class="p">,</span>
            <span class="n">x</span><span class="o">=</span><span class="n">x_str</span><span class="p">,</span>
            <span class="n">y</span><span class="o">=</span><span class="n">y_str</span><span class="p">,</span>
            <span class="n">hue</span><span class="o">=</span><span class="n">case_str</span><span class="p">,</span>
            <span class="n">style</span><span class="o">=</span><span class="n">event_str</span><span class="p">,</span>
            <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span>
            <span class="n">estimator</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="p">)</span><span class="o">.</span><span class="n">set</span><span class="p">(</span>
            <span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="n">xticks</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">interval</span><span class="p">),</span>
            <span class="n">yticks</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">interval</span><span class="p">),</span>
        <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="hydroutils.hydro_plot.plot_ecdfs_matplot" class="doc doc-heading">
<code class="highlight language-python"><span class="n">plot_ecdfs_matplot</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">ys</span><span class="p">,</span> <span class="n">legends</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;rbkgcmy&#39;</span><span class="p">,</span> <span class="n">dash_lines</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">x_str</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">y_str</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">x_interval</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">y_interval</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">x_lim</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">y_lim</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">show_legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">legend_font_size</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">fig_size</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span></code>


<a href="#hydroutils.hydro_plot.plot_ecdfs_matplot" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Creates ECDF plots using matplotlib with extensive customization options.</p>
<p>This function provides a more customizable alternative to the seaborn-based ECDF
plotting functions, offering direct control over matplotlib parameters and styling.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>xs</code></td>
        <td><code>list[np.array]</code></td>
        <td><p>List of x-values arrays for each ECDF.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>ys</code></td>
        <td><code>list[np.array]</code></td>
        <td><p>List of y-values arrays for each ECDF.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>legends</code></td>
        <td><code>list[str]</code></td>
        <td><p>Legend labels for each ECDF. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>colors</code></td>
        <td><code>str</code></td>
        <td><p>String of color characters for different lines.
Defaults to "rbkgcmy".</p></td>
        <td><code>&#39;rbkgcmy&#39;</code></td>
      </tr>
      <tr>
        <td><code>dash_lines</code></td>
        <td><code>list[bool]</code></td>
        <td><p>Specifies which lines should be dashed.
Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>x_str</code></td>
        <td><code>str</code></td>
        <td><p>X-axis label. Defaults to "x".</p></td>
        <td><code>&#39;x&#39;</code></td>
      </tr>
      <tr>
        <td><code>y_str</code></td>
        <td><code>str</code></td>
        <td><p>Y-axis label. Defaults to "y".</p></td>
        <td><code>&#39;y&#39;</code></td>
      </tr>
      <tr>
        <td><code>x_interval</code></td>
        <td><code>float</code></td>
        <td><p>Interval for x-axis ticks. Defaults to 0.1.</p></td>
        <td><code>0.1</code></td>
      </tr>
      <tr>
        <td><code>y_interval</code></td>
        <td><code>float</code></td>
        <td><p>Interval for y-axis ticks. Defaults to 0.1.</p></td>
        <td><code>0.1</code></td>
      </tr>
      <tr>
        <td><code>x_lim</code></td>
        <td><code>tuple</code></td>
        <td><p>X-axis limits as (min, max). Defaults to (0, 1).</p></td>
        <td><code>(0, 1)</code></td>
      </tr>
      <tr>
        <td><code>y_lim</code></td>
        <td><code>tuple</code></td>
        <td><p>Y-axis limits as (min, max). Defaults to (0, 1).</p></td>
        <td><code>(0, 1)</code></td>
      </tr>
      <tr>
        <td><code>show_legend</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to show legend. Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>legend_font_size</code></td>
        <td><code>int</code></td>
        <td><p>Font size for legend. Defaults to 16.</p></td>
        <td><code>16</code></td>
      </tr>
      <tr>
        <td><code>fig_size</code></td>
        <td><code>tuple</code></td>
        <td><p>Figure size as (width, height). Defaults to (8, 6).</p></td>
        <td><code>(8, 6)</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Tuple[matplotlib.figure.Figure, matplotlib.axes.Axes]</code></td>
      <td><p>The figure and axes
    objects containing the ECDF plots.</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="c1"># Compare multiple distributions</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">x1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">x2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">,</span> <span class="mi">1000</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plot_ecdfs_matplot</span><span class="p">(</span>
<span class="o">...</span>     <span class="p">[</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">],</span> <span class="p">[</span><span class="n">y</span><span class="p">,</span> <span class="n">y</span><span class="p">],</span>
<span class="o">...</span>     <span class="n">legends</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Normal(0,1)&#39;</span><span class="p">,</span> <span class="s1">&#39;Normal(0.5,1.2)&#39;</span><span class="p">],</span>
<span class="o">...</span>     <span class="n">x_str</span><span class="o">=</span><span class="s1">&#39;Value&#39;</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">y_str</span><span class="o">=</span><span class="s1">&#39;Probability&#39;</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">x_lim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="o">...</span> <span class="p">)</span>
</code></pre></div>
    <div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="c1"># Custom styling</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plot_ecdfs_matplot</span><span class="p">(</span>
<span class="o">...</span>     <span class="p">[</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">],</span> <span class="p">[</span><span class="n">y</span><span class="p">,</span> <span class="n">y</span><span class="p">],</span>
<span class="o">...</span>     <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;rb&#39;</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">dash_lines</span><span class="o">=</span><span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">],</span>
<span class="o">...</span>     <span class="n">legend_font_size</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">fig_size</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="o">...</span> <span class="p">)</span>
</code></pre></div>
      <p>!!! notes
    - Uses clean plotting style with minimal spines
    - Supports both continuous and dashed lines
    - Provides fine-grained control over axis properties
    - Input arrays must be sorted in ascending order
    - Automatically validates data ordering</p>

        <details class="quote">
          <summary>Source code in <code>hydroutils/hydro_plot.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_ecdfs_matplot</span><span class="p">(</span>
    <span class="n">xs</span><span class="p">,</span>
    <span class="n">ys</span><span class="p">,</span>
    <span class="n">legends</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">colors</span><span class="o">=</span><span class="s2">&quot;rbkgcmy&quot;</span><span class="p">,</span>
    <span class="n">dash_lines</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">x_str</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span>
    <span class="n">y_str</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span>
    <span class="n">x_interval</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
    <span class="n">y_interval</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
    <span class="n">x_lim</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
    <span class="n">y_lim</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
    <span class="n">show_legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">legend_font_size</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span>
    <span class="n">fig_size</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates ECDF plots using matplotlib with extensive customization options.</span>

<span class="sd">    This function provides a more customizable alternative to the seaborn-based ECDF</span>
<span class="sd">    plotting functions, offering direct control over matplotlib parameters and styling.</span>

<span class="sd">    Args:</span>
<span class="sd">        xs (list[np.array]): List of x-values arrays for each ECDF.</span>
<span class="sd">        ys (list[np.array]): List of y-values arrays for each ECDF.</span>
<span class="sd">        legends (list[str], optional): Legend labels for each ECDF. Defaults to None.</span>
<span class="sd">        colors (str, optional): String of color characters for different lines.</span>
<span class="sd">            Defaults to &quot;rbkgcmy&quot;.</span>
<span class="sd">        dash_lines (list[bool], optional): Specifies which lines should be dashed.</span>
<span class="sd">            Defaults to None.</span>
<span class="sd">        x_str (str, optional): X-axis label. Defaults to &quot;x&quot;.</span>
<span class="sd">        y_str (str, optional): Y-axis label. Defaults to &quot;y&quot;.</span>
<span class="sd">        x_interval (float, optional): Interval for x-axis ticks. Defaults to 0.1.</span>
<span class="sd">        y_interval (float, optional): Interval for y-axis ticks. Defaults to 0.1.</span>
<span class="sd">        x_lim (tuple, optional): X-axis limits as (min, max). Defaults to (0, 1).</span>
<span class="sd">        y_lim (tuple, optional): Y-axis limits as (min, max). Defaults to (0, 1).</span>
<span class="sd">        show_legend (bool, optional): Whether to show legend. Defaults to True.</span>
<span class="sd">        legend_font_size (int, optional): Font size for legend. Defaults to 16.</span>
<span class="sd">        fig_size (tuple, optional): Figure size as (width, height). Defaults to (8, 6).</span>

<span class="sd">    Returns:</span>
<span class="sd">        Tuple[matplotlib.figure.Figure, matplotlib.axes.Axes]: The figure and axes</span>
<span class="sd">            objects containing the ECDF plots.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; # Compare multiple distributions</span>
<span class="sd">        &gt;&gt;&gt; x1 = np.sort(np.random.normal(0, 1, 1000))</span>
<span class="sd">        &gt;&gt;&gt; x2 = np.sort(np.random.normal(0.5, 1.2, 1000))</span>
<span class="sd">        &gt;&gt;&gt; y = np.linspace(0, 1, 1000)</span>
<span class="sd">        &gt;&gt;&gt; fig, ax = plot_ecdfs_matplot(</span>
<span class="sd">        ...     [x1, x2], [y, y],</span>
<span class="sd">        ...     legends=[&#39;Normal(0,1)&#39;, &#39;Normal(0.5,1.2)&#39;],</span>
<span class="sd">        ...     x_str=&#39;Value&#39;,</span>
<span class="sd">        ...     y_str=&#39;Probability&#39;,</span>
<span class="sd">        ...     x_lim=(-3, 3)</span>
<span class="sd">        ... )</span>

<span class="sd">        &gt;&gt;&gt; # Custom styling</span>
<span class="sd">        &gt;&gt;&gt; fig, ax = plot_ecdfs_matplot(</span>
<span class="sd">        ...     [x1, x2], [y, y],</span>
<span class="sd">        ...     colors=&#39;rb&#39;,</span>
<span class="sd">        ...     dash_lines=[False, True],</span>
<span class="sd">        ...     legend_font_size=12,</span>
<span class="sd">        ...     fig_size=(10, 8)</span>
<span class="sd">        ... )</span>

<span class="sd">    Notes:</span>
<span class="sd">        - Uses clean plotting style with minimal spines</span>
<span class="sd">        - Supports both continuous and dashed lines</span>
<span class="sd">        - Provides fine-grained control over axis properties</span>
<span class="sd">        - Input arrays must be sorted in ascending order</span>
<span class="sd">        - Automatically validates data ordering</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ys</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">xs</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">ys</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">legends</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">legends</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">ys</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">legends</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">dash_lines</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dash_lines</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">dash_lines</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">xs</span><span class="p">),</span> <span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">ys</span><span class="p">:</span>
        <span class="k">assert</span> <span class="nb">all</span><span class="p">(</span><span class="n">xi</span> <span class="o">&lt;</span> <span class="n">yi</span> <span class="k">for</span> <span class="n">xi</span><span class="p">,</span> <span class="n">yi</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">:]))</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">fig_size</span><span class="p">)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">xs</span><span class="p">)):</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">xs</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span>
            <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">xs</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span> <span class="o">==</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span>
        <span class="p">):</span>
            <span class="k">assert</span> <span class="nb">all</span><span class="p">(</span><span class="n">xi</span> <span class="o">&lt;=</span> <span class="n">yi</span> <span class="k">for</span> <span class="n">xi</span><span class="p">,</span> <span class="n">yi</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">xs</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">xs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">:]))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">all</span><span class="p">(</span><span class="n">xi</span> <span class="o">&lt;=</span> <span class="n">yi</span> <span class="k">for</span> <span class="n">xi</span><span class="p">,</span> <span class="n">yi</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">xs</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">xs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">:]))</span>
        <span class="p">(</span><span class="n">line_i</span><span class="p">,)</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xs</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">ys</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="n">legends</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">dash_lines</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
            <span class="n">line_i</span><span class="o">.</span><span class="n">set_dashes</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">x_str</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="n">y_str</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">x_lim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x_lim</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">y_lim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">y_lim</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="c1"># set x y number font size</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">x_lim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x_lim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">x_lim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="mi">100</span><span class="p">,</span> <span class="n">x_interval</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">y_lim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">y_lim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">y_lim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="mi">100</span><span class="p">,</span> <span class="n">y_interval</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">show_legend</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;size&quot;</span><span class="p">:</span> <span class="n">legend_font_size</span><span class="p">})</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="c1"># Hide the right and top spines</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="hydroutils.hydro_plot.plot_heat_map" class="doc doc-heading">
<code class="highlight language-python"><span class="n">plot_heat_map</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fig_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="n">square</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">xticklabels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">yticklabels</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>


<a href="#hydroutils.hydro_plot.plot_heat_map" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Creates a heatmap visualization of 2D data using seaborn.</p>
<p>This function creates a heatmap visualization with customizable formatting,
annotations, and masking options. It uses seaborn's heatmap function with
additional customization options.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>data</code></td>
        <td><code>pd.DataFrame</code></td>
        <td><p>2D array or DataFrame to be visualized.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>mask</code></td>
        <td><code>np.array</code></td>
        <td><p>Boolean array of same shape as data. True values will
be masked (not shown). Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>fig_size</code></td>
        <td><code>tuple</code></td>
        <td><p>Figure size as (width, height). Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>fmt</code></td>
        <td><code>str</code></td>
        <td><p>String formatting code for cell annotations. Defaults to "d"
for integer formatting.</p></td>
        <td><code>&#39;d&#39;</code></td>
      </tr>
      <tr>
        <td><code>square</code></td>
        <td><code>bool</code></td>
        <td><p>If True, set the Axes aspect to "equal". Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>annot</code></td>
        <td><code>bool</code></td>
        <td><p>If True, write the data value in each cell. Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>xticklabels</code></td>
        <td><code>bool</code></td>
        <td><p>If True, show x-axis labels. Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>yticklabels</code></td>
        <td><code>bool</code></td>
        <td><p>If True, show y-axis labels. Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>matplotlib.axes.Axes</code></td>
      <td><p>The matplotlib Axes object containing the heatmap.</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">plot_heat_map</span><span class="p">(</span>
<span class="o">...</span>     <span class="n">data</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;.2f&#39;</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">fig_size</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span>
<span class="o">...</span>     <span class="n">annot</span><span class="o">=</span><span class="kc">True</span>
<span class="o">...</span> <span class="p">)</span>
</code></pre></div>
      <p>!!! notes
    The function uses a red-blue diverging colormap ('RdBu_r') by default.
    For more details on the underlying implementation, see:
    https://zhuanlan.zhihu.com/p/96040773</p>

        <details class="quote">
          <summary>Source code in <code>hydroutils/hydro_plot.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_heat_map</span><span class="p">(</span>
    <span class="n">data</span><span class="p">,</span>
    <span class="n">mask</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">fig_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">fmt</span><span class="o">=</span><span class="s2">&quot;d&quot;</span><span class="p">,</span>
    <span class="n">square</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">xticklabels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">yticklabels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates a heatmap visualization of 2D data using seaborn.</span>

<span class="sd">    This function creates a heatmap visualization with customizable formatting,</span>
<span class="sd">    annotations, and masking options. It uses seaborn&#39;s heatmap function with</span>
<span class="sd">    additional customization options.</span>

<span class="sd">    Args:</span>
<span class="sd">        data (pd.DataFrame): 2D array or DataFrame to be visualized.</span>
<span class="sd">        mask (np.array, optional): Boolean array of same shape as data. True values will</span>
<span class="sd">            be masked (not shown). Defaults to None.</span>
<span class="sd">        fig_size (tuple, optional): Figure size as (width, height). Defaults to None.</span>
<span class="sd">        fmt (str, optional): String formatting code for cell annotations. Defaults to &quot;d&quot;</span>
<span class="sd">            for integer formatting.</span>
<span class="sd">        square (bool, optional): If True, set the Axes aspect to &quot;equal&quot;. Defaults to True.</span>
<span class="sd">        annot (bool, optional): If True, write the data value in each cell. Defaults to True.</span>
<span class="sd">        xticklabels (bool, optional): If True, show x-axis labels. Defaults to True.</span>
<span class="sd">        yticklabels (bool, optional): If True, show y-axis labels. Defaults to True.</span>

<span class="sd">    Returns:</span>
<span class="sd">        matplotlib.axes.Axes: The matplotlib Axes object containing the heatmap.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; data = pd.DataFrame(np.random.rand(5, 5))</span>
<span class="sd">        &gt;&gt;&gt; plot_heat_map(</span>
<span class="sd">        ...     data,</span>
<span class="sd">        ...     fmt=&#39;.2f&#39;,</span>
<span class="sd">        ...     fig_size=(8, 6),</span>
<span class="sd">        ...     annot=True</span>
<span class="sd">        ... )</span>

<span class="sd">    Notes:</span>
<span class="sd">        The function uses a red-blue diverging colormap (&#39;RdBu_r&#39;) by default.</span>
<span class="sd">        For more details on the underlying implementation, see:</span>
<span class="sd">        https://zhuanlan.zhihu.com/p/96040773</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">fig_size</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">fig_size</span><span class="p">)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span>
        <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
        <span class="n">square</span><span class="o">=</span><span class="n">square</span><span class="p">,</span>
        <span class="n">annot</span><span class="o">=</span><span class="n">annot</span><span class="p">,</span>
        <span class="n">fmt</span><span class="o">=</span><span class="n">fmt</span><span class="p">,</span>
        <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;RdBu_r&quot;</span><span class="p">,</span>
        <span class="n">mask</span><span class="o">=</span><span class="n">mask</span><span class="p">,</span>
        <span class="n">xticklabels</span><span class="o">=</span><span class="n">xticklabels</span><span class="p">,</span>
        <span class="n">yticklabels</span><span class="o">=</span><span class="n">yticklabels</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="hydroutils.hydro_plot.plot_map_carto" class="doc doc-heading">
<code class="highlight language-python"><span class="n">plot_map_carto</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span> <span class="n">fig</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">pertile_range</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">value_range</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fig_size</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="n">need_colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">colorbar_size</span><span class="o">=</span><span class="p">[</span><span class="mf">0.91</span><span class="p">,</span> <span class="mf">0.318</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">,</span> <span class="mf">0.354</span><span class="p">],</span> <span class="n">cmap_str</span><span class="o">=</span><span class="s1">&#39;jet&#39;</span><span class="p">,</span> <span class="n">idx_lst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">markers</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">marker_size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">is_discrete</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;rbkgcmywrbkgcmyw&#39;</span><span class="p">,</span> <span class="n">category_names</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">legend_font_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">colorbar_font_size</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#hydroutils.hydro_plot.plot_map_carto" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Creates a cartographic map visualization using Cartopy with extensive customization options.</p>
<p>This function generates a map visualization for spatial data with support for continuous
and discrete color scales, multiple marker types, and various styling options. It's
particularly useful for visualizing hydrological data in a geographic context.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>data</code></td>
        <td><code>np.array</code></td>
        <td><p>1-D array of values to be plotted on the map.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>lat</code></td>
        <td><code>np.array</code></td>
        <td><p>1-D array of latitude values for each data point.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>lon</code></td>
        <td><code>np.array</code></td>
        <td><p>1-D array of longitude values for each data point.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>fig</code></td>
        <td><code>matplotlib.figure.Figure</code></td>
        <td><p>Existing figure to plot on.
Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>ax</code></td>
        <td><code>matplotlib.axes.Axes</code></td>
        <td><p>Existing axes to plot on. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>pertile_range</code></td>
        <td><code>list</code></td>
        <td><p>Percentile range for color scaling, e.g.,
[25, 75] for interquartile range. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>value_range</code></td>
        <td><code>list</code></td>
        <td><p>Explicit value range for color scaling. Takes
precedence over pertile_range. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>fig_size</code></td>
        <td><code>tuple</code></td>
        <td><p>Figure size as (width, height). Defaults to (8, 8).</p></td>
        <td><code>(8, 8)</code></td>
      </tr>
      <tr>
        <td><code>need_colorbar</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to add a colorbar. Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>colorbar_size</code></td>
        <td><code>list</code></td>
        <td><p>Colorbar dimensions [left, bottom, width, height].
Defaults to [0.91, 0.318, 0.02, 0.354].</p></td>
        <td><code>[0.91, 0.318, 0.02, 0.354]</code></td>
      </tr>
      <tr>
        <td><code>cmap_str</code></td>
        <td><code>str</code></td>
        <td><p>Colormap name. Defaults to "jet".</p></td>
        <td><code>&#39;jet&#39;</code></td>
      </tr>
      <tr>
        <td><code>idx_lst</code></td>
        <td><code>list</code></td>
        <td><p>List of index arrays for plotting multiple point
categories. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>markers</code></td>
        <td><code>list</code></td>
        <td><p>Marker styles for each category. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>marker_size</code></td>
        <td><code>Union[int, list]</code></td>
        <td><p>Size(s) of markers. Defaults to 20.</p></td>
        <td><code>20</code></td>
      </tr>
      <tr>
        <td><code>is_discrete</code></td>
        <td><code>bool</code></td>
        <td><p>If True, uses discrete colors with legend instead
of continuous colorbar. Defaults to False.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>colors</code></td>
        <td><code>str</code></td>
        <td><p>Color characters for discrete categories.
Defaults to "rbkgcmywrbkgcmyw".</p></td>
        <td><code>&#39;rbkgcmywrbkgcmyw&#39;</code></td>
      </tr>
      <tr>
        <td><code>category_names</code></td>
        <td><code>list</code></td>
        <td><p>Names for discrete categories in legend.
Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>legend_font_size</code></td>
        <td><code>float</code></td>
        <td><p>Font size for legend. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>colorbar_font_size</code></td>
        <td><code>float</code></td>
        <td><p>Font size for colorbar. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>matplotlib.axes.Axes</code></td>
      <td><p>The axes object containing the map.</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="c1"># Simple continuous color map</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">lat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">lon</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mi">120</span><span class="p">,</span> <span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plot_map_carto</span><span class="p">(</span>
<span class="o">...</span>     <span class="n">data</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">value_range</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="o">...</span>     <span class="n">cmap_str</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span>
<span class="o">...</span> <span class="p">)</span>
</code></pre></div>
    <div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="c1"># Discrete categories with custom markers</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">categories</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">idx_lst</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">categories</span> <span class="o">==</span> <span class="n">i</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plot_map_carto</span><span class="p">(</span>
<span class="o">...</span>     <span class="n">data</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">idx_lst</span><span class="o">=</span><span class="n">idx_lst</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">markers</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="s1">&#39;^&#39;</span><span class="p">],</span>
<span class="o">...</span>     <span class="n">is_discrete</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">category_names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Low&#39;</span><span class="p">,</span> <span class="s1">&#39;Medium&#39;</span><span class="p">,</span> <span class="s1">&#39;High&#39;</span><span class="p">]</span>
<span class="o">...</span> <span class="p">)</span>
</code></pre></div>
      <p>!!! notes
    - Uses Cartopy for map projections and features
    - Automatically adds state boundaries and coastlines
    - Supports both continuous and categorical data visualization
    - Handles NaN values appropriately
    - Provides flexible control over color scaling</p>

        <details class="quote">
          <summary>Source code in <code>hydroutils/hydro_plot.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_map_carto</span><span class="p">(</span>
    <span class="n">data</span><span class="p">,</span>
    <span class="n">lat</span><span class="p">,</span>
    <span class="n">lon</span><span class="p">,</span>
    <span class="n">fig</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">pertile_range</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">value_range</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">fig_size</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span>
    <span class="n">need_colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">colorbar_size</span><span class="o">=</span><span class="p">[</span><span class="mf">0.91</span><span class="p">,</span> <span class="mf">0.318</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">,</span> <span class="mf">0.354</span><span class="p">],</span>
    <span class="n">cmap_str</span><span class="o">=</span><span class="s2">&quot;jet&quot;</span><span class="p">,</span>
    <span class="n">idx_lst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">markers</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">marker_size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
    <span class="n">is_discrete</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">colors</span><span class="o">=</span><span class="s2">&quot;rbkgcmywrbkgcmyw&quot;</span><span class="p">,</span>
    <span class="n">category_names</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">legend_font_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">colorbar_font_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates a cartographic map visualization using Cartopy with extensive customization options.</span>

<span class="sd">    This function generates a map visualization for spatial data with support for continuous</span>
<span class="sd">    and discrete color scales, multiple marker types, and various styling options. It&#39;s</span>
<span class="sd">    particularly useful for visualizing hydrological data in a geographic context.</span>

<span class="sd">    Args:</span>
<span class="sd">        data (np.array): 1-D array of values to be plotted on the map.</span>
<span class="sd">        lat (np.array): 1-D array of latitude values for each data point.</span>
<span class="sd">        lon (np.array): 1-D array of longitude values for each data point.</span>
<span class="sd">        fig (matplotlib.figure.Figure, optional): Existing figure to plot on.</span>
<span class="sd">            Defaults to None.</span>
<span class="sd">        ax (matplotlib.axes.Axes, optional): Existing axes to plot on. Defaults to None.</span>
<span class="sd">        pertile_range (list, optional): Percentile range for color scaling, e.g.,</span>
<span class="sd">            [25, 75] for interquartile range. Defaults to None.</span>
<span class="sd">        value_range (list, optional): Explicit value range for color scaling. Takes</span>
<span class="sd">            precedence over pertile_range. Defaults to None.</span>
<span class="sd">        fig_size (tuple, optional): Figure size as (width, height). Defaults to (8, 8).</span>
<span class="sd">        need_colorbar (bool, optional): Whether to add a colorbar. Defaults to True.</span>
<span class="sd">        colorbar_size (list, optional): Colorbar dimensions [left, bottom, width, height].</span>
<span class="sd">            Defaults to [0.91, 0.318, 0.02, 0.354].</span>
<span class="sd">        cmap_str (str, optional): Colormap name. Defaults to &quot;jet&quot;.</span>
<span class="sd">        idx_lst (list, optional): List of index arrays for plotting multiple point</span>
<span class="sd">            categories. Defaults to None.</span>
<span class="sd">        markers (list, optional): Marker styles for each category. Defaults to None.</span>
<span class="sd">        marker_size (Union[int, list], optional): Size(s) of markers. Defaults to 20.</span>
<span class="sd">        is_discrete (bool, optional): If True, uses discrete colors with legend instead</span>
<span class="sd">            of continuous colorbar. Defaults to False.</span>
<span class="sd">        colors (str, optional): Color characters for discrete categories.</span>
<span class="sd">            Defaults to &quot;rbkgcmywrbkgcmyw&quot;.</span>
<span class="sd">        category_names (list, optional): Names for discrete categories in legend.</span>
<span class="sd">            Defaults to None.</span>
<span class="sd">        legend_font_size (float, optional): Font size for legend. Defaults to None.</span>
<span class="sd">        colorbar_font_size (float, optional): Font size for colorbar. Defaults to None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        matplotlib.axes.Axes: The axes object containing the map.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; # Simple continuous color map</span>
<span class="sd">        &gt;&gt;&gt; data = np.random.rand(100)</span>
<span class="sd">        &gt;&gt;&gt; lat = np.random.uniform(30, 45, 100)</span>
<span class="sd">        &gt;&gt;&gt; lon = np.random.uniform(-120, -100, 100)</span>
<span class="sd">        &gt;&gt;&gt; ax = plot_map_carto(</span>
<span class="sd">        ...     data, lat, lon,</span>
<span class="sd">        ...     value_range=[0, 1],</span>
<span class="sd">        ...     cmap_str=&#39;viridis&#39;</span>
<span class="sd">        ... )</span>

<span class="sd">        &gt;&gt;&gt; # Discrete categories with custom markers</span>
<span class="sd">        &gt;&gt;&gt; categories = np.random.randint(0, 3, 100)</span>
<span class="sd">        &gt;&gt;&gt; idx_lst = [np.where(categories == i)[0] for i in range(3)]</span>
<span class="sd">        &gt;&gt;&gt; ax = plot_map_carto(</span>
<span class="sd">        ...     data, lat, lon,</span>
<span class="sd">        ...     idx_lst=idx_lst,</span>
<span class="sd">        ...     markers=[&#39;o&#39;, &#39;s&#39;, &#39;^&#39;],</span>
<span class="sd">        ...     is_discrete=True,</span>
<span class="sd">        ...     category_names=[&#39;Low&#39;, &#39;Medium&#39;, &#39;High&#39;]</span>
<span class="sd">        ... )</span>

<span class="sd">    Notes:</span>
<span class="sd">        - Uses Cartopy for map projections and features</span>
<span class="sd">        - Automatically adds state boundaries and coastlines</span>
<span class="sd">        - Supports both continuous and categorical data visualization</span>
<span class="sd">        - Handles NaN values appropriately</span>
<span class="sd">        - Provides flexible control over color scaling</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">value_range</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">vmin</span> <span class="o">=</span> <span class="n">value_range</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">vmax</span> <span class="o">=</span> <span class="n">value_range</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">elif</span> <span class="n">pertile_range</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># https://blog.csdn.net/chenirene510/article/details/111318539</span>
        <span class="n">mask_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">masked_invalid</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">vmin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">mask_data</span><span class="p">)</span>
        <span class="n">vmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">mask_data</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">assert</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">pertile_range</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">pertile_range</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">100</span>
        <span class="n">vmin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanpercentile</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">pertile_range</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">vmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanpercentile</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">pertile_range</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">llcrnrlat</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">lat</span><span class="p">),)</span>
    <span class="n">urcrnrlat</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">lat</span><span class="p">),)</span>
    <span class="n">llcrnrlon</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">lon</span><span class="p">),)</span>
    <span class="n">urcrnrlon</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">lon</span><span class="p">),)</span>
    <span class="n">extent</span> <span class="o">=</span> <span class="p">[</span><span class="n">llcrnrlon</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">urcrnrlon</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">llcrnrlat</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">urcrnrlat</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
    <span class="c1"># Figure</span>
    <span class="k">if</span> <span class="n">fig</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span>
            <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="n">fig_size</span><span class="p">,</span> <span class="n">subplot_kw</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;projection&quot;</span><span class="p">:</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">()}</span>
        <span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_extent</span><span class="p">(</span><span class="n">extent</span><span class="p">)</span>
    <span class="n">states</span> <span class="o">=</span> <span class="n">NaturalEarthFeature</span><span class="p">(</span>
        <span class="n">category</span><span class="o">=</span><span class="s2">&quot;cultural&quot;</span><span class="p">,</span>
        <span class="n">scale</span><span class="o">=</span><span class="s2">&quot;50m&quot;</span><span class="p">,</span>
        <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">,</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;admin_1_states_provinces_shp&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">states</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">(</span><span class="s2">&quot;50m&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">idx_lst</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">marker_size</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">marker_size</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">idx_lst</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">marker_size</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">idx_lst</span><span class="p">),</span> <span class="n">marker_size</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">marker_size</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">markers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">idx_lst</span><span class="p">),</span> <span class="n">markers</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">markers</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">idx_lst</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cmap_str</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">cmap_str</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">idx_lst</span><span class="p">),</span> <span class="n">cmap_str</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">cmap_str</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">idx_lst</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">is_discrete</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">idx_lst</span><span class="p">)):</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
                    <span class="n">lon</span><span class="p">[</span><span class="n">idx_lst</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span>
                    <span class="n">lat</span><span class="p">[</span><span class="n">idx_lst</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span>
                    <span class="n">marker</span><span class="o">=</span><span class="n">markers</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                    <span class="n">ms</span><span class="o">=</span><span class="n">marker_size</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                    <span class="n">label</span><span class="o">=</span><span class="n">category_names</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                    <span class="n">c</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                    <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">prop</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">legend_font_size</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">scatter</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">idx_lst</span><span class="p">)):</span>
                <span class="n">scat</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
                    <span class="n">lon</span><span class="p">[</span><span class="n">idx_lst</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span>
                    <span class="n">lat</span><span class="p">[</span><span class="n">idx_lst</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span>
                    <span class="n">c</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="n">idx_lst</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span>
                    <span class="n">marker</span><span class="o">=</span><span class="n">markers</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                    <span class="n">s</span><span class="o">=</span><span class="n">marker_size</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                    <span class="n">cmap</span><span class="o">=</span><span class="n">cmap_str</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                    <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span>
                    <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="n">scatter</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">scat</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">need_colorbar</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">colorbar_size</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">cbar_ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">(</span><span class="n">colorbar_size</span><span class="p">)</span>
                    <span class="n">cbar</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">scat</span><span class="p">,</span> <span class="n">cax</span><span class="o">=</span><span class="n">cbar_ax</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s2">&quot;vertical&quot;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">cbar</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">scat</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">colorbar_font_size</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="n">colorbar_font_size</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">category_names</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span>
                    <span class="n">scatter</span><span class="p">,</span> <span class="n">category_names</span><span class="p">,</span> <span class="n">prop</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">legend_font_size</span><span class="p">),</span> <span class="n">ncol</span><span class="o">=</span><span class="mi">2</span>
                <span class="p">)</span>
    <span class="k">elif</span> <span class="n">is_discrete</span><span class="p">:</span>
        <span class="n">scatter</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="n">marker_size</span><span class="p">)</span>
        <span class="c1"># produce a legend with the unique colors from the scatter</span>
        <span class="n">legend1</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span>
            <span class="o">*</span><span class="n">scatter</span><span class="o">.</span><span class="n">legend_elements</span><span class="p">(),</span> <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;lower left&quot;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Classes&quot;</span>
        <span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">add_artist</span><span class="p">(</span><span class="n">legend1</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">scat</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
            <span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="n">marker_size</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap_str</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">need_colorbar</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">colorbar_size</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">cbar_ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">(</span><span class="n">colorbar_size</span><span class="p">)</span>
                <span class="n">cbar</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">scat</span><span class="p">,</span> <span class="n">cax</span><span class="o">=</span><span class="n">cbar_ax</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s2">&quot;vertical&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">cbar</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">scat</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">colorbar_font_size</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="n">colorbar_font_size</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ax</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="hydroutils.hydro_plot.plot_pdf_cdf" class="doc doc-heading">
<code class="highlight language-python"><span class="n">plot_pdf_cdf</span><span class="p">(</span><span class="n">mydataframe</span><span class="p">,</span> <span class="n">mycolumn</span><span class="p">)</span></code>


<a href="#hydroutils.hydro_plot.plot_pdf_cdf" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Creates side-by-side plots of probability density function (PDF) and cumulative
distribution function (CDF).</p>
<p>This function generates a figure with two subplots: a PDF plot on the left and
a CDF plot on the right. The PDF includes both histogram and kernel density
estimation, while the CDF shows the cumulative histogram.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>mydataframe</code></td>
        <td><code>pd.DataFrame</code></td>
        <td><p>DataFrame containing the data to plot.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>mycolumn</code></td>
        <td><code>str</code></td>
        <td><p>Name of the column to create distributions for.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="c1"># Create sample data</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
<span class="o">...</span>     <span class="s1">&#39;values&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span>
<span class="o">...</span>         <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">),</span>
<span class="o">...</span>         <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="o">...</span>     <span class="p">])</span>
<span class="o">...</span> <span class="p">})</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">plot_pdf_cdf</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s1">&#39;values&#39;</span><span class="p">)</span>
</code></pre></div>
      <p>!!! notes
    - Uses seaborn's distplot for both PDF and CDF
    - PDF includes both histogram and kernel density estimation
    - CDF shows cumulative histogram with step-style line
    - Both plots are set to range [0, 1] on x-axis
    - CDF y-axis is also set to range [0, 1]
    - High DPI (320) for publication-quality figures
    - Large figure size (18x6) for clear visualization</p>

        <details class="quote">
          <summary>Source code in <code>hydroutils/hydro_plot.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_pdf_cdf</span><span class="p">(</span><span class="n">mydataframe</span><span class="p">,</span> <span class="n">mycolumn</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates side-by-side plots of probability density function (PDF) and cumulative</span>
<span class="sd">    distribution function (CDF).</span>

<span class="sd">    This function generates a figure with two subplots: a PDF plot on the left and</span>
<span class="sd">    a CDF plot on the right. The PDF includes both histogram and kernel density</span>
<span class="sd">    estimation, while the CDF shows the cumulative histogram.</span>

<span class="sd">    Args:</span>
<span class="sd">        mydataframe (pd.DataFrame): DataFrame containing the data to plot.</span>
<span class="sd">        mycolumn (str): Name of the column to create distributions for.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; # Create sample data</span>
<span class="sd">        &gt;&gt;&gt; df = pd.DataFrame({</span>
<span class="sd">        ...     &#39;values&#39;: np.concatenate([</span>
<span class="sd">        ...         np.random.normal(0.3, 0.1, 1000),</span>
<span class="sd">        ...         np.random.normal(0.7, 0.1, 1000)</span>
<span class="sd">        ...     ])</span>
<span class="sd">        ... })</span>
<span class="sd">        &gt;&gt;&gt; plot_pdf_cdf(df, &#39;values&#39;)</span>

<span class="sd">    Notes:</span>
<span class="sd">        - Uses seaborn&#39;s distplot for both PDF and CDF</span>
<span class="sd">        - PDF includes both histogram and kernel density estimation</span>
<span class="sd">        - CDF shows cumulative histogram with step-style line</span>
<span class="sd">        - Both plots are set to range [0, 1] on x-axis</span>
<span class="sd">        - CDF y-axis is also set to range [0, 1]</span>
<span class="sd">        - High DPI (320) for publication-quality figures</span>
<span class="sd">        - Large figure size (18x6) for clear visualization</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># settings</span>
    <span class="n">f</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">320</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;fraction (PDF)&quot;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;fraction (CDF)&quot;</span><span class="p">)</span>

    <span class="c1"># left plot (PDF) # REMEMBER TO CHANGE bins, xlim PROPERLY!!</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span>
        <span class="n">mydataframe</span><span class="p">[</span><span class="n">mycolumn</span><span class="p">],</span>
        <span class="n">kde</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">axlabel</span><span class="o">=</span><span class="n">mycolumn</span><span class="p">,</span>
        <span class="n">hist_kws</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;density&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">},</span>
        <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
    <span class="p">)</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

    <span class="c1"># right plot (CDF) # REMEMBER TO CHANGE bins, xlim PROPERLY!!</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span>
        <span class="n">mydataframe</span><span class="p">[</span><span class="n">mycolumn</span><span class="p">],</span>
        <span class="n">kde</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">axlabel</span><span class="o">=</span><span class="n">mycolumn</span><span class="p">,</span>
        <span class="n">hist_kws</span><span class="o">=</span><span class="p">{</span>
            <span class="s2">&quot;density&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
            <span class="s2">&quot;cumulative&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
            <span class="s2">&quot;histtype&quot;</span><span class="p">:</span> <span class="s2">&quot;step&quot;</span><span class="p">,</span>
            <span class="s2">&quot;linewidth&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
    <span class="p">)</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="hydroutils.hydro_plot.plot_quiver" class="doc doc-heading">
<code class="highlight language-python"><span class="n">plot_quiver</span><span class="p">(</span><span class="n">exps_q_ssm_result_show</span><span class="p">,</span> <span class="n">exps_ssm_q_result_show</span><span class="p">,</span> <span class="n">q_diff_show</span><span class="p">,</span> <span class="n">ssm_diff_show</span><span class="p">,</span> <span class="n">x_label</span><span class="p">,</span> <span class="n">y_label</span><span class="p">)</span></code>


<a href="#hydroutils.hydro_plot.plot_quiver" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Creates a quiver plot showing vector field with normalized arrows.</p>
<p>This function generates a quiver plot where arrows represent the direction and
magnitude of differences between two variables. The arrows are normalized to have
uniform length, with color indicating the actual magnitude of the difference.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>exps_q_ssm_result_show</code></td>
        <td><code>np.array</code></td>
        <td><p>X-coordinates for arrow origins.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>exps_ssm_q_result_show</code></td>
        <td><code>np.array</code></td>
        <td><p>Y-coordinates for arrow origins.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>q_diff_show</code></td>
        <td><code>np.array</code></td>
        <td><p>X-components of the difference vectors.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>ssm_diff_show</code></td>
        <td><code>np.array</code></td>
        <td><p>Y-components of the difference vectors.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>x_label</code></td>
        <td><code>str</code></td>
        <td><p>Label for x-axis.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>y_label</code></td>
        <td><code>str</code></td>
        <td><p>Label for y-axis.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Tuple[matplotlib.figure.Figure, matplotlib.axes.Axes]</code></td>
      <td><p>The figure and axes
    objects containing the quiver plot.</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="c1"># Create sample data</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">dx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">dy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plot_quiver</span><span class="p">(</span>
<span class="o">...</span>     <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">,</span>
<span class="o">...</span>     <span class="s1">&#39;X Variable&#39;</span><span class="p">,</span>
<span class="o">...</span>     <span class="s1">&#39;Y Variable&#39;</span>
<span class="o">...</span> <span class="p">)</span>
</code></pre></div>
      <p>!!! notes
    - Arrows are normalized to uniform length for better visualization
    - Color indicates the actual magnitude of the difference vector
    - Plot includes a colorbar showing the magnitude scale
    - Uses clean plotting style with minimal spines
    - Default plot range is [0, 1] for both axes</p>

        <details class="quote">
          <summary>Source code in <code>hydroutils/hydro_plot.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_quiver</span><span class="p">(</span>
    <span class="n">exps_q_ssm_result_show</span><span class="p">,</span>
    <span class="n">exps_ssm_q_result_show</span><span class="p">,</span>
    <span class="n">q_diff_show</span><span class="p">,</span>
    <span class="n">ssm_diff_show</span><span class="p">,</span>
    <span class="n">x_label</span><span class="p">,</span>
    <span class="n">y_label</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates a quiver plot showing vector field with normalized arrows.</span>

<span class="sd">    This function generates a quiver plot where arrows represent the direction and</span>
<span class="sd">    magnitude of differences between two variables. The arrows are normalized to have</span>
<span class="sd">    uniform length, with color indicating the actual magnitude of the difference.</span>

<span class="sd">    Args:</span>
<span class="sd">        exps_q_ssm_result_show (np.array): X-coordinates for arrow origins.</span>
<span class="sd">        exps_ssm_q_result_show (np.array): Y-coordinates for arrow origins.</span>
<span class="sd">        q_diff_show (np.array): X-components of the difference vectors.</span>
<span class="sd">        ssm_diff_show (np.array): Y-components of the difference vectors.</span>
<span class="sd">        x_label (str): Label for x-axis.</span>
<span class="sd">        y_label (str): Label for y-axis.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Tuple[matplotlib.figure.Figure, matplotlib.axes.Axes]: The figure and axes</span>
<span class="sd">            objects containing the quiver plot.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; # Create sample data</span>
<span class="sd">        &gt;&gt;&gt; x = np.random.rand(50)</span>
<span class="sd">        &gt;&gt;&gt; y = np.random.rand(50)</span>
<span class="sd">        &gt;&gt;&gt; dx = np.random.normal(0, 0.1, 50)</span>
<span class="sd">        &gt;&gt;&gt; dy = np.random.normal(0, 0.1, 50)</span>
<span class="sd">        &gt;&gt;&gt; fig, ax = plot_quiver(</span>
<span class="sd">        ...     x, y, dx, dy,</span>
<span class="sd">        ...     &#39;X Variable&#39;,</span>
<span class="sd">        ...     &#39;Y Variable&#39;</span>
<span class="sd">        ... )</span>

<span class="sd">    Notes:</span>
<span class="sd">        - Arrows are normalized to uniform length for better visualization</span>
<span class="sd">        - Color indicates the actual magnitude of the difference vector</span>
<span class="sd">        - Plot includes a colorbar showing the magnitude scale</span>
<span class="sd">        - Uses clean plotting style with minimal spines</span>
<span class="sd">        - Default plot range is [0, 1] for both axes</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
    <span class="n">color</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">q_diff_show</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">ssm_diff_show</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="c1"># normalize to get same length arrows</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">q_diff_show</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">ssm_diff_show</span><span class="p">,</span> <span class="mi">2</span><span class="p">)),</span> <span class="mf">0.5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span>
        <span class="n">exps_q_ssm_result_show</span><span class="p">,</span>
        <span class="n">exps_ssm_q_result_show</span><span class="p">,</span>
        <span class="n">q_diff_show</span> <span class="o">/</span> <span class="n">r</span><span class="p">,</span>
        <span class="n">ssm_diff_show</span> <span class="o">/</span> <span class="n">r</span><span class="p">,</span>
        <span class="n">color</span><span class="p">,</span>
        <span class="n">scale</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span>
        <span class="n">width</span><span class="o">=</span><span class="mf">0.005</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="c1"># Defining color</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.01</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.01</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
    <span class="c1"># Hide the right and top spines</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">x_label</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="n">y_label</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="hydroutils.hydro_plot.plot_rainfall_runoff" class="doc doc-heading">
<code class="highlight language-python"><span class="n">plot_rainfall_runoff</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">qs</span><span class="p">,</span> <span class="n">fig_size</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">c_lst</span><span class="o">=</span><span class="s1">&#39;rbkgcmy&#39;</span><span class="p">,</span> <span class="n">leg_lst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dash_lines</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">prcp_ylabel</span><span class="o">=</span><span class="s1">&#39;prcp(mm/day)&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">prcp_interval</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span></code>


<a href="#hydroutils.hydro_plot.plot_rainfall_runoff" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Creates a combined rainfall-runoff plot with precipitation bars and streamflow lines.</p>
<p>This function generates a dual-axis plot showing precipitation as inverted bars from
the top and streamflow as lines on the bottom. This is a common visualization in
hydrology for analyzing rainfall-runoff relationships.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>t</code></td>
        <td><code>Union[np.array, List[np.array]]</code></td>
        <td><p>Time values. If multiple streamflow series
are provided, t can be a list of time arrays matching qs.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>p</code></td>
        <td><code>np.array</code></td>
        <td><p>Precipitation time series data in mm/day.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>qs</code></td>
        <td><code>Union[np.array, List[np.array]]</code></td>
        <td><p>Streamflow time series data. Can be a
single array or list of arrays for multiple streamflow series.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>fig_size</code></td>
        <td><code>tuple</code></td>
        <td><p>Figure size as (width, height). Defaults to (8, 6).</p></td>
        <td><code>(8, 6)</code></td>
      </tr>
      <tr>
        <td><code>c_lst</code></td>
        <td><code>str</code></td>
        <td><p>String of color characters for streamflow lines.
Defaults to "rbkgcmy".</p></td>
        <td><code>&#39;rbkgcmy&#39;</code></td>
      </tr>
      <tr>
        <td><code>leg_lst</code></td>
        <td><code>list</code></td>
        <td><p>Legend labels for streamflow series. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>dash_lines</code></td>
        <td><code>list[bool]</code></td>
        <td><p>Specifies which streamflow lines should be
dashed. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>title</code></td>
        <td><code>str</code></td>
        <td><p>Plot title. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>xlabel</code></td>
        <td><code>str</code></td>
        <td><p>X-axis label. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>ylabel</code></td>
        <td><code>str</code></td>
        <td><p>Y-axis label for streamflow. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>prcp_ylabel</code></td>
        <td><code>str</code></td>
        <td><p>Y-axis label for precipitation. Defaults to
"prcp(mm/day)".</p></td>
        <td><code>&#39;prcp(mm/day)&#39;</code></td>
      </tr>
      <tr>
        <td><code>linewidth</code></td>
        <td><code>int</code></td>
        <td><p>Width of streamflow lines. Defaults to 1.</p></td>
        <td><code>1</code></td>
      </tr>
      <tr>
        <td><code>prcp_interval</code></td>
        <td><code>int</code></td>
        <td><p>Interval for precipitation y-axis ticks.
Defaults to 20.</p></td>
        <td><code>20</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Tuple[matplotlib.figure.Figure, matplotlib.axes.Axes]</code></td>
      <td><p>The figure and axes
    objects containing the plot.</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="c1"># Simple rainfall-runoff plot</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="s1">&#39;2020-01-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2020-12-31&#39;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;datetime64[D]&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">exponential</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>  <span class="c1"># precipitation</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">q</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">)</span>  <span class="c1"># simulated streamflow</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plot_rainfall_runoff</span><span class="p">(</span>
<span class="o">...</span>     <span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Rainfall-Runoff Analysis&#39;</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Date&#39;</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Streamflow (mÂ³/s)&#39;</span>
<span class="o">...</span> <span class="p">)</span>
</code></pre></div>
    <div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="c1"># Multiple streamflow series</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">qs</span> <span class="o">=</span> <span class="p">[</span><span class="n">q</span><span class="p">,</span> <span class="n">q</span><span class="o">*</span><span class="mf">1.2</span><span class="p">]</span>  <span class="c1"># observed and simulated</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plot_rainfall_runoff</span><span class="p">(</span>
<span class="o">...</span>     <span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">qs</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">leg_lst</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Observed&#39;</span><span class="p">,</span> <span class="s1">&#39;Simulated&#39;</span><span class="p">],</span>
<span class="o">...</span>     <span class="n">dash_lines</span><span class="o">=</span><span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">]</span>
<span class="o">...</span> <span class="p">)</span>
</code></pre></div>
      <p>!!! notes
    - Precipitation is plotted as blue bars from the top of the plot
    - Streamflow is plotted as lines on the bottom
    - The precipitation y-axis is inverted for better visualization
    - Grid lines are added automatically</p>

        <details class="quote">
          <summary>Source code in <code>hydroutils/hydro_plot.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_rainfall_runoff</span><span class="p">(</span>
    <span class="n">t</span><span class="p">,</span>
    <span class="n">p</span><span class="p">,</span>
    <span class="n">qs</span><span class="p">,</span>
    <span class="n">fig_size</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span>
    <span class="n">c_lst</span><span class="o">=</span><span class="s2">&quot;rbkgcmy&quot;</span><span class="p">,</span>
    <span class="n">leg_lst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">dash_lines</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">xlabel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">ylabel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">prcp_ylabel</span><span class="o">=</span><span class="s2">&quot;prcp(mm/day)&quot;</span><span class="p">,</span>
    <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">prcp_interval</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates a combined rainfall-runoff plot with precipitation bars and streamflow lines.</span>

<span class="sd">    This function generates a dual-axis plot showing precipitation as inverted bars from</span>
<span class="sd">    the top and streamflow as lines on the bottom. This is a common visualization in</span>
<span class="sd">    hydrology for analyzing rainfall-runoff relationships.</span>

<span class="sd">    Args:</span>
<span class="sd">        t (Union[np.array, List[np.array]]): Time values. If multiple streamflow series</span>
<span class="sd">            are provided, t can be a list of time arrays matching qs.</span>
<span class="sd">        p (np.array): Precipitation time series data in mm/day.</span>
<span class="sd">        qs (Union[np.array, List[np.array]]): Streamflow time series data. Can be a</span>
<span class="sd">            single array or list of arrays for multiple streamflow series.</span>
<span class="sd">        fig_size (tuple, optional): Figure size as (width, height). Defaults to (8, 6).</span>
<span class="sd">        c_lst (str, optional): String of color characters for streamflow lines.</span>
<span class="sd">            Defaults to &quot;rbkgcmy&quot;.</span>
<span class="sd">        leg_lst (list, optional): Legend labels for streamflow series. Defaults to None.</span>
<span class="sd">        dash_lines (list[bool], optional): Specifies which streamflow lines should be</span>
<span class="sd">            dashed. Defaults to None.</span>
<span class="sd">        title (str, optional): Plot title. Defaults to None.</span>
<span class="sd">        xlabel (str, optional): X-axis label. Defaults to None.</span>
<span class="sd">        ylabel (str, optional): Y-axis label for streamflow. Defaults to None.</span>
<span class="sd">        prcp_ylabel (str, optional): Y-axis label for precipitation. Defaults to</span>
<span class="sd">            &quot;prcp(mm/day)&quot;.</span>
<span class="sd">        linewidth (int, optional): Width of streamflow lines. Defaults to 1.</span>
<span class="sd">        prcp_interval (int, optional): Interval for precipitation y-axis ticks.</span>
<span class="sd">            Defaults to 20.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Tuple[matplotlib.figure.Figure, matplotlib.axes.Axes]: The figure and axes</span>
<span class="sd">            objects containing the plot.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; # Simple rainfall-runoff plot</span>
<span class="sd">        &gt;&gt;&gt; t = np.arange(&#39;2020-01-01&#39;, &#39;2020-12-31&#39;, dtype=&#39;datetime64[D]&#39;)</span>
<span class="sd">        &gt;&gt;&gt; p = np.random.exponential(2, size=len(t))  # precipitation</span>
<span class="sd">        &gt;&gt;&gt; q = np.convolve(p, np.ones(5)/5, mode=&#39;same&#39;)  # simulated streamflow</span>
<span class="sd">        &gt;&gt;&gt; fig, ax = plot_rainfall_runoff(</span>
<span class="sd">        ...     t, p, q,</span>
<span class="sd">        ...     title=&#39;Rainfall-Runoff Analysis&#39;,</span>
<span class="sd">        ...     xlabel=&#39;Date&#39;,</span>
<span class="sd">        ...     ylabel=&#39;Streamflow (mÂ³/s)&#39;</span>
<span class="sd">        ... )</span>

<span class="sd">        &gt;&gt;&gt; # Multiple streamflow series</span>
<span class="sd">        &gt;&gt;&gt; qs = [q, q*1.2]  # observed and simulated</span>
<span class="sd">        &gt;&gt;&gt; fig, ax = plot_rainfall_runoff(</span>
<span class="sd">        ...     t, p, qs,</span>
<span class="sd">        ...     leg_lst=[&#39;Observed&#39;, &#39;Simulated&#39;],</span>
<span class="sd">        ...     dash_lines=[False, True]</span>
<span class="sd">        ... )</span>

<span class="sd">    Notes:</span>
<span class="sd">        - Precipitation is plotted as blue bars from the top of the plot</span>
<span class="sd">        - Streamflow is plotted as lines on the bottom</span>
<span class="sd">        - The precipitation y-axis is inverted for better visualization</span>
<span class="sd">        - Grid lines are added automatically</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">fig_size</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">dash_lines</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dash_lines</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">dash_lines</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">qs</span><span class="p">),</span> <span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">qs</span><span class="p">)):</span>
        <span class="n">tt</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span> <span class="k">else</span> <span class="n">t</span>
        <span class="n">q</span> <span class="o">=</span> <span class="n">qs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
        <span class="n">leg_str</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">leg_lst</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">leg_str</span> <span class="o">=</span> <span class="n">leg_lst</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
        <span class="p">(</span><span class="n">line_i</span><span class="p">,)</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tt</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">c_lst</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="n">leg_str</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="n">linewidth</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">dash_lines</span><span class="p">[</span><span class="n">k</span><span class="p">]:</span>
            <span class="n">line_i</span><span class="o">.</span><span class="n">set_dashes</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1.2</span><span class="p">)</span>
    <span class="c1"># Create second axes, in order to get the bars from the top you can multiply by -1</span>
    <span class="n">ax2</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
    <span class="c1"># ax2.bar(tt, -p, color=&quot;b&quot;)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">tt</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="n">p</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="s2">&quot;mid&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="c1"># ax2.plot(tt, -p, color=&quot;b&quot;, alpha=0.7, linewidth=1.5)</span>

    <span class="c1"># Now need to fix the axis labels</span>
    <span class="c1"># max_pre = max(p)</span>
    <span class="n">max_pre</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="n">max_pre</span> <span class="o">*</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">y2_ticks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">max_pre</span><span class="p">,</span> <span class="n">prcp_interval</span><span class="p">)</span>
    <span class="n">y2_ticklabels</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">y2_ticks</span><span class="p">]</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">y2_ticks</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="n">y2_ticklabels</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="c1"># ax2.set_yticklabels([lab.get_text()[1:] for lab in ax2.get_yticklabels()])</span>
    <span class="k">if</span> <span class="n">title</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">fontdict</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;fontsize&quot;</span><span class="p">:</span> <span class="mi">17</span><span class="p">})</span>
    <span class="k">if</span> <span class="n">ylabel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">xlabel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">xlabel</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">prcp_ylabel</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;top&quot;</span><span class="p">)</span>
    <span class="c1"># ax2.set_ylabel(&quot;precipitation (mm/day)&quot;, fontsize=12, loc=&#39;top&#39;)</span>
    <span class="c1"># https://github.com/matplotlib/matplotlib/issues/12318</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.85</span><span class="p">),</span> <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper left&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="hydroutils.hydro_plot.plot_rainfall_runoff_chai" class="doc doc-heading">
<code class="highlight language-python"><span class="n">plot_rainfall_runoff_chai</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">ps</span><span class="p">,</span> <span class="n">qs</span><span class="p">,</span> <span class="n">c_lst</span><span class="o">=</span><span class="s1">&#39;rbkgcmy&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Observation of Precipitation and Streamflow&#39;</span><span class="p">,</span> <span class="n">alpha_lst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">p_labels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">q_labels</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#hydroutils.hydro_plot.plot_rainfall_runoff_chai" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Creates a two-panel rainfall-runoff plot following Chai's style.</p>
<p>This function generates a figure with two vertically stacked panels: precipitation
on top and streamflow below. It supports multiple precipitation sources and
streamflow series with customizable styling.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>t</code></td>
        <td><code>array-like</code></td>
        <td><p>Time points for x-axis.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>ps</code></td>
        <td><code>list[np.array]</code></td>
        <td><p>List of precipitation arrays from different sources.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>qs</code></td>
        <td><code>list[np.array]</code></td>
        <td><p>List of streamflow arrays (e.g., observed and simulated).</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>c_lst</code></td>
        <td><code>str</code></td>
        <td><p>String of color characters. Defaults to "rbkgcmy".</p></td>
        <td><code>&#39;rbkgcmy&#39;</code></td>
      </tr>
      <tr>
        <td><code>title</code></td>
        <td><code>str</code></td>
        <td><p>Figure title. Defaults to "Observation of Precipitation
and Streamflow".</p></td>
        <td><code>&#39;Observation of Precipitation and Streamflow&#39;</code></td>
      </tr>
      <tr>
        <td><code>alpha_lst</code></td>
        <td><code>list[float]</code></td>
        <td><p>Transparency values for each series.
Defaults to [0.5, 0.5].</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>p_labels</code></td>
        <td><code>list[str]</code></td>
        <td><p>Labels for precipitation sources.
Defaults to ["era5land", "gauge"].</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>q_labels</code></td>
        <td><code>list[str]</code></td>
        <td><p>Labels for streamflow series.
Defaults to ["observation", "simulation"].</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Tuple[matplotlib.figure.Figure, matplotlib.axes.Axes]</code></td>
      <td><p>The figure and bottom
    axes (streamflow plot).</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="c1"># Create sample data</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">t</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s1">&#39;2020-01-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2020-12-31&#39;</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;D&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="c1"># Two precipitation sources</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">p1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">exponential</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>  <span class="c1"># ERA5</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">p2</span> <span class="o">=</span> <span class="n">p1</span> <span class="o">*</span> <span class="mf">1.2</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>  <span class="c1"># Gauge</span>
<span class="o">&gt;&gt;&gt;</span> <span class="c1"># Observed and simulated streamflow</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">q_obs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">q_sim</span> <span class="o">=</span> <span class="n">q_obs</span> <span class="o">*</span> <span class="mf">1.1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">q_obs</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> 
<span class="o">&gt;&gt;&gt;</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plot_rainfall_runoff_chai</span><span class="p">(</span>
<span class="o">...</span>     <span class="n">t</span><span class="p">,</span> <span class="p">[</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">],</span> <span class="p">[</span><span class="n">q_obs</span><span class="p">,</span> <span class="n">q_sim</span><span class="p">],</span>
<span class="o">...</span>     <span class="n">title</span><span class="o">=</span><span class="s1">&#39;2020 Rainfall-Runoff Comparison&#39;</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">p_labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;ERA5&#39;</span><span class="p">,</span> <span class="s1">&#39;Rain Gauge&#39;</span><span class="p">],</span>
<span class="o">...</span>     <span class="n">q_labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Observed&#39;</span><span class="p">,</span> <span class="s1">&#39;Simulated&#39;</span><span class="p">]</span>
<span class="o">...</span> <span class="p">)</span>
</code></pre></div>
      <p>!!! notes
    - Top panel shows precipitation with bars
    - Bottom panel shows streamflow with lines
    - Precipitation y-axis is inverted and blue
    - Streamflow y-axis is red
    - Both panels share x-axis limits
    - Legends included for both panels
    - Uses large figure size (20x8) by default
    - Includes "Streamflow" text box in bottom panel</p>

        <details class="quote">
          <summary>Source code in <code>hydroutils/hydro_plot.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_rainfall_runoff_chai</span><span class="p">(</span>
    <span class="n">t</span><span class="p">,</span>
    <span class="n">ps</span><span class="p">,</span>
    <span class="n">qs</span><span class="p">,</span>
    <span class="n">c_lst</span><span class="o">=</span><span class="s2">&quot;rbkgcmy&quot;</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Observation of Precipitation and Streamflow&quot;</span><span class="p">,</span>
    <span class="n">alpha_lst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">p_labels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">q_labels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates a two-panel rainfall-runoff plot following Chai&#39;s style.</span>

<span class="sd">    This function generates a figure with two vertically stacked panels: precipitation</span>
<span class="sd">    on top and streamflow below. It supports multiple precipitation sources and</span>
<span class="sd">    streamflow series with customizable styling.</span>

<span class="sd">    Args:</span>
<span class="sd">        t (array-like): Time points for x-axis.</span>
<span class="sd">        ps (list[np.array]): List of precipitation arrays from different sources.</span>
<span class="sd">        qs (list[np.array]): List of streamflow arrays (e.g., observed and simulated).</span>
<span class="sd">        c_lst (str, optional): String of color characters. Defaults to &quot;rbkgcmy&quot;.</span>
<span class="sd">        title (str, optional): Figure title. Defaults to &quot;Observation of Precipitation</span>
<span class="sd">            and Streamflow&quot;.</span>
<span class="sd">        alpha_lst (list[float], optional): Transparency values for each series.</span>
<span class="sd">            Defaults to [0.5, 0.5].</span>
<span class="sd">        p_labels (list[str], optional): Labels for precipitation sources.</span>
<span class="sd">            Defaults to [&quot;era5land&quot;, &quot;gauge&quot;].</span>
<span class="sd">        q_labels (list[str], optional): Labels for streamflow series.</span>
<span class="sd">            Defaults to [&quot;observation&quot;, &quot;simulation&quot;].</span>

<span class="sd">    Returns:</span>
<span class="sd">        Tuple[matplotlib.figure.Figure, matplotlib.axes.Axes]: The figure and bottom</span>
<span class="sd">            axes (streamflow plot).</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; # Create sample data</span>
<span class="sd">        &gt;&gt;&gt; t = pd.date_range(&#39;2020-01-01&#39;, &#39;2020-12-31&#39;, freq=&#39;D&#39;)</span>
<span class="sd">        &gt;&gt;&gt; # Two precipitation sources</span>
<span class="sd">        &gt;&gt;&gt; p1 = np.random.exponential(2, size=len(t))  # ERA5</span>
<span class="sd">        &gt;&gt;&gt; p2 = p1 * 1.2 + np.random.normal(0, 0.2, len(t))  # Gauge</span>
<span class="sd">        &gt;&gt;&gt; # Observed and simulated streamflow</span>
<span class="sd">        &gt;&gt;&gt; q_obs = np.convolve(p1, np.ones(5)/5, mode=&#39;same&#39;)</span>
<span class="sd">        &gt;&gt;&gt; q_sim = q_obs * 1.1 + np.random.normal(0, 0.1, len(q_obs))</span>
<span class="sd">        &gt;&gt;&gt; </span>
<span class="sd">        &gt;&gt;&gt; fig, ax = plot_rainfall_runoff_chai(</span>
<span class="sd">        ...     t, [p1, p2], [q_obs, q_sim],</span>
<span class="sd">        ...     title=&#39;2020 Rainfall-Runoff Comparison&#39;,</span>
<span class="sd">        ...     p_labels=[&#39;ERA5&#39;, &#39;Rain Gauge&#39;],</span>
<span class="sd">        ...     q_labels=[&#39;Observed&#39;, &#39;Simulated&#39;]</span>
<span class="sd">        ... )</span>

<span class="sd">    Notes:</span>
<span class="sd">        - Top panel shows precipitation with bars</span>
<span class="sd">        - Bottom panel shows streamflow with lines</span>
<span class="sd">        - Precipitation y-axis is inverted and blue</span>
<span class="sd">        - Streamflow y-axis is red</span>
<span class="sd">        - Both panels share x-axis limits</span>
<span class="sd">        - Legends included for both panels</span>
<span class="sd">        - Uses large figure size (20x8) by default</span>
<span class="sd">        - Includes &quot;Streamflow&quot; text box in bottom panel</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">alpha_lst</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">alpha_lst</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">p_labels</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">p_labels</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;era5land&quot;</span><span class="p">,</span> <span class="s2">&quot;gauge&quot;</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">q_labels</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">q_labels</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;observation&quot;</span><span class="p">,</span> <span class="s2">&quot;simulation&quot;</span><span class="p">]</span>
    <span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">ps</span><span class="p">):</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span>
            <span class="n">t</span><span class="p">,</span>
            <span class="n">p</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="n">c_lst</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
            <span class="n">label</span><span class="o">=</span><span class="n">p_labels</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
            <span class="n">width</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="n">alpha_lst</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
        <span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Precipitation (mm/d)&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;b&quot;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">invert_yaxis</span><span class="p">()</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">labelcolor</span><span class="o">=</span><span class="s2">&quot;b&quot;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">q</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">qs</span><span class="p">):</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">c_lst</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="n">q_labels</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha_lst</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Streamflow (m$^3$/s)&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">labelcolor</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">ax1</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">())</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
        <span class="mf">0.05</span><span class="p">,</span>
        <span class="mf">0.95</span><span class="p">,</span>
        <span class="s2">&quot;Streamflow&quot;</span><span class="p">,</span>
        <span class="n">transform</span><span class="o">=</span><span class="n">ax2</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span>
        <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>
        <span class="n">verticalalignment</span><span class="o">=</span><span class="s2">&quot;top&quot;</span><span class="p">,</span>
        <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">),</span>
    <span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax2</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="hydroutils.hydro_plot.plot_rainfall_runoff_xu" class="doc doc-heading">
<code class="highlight language-python"><span class="n">plot_rainfall_runoff_xu</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">qs</span><span class="p">,</span> <span class="n">fig_size</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;prcp-streamflow&#39;</span><span class="p">,</span> <span class="n">leg_lst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;streamflow(m^3/s)&#39;</span><span class="p">,</span> <span class="n">prcp_ylabel</span><span class="o">=</span><span class="s1">&#39;prcp(mm/day)&#39;</span><span class="p">)</span></code>


<a href="#hydroutils.hydro_plot.plot_rainfall_runoff_xu" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Creates a dual-axis plot for rainfall-runoff analysis with Xu's style.</p>
<p>This function generates a specialized plot with precipitation bars from the top
and streamflow lines on the bottom, following Xu's visualization style. It uses
dual y-axes with color-coded labels and ticks.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>t</code></td>
        <td><code>array-like</code></td>
        <td><p>Time points for x-axis.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>p</code></td>
        <td><code>np.array</code></td>
        <td><p>Precipitation values.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>qs</code></td>
        <td><code>tuple</code></td>
        <td><p>Tuple of (observed, predicted) streamflow values.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>fig_size</code></td>
        <td><code>tuple</code></td>
        <td><p>Figure size as (width, height). Defaults to (10, 6).</p></td>
        <td><code>(10, 6)</code></td>
      </tr>
      <tr>
        <td><code>title</code></td>
        <td><code>str</code></td>
        <td><p>Plot title. Defaults to "prcp-streamflow".</p></td>
        <td><code>&#39;prcp-streamflow&#39;</code></td>
      </tr>
      <tr>
        <td><code>leg_lst</code></td>
        <td><code>list</code></td>
        <td><p>Legend labels. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>ylabel</code></td>
        <td><code>str</code></td>
        <td><p>Y-axis label for streamflow. Defaults to "streamflow(m^3/s)".</p></td>
        <td><code>&#39;streamflow(m^3/s)&#39;</code></td>
      </tr>
      <tr>
        <td><code>prcp_ylabel</code></td>
        <td><code>str</code></td>
        <td><p>Y-axis label for precipitation.
Defaults to "prcp(mm/day)".</p></td>
        <td><code>&#39;prcp(mm/day)&#39;</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="c1"># Create sample data</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="s1">&#39;2020-01-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2020-12-31&#39;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;datetime64[D]&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">exponential</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>  <span class="c1"># precipitation</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">obs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">)</span>  <span class="c1"># observed flow</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">pred</span> <span class="o">=</span> <span class="n">obs</span> <span class="o">*</span> <span class="mf">1.1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">obs</span><span class="p">))</span>  <span class="c1"># predicted flow</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">plot_rainfall_runoff_xu</span><span class="p">(</span>
<span class="o">...</span>     <span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="p">(</span><span class="n">obs</span><span class="p">,</span> <span class="n">pred</span><span class="p">),</span>
<span class="o">...</span>     <span class="n">title</span><span class="o">=</span><span class="s1">&#39;2020 Rainfall-Runoff Analysis&#39;</span>
<span class="o">...</span> <span class="p">)</span>
</code></pre></div>
      <p>!!! notes
    - Precipitation shown as blue bars from top
    - Observed streamflow as solid green line
    - Predicted streamflow as dashed red line
    - Y-axes labels and ticks color-coded
    - Precipitation axis inverted
    - Legend positioned at upper left
    - Precipitation bars semi-transparent (alpha=0.6)</p>

        <details class="quote">
          <summary>Source code in <code>hydroutils/hydro_plot.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_rainfall_runoff_xu</span><span class="p">(</span>
    <span class="n">t</span><span class="p">,</span>
    <span class="n">p</span><span class="p">,</span>
    <span class="n">qs</span><span class="p">,</span>
    <span class="n">fig_size</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;prcp-streamflow&quot;</span><span class="p">,</span>
    <span class="n">leg_lst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;streamflow(m^3/s)&quot;</span><span class="p">,</span>
    <span class="n">prcp_ylabel</span><span class="o">=</span><span class="s2">&quot;prcp(mm/day)&quot;</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates a dual-axis plot for rainfall-runoff analysis with Xu&#39;s style.</span>

<span class="sd">    This function generates a specialized plot with precipitation bars from the top</span>
<span class="sd">    and streamflow lines on the bottom, following Xu&#39;s visualization style. It uses</span>
<span class="sd">    dual y-axes with color-coded labels and ticks.</span>

<span class="sd">    Args:</span>
<span class="sd">        t (array-like): Time points for x-axis.</span>
<span class="sd">        p (np.array): Precipitation values.</span>
<span class="sd">        qs (tuple): Tuple of (observed, predicted) streamflow values.</span>
<span class="sd">        fig_size (tuple, optional): Figure size as (width, height). Defaults to (10, 6).</span>
<span class="sd">        title (str, optional): Plot title. Defaults to &quot;prcp-streamflow&quot;.</span>
<span class="sd">        leg_lst (list, optional): Legend labels. Defaults to None.</span>
<span class="sd">        ylabel (str, optional): Y-axis label for streamflow. Defaults to &quot;streamflow(m^3/s)&quot;.</span>
<span class="sd">        prcp_ylabel (str, optional): Y-axis label for precipitation.</span>
<span class="sd">            Defaults to &quot;prcp(mm/day)&quot;.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; # Create sample data</span>
<span class="sd">        &gt;&gt;&gt; t = np.arange(&#39;2020-01-01&#39;, &#39;2020-12-31&#39;, dtype=&#39;datetime64[D]&#39;)</span>
<span class="sd">        &gt;&gt;&gt; p = np.random.exponential(2, size=len(t))  # precipitation</span>
<span class="sd">        &gt;&gt;&gt; obs = np.convolve(p, np.ones(5)/5, mode=&#39;same&#39;)  # observed flow</span>
<span class="sd">        &gt;&gt;&gt; pred = obs * 1.1 + np.random.normal(0, 0.1, len(obs))  # predicted flow</span>
<span class="sd">        &gt;&gt;&gt; plot_rainfall_runoff_xu(</span>
<span class="sd">        ...     t, p, (obs, pred),</span>
<span class="sd">        ...     title=&#39;2020 Rainfall-Runoff Analysis&#39;</span>
<span class="sd">        ... )</span>

<span class="sd">    Notes:</span>
<span class="sd">        - Precipitation shown as blue bars from top</span>
<span class="sd">        - Observed streamflow as solid green line</span>
<span class="sd">        - Predicted streamflow as dashed red line</span>
<span class="sd">        - Y-axes labels and ticks color-coded</span>
<span class="sd">        - Precipitation axis inverted</span>
<span class="sd">        - Legend positioned at upper left</span>
<span class="sd">        - Precipitation bars semi-transparent (alpha=0.6)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">obs</span><span class="p">,</span> <span class="n">pred</span> <span class="o">=</span> <span class="n">qs</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">fig_size</span><span class="p">)</span>

    <span class="n">ax1</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Precipitation&quot;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">prcp_ylabel</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">labelcolor</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">)</span>

    <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">p</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">*</span> <span class="mi">5</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">invert_yaxis</span><span class="p">()</span>

    <span class="n">ax2</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>

    <span class="c1"># transform the unit of obs and pred</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <span class="n">t</span><span class="p">,</span>
        <span class="n">obs</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">,</span>
        <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="s2">&quot;observed value&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <span class="n">t</span><span class="p">,</span>
        <span class="n">pred</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span>
        <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="s2">&quot;predicted value&quot;</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">labelcolor</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper left&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="hydroutils.hydro_plot.plot_scatter_with_11line" class="doc doc-heading">
<code class="highlight language-python"><span class="n">plot_scatter_with_11line</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">point_color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">line_color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span> <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span> <span class="n">xlabel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#hydroutils.hydro_plot.plot_scatter_with_11line" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Creates a scatter plot comparing two variables with a 1:1 line.</p>
<p>This function generates a scatter plot with a 1:1 line (diagonal) for comparing
two variables, commonly used in model evaluation to compare observed vs predicted values.
The plot includes customizable colors, axis limits, and labels.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>x</code></td>
        <td><code>np.array</code></td>
        <td><p>First variable to be plotted (typically observed values).</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>y</code></td>
        <td><code>np.array</code></td>
        <td><p>Second variable to be plotted (typically predicted values).</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>point_color</code></td>
        <td><code>str</code></td>
        <td><p>Color of scatter points. Defaults to "blue".</p></td>
        <td><code>&#39;blue&#39;</code></td>
      </tr>
      <tr>
        <td><code>line_color</code></td>
        <td><code>str</code></td>
        <td><p>Color of the 1:1 line. Defaults to "black".</p></td>
        <td><code>&#39;black&#39;</code></td>
      </tr>
      <tr>
        <td><code>xlim</code></td>
        <td><code>list</code></td>
        <td><p>X-axis range as [min, max]. Defaults to [0.0, 1.0].</p></td>
        <td><code>[0.0, 1.0]</code></td>
      </tr>
      <tr>
        <td><code>ylim</code></td>
        <td><code>list</code></td>
        <td><p>Y-axis range as [min, max]. Defaults to [0.0, 1.0].</p></td>
        <td><code>[0.0, 1.0]</code></td>
      </tr>
      <tr>
        <td><code>xlabel</code></td>
        <td><code>str</code></td>
        <td><p>Label for x-axis. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>ylabel</code></td>
        <td><code>str</code></td>
        <td><p>Label for y-axis. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>tuple[matplotlib.figure.Figure, matplotlib.axes.Axes]</code></td>
      <td><p>A tuple containing the figure and axes objects.</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">obs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">2.2</span><span class="p">,</span> <span class="mf">2.9</span><span class="p">,</span> <span class="mf">4.1</span><span class="p">,</span> <span class="mf">5.2</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plot_scatter_with_11line</span><span class="p">(</span>
<span class="o">...</span>     <span class="n">obs</span><span class="p">,</span> <span class="n">pred</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Observed&#39;</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Predicted&#39;</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
<span class="o">...</span>     <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>
<span class="o">...</span> <span class="p">)</span>
</code></pre></div>

        <details class="quote">
          <summary>Source code in <code>hydroutils/hydro_plot.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_scatter_with_11line</span><span class="p">(</span>
    <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">,</span>
    <span class="n">y</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">,</span>
    <span class="n">point_color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span>
    <span class="n">line_color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span>
    <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span>
    <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span>
    <span class="n">xlabel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">ylabel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates a scatter plot comparing two variables with a 1:1 line.</span>

<span class="sd">    This function generates a scatter plot with a 1:1 line (diagonal) for comparing</span>
<span class="sd">    two variables, commonly used in model evaluation to compare observed vs predicted values.</span>
<span class="sd">    The plot includes customizable colors, axis limits, and labels.</span>

<span class="sd">    Args:</span>
<span class="sd">        x (np.array): First variable to be plotted (typically observed values).</span>
<span class="sd">        y (np.array): Second variable to be plotted (typically predicted values).</span>
<span class="sd">        point_color (str, optional): Color of scatter points. Defaults to &quot;blue&quot;.</span>
<span class="sd">        line_color (str, optional): Color of the 1:1 line. Defaults to &quot;black&quot;.</span>
<span class="sd">        xlim (list, optional): X-axis range as [min, max]. Defaults to [0.0, 1.0].</span>
<span class="sd">        ylim (list, optional): Y-axis range as [min, max]. Defaults to [0.0, 1.0].</span>
<span class="sd">        xlabel (str, optional): Label for x-axis. Defaults to None.</span>
<span class="sd">        ylabel (str, optional): Label for y-axis. Defaults to None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple[matplotlib.figure.Figure, matplotlib.axes.Axes]: </span>
<span class="sd">            A tuple containing the figure and axes objects.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; obs = np.array([1, 2, 3, 4, 5])</span>
<span class="sd">        &gt;&gt;&gt; pred = np.array([1.1, 2.2, 2.9, 4.1, 5.2])</span>
<span class="sd">        &gt;&gt;&gt; fig, ax = plot_scatter_with_11line(</span>
<span class="sd">        ...     obs, pred,</span>
<span class="sd">        ...     xlabel=&#39;Observed&#39;,</span>
<span class="sd">        ...     ylabel=&#39;Predicted&#39;,</span>
<span class="sd">        ...     xlim=[0, 6],</span>
<span class="sd">        ...     ylim=[0, 6]</span>
<span class="sd">        ... )</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
    <span class="c1"># set background color for ax</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_facecolor</span><span class="p">(</span><span class="s2">&quot;whitesmoke&quot;</span><span class="p">)</span>
    <span class="c1"># plot the grid of the figure</span>
    <span class="c1"># plt.grid(color=&quot;whitesmoke&quot;)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">point_color</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">line</span> <span class="o">=</span> <span class="n">mlines</span><span class="o">.</span><span class="n">Line2D</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">line_color</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">)</span>
    <span class="n">transform</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span>
    <span class="n">line</span><span class="o">.</span><span class="n">set_transform</span><span class="p">(</span><span class="n">transform</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">add_line</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">xlim</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ylim</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">xlim</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mf">0.1</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">ylim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ylim</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mf">0.1</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="c1"># set xlable and ylabel</span>
    <span class="k">if</span> <span class="n">xlabel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">xlabel</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">ylabel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;bottom&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="hydroutils.hydro_plot.plot_scatter_xyc" class="doc doc-heading">
<code class="highlight language-python"><span class="n">plot_scatter_xyc</span><span class="p">(</span><span class="n">x_label</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y_label</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">c_label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">is_reg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ylim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">quadrant</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#hydroutils.hydro_plot.plot_scatter_xyc" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Creates a scatter plot with optional color mapping and quadrant analysis.</p>
<p>This function generates a scatter plot with optional color mapping for points,
regression line, and quadrant analysis. It's particularly useful for analyzing
relationships between variables with an additional dimension represented by color.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>x_label</code></td>
        <td><code>str</code></td>
        <td><p>Label for x-axis.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>x</code></td>
        <td><code>Union[np.array, List[np.array]]</code></td>
        <td><p>X-axis data values.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>y_label</code></td>
        <td><code>str</code></td>
        <td><p>Label for y-axis.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>y</code></td>
        <td><code>Union[np.array, List[np.array]]</code></td>
        <td><p>Y-axis data values.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>c_label</code></td>
        <td><code>Union[str, List[str]]</code></td>
        <td><p>Label(s) for color mapping or
multiple series. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>c</code></td>
        <td><code>Union[np.array, List[str]]</code></td>
        <td><p>Values for color mapping or
colors for multiple series. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>size</code></td>
        <td><code>int</code></td>
        <td><p>Size of scatter points. Defaults to 20.</p></td>
        <td><code>20</code></td>
      </tr>
      <tr>
        <td><code>is_reg</code></td>
        <td><code>bool</code></td>
        <td><p>If True, adds regression line. Defaults to False.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>xlim</code></td>
        <td><code>list</code></td>
        <td><p>X-axis limits as [min, max]. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>ylim</code></td>
        <td><code>list</code></td>
        <td><p>Y-axis limits as [min, max]. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>quadrant</code></td>
        <td><code>list</code></td>
        <td><p>Reference points [x, y] for quadrant analysis.
Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="c1"># Simple scatter plot</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">y</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">plot_scatter_xyc</span><span class="p">(</span>
<span class="o">...</span>     <span class="s1">&#39;X Values&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span>
<span class="o">...</span>     <span class="s1">&#39;Y Values&#39;</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">is_reg</span><span class="o">=</span><span class="kc">True</span>
<span class="o">...</span> <span class="p">)</span>
</code></pre></div>
    <div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="c1"># Scatter plot with color mapping</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">plot_scatter_xyc</span><span class="p">(</span>
<span class="o">...</span>     <span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">c_label</span><span class="o">=</span><span class="s1">&#39;Z Values&#39;</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">c</span><span class="o">=</span><span class="n">c</span>
<span class="o">...</span> <span class="p">)</span>
</code></pre></div>
    <div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="c1"># Quadrant analysis</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">plot_scatter_xyc</span><span class="p">(</span>
<span class="o">...</span>     <span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">quadrant</span><span class="o">=</span><span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>
<span class="o">...</span>     <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="o">...</span>     <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="o">...</span> <span class="p">)</span>
</code></pre></div>
      <p>!!! notes
    - Supports both single and multiple series plotting
    - Automatically handles NaN values
    - Provides quadrant statistics when quadrant analysis is enabled
    - Uses clean plotting style with minimal spines
    - Supports regression line with seaborn's regplot</p>

        <details class="quote">
          <summary>Source code in <code>hydroutils/hydro_plot.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_scatter_xyc</span><span class="p">(</span>
    <span class="n">x_label</span><span class="p">,</span>
    <span class="n">x</span><span class="p">,</span>
    <span class="n">y_label</span><span class="p">,</span>
    <span class="n">y</span><span class="p">,</span>
    <span class="n">c_label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">c</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
    <span class="n">is_reg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">xlim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">ylim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">quadrant</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates a scatter plot with optional color mapping and quadrant analysis.</span>

<span class="sd">    This function generates a scatter plot with optional color mapping for points,</span>
<span class="sd">    regression line, and quadrant analysis. It&#39;s particularly useful for analyzing</span>
<span class="sd">    relationships between variables with an additional dimension represented by color.</span>

<span class="sd">    Args:</span>
<span class="sd">        x_label (str): Label for x-axis.</span>
<span class="sd">        x (Union[np.array, List[np.array]]): X-axis data values.</span>
<span class="sd">        y_label (str): Label for y-axis.</span>
<span class="sd">        y (Union[np.array, List[np.array]]): Y-axis data values.</span>
<span class="sd">        c_label (Union[str, List[str]], optional): Label(s) for color mapping or</span>
<span class="sd">            multiple series. Defaults to None.</span>
<span class="sd">        c (Union[np.array, List[str]], optional): Values for color mapping or</span>
<span class="sd">            colors for multiple series. Defaults to None.</span>
<span class="sd">        size (int, optional): Size of scatter points. Defaults to 20.</span>
<span class="sd">        is_reg (bool, optional): If True, adds regression line. Defaults to False.</span>
<span class="sd">        xlim (list, optional): X-axis limits as [min, max]. Defaults to None.</span>
<span class="sd">        ylim (list, optional): Y-axis limits as [min, max]. Defaults to None.</span>
<span class="sd">        quadrant (list, optional): Reference points [x, y] for quadrant analysis.</span>
<span class="sd">            Defaults to None.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; # Simple scatter plot</span>
<span class="sd">        &gt;&gt;&gt; x = np.random.rand(100)</span>
<span class="sd">        &gt;&gt;&gt; y = x + np.random.normal(0, 0.1, 100)</span>
<span class="sd">        &gt;&gt;&gt; plot_scatter_xyc(</span>
<span class="sd">        ...     &#39;X Values&#39;, x,</span>
<span class="sd">        ...     &#39;Y Values&#39;, y,</span>
<span class="sd">        ...     is_reg=True</span>
<span class="sd">        ... )</span>

<span class="sd">        &gt;&gt;&gt; # Scatter plot with color mapping</span>
<span class="sd">        &gt;&gt;&gt; c = np.random.rand(100)</span>
<span class="sd">        &gt;&gt;&gt; plot_scatter_xyc(</span>
<span class="sd">        ...     &#39;X&#39;, x, &#39;Y&#39;, y,</span>
<span class="sd">        ...     c_label=&#39;Z Values&#39;,</span>
<span class="sd">        ...     c=c</span>
<span class="sd">        ... )</span>

<span class="sd">        &gt;&gt;&gt; # Quadrant analysis</span>
<span class="sd">        &gt;&gt;&gt; plot_scatter_xyc(</span>
<span class="sd">        ...     &#39;X&#39;, x, &#39;Y&#39;, y,</span>
<span class="sd">        ...     quadrant=[0.5, 0.5],</span>
<span class="sd">        ...     xlim=[0, 1],</span>
<span class="sd">        ...     ylim=[0, 1]</span>
<span class="sd">        ... )</span>

<span class="sd">    Notes:</span>
<span class="sd">        - Supports both single and multiple series plotting</span>
<span class="sd">        - Automatically handles NaN values</span>
<span class="sd">        - Provides quadrant statistics when quadrant analysis is enabled</span>
<span class="sd">        - Uses clean plotting style with minimal spines</span>
<span class="sd">        - Supports regression line with seaborn&#39;s regplot</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)):</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
                <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="n">size</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">c_label</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">c</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

    <span class="k">elif</span> <span class="n">c</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="n">x_label</span><span class="p">:</span> <span class="n">x</span><span class="p">,</span> <span class="n">y_label</span><span class="p">:</span> <span class="n">y</span><span class="p">})</span>
        <span class="n">points</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">x_label</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="n">y_label</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">quadrant</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">quadrant</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;grey&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">quadrant</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;grey&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">)</span>
            <span class="n">q2</span> <span class="o">=</span> <span class="n">df</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="n">x_label</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">y_label</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">q3</span> <span class="o">=</span> <span class="n">df</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="n">x_label</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">y_label</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">q4</span> <span class="o">=</span> <span class="n">df</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="n">x_label</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">y_label</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">q5</span> <span class="o">=</span> <span class="n">df</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="n">x_label</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">y_label</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">q1</span> <span class="o">=</span> <span class="n">df</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="n">x_label</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">y_label</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">q</span> <span class="o">=</span> <span class="n">q1</span> <span class="o">+</span> <span class="n">q2</span> <span class="o">+</span> <span class="n">q3</span> <span class="o">+</span> <span class="n">q4</span> <span class="o">+</span> <span class="n">q5</span>
            <span class="n">r1</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">q1</span> <span class="o">/</span> <span class="n">q</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span>
            <span class="n">r2</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">q2</span> <span class="o">/</span> <span class="n">q</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span>
            <span class="n">r3</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">q3</span> <span class="o">/</span> <span class="n">q</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span>
            <span class="n">r4</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">q4</span> <span class="o">/</span> <span class="n">q</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span>
            <span class="n">r5</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">-</span> <span class="n">r1</span> <span class="o">-</span> <span class="n">r2</span> <span class="o">-</span> <span class="n">r3</span> <span class="o">-</span> <span class="n">r4</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
                <span class="n">xlim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="p">(</span><span class="n">xlim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="mf">0.1</span><span class="p">,</span>
                <span class="n">ylim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="p">(</span><span class="n">ylim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">ylim</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="mf">0.1</span><span class="p">,</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">r1</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">,</span>
                <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
                <span class="n">xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">xlim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="mf">0.1</span><span class="p">,</span>
                <span class="n">ylim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="p">(</span><span class="n">ylim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">ylim</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="mf">0.1</span><span class="p">,</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">r2</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">,</span>
                <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
                <span class="n">xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">xlim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="mf">0.1</span><span class="p">,</span>
                <span class="n">ylim</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">ylim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">ylim</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="mf">0.1</span><span class="p">,</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">r3</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">,</span>
                <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
                <span class="n">xlim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="p">(</span><span class="n">xlim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="mf">0.1</span><span class="p">,</span>
                <span class="n">ylim</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">ylim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">ylim</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="mf">0.1</span><span class="p">,</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">r4</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">,</span>
                <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">r5</span><span class="p">)</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="n">x_label</span><span class="p">:</span> <span class="n">x</span><span class="p">,</span> <span class="n">y_label</span><span class="p">:</span> <span class="n">y</span><span class="p">,</span> <span class="n">c_label</span><span class="p">:</span> <span class="n">c</span><span class="p">})</span>
        <span class="n">points</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
            <span class="n">df</span><span class="p">[</span><span class="n">x_label</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="n">y_label</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">c_label</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="n">size</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;Spectral&quot;</span>
        <span class="p">)</span>  <span class="c1"># set style options</span>
        <span class="c1"># add a color bar</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>

    <span class="c1"># set limits</span>
    <span class="k">if</span> <span class="n">xlim</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">xlim</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">ylim</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="n">ylim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ylim</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="c1"># Hide the right and top spines</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="c1"># build the regression plot</span>
    <span class="k">if</span> <span class="n">is_reg</span><span class="p">:</span>
        <span class="n">plot</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">regplot</span><span class="p">(</span><span class="n">x_label</span><span class="p">,</span> <span class="n">y_label</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">scatter</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>  <span class="c1"># , color=&quot;.1&quot;</span>
        <span class="n">plot</span> <span class="o">=</span> <span class="n">plot</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="n">x_label</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="n">y_label</span><span class="p">)</span>  <span class="c1"># add labels</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">x_label</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="n">y_label</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="hydroutils.hydro_plot.plot_ts" class="doc doc-heading">
<code class="highlight language-python"><span class="n">plot_ts</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">t_bar</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fig_size</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">c_lst</span><span class="o">=</span><span class="s1">&#39;rbkgcmyrbkgcmyrbkgcmy&#39;</span><span class="p">,</span> <span class="n">leg_lst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">marker_lst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">linespec</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dash_lines</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span></code>


<a href="#hydroutils.hydro_plot.plot_ts" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Plot time series for multi arrays with matplotlib</p>
<h4 id="hydroutils.hydro_plot.plot_ts--parameters">Parameters<a class="headerlink" href="#hydroutils.hydro_plot.plot_ts--parameters" title="Permanent link">&para;</a></h4>
<p>t : Union[list, np.array]
    time series but not just date; it can also be numbers like 1, 2, 3, ...
y : Union[list, np.array]
    shown data series; the len of y should be equal to t's
ax : <em>type</em>, optional
    <em>description</em>, by default None
t_bar : <em>type</em>, optional
    <em>description</em>, by default None
title : <em>type</em>, optional
    <em>description</em>, by default None
!!! xlabel "str, optional"
    the name of x axis, by default None
ylabel : str, optional
    the name of y axis, by default None
fig_size : tuple, optional
    <em>description</em>, by default (12, 4)
c_lst : str, optional
    <em>description</em>, by default "rbkgcmy"
leg_lst : <em>type</em>, optional
    <em>description</em>, by default None
marker_lst : <em>type</em>, optional
    <em>description</em>, by default None
linewidth : int, optional
    <em>description</em>, by default 2
linespec : <em>type</em>, optional
    <em>description</em>, by default None
dash_lines : <em>type</em>, optional
    if dash_line, then we will plot dashed line, by default None</p>
<h4 id="hydroutils.hydro_plot.plot_ts--returns">Returns<a class="headerlink" href="#hydroutils.hydro_plot.plot_ts--returns" title="Permanent link">&para;</a></h4>
<p><em>type</em>
    <em>description</em></p>

        <details class="quote">
          <summary>Source code in <code>hydroutils/hydro_plot.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_ts</span><span class="p">(</span>
    <span class="n">t</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">list</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">],</span>
    <span class="n">y</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">list</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">],</span>
    <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">t_bar</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">xlabel</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">ylabel</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">fig_size</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>
    <span class="n">c_lst</span><span class="o">=</span><span class="s2">&quot;rbkgcmyrbkgcmyrbkgcmy&quot;</span><span class="p">,</span>
    <span class="n">leg_lst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">marker_lst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">linespec</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">dash_lines</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plot time series for multi arrays with matplotlib</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    t : Union[list, np.array]</span>
<span class="sd">        time series but not just date; it can also be numbers like 1, 2, 3, ...</span>
<span class="sd">    y : Union[list, np.array]</span>
<span class="sd">        shown data series; the len of y should be equal to t&#39;s</span>
<span class="sd">    ax : _type_, optional</span>
<span class="sd">        _description_, by default None</span>
<span class="sd">    t_bar : _type_, optional</span>
<span class="sd">        _description_, by default None</span>
<span class="sd">    title : _type_, optional</span>
<span class="sd">        _description_, by default None</span>
<span class="sd">    xlabel: str, optional</span>
<span class="sd">        the name of x axis, by default None</span>
<span class="sd">    ylabel : str, optional</span>
<span class="sd">        the name of y axis, by default None</span>
<span class="sd">    fig_size : tuple, optional</span>
<span class="sd">        _description_, by default (12, 4)</span>
<span class="sd">    c_lst : str, optional</span>
<span class="sd">        _description_, by default &quot;rbkgcmy&quot;</span>
<span class="sd">    leg_lst : _type_, optional</span>
<span class="sd">        _description_, by default None</span>
<span class="sd">    marker_lst : _type_, optional</span>
<span class="sd">        _description_, by default None</span>
<span class="sd">    linewidth : int, optional</span>
<span class="sd">        _description_, by default 2</span>
<span class="sd">    linespec : _type_, optional</span>
<span class="sd">        _description_, by default None</span>
<span class="sd">    dash_lines : _type_, optional</span>
<span class="sd">        if dash_line, then we will plot dashed line, by default None</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    _type_</span>
<span class="sd">        _description_</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">is_new_fig</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">fig_size</span><span class="p">)</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
        <span class="n">is_new_fig</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">if</span> <span class="n">dash_lines</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dash_lines</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">dash_lines</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="c1"># dash_lines[-1] = True</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="ow">is</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
        <span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="n">y</span><span class="p">]</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">linewidth</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">list</span><span class="p">:</span>
        <span class="n">linewidth</span> <span class="o">=</span> <span class="p">[</span><span class="n">linewidth</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">list</span><span class="p">:</span>
        <span class="n">alpha</span> <span class="o">=</span> <span class="p">[</span><span class="n">alpha</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)):</span>
        <span class="n">tt</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span> <span class="k">else</span> <span class="n">t</span>
        <span class="n">yy</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
        <span class="n">leg_str</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">leg_lst</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">leg_str</span> <span class="o">=</span> <span class="n">leg_lst</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">marker_lst</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="p">(</span><span class="n">line_i</span><span class="p">,)</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tt</span><span class="p">,</span> <span class="n">yy</span><span class="p">,</span> <span class="s2">&quot;*&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">c_lst</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="n">leg_str</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                <span class="k">if</span> <span class="kc">True</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">yy</span><span class="p">)</span>
                <span class="k">else</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
                    <span class="n">tt</span><span class="p">,</span>
                    <span class="n">yy</span><span class="p">,</span>
                    <span class="n">color</span><span class="o">=</span><span class="n">c_lst</span><span class="p">[</span><span class="n">k</span><span class="p">],</span>
                    <span class="n">label</span><span class="o">=</span><span class="n">leg_str</span><span class="p">,</span>
                    <span class="n">linewidth</span><span class="o">=</span><span class="n">linewidth</span><span class="p">[</span><span class="n">k</span><span class="p">],</span>
                    <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">[</span><span class="n">k</span><span class="p">],</span>
                <span class="p">)</span>
            <span class="p">)</span>
        <span class="k">elif</span> <span class="n">marker_lst</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;-&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">linespec</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="p">(</span><span class="n">line_i</span><span class="p">,)</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
                    <span class="n">tt</span><span class="p">,</span>
                    <span class="n">yy</span><span class="p">,</span>
                    <span class="n">color</span><span class="o">=</span><span class="n">c_lst</span><span class="p">[</span><span class="n">k</span><span class="p">],</span>
                    <span class="n">label</span><span class="o">=</span><span class="n">leg_str</span><span class="p">,</span>
                    <span class="n">linestyle</span><span class="o">=</span><span class="n">linespec</span><span class="p">[</span><span class="n">k</span><span class="p">],</span>
                    <span class="n">lw</span><span class="o">=</span><span class="n">linewidth</span><span class="p">[</span><span class="n">k</span><span class="p">],</span>
                    <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">[</span><span class="n">k</span><span class="p">],</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="p">(</span><span class="n">line_i</span><span class="p">,)</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
                    <span class="n">tt</span><span class="p">,</span>
                    <span class="n">yy</span><span class="p">,</span>
                    <span class="n">color</span><span class="o">=</span><span class="n">c_lst</span><span class="p">[</span><span class="n">k</span><span class="p">],</span>
                    <span class="n">label</span><span class="o">=</span><span class="n">leg_str</span><span class="p">,</span>
                    <span class="n">lw</span><span class="o">=</span><span class="n">linewidth</span><span class="p">[</span><span class="n">k</span><span class="p">],</span>
                    <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">[</span><span class="n">k</span><span class="p">],</span>
                <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="p">(</span><span class="n">line_i</span><span class="p">,)</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
                <span class="n">tt</span><span class="p">,</span>
                <span class="n">yy</span><span class="p">,</span>
                <span class="n">color</span><span class="o">=</span><span class="n">c_lst</span><span class="p">[</span><span class="n">k</span><span class="p">],</span>
                <span class="n">label</span><span class="o">=</span><span class="n">leg_str</span><span class="p">,</span>
                <span class="n">marker</span><span class="o">=</span><span class="n">marker_lst</span><span class="p">[</span><span class="n">k</span><span class="p">],</span>
                <span class="n">lw</span><span class="o">=</span><span class="n">linewidth</span><span class="p">[</span><span class="n">k</span><span class="p">],</span>
                <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">[</span><span class="n">k</span><span class="p">],</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="n">dash_lines</span><span class="p">[</span><span class="n">k</span><span class="p">]:</span>
            <span class="n">line_i</span><span class="o">.</span><span class="n">set_dashes</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">ylabel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">xlabel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">xlabel</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">t_bar</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ylim</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span>
        <span class="n">t_bar</span> <span class="o">=</span> <span class="p">[</span><span class="n">t_bar</span><span class="p">]</span> <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">t_bar</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">list</span> <span class="k">else</span> <span class="n">t_bar</span>
        <span class="k">for</span> <span class="n">tt</span> <span class="ow">in</span> <span class="n">t_bar</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">tt</span><span class="p">,</span> <span class="n">tt</span><span class="p">],</span> <span class="n">ylim</span><span class="p">,</span> <span class="s2">&quot;-k&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">leg_lst</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper right&quot;</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;size&quot;</span><span class="p">:</span> <span class="mi">16</span><span class="p">})</span>
    <span class="k">if</span> <span class="n">title</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">fontdict</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;fontsize&quot;</span><span class="p">:</span> <span class="mi">17</span><span class="p">})</span>
    <span class="c1"># plot the grid of the figure</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="c1"># Hide the right and top spines</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span> <span class="k">if</span> <span class="n">is_new_fig</span> <span class="k">else</span> <span class="n">ax</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="hydroutils.hydro_plot.plot_ts_map" class="doc doc-heading">
<code class="highlight language-python"><span class="n">plot_ts_map</span><span class="p">(</span><span class="n">dataMap</span><span class="p">,</span> <span class="n">dataTs</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">sites_id</span><span class="p">,</span> <span class="n">pertile_range</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#hydroutils.hydro_plot.plot_ts_map" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Creates an interactive map with linked time series plots.</p>
<p>This function generates a figure with two subplots: a map on top and a time series
plot below. Clicking on a location in the map updates the time series plot to show
data from the nearest site.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>dataMap</code></td>
        <td><code>list</code></td>
        <td><p>Data values to be shown on the map.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>dataTs</code></td>
        <td><code>list</code></td>
        <td><p>List of time series data for each site.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>lat</code></td>
        <td><code>np.array</code></td>
        <td><p>Latitude values for each site.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>lon</code></td>
        <td><code>np.array</code></td>
        <td><p>Longitude values for each site.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>t</code></td>
        <td><code>list</code></td>
        <td><p>Time points for x-axis of time series.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>sites_id</code></td>
        <td><code>list</code></td>
        <td><p>Identifiers for each site.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>pertile_range</code></td>
        <td><code>list</code></td>
        <td><p>Percentile range for color scaling on map.
Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="c1"># Create sample data</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">n_sites</span> <span class="o">=</span> <span class="mi">10</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">n_times</span> <span class="o">=</span> <span class="mi">100</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">lat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="n">n_sites</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">lon</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mi">120</span><span class="p">,</span> <span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="n">n_sites</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">sites_id</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;SITE_</span><span class="si">{</span><span class="n">i</span><span class="si">:</span><span class="s1">03d</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_sites</span><span class="p">)]</span>
<span class="o">&gt;&gt;&gt;</span> 
<span class="o">&gt;&gt;&gt;</span> <span class="c1"># Generate sample time series for each site</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">t</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n_times</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">dataTs</span> <span class="o">=</span> <span class="p">[]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_sites</span><span class="p">):</span>
<span class="o">...</span>     <span class="n">pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">/</span><span class="mi">10</span> <span class="o">+</span> <span class="n">i</span><span class="o">/</span><span class="mi">5</span><span class="p">)</span>
<span class="o">...</span>     <span class="n">obs</span> <span class="o">=</span> <span class="n">pred</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="n">n_times</span><span class="p">)</span>
<span class="o">...</span>     <span class="n">dataTs</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">pred</span><span class="p">,</span> <span class="n">obs</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> 
<span class="o">&gt;&gt;&gt;</span> <span class="c1"># Map data could be mean values</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">dataMap</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">ts</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="k">for</span> <span class="n">ts</span> <span class="ow">in</span> <span class="n">dataTs</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> 
<span class="o">&gt;&gt;&gt;</span> <span class="n">plot_ts_map</span><span class="p">(</span><span class="n">dataMap</span><span class="p">,</span> <span class="n">dataTs</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">sites_id</span><span class="p">)</span>
</code></pre></div>
      <p>!!! notes
    - Uses TkAgg backend for interactive display
    - Map uses Cartopy for proper geographic projection
    - Time series updates automatically on map click
    - Shows site ID and coordinates in time series title
    - Finds nearest site to click location
    - Both predicted and observed values shown in time series</p>

        <details class="quote">
          <summary>Source code in <code>hydroutils/hydro_plot.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_ts_map</span><span class="p">(</span><span class="n">dataMap</span><span class="p">,</span> <span class="n">dataTs</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">sites_id</span><span class="p">,</span> <span class="n">pertile_range</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates an interactive map with linked time series plots.</span>

<span class="sd">    This function generates a figure with two subplots: a map on top and a time series</span>
<span class="sd">    plot below. Clicking on a location in the map updates the time series plot to show</span>
<span class="sd">    data from the nearest site.</span>

<span class="sd">    Args:</span>
<span class="sd">        dataMap (list): Data values to be shown on the map.</span>
<span class="sd">        dataTs (list): List of time series data for each site.</span>
<span class="sd">        lat (np.array): Latitude values for each site.</span>
<span class="sd">        lon (np.array): Longitude values for each site.</span>
<span class="sd">        t (list): Time points for x-axis of time series.</span>
<span class="sd">        sites_id (list): Identifiers for each site.</span>
<span class="sd">        pertile_range (list, optional): Percentile range for color scaling on map.</span>
<span class="sd">            Defaults to None.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; # Create sample data</span>
<span class="sd">        &gt;&gt;&gt; n_sites = 10</span>
<span class="sd">        &gt;&gt;&gt; n_times = 100</span>
<span class="sd">        &gt;&gt;&gt; lat = np.random.uniform(30, 45, n_sites)</span>
<span class="sd">        &gt;&gt;&gt; lon = np.random.uniform(-120, -100, n_sites)</span>
<span class="sd">        &gt;&gt;&gt; sites_id = [f&#39;SITE_{i:03d}&#39; for i in range(n_sites)]</span>
<span class="sd">        &gt;&gt;&gt; </span>
<span class="sd">        &gt;&gt;&gt; # Generate sample time series for each site</span>
<span class="sd">        &gt;&gt;&gt; t = list(range(n_times))</span>
<span class="sd">        &gt;&gt;&gt; dataTs = []</span>
<span class="sd">        &gt;&gt;&gt; for i in range(n_sites):</span>
<span class="sd">        ...     pred = np.sin(np.array(t)/10 + i/5)</span>
<span class="sd">        ...     obs = pred + np.random.normal(0, 0.1, n_times)</span>
<span class="sd">        ...     dataTs.append([pred, obs])</span>
<span class="sd">        &gt;&gt;&gt; </span>
<span class="sd">        &gt;&gt;&gt; # Map data could be mean values</span>
<span class="sd">        &gt;&gt;&gt; dataMap = [np.mean(ts[0]) for ts in dataTs]</span>
<span class="sd">        &gt;&gt;&gt; </span>
<span class="sd">        &gt;&gt;&gt; plot_ts_map(dataMap, dataTs, lat, lon, t, sites_id)</span>

<span class="sd">    Notes:</span>
<span class="sd">        - Uses TkAgg backend for interactive display</span>
<span class="sd">        - Map uses Cartopy for proper geographic projection</span>
<span class="sd">        - Time series updates automatically on map click</span>
<span class="sd">        - Shows site ID and coordinates in time series title</span>
<span class="sd">        - Finds nearest site to click location</span>
<span class="sd">        - Both predicted and observed values shown in time series</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># show the map in a pop-up window</span>
    <span class="n">matplotlib</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">&quot;TkAgg&quot;</span><span class="p">)</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dataMap</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dataTs</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span>
    <span class="c1"># setup axes</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
    <span class="n">gs</span> <span class="o">=</span> <span class="n">gridspec</span><span class="o">.</span><span class="n">GridSpec</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="c1"># plt.subplots_adjust(left=0.13, right=0.89, bottom=0.05)</span>
    <span class="c1"># plot maps</span>
    <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
    <span class="n">ax1</span> <span class="o">=</span> <span class="n">plot_map_carto</span><span class="p">(</span>
        <span class="n">dataMap</span><span class="p">,</span> <span class="n">lat</span><span class="o">=</span><span class="n">lat</span><span class="p">,</span> <span class="n">lon</span><span class="o">=</span><span class="n">lon</span><span class="p">,</span> <span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">,</span> <span class="n">pertile_range</span><span class="o">=</span><span class="n">pertile_range</span>
    <span class="p">)</span>
    <span class="c1"># line plot</span>
    <span class="n">ax2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

    <span class="c1"># plot ts</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">onclick</span><span class="p">(</span><span class="n">event</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;click event&quot;</span><span class="p">)</span>
        <span class="c1"># refresh the ax2, then new ts data can be showed without previous one</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">cla</span><span class="p">()</span>
        <span class="n">xClick</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">xdata</span>
        <span class="n">yClick</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">ydata</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">xClick</span> <span class="o">-</span> <span class="n">lon</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">yClick</span> <span class="o">-</span> <span class="n">lat</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">ind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
        <span class="n">titleStr</span> <span class="o">=</span> <span class="s2">&quot;site_id </span><span class="si">%s</span><span class="s2">, lat </span><span class="si">%.3f</span><span class="s2">, lon </span><span class="si">%.3f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span>
            <span class="n">sites_id</span><span class="p">[</span><span class="n">ind</span><span class="p">],</span>
            <span class="n">lat</span><span class="p">[</span><span class="n">ind</span><span class="p">],</span>
            <span class="n">lon</span><span class="p">[</span><span class="n">ind</span><span class="p">],</span>
        <span class="p">)</span>
        <span class="n">tsLst</span> <span class="o">=</span> <span class="n">dataTs</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span>
        <span class="n">plot_ts_matplot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">tsLst</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax2</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">titleStr</span><span class="p">)</span>
        <span class="c1"># following funcs both work</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
        <span class="c1"># plt.draw()</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">mpl_connect</span><span class="p">(</span><span class="s2">&quot;button_press_event&quot;</span><span class="p">,</span> <span class="n">onclick</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="hydroutils.hydro_plot.plot_ts_matplot" class="doc doc-heading">
<code class="highlight language-python"><span class="n">plot_ts_matplot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#hydroutils.hydro_plot.plot_ts_matplot" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Creates a simple time series plot comparing predicted and observed values.</p>
<p>This function provides a straightforward way to plot and compare two time series,
typically used for showing predicted vs observed values. It supports both creating
new figures and adding to existing axes.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>t</code></td>
        <td><code>list</code></td>
        <td><p>Time points for x-axis.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>y</code></td>
        <td><code>list</code></td>
        <td><p>List containing two arrays: [predicted_values, observed_values].</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>color</code></td>
        <td><code>str</code></td>
        <td><p>Color for predicted values line. Defaults to "r".</p></td>
        <td><code>&#39;r&#39;</code></td>
      </tr>
      <tr>
        <td><code>ax</code></td>
        <td><code>matplotlib.axes.Axes</code></td>
        <td><p>Existing axes to plot on. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>title</code></td>
        <td><code>str</code></td>
        <td><p>Plot title. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Union[Tuple[matplotlib.figure.Figure, matplotlib.axes.Axes], matplotlib.axes.Axes]</code></td>
      <td><p>If ax is None, returns (fig, ax), otherwise returns ax.</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="c1"># Create new plot</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">t</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">/</span><span class="mi">10</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">y_obs</span> <span class="o">=</span> <span class="n">y_pred</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plot_ts_matplot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="p">[</span><span class="n">y_pred</span><span class="p">,</span> <span class="n">y_obs</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
</code></pre></div>
    <div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="c1"># Add to existing axes</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plot_ts_matplot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="p">[</span><span class="n">y_pred</span><span class="p">,</span> <span class="n">y_obs</span><span class="p">],</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
<span class="o">...</span>                     <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Sine Wave Prediction&#39;</span><span class="p">)</span>
</code></pre></div>
      <p>!!! notes
    - Predicted values are plotted first with specified color
    - Observed values are plotted second with default color
    - Legend is automatically added with "pred" and "obs" labels
    - Title is centered if provided</p>

        <details class="quote">
          <summary>Source code in <code>hydroutils/hydro_plot.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_ts_matplot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates a simple time series plot comparing predicted and observed values.</span>

<span class="sd">    This function provides a straightforward way to plot and compare two time series,</span>
<span class="sd">    typically used for showing predicted vs observed values. It supports both creating</span>
<span class="sd">    new figures and adding to existing axes.</span>

<span class="sd">    Args:</span>
<span class="sd">        t (list): Time points for x-axis.</span>
<span class="sd">        y (list): List containing two arrays: [predicted_values, observed_values].</span>
<span class="sd">        color (str, optional): Color for predicted values line. Defaults to &quot;r&quot;.</span>
<span class="sd">        ax (matplotlib.axes.Axes, optional): Existing axes to plot on. Defaults to None.</span>
<span class="sd">        title (str, optional): Plot title. Defaults to None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Union[Tuple[matplotlib.figure.Figure, matplotlib.axes.Axes], matplotlib.axes.Axes]:</span>
<span class="sd">            If ax is None, returns (fig, ax), otherwise returns ax.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; # Create new plot</span>
<span class="sd">        &gt;&gt;&gt; t = list(range(100))</span>
<span class="sd">        &gt;&gt;&gt; y_pred = np.sin(np.array(t)/10)</span>
<span class="sd">        &gt;&gt;&gt; y_obs = y_pred + np.random.normal(0, 0.1, 100)</span>
<span class="sd">        &gt;&gt;&gt; fig, ax = plot_ts_matplot(t, [y_pred, y_obs], color=&#39;blue&#39;)</span>

<span class="sd">        &gt;&gt;&gt; # Add to existing axes</span>
<span class="sd">        &gt;&gt;&gt; fig, ax = plt.subplots()</span>
<span class="sd">        &gt;&gt;&gt; ax = plot_ts_matplot(t, [y_pred, y_obs], ax=ax,</span>
<span class="sd">        ...                     title=&#39;Sine Wave Prediction&#39;)</span>

<span class="sd">    Notes:</span>
<span class="sd">        - Predicted values are plotted first with specified color</span>
<span class="sd">        - Observed values are plotted second with default color</span>
<span class="sd">        - Legend is automatically added with &quot;pred&quot; and &quot;obs&quot; labels</span>
<span class="sd">        - Title is centered if provided</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;pred&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;obs&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">title</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span> <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">ax</span>
</code></pre></div>
        </details>
    </div>

  </div>




  <div class="doc doc-object doc-function">



<h2 id="hydroutils.hydro_plot.swarmplot_without_legend" class="doc doc-heading">
<code class="highlight language-python"><span class="n">swarmplot_without_legend</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">hue</span><span class="p">,</span> <span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="p">,</span> <span class="n">cmap</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#hydroutils.hydro_plot.swarmplot_without_legend" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Creates a swarm plot using seaborn with colorbar instead of legend.</p>
<p>This function creates a swarm plot where points are colored according to a continuous
variable, replacing the default legend with a colorbar for better visualization of
the color scale.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>x</code></td>
        <td></td>
        <td><p>Values for x-axis categories.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>y</code></td>
        <td></td>
        <td><p>Values for y-axis.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>hue</code></td>
        <td></td>
        <td><p>Values determining the color of each point.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>vmin</code></td>
        <td><code>float</code></td>
        <td><p>Minimum value for color normalization.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>vmax</code></td>
        <td><code>float</code></td>
        <td><p>Maximum value for color normalization.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>cmap</code></td>
        <td><code>str</code></td>
        <td><p>Colormap name or matplotlib colormap object.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>**kwargs</code></td>
        <td></td>
        <td><p>Additional keyword arguments passed to sns.swarmplot.</p></td>
        <td><code>{}</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>matplotlib.figure.Figure</code></td>
      <td><p>The figure containing the swarm plot.</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">hue</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">fig</span> <span class="o">=</span> <span class="n">swarmplot_without_legend</span><span class="p">(</span>
<span class="o">...</span>     <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">hue</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span>
<span class="o">...</span> <span class="p">)</span>
</code></pre></div>

        <details class="quote">
          <summary>Source code in <code>hydroutils/hydro_plot.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">swarmplot_without_legend</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">hue</span><span class="p">,</span> <span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="p">,</span> <span class="n">cmap</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates a swarm plot using seaborn with colorbar instead of legend.</span>

<span class="sd">    This function creates a swarm plot where points are colored according to a continuous</span>
<span class="sd">    variable, replacing the default legend with a colorbar for better visualization of</span>
<span class="sd">    the color scale.</span>

<span class="sd">    Args:</span>
<span class="sd">        x: Values for x-axis categories.</span>
<span class="sd">        y: Values for y-axis.</span>
<span class="sd">        hue: Values determining the color of each point.</span>
<span class="sd">        vmin (float): Minimum value for color normalization.</span>
<span class="sd">        vmax (float): Maximum value for color normalization.</span>
<span class="sd">        cmap (str): Colormap name or matplotlib colormap object.</span>
<span class="sd">        **kwargs: Additional keyword arguments passed to sns.swarmplot.</span>

<span class="sd">    Returns:</span>
<span class="sd">        matplotlib.figure.Figure: The figure containing the swarm plot.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; x = [&#39;A&#39;, &#39;A&#39;, &#39;B&#39;, &#39;B&#39;]</span>
<span class="sd">        &gt;&gt;&gt; y = [1, 2, 3, 4]</span>
<span class="sd">        &gt;&gt;&gt; hue = [0.1, 0.5, 0.8, 0.9]</span>
<span class="sd">        &gt;&gt;&gt; fig = swarmplot_without_legend(</span>
<span class="sd">        ...     x, y, hue,</span>
<span class="sd">        ...     vmin=0, vmax=1,</span>
<span class="sd">        ...     cmap=&#39;viridis&#39;</span>
<span class="sd">        ... )</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">swarmplot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">hue</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="c1"># remove the legend, because we want to set a colorbar instead</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
    <span class="n">norm</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="p">)</span>
    <span class="n">sm</span> <span class="o">=</span> <span class="n">ScalarMappable</span><span class="p">(</span><span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">fig</span>
</code></pre></div>
        </details>
    </div>

  </div>






  </div>

    </div>

  </div>







  
    
  
  


  <aside class="md-source-file">
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Last update">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg>
    </span>
    2025-08-19
  </span>

    
    
    
    
  </aside>





                

              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.instant", "search.highlight"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.92b07e13.min.js"></script>
      
    
  </body>
</html>